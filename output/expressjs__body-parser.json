{"repo":"expressjs/body-parser","url":"https://github.com/expressjs/body-parser","branch":"master","configs":[{"package":"body-parser","lang":"js","dir":"test","framework":"mocha","pattern":"**/*.{js,ts}"}],"tests":[{"name":"should default to {}","suites":["bodyParser()"],"updatePoint":{"line":9,"column":26,"index":259},"line":9,"code":"  it('should default to {}', function (done) {\n    request(this.server).post('/').expect(200, '{}', done);\n  });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should parse JSON","suites":["bodyParser()"],"updatePoint":{"line":12,"column":23,"index":369},"line":12,"code":"  it('should parse JSON', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n  });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should parse x-www-form-urlencoded","suites":["bodyParser()"],"updatePoint":{"line":15,"column":40,"index":573},"line":15,"code":"  it('should parse x-www-form-urlencoded', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n  });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should handle duplicated middleware","suites":["bodyParser()"],"updatePoint":{"line":18,"column":41,"index":789},"line":18,"code":"  it('should handle duplicated middleware', function (done) {\n    var _bodyParser = bodyParser();\n    var server = http.createServer(function (req, res) {\n      _bodyParser(req, res, function (err0) {\n        _bodyParser(req, res, function (err1) {\n          var err = err0 || err1;\n          res.statusCode = err ? err.status || 500 : 200;\n          res.end(err ? err.message : JSON.stringify(req.body));\n        });\n      });\n    });\n    request(server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n  });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should parse JSON","suites":["bodyParser()","with type option"],"updatePoint":{"line":63,"column":25,"index":2479},"line":63,"code":"    it('should parse JSON', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n    });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should parse x-www-form-urlencoded","suites":["bodyParser()","with type option"],"updatePoint":{"line":66,"column":42,"index":2689},"line":66,"code":"    it('should parse x-www-form-urlencoded', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n    });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should apply to json","suites":["bodyParser()","with verify option"],"updatePoint":{"line":71,"column":28,"index":2949},"line":71,"code":"    it('should apply to json', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x20) throw new Error('no leading space');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/json').send(' {\"user\":\"tobi\"}').expect(403, '[entity.verify.failed] no leading space', done);\n    });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should apply to urlencoded","suites":["bodyParser()","with verify option"],"updatePoint":{"line":79,"column":34,"index":3336},"line":79,"code":"    it('should apply to urlencoded', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x20) throw new Error('no leading space');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(' user=tobi').expect(403, '[entity.verify.failed] no leading space', done);\n    });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should parse JSON","suites":["bodyParser.json()"],"updatePoint":{"line":9,"column":23,"index":388},"line":9,"code":"  it('should parse JSON', function (done) {\n    request(createServer()).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should handle Content-Length: 0","suites":["bodyParser.json()"],"updatePoint":{"line":12,"column":37,"index":592},"line":12,"code":"  it('should handle Content-Length: 0', function (done) {\n    request(createServer()).get('/').set('Content-Type', 'application/json').set('Content-Length', '0').expect(200, '{}', done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should handle empty message-body","suites":["bodyParser.json()"],"updatePoint":{"line":15,"column":38,"index":786},"line":15,"code":"  it('should handle empty message-body', function (done) {\n    request(createServer()).get('/').set('Content-Type', 'application/json').set('Transfer-Encoding', 'chunked').expect(200, '{}', done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should handle no message-body","suites":["bodyParser.json()"],"updatePoint":{"line":18,"column":35,"index":986},"line":18,"code":"  it('should handle no message-body', function (done) {\n    request(createServer()).get('/').set('Content-Type', 'application/json').unset('Transfer-Encoding').expect(200, '{}', done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 400 when only whitespace","suites":["bodyParser.json()"],"updatePoint":{"line":21,"column":37,"index":1179},"line":21,"code":"  it('should 400 when only whitespace', function (done) {\n    request(createServer()).post('/').set('Content-Type', 'application/json').send('  \\n').expect(400, '[entity.parse.failed] ' + parseError(' '), done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 400 when invalid content-length","suites":["bodyParser.json()"],"updatePoint":{"line":24,"column":44,"index":1404},"line":24,"code":"  it('should 400 when invalid content-length', function (done) {\n    var jsonParser = bodyParser.json();\n    var server = createServer(function (req, res, next) {\n      req.headers['content-length'] = '20'; // bad length\n      jsonParser(req, res, next);\n    });\n    request(server).post('/').set('Content-Type', 'application/json').send('{\"str\":').expect(400, /content length/, done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 500 if stream not readable","suites":["bodyParser.json()"],"updatePoint":{"line":32,"column":39,"index":1791},"line":32,"code":"  it('should 500 if stream not readable', function (done) {\n    var jsonParser = bodyParser.json();\n    var server = createServer(function (req, res, next) {\n      req.on('end', function () {\n        jsonParser(req, res, next);\n      });\n      req.resume();\n    });\n    request(server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(500, '[stream.not.readable] stream is not readable', done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should handle duplicated middleware","suites":["bodyParser.json()"],"updatePoint":{"line":42,"column":41,"index":2226},"line":42,"code":"  it('should handle duplicated middleware', function (done) {\n    var jsonParser = bodyParser.json();\n    var server = createServer(function (req, res, next) {\n      jsonParser(req, res, function (err) {\n        if (err) return next(err);\n        jsonParser(req, res, next);\n      });\n    });\n    request(server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 400 for bad token","suites":["bodyParser.json()","when JSON is invalid"],"updatePoint":{"line":56,"column":32,"index":2766},"line":56,"code":"    it('should 400 for bad token', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/json').send('{:').expect(400, '[entity.parse.failed] ' + parseError('{:'), done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 400 for incomplete","suites":["bodyParser.json()","when JSON is invalid"],"updatePoint":{"line":59,"column":33,"index":2980},"line":59,"code":"    it('should 400 for incomplete', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\"').expect(400, '[entity.parse.failed] ' + parseError('{\"user\"'), done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should include original body on error object","suites":["bodyParser.json()","when JSON is invalid"],"updatePoint":{"line":62,"column":52,"index":3223},"line":62,"code":"    it('should include original body on error object', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/json').set('X-Error-Property', 'body').send(' {\"user\"').expect(400, ' {\"user\"', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with Content-Length","suites":["bodyParser.json()","with limit option"],"updatePoint":{"line":67,"column":54,"index":3515},"line":67,"code":"    it('should 413 when over limit with Content-Length', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      request(createServer({\n        limit: '1kb'\n      })).post('/').set('Content-Type', 'application/json').set('Content-Length', '1034').send(JSON.stringify({\n        str: buf.toString()\n      })).expect(413, '[entity.too.large] request entity too large', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with chunked encoding","suites":["bodyParser.json()","with limit option"],"updatePoint":{"line":75,"column":56,"index":3907},"line":75,"code":"    it('should 413 when over limit with chunked encoding', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/json');\n      test.set('Transfer-Encoding', 'chunked');\n      test.write('{\"str\":');\n      test.write('\"' + buf.toString() + '\"}');\n      test.expect(413, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 413 when inflated body over limit","suites":["bodyParser.json()","with limit option"],"updatePoint":{"line":87,"column":48,"index":4340},"line":87,"code":"    it('should 413 when inflated body over limit', function (done) {\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000aab562a2e2952b252d21b05a360148c58a0540b0066f7ce1e0a040000', 'hex'));\n      test.expect(413, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should accept number of bytes","suites":["bodyParser.json()","with limit option"],"updatePoint":{"line":97,"column":37,"index":4759},"line":97,"code":"    it('should accept number of bytes', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      request(createServer({\n        limit: 1024\n      })).post('/').set('Content-Type', 'application/json').send(JSON.stringify({\n        str: buf.toString()\n      })).expect(413, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should not change when options altered","suites":["bodyParser.json()","with limit option"],"updatePoint":{"line":105,"column":46,"index":5063},"line":105,"code":"    it('should not change when options altered', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      var options = {\n        limit: '1kb'\n      };\n      var server = createServer(options);\n      options.limit = '100kb';\n      request(server).post('/').set('Content-Type', 'application/json').send(JSON.stringify({\n        str: buf.toString()\n      })).expect(413, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should not hang response","suites":["bodyParser.json()","with limit option"],"updatePoint":{"line":116,"column":32,"index":5441},"line":116,"code":"    it('should not hang response', function (done) {\n      var buf = Buffer.alloc(10240, '.');\n      var server = createServer({\n        limit: '8kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/json');\n      test.write(buf);\n      test.write(buf);\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should not error when inflating","suites":["bodyParser.json()","with limit option"],"updatePoint":{"line":128,"column":39,"index":5811},"line":128,"code":"    it('should not error when inflating', function (done) {\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000aab562a2e2952b252d21b05a360148c58a0540b0066f7ce1e0a0400', 'hex'));\n      test.expect(413, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should not accept content-encoding","suites":["bodyParser.json()","with inflate option","when false"],"updatePoint":{"line":146,"column":44,"index":6441},"line":146,"code":"      it('should not accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'application/json');\n        test.write(Buffer.from('1f8b080000000000000bab56ca4bcc4d55b2527ab16e97522d00515be1cc0e000000', 'hex'));\n        test.expect(415, '[encoding.unsupported] content encoding unsupported', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should accept content-encoding","suites":["bodyParser.json()","with inflate option","when true"],"updatePoint":{"line":160,"column":40,"index":7020},"line":160,"code":"      it('should accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'application/json');\n        test.write(Buffer.from('1f8b080000000000000bab56ca4bcc4d55b2527ab16e97522d00515be1cc0e000000', 'hex'));\n        test.expect(200, '{\"name\":\"论\"}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 400 on primitives","suites":["bodyParser.json()","with strict option","when undefined"],"updatePoint":{"line":174,"column":34,"index":7577},"line":174,"code":"      it('should 400 on primitives', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').send('true').expect(400, '[entity.parse.failed] ' + parseError('#rue').replace(/#/g, 't'), done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse primitives","suites":["bodyParser.json()","with strict option","when false"],"updatePoint":{"line":184,"column":33,"index":7977},"line":184,"code":"      it('should parse primitives', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').send('true').expect(200, 'true', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should not parse primitives","suites":["bodyParser.json()","with strict option","when true"],"updatePoint":{"line":194,"column":37,"index":8321},"line":194,"code":"      it('should not parse primitives', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').send('true').expect(400, '[entity.parse.failed] ' + parseError('#rue').replace(/#/g, 't'), done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should not parse primitives with leading whitespaces","suites":["bodyParser.json()","with strict option","when true"],"updatePoint":{"line":197,"column":62,"index":8591},"line":197,"code":"      it('should not parse primitives with leading whitespaces', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').send('    true').expect(400, '[entity.parse.failed] ' + parseError('    #rue').replace(/#/g, 't'), done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should allow leading whitespaces in JSON","suites":["bodyParser.json()","with strict option","when true"],"updatePoint":{"line":200,"column":50,"index":8857},"line":200,"code":"      it('should allow leading whitespaces in JSON', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').send('   { \"user\": \"tobi\" }').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should include correct message in stack trace","suites":["bodyParser.json()","with strict option","when true"],"updatePoint":{"line":203,"column":55,"index":9090},"line":203,"code":"      it('should include correct message in stack trace', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').set('X-Error-Property', 'stack').send('true').expect(400).expect(shouldContainInBody(parseError('#rue').replace(/#/g, 't'))).end(done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse JSON for custom type","suites":["bodyParser.json()","with type option","when \"application/vnd.api+json\""],"updatePoint":{"line":215,"column":43,"index":9629},"line":215,"code":"      it('should parse JSON for custom type', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/vnd.api+json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should ignore standard type","suites":["bodyParser.json()","with type option","when \"application/vnd.api+json\""],"updatePoint":{"line":218,"column":37,"index":9846},"line":218,"code":"      it('should ignore standard type', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse JSON for \"application/json\"","suites":["bodyParser.json()","with type option","when [\"application/json\", \"application/vnd.api+json\"]"],"updatePoint":{"line":228,"column":50,"index":10298},"line":228,"code":"      it('should parse JSON for \"application/json\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse JSON for \"application/vnd.api+json\"","suites":["bodyParser.json()","with type option","when [\"application/json\", \"application/vnd.api+json\"]"],"updatePoint":{"line":231,"column":58,"index":10528},"line":231,"code":"      it('should parse JSON for \"application/vnd.api+json\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/vnd.api+json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should ignore \"application/x-json\"","suites":["bodyParser.json()","with type option","when [\"application/json\", \"application/vnd.api+json\"]"],"updatePoint":{"line":234,"column":44,"index":10752},"line":234,"code":"      it('should ignore \"application/x-json\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-json').send('{\"user\":\"tobi\"}').expect(200, '{}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse when truthy value returned","suites":["bodyParser.json()","with type option","when a function"],"updatePoint":{"line":239,"column":49,"index":11016},"line":239,"code":"      it('should parse when truthy value returned', function (done) {\n        var server = createServer({\n          type: accept\n        });\n        function accept(req) {\n          return req.headers['content-type'] === 'application/vnd.api+json';\n        }\n        request(server).post('/').set('Content-Type', 'application/vnd.api+json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should work without content-type","suites":["bodyParser.json()","with type option","when a function"],"updatePoint":{"line":248,"column":42,"index":11422},"line":248,"code":"      it('should work without content-type', function (done) {\n        var server = createServer({\n          type: accept\n        });\n        function accept(req) {\n          return true;\n        }\n        var test = request(server).post('/');\n        test.write('{\"user\":\"tobi\"}');\n        test.expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should not invoke without a body","suites":["bodyParser.json()","with type option","when a function"],"updatePoint":{"line":259,"column":42,"index":11766},"line":259,"code":"      it('should not invoke without a body', function (done) {\n        var server = createServer({\n          type: accept\n        });\n        function accept(req) {\n          throw new Error('oops!');\n        }\n        request(server).get('/').expect(200, done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should assert value if function","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":271,"column":39,"index":12097},"line":271,"code":"    it('should assert value if function', function () {\n      assert.throws(createServer.bind(null, {\n        verify: 'lol'\n      }), /TypeError: option verify must be function/);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should error from verify","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":276,"column":32,"index":12278},"line":276,"code":"    it('should error from verify', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x5b) throw new Error('no arrays');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/json').send('[\"tobi\"]').expect(403, '[entity.verify.failed] no arrays', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should allow custom codes","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":284,"column":33,"index":12642},"line":284,"code":"    it('should allow custom codes', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] !== 0x5b) return;\n          var err = new Error('no arrays');\n          err.status = 400;\n          throw err;\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/json').send('[\"tobi\"]').expect(400, '[entity.verify.failed] no arrays', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should allow custom type","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":295,"column":32,"index":13076},"line":295,"code":"    it('should allow custom type', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] !== 0x5b) return;\n          var err = new Error('no arrays');\n          err.type = 'foo.bar';\n          throw err;\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/json').send('[\"tobi\"]').expect(403, '[foo.bar] no arrays', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should include original body on error object","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":306,"column":52,"index":13521},"line":306,"code":"    it('should include original body on error object', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x5b) throw new Error('no arrays');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/json').set('X-Error-Property', 'body').send('[\"tobi\"]').expect(403, '[\"tobi\"]', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should allow pass-through","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":314,"column":33,"index":13893},"line":314,"code":"    it('should allow pass-through', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x5b) throw new Error('no arrays');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should work with different charsets","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":322,"column":43,"index":14257},"line":322,"code":"    it('should work with different charsets', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x5b) throw new Error('no arrays');\n        }\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/json; charset=utf-16');\n      test.write(Buffer.from('feff007b0022006e0061006d00650022003a00228bba0022007d', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown charset prior to verify","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":333,"column":53,"index":14749},"line":333,"code":"    it('should 415 on unknown charset prior to verify', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          throw new Error('unexpected verify call');\n        }\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/json; charset=x-bogus');\n      test.write(Buffer.from('00000000', 'hex'));\n      test.expect(415, '[charset.unsupported] unsupported charset \"X-BOGUS\"', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should presist store","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":364,"column":28,"index":15834},"line":364,"code":"    it('should presist store', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200).expect('x-store-foo', 'bar').expect('{\"user\":\"tobi\"}').end(done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should presist store when unmatched content-type","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":367,"column":56,"index":16098},"line":367,"code":"    it('should presist store when unmatched content-type', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/fizzbuzz').send('buzz').expect(200).expect('x-store-foo', 'bar').expect('{}').end(done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should presist store when inflated","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":370,"column":42,"index":16328},"line":370,"code":"    it('should presist store when inflated', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000bab56ca4bcc4d55b2527ab16e97522d00515be1cc0e000000', 'hex'));\n      test.expect(200);\n      test.expect('x-store-foo', 'bar');\n      test.expect('{\"name\":\"论\"}');\n      test.end(done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should presist store when inflate error","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":380,"column":47,"index":16781},"line":380,"code":"    it('should presist store when inflate error', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000bab56cc4d55b2527ab16e97522d00515be1cc0e000000', 'hex'));\n      test.expect(400);\n      test.expect('x-store-foo', 'bar');\n      test.end(done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should presist store when parse error","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":389,"column":45,"index":17193},"line":389,"code":"    it('should presist store when parse error', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\":').expect(400).expect('x-store-foo', 'bar').end(done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should presist store when limit exceeded","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":392,"column":48,"index":17416},"line":392,"code":"    it('should presist store when limit exceeded', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"' + Buffer.alloc(1024 * 100, '.').toString() + '\"}').expect(413).expect('x-store-foo', 'bar').end(done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse utf-8","suites":["bodyParser.json()","charset"],"updatePoint":{"line":400,"column":26,"index":17779},"line":400,"code":"    it('should parse utf-8', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/json; charset=utf-8');\n      test.write(Buffer.from('7b226e616d65223a22e8aeba227d', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse utf-16","suites":["bodyParser.json()","charset"],"updatePoint":{"line":406,"column":27,"index":18067},"line":406,"code":"    it('should parse utf-16', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/json; charset=utf-16');\n      test.write(Buffer.from('feff007b0022006e0061006d00650022003a00228bba0022007d', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse when content-length != char length","suites":["bodyParser.json()","charset"],"updatePoint":{"line":412,"column":55,"index":18408},"line":412,"code":"    it('should parse when content-length != char length', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/json; charset=utf-8');\n      test.set('Content-Length', '13');\n      test.write(Buffer.from('7b2274657374223a22c3a5227d', 'hex'));\n      test.expect(200, '{\"test\":\"å\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should default to utf-8","suites":["bodyParser.json()","charset"],"updatePoint":{"line":419,"column":31,"index":18738},"line":419,"code":"    it('should default to utf-8', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('7b226e616d65223a22e8aeba227d', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should fail on unknown charset","suites":["bodyParser.json()","charset"],"updatePoint":{"line":425,"column":38,"index":19022},"line":425,"code":"    it('should fail on unknown charset', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/json; charset=koi8-r');\n      test.write(Buffer.from('7b226e616d65223a22cec5d4227d', 'hex'));\n      test.expect(415, '[charset.unsupported] unsupported charset \"KOI8-R\"', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse without encoding","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":438,"column":37,"index":19501},"line":438,"code":"    it('should parse without encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('7b226e616d65223a22e8aeba227d', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should support identity encoding","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":444,"column":40,"index":19787},"line":444,"code":"    it('should support identity encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'identity');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('7b226e616d65223a22e8aeba227d', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should support gzip encoding","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":451,"column":36,"index":20117},"line":451,"code":"    it('should support gzip encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000bab56ca4bcc4d55b2527ab16e97522d00515be1cc0e000000', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should support deflate encoding","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":458,"column":39,"index":20486},"line":458,"code":"    it('should support deflate encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'deflate');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('789cab56ca4bcc4d55b2527ab16e97522d00274505ac', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should be case-insensitive","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":465,"column":34,"index":20829},"line":465,"code":"    it('should be case-insensitive', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'GZIP');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000bab56ca4bcc4d55b2527ab16e97522d00515be1cc0e000000', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown encoding","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":472,"column":38,"index":21197},"line":472,"code":"    it('should 415 on unknown encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'nulls');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('000000000000', 'hex'));\n      test.expect(415, '[encoding.unsupported] unsupported content encoding \"nulls\"', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 400 on malformed encoding","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":479,"column":40,"index":21559},"line":479,"code":"    it('should 400 on malformed encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000bab56cc4d55b2527ab16e97522d00515be1cc0e000000', 'hex'));\n      test.expect(400, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 413 when inflated value exceeds limit","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":486,"column":52,"index":21921},"line":486,"code":"    it('should 413 when inflated value exceeds limit', function (done) {\n      // gzip'd data exceeds 1kb, but deflated below 1kb\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000bedc1010d000000c2a0f74f6d0f071400000000000000', 'hex'));\n      test.write(Buffer.from('0000000000000000000000000000000000000000000000000000000000000000', 'hex'));\n      test.write(Buffer.from('0000000000000000004f0625b3b71650c30000', 'hex'));\n      test.expect(413, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse application/octet-stream","suites":["bodyParser.raw()"],"updatePoint":{"line":12,"column":43,"index":470},"line":12,"code":"  it('should parse application/octet-stream', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/octet-stream').send('the user is tobi').expect(200, 'buf:746865207573657220697320746f6269', done);\n  });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should 400 when invalid content-length","suites":["bodyParser.raw()"],"updatePoint":{"line":15,"column":44,"index":708},"line":15,"code":"  it('should 400 when invalid content-length', function (done) {\n    var rawParser = bodyParser.raw();\n    var server = createServer(function (req, res, next) {\n      req.headers['content-length'] = '20'; // bad length\n      rawParser(req, res, next);\n    });\n    request(server).post('/').set('Content-Type', 'application/octet-stream').send('stuff').expect(400, /content length/, done);\n  });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should handle Content-Length: 0","suites":["bodyParser.raw()"],"updatePoint":{"line":23,"column":37,"index":1096},"line":23,"code":"  it('should handle Content-Length: 0', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/octet-stream').set('Content-Length', '0').expect(200, 'buf:', done);\n  });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should handle empty message-body","suites":["bodyParser.raw()"],"updatePoint":{"line":26,"column":38,"index":1298},"line":26,"code":"  it('should handle empty message-body', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/octet-stream').set('Transfer-Encoding', 'chunked').send('').expect(200, 'buf:', done);\n  });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should 500 if stream not readable","suites":["bodyParser.raw()"],"updatePoint":{"line":29,"column":39,"index":1519},"line":29,"code":"  it('should 500 if stream not readable', function (done) {\n    var rawParser = bodyParser.raw();\n    var server = createServer(function (req, res, next) {\n      req.on('end', function () {\n        rawParser(req, res, next);\n      });\n      req.resume();\n    });\n    request(server).post('/').set('Content-Type', 'application/octet-stream').send('the user is tobi').expect(500, '[stream.not.readable] stream is not readable', done);\n  });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should handle duplicated middleware","suites":["bodyParser.raw()"],"updatePoint":{"line":39,"column":41,"index":1960},"line":39,"code":"  it('should handle duplicated middleware', function (done) {\n    var rawParser = bodyParser.raw();\n    var server = createServer(function (req, res, next) {\n      rawParser(req, res, function (err) {\n        if (err) return next(err);\n        rawParser(req, res, next);\n      });\n    });\n    request(server).post('/').set('Content-Type', 'application/octet-stream').send('the user is tobi').expect(200, 'buf:746865207573657220697320746f6269', done);\n  });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with Content-Length","suites":["bodyParser.raw()","with limit option"],"updatePoint":{"line":50,"column":54,"index":2476},"line":50,"code":"    it('should 413 when over limit with Content-Length', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.set('Content-Length', '1028');\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with chunked encoding","suites":["bodyParser.raw()","with limit option"],"updatePoint":{"line":61,"column":56,"index":2866},"line":61,"code":"    it('should 413 when over limit with chunked encoding', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.set('Transfer-Encoding', 'chunked');\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should 413 when inflated body over limit","suites":["bodyParser.raw()","with limit option"],"updatePoint":{"line":72,"column":48,"index":3254},"line":72,"code":"    it('should 413 when inflated body over limit', function (done) {\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('1f8b080000000000000ad3d31b05a360148c64000087e5a14704040000', 'hex'));\n      test.expect(413, done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should accept number of bytes","suites":["bodyParser.raw()","with limit option"],"updatePoint":{"line":82,"column":37,"index":3663},"line":82,"code":"    it('should accept number of bytes', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      var server = createServer({\n        limit: 1024\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should not change when options altered","suites":["bodyParser.raw()","with limit option"],"updatePoint":{"line":92,"column":46,"index":4000},"line":92,"code":"    it('should not change when options altered', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      var options = {\n        limit: '1kb'\n      };\n      var server = createServer(options);\n      options.limit = '100kb';\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should not hang response","suites":["bodyParser.raw()","with limit option"],"updatePoint":{"line":104,"column":32,"index":4384},"line":104,"code":"    it('should not hang response', function (done) {\n      var buf = Buffer.alloc(10240, '.');\n      var server = createServer({\n        limit: '8kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(buf);\n      test.write(buf);\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should not error when inflating","suites":["bodyParser.raw()","with limit option"],"updatePoint":{"line":116,"column":39,"index":4762},"line":116,"code":"    it('should not error when inflating', function (done) {\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('1f8b080000000000000ad3d31b05a360148c64000087e5a147040400', 'hex'));\n      test.expect(413, done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should not accept content-encoding","suites":["bodyParser.raw()","with inflate option","when false"],"updatePoint":{"line":134,"column":44,"index":5382},"line":134,"code":"      it('should not accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'application/octet-stream');\n        test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n        test.expect(415, '[encoding.unsupported] content encoding unsupported', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should accept content-encoding","suites":["bodyParser.raw()","with inflate option","when true"],"updatePoint":{"line":148,"column":40,"index":5957},"line":148,"code":"      it('should accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'application/octet-stream');\n        test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n        test.expect(200, 'buf:6e616d653de8aeba', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should parse for custom type","suites":["bodyParser.raw()","with type option","when \"application/vnd+octets\""],"updatePoint":{"line":164,"column":38,"index":6587},"line":164,"code":"      it('should parse for custom type', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Type', 'application/vnd+octets');\n        test.write(Buffer.from('000102', 'hex'));\n        test.expect(200, 'buf:000102', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should ignore standard type","suites":["bodyParser.raw()","with type option","when \"application/vnd+octets\""],"updatePoint":{"line":170,"column":37,"index":6862},"line":170,"code":"      it('should ignore standard type', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Type', 'application/octet-stream');\n        test.write(Buffer.from('000102', 'hex'));\n        test.expect(200, '{}', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should parse \"application/octet-stream\"","suites":["bodyParser.raw()","with type option","when [\"application/octet-stream\", \"application/vnd+octets\"]"],"updatePoint":{"line":183,"column":49,"index":7398},"line":183,"code":"      it('should parse \"application/octet-stream\"', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Type', 'application/octet-stream');\n        test.write(Buffer.from('000102', 'hex'));\n        test.expect(200, 'buf:000102', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should parse \"application/vnd+octets\"","suites":["bodyParser.raw()","with type option","when [\"application/octet-stream\", \"application/vnd+octets\"]"],"updatePoint":{"line":189,"column":47,"index":7685},"line":189,"code":"      it('should parse \"application/vnd+octets\"', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Type', 'application/vnd+octets');\n        test.write(Buffer.from('000102', 'hex'));\n        test.expect(200, 'buf:000102', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should ignore \"application/x-foo\"","suites":["bodyParser.raw()","with type option","when [\"application/octet-stream\", \"application/vnd+octets\"]"],"updatePoint":{"line":195,"column":43,"index":7966},"line":195,"code":"      it('should ignore \"application/x-foo\"', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Type', 'application/x-foo');\n        test.write(Buffer.from('000102', 'hex'));\n        test.expect(200, '{}', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should parse when truthy value returned","suites":["bodyParser.raw()","with type option","when a function"],"updatePoint":{"line":203,"column":49,"index":8294},"line":203,"code":"      it('should parse when truthy value returned', function (done) {\n        var server = createServer({\n          type: accept\n        });\n        function accept(req) {\n          return req.headers['content-type'] === 'application/vnd.octet';\n        }\n        var test = request(server).post('/');\n        test.set('Content-Type', 'application/vnd.octet');\n        test.write(Buffer.from('000102', 'hex'));\n        test.expect(200, 'buf:000102', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should work without content-type","suites":["bodyParser.raw()","with type option","when a function"],"updatePoint":{"line":215,"column":42,"index":8754},"line":215,"code":"      it('should work without content-type', function (done) {\n        var server = createServer({\n          type: accept\n        });\n        function accept(req) {\n          return true;\n        }\n        var test = request(server).post('/');\n        test.write(Buffer.from('000102', 'hex'));\n        test.expect(200, 'buf:000102', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should not invoke without a body","suites":["bodyParser.raw()","with type option","when a function"],"updatePoint":{"line":226,"column":42,"index":9104},"line":226,"code":"      it('should not invoke without a body', function (done) {\n        var server = createServer({\n          type: accept\n        });\n        function accept(req) {\n          throw new Error('oops!');\n        }\n        request(server).get('/').expect(200, done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should assert value is function","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":238,"column":39,"index":9435},"line":238,"code":"    it('should assert value is function', function () {\n      assert.throws(createServer.bind(null, {\n        verify: 'lol'\n      }), /TypeError: option verify must be function/);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should error from verify","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":243,"column":32,"index":9616},"line":243,"code":"    it('should error from verify', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x00) throw new Error('no leading null');\n        }\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('000102', 'hex'));\n      test.expect(403, '[entity.verify.failed] no leading null', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should allow custom codes","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":254,"column":33,"index":10066},"line":254,"code":"    it('should allow custom codes', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] !== 0x00) return;\n          var err = new Error('no leading null');\n          err.status = 400;\n          throw err;\n        }\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('000102', 'hex'));\n      test.expect(400, '[entity.verify.failed] no leading null', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should allow pass-through","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":268,"column":33,"index":10587},"line":268,"code":"    it('should allow pass-through', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x00) throw new Error('no leading null');\n        }\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('0102', 'hex'));\n      test.expect(200, 'buf:0102', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should presist store","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":299,"column":28,"index":11627},"line":299,"code":"    it('should presist store', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/octet-stream').send('the user is tobi').expect(200).expect('x-store-foo', 'bar').expect('buf:746865207573657220697320746f6269').end(done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should presist store when unmatched content-type","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":302,"column":56,"index":11921},"line":302,"code":"    it('should presist store when unmatched content-type', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/fizzbuzz').send('buzz').expect(200).expect('x-store-foo', 'bar').expect('{}').end(done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should presist store when inflated","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":305,"column":42,"index":12151},"line":305,"code":"    it('should presist store when inflated', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n      test.expect(200);\n      test.expect('x-store-foo', 'bar');\n      test.expect('buf:6e616d653de8aeba');\n      test.end(done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should presist store when inflate error","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":315,"column":47,"index":12608},"line":315,"code":"    it('should presist store when inflate error', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad6080000', 'hex'));\n      test.expect(400);\n      test.expect('x-store-foo', 'bar');\n      test.end(done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should presist store when limit exceeded","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":324,"column":48,"index":13021},"line":324,"code":"    it('should presist store when limit exceeded', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/octet-stream').send('the user is ' + Buffer.alloc(1024 * 100, '.').toString()).expect(413).expect('x-store-foo', 'bar').end(done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should ignore charset","suites":["bodyParser.raw()","charset"],"updatePoint":{"line":332,"column":29,"index":13391},"line":332,"code":"    it('should ignore charset', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/octet-stream; charset=utf-8');\n      test.write(Buffer.from('6e616d6520697320e8aeba', 'hex'));\n      test.expect(200, 'buf:6e616d6520697320e8aeba', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should parse without encoding","suites":["bodyParser.raw()","encoding"],"updatePoint":{"line":345,"column":37,"index":13848},"line":345,"code":"    it('should parse without encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('6e616d653de8aeba', 'hex'));\n      test.expect(200, 'buf:6e616d653de8aeba', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should support identity encoding","suites":["bodyParser.raw()","encoding"],"updatePoint":{"line":351,"column":40,"index":14138},"line":351,"code":"    it('should support identity encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'identity');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('6e616d653de8aeba', 'hex'));\n      test.expect(200, 'buf:6e616d653de8aeba', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should support gzip encoding","suites":["bodyParser.raw()","encoding"],"updatePoint":{"line":358,"column":36,"index":14472},"line":358,"code":"    it('should support gzip encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n      test.expect(200, 'buf:6e616d653de8aeba', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should support deflate encoding","suites":["bodyParser.raw()","encoding"],"updatePoint":{"line":365,"column":39,"index":14845},"line":365,"code":"    it('should support deflate encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'deflate');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('789ccb4bcc4db57db16e17001068042f', 'hex'));\n      test.expect(200, 'buf:6e616d653de8aeba', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should be case-insensitive","suites":["bodyParser.raw()","encoding"],"updatePoint":{"line":372,"column":34,"index":15192},"line":372,"code":"    it('should be case-insensitive', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'GZIP');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n      test.expect(200, 'buf:6e616d653de8aeba', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown encoding","suites":["bodyParser.raw()","encoding"],"updatePoint":{"line":379,"column":38,"index":15564},"line":379,"code":"    it('should 415 on unknown encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'nulls');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('000000000000', 'hex'));\n      test.expect(415, '[encoding.unsupported] unsupported content encoding \"nulls\"', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should parse text/plain","suites":["bodyParser.text()"],"updatePoint":{"line":12,"column":29,"index":457},"line":12,"code":"  it('should parse text/plain', function (done) {\n    request(this.server).post('/').set('Content-Type', 'text/plain').send('user is tobi').expect(200, '\"user is tobi\"', done);\n  });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 400 when invalid content-length","suites":["bodyParser.text()"],"updatePoint":{"line":15,"column":44,"index":655},"line":15,"code":"  it('should 400 when invalid content-length', function (done) {\n    var textParser = bodyParser.text();\n    var server = createServer(function (req, res, next) {\n      req.headers['content-length'] = '20'; // bad length\n      textParser(req, res, next);\n    });\n    request(server).post('/').set('Content-Type', 'text/plain').send('user').expect(400, /content length/, done);\n  });","file":"text.js","skipped":false,"dir":"test"},{"name":"should handle Content-Length: 0","suites":["bodyParser.text()"],"updatePoint":{"line":23,"column":37,"index":1031},"line":23,"code":"  it('should handle Content-Length: 0', function (done) {\n    request(createServer({\n      limit: '1kb'\n    })).post('/').set('Content-Type', 'text/plain').set('Content-Length', '0').expect(200, '\"\"', done);\n  });","file":"text.js","skipped":false,"dir":"test"},{"name":"should handle empty message-body","suites":["bodyParser.text()"],"updatePoint":{"line":28,"column":38,"index":1246},"line":28,"code":"  it('should handle empty message-body', function (done) {\n    request(createServer({\n      limit: '1kb'\n    })).post('/').set('Content-Type', 'text/plain').set('Transfer-Encoding', 'chunked').send('').expect(200, '\"\"', done);\n  });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 500 if stream not readable","suites":["bodyParser.text()"],"updatePoint":{"line":33,"column":39,"index":1480},"line":33,"code":"  it('should 500 if stream not readable', function (done) {\n    var textParser = bodyParser.text();\n    var server = createServer(function (req, res, next) {\n      req.on('end', function () {\n        textParser(req, res, next);\n      });\n      req.resume();\n    });\n    request(server).post('/').set('Content-Type', 'text/plain').send('user is tobi').expect(500, '[stream.not.readable] stream is not readable', done);\n  });","file":"text.js","skipped":false,"dir":"test"},{"name":"should handle duplicated middleware","suites":["bodyParser.text()"],"updatePoint":{"line":43,"column":41,"index":1906},"line":43,"code":"  it('should handle duplicated middleware', function (done) {\n    var textParser = bodyParser.text();\n    var server = createServer(function (req, res, next) {\n      textParser(req, res, function (err) {\n        if (err) return next(err);\n        textParser(req, res, next);\n      });\n    });\n    request(server).post('/').set('Content-Type', 'text/plain').send('user is tobi').expect(200, '\"user is tobi\"', done);\n  });","file":"text.js","skipped":false,"dir":"test"},{"name":"should change default charset","suites":["bodyParser.text()","with defaultCharset option"],"updatePoint":{"line":54,"column":37,"index":2378},"line":54,"code":"    it('should change default charset', function (done) {\n      var server = createServer({\n        defaultCharset: 'koi8-r'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('6e616d6520697320cec5d4', 'hex'));\n      test.expect(200, '\"name is нет\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should honor content-type charset","suites":["bodyParser.text()","with defaultCharset option"],"updatePoint":{"line":63,"column":41,"index":2726},"line":63,"code":"    it('should honor content-type charset', function (done) {\n      var server = createServer({\n        defaultCharset: 'koi8-r'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'text/plain; charset=utf-8');\n      test.write(Buffer.from('6e616d6520697320e8aeba', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with Content-Length","suites":["bodyParser.text()","with limit option"],"updatePoint":{"line":74,"column":54,"index":3152},"line":74,"code":"    it('should 413 when over limit with Content-Length', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      request(createServer({\n        limit: '1kb'\n      })).post('/').set('Content-Type', 'text/plain').set('Content-Length', '1028').send(buf.toString()).expect(413, done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with chunked encoding","suites":["bodyParser.text()","with limit option"],"updatePoint":{"line":80,"column":56,"index":3452},"line":80,"code":"    it('should 413 when over limit with chunked encoding', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'text/plain');\n      test.set('Transfer-Encoding', 'chunked');\n      test.write(buf.toString());\n      test.expect(413, done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 413 when inflated body over limit","suites":["bodyParser.text()","with limit option"],"updatePoint":{"line":91,"column":48,"index":3837},"line":91,"code":"    it('should 413 when inflated body over limit', function (done) {\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('1f8b080000000000000ad3d31b05a360148c64000087e5a14704040000', 'hex'));\n      test.expect(413, done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should accept number of bytes","suites":["bodyParser.text()","with limit option"],"updatePoint":{"line":101,"column":37,"index":4232},"line":101,"code":"    it('should accept number of bytes', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      request(createServer({\n        limit: 1024\n      })).post('/').set('Content-Type', 'text/plain').send(buf.toString()).expect(413, done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should not change when options altered","suites":["bodyParser.text()","with limit option"],"updatePoint":{"line":107,"column":46,"index":4491},"line":107,"code":"    it('should not change when options altered', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      var options = {\n        limit: '1kb'\n      };\n      var server = createServer(options);\n      options.limit = '100kb';\n      request(server).post('/').set('Content-Type', 'text/plain').send(buf.toString()).expect(413, done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should not hang response","suites":["bodyParser.text()","with limit option"],"updatePoint":{"line":116,"column":32,"index":4824},"line":116,"code":"    it('should not hang response', function (done) {\n      var buf = Buffer.alloc(10240, '.');\n      var server = createServer({\n        limit: '8kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'text/plain');\n      test.write(buf);\n      test.write(buf);\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should not error when inflating","suites":["bodyParser.text()","with limit option"],"updatePoint":{"line":128,"column":39,"index":5188},"line":128,"code":"    it('should not error when inflating', function (done) {\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('1f8b080000000000000ad3d31b05a360148c64000087e5a1470404', 'hex'));\n      setTimeout(function () {\n        test.expect(413, done);\n      }, 100);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should not accept content-encoding","suites":["bodyParser.text()","with inflate option","when false"],"updatePoint":{"line":148,"column":44,"index":5840},"line":148,"code":"      it('should not accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'text/plain');\n        test.write(Buffer.from('1f8b080000000000000bcb4bcc4d55c82c5678b16e170072b3e0200b000000', 'hex'));\n        test.expect(415, '[encoding.unsupported] content encoding unsupported', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should accept content-encoding","suites":["bodyParser.text()","with inflate option","when true"],"updatePoint":{"line":162,"column":40,"index":6407},"line":162,"code":"      it('should accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'text/plain');\n        test.write(Buffer.from('1f8b080000000000000bcb4bcc4d55c82c5678b16e170072b3e0200b000000', 'hex'));\n        test.expect(200, '\"name is 论\"', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse for custom type","suites":["bodyParser.text()","with type option","when \"text/html\""],"updatePoint":{"line":178,"column":38,"index":6994},"line":178,"code":"      it('should parse for custom type', function (done) {\n        request(this.server).post('/').set('Content-Type', 'text/html').send('<b>tobi</b>').expect(200, '\"<b>tobi</b>\"', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should ignore standard type","suites":["bodyParser.text()","with type option","when \"text/html\""],"updatePoint":{"line":181,"column":37,"index":7190},"line":181,"code":"      it('should ignore standard type', function (done) {\n        request(this.server).post('/').set('Content-Type', 'text/plain').send('user is tobi').expect(200, '{}', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse \"text/html\"","suites":["bodyParser.text()","with type option","when [\"text/html\", \"text/plain\"]"],"updatePoint":{"line":191,"column":34,"index":7575},"line":191,"code":"      it('should parse \"text/html\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'text/html').send('<b>tobi</b>').expect(200, '\"<b>tobi</b>\"', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse \"text/plain\"","suites":["bodyParser.text()","with type option","when [\"text/html\", \"text/plain\"]"],"updatePoint":{"line":194,"column":35,"index":7769},"line":194,"code":"      it('should parse \"text/plain\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'text/plain').send('tobi').expect(200, '\"tobi\"', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should ignore \"text/xml\"","suites":["bodyParser.text()","with type option","when [\"text/html\", \"text/plain\"]"],"updatePoint":{"line":197,"column":34,"index":7949},"line":197,"code":"      it('should ignore \"text/xml\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'text/xml').send('<user>tobi</user>').expect(200, '{}', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse when truthy value returned","suites":["bodyParser.text()","with type option","when a function"],"updatePoint":{"line":202,"column":49,"index":8205},"line":202,"code":"      it('should parse when truthy value returned', function (done) {\n        var server = createServer({\n          type: accept\n        });\n        function accept(req) {\n          return req.headers['content-type'] === 'text/vnd.something';\n        }\n        request(server).post('/').set('Content-Type', 'text/vnd.something').send('user is tobi').expect(200, '\"user is tobi\"', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should work without content-type","suites":["bodyParser.text()","with type option","when a function"],"updatePoint":{"line":211,"column":42,"index":8595},"line":211,"code":"      it('should work without content-type', function (done) {\n        var server = createServer({\n          type: accept\n        });\n        function accept(req) {\n          return true;\n        }\n        var test = request(server).post('/');\n        test.write('user is tobi');\n        test.expect(200, '\"user is tobi\"', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should not invoke without a body","suites":["bodyParser.text()","with type option","when a function"],"updatePoint":{"line":222,"column":42,"index":8935},"line":222,"code":"      it('should not invoke without a body', function (done) {\n        var server = createServer({\n          type: accept\n        });\n        function accept(req) {\n          throw new Error('oops!');\n        }\n        request(server).get('/').expect(200, done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should assert value is function","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":234,"column":39,"index":9266},"line":234,"code":"    it('should assert value is function', function () {\n      assert.throws(createServer.bind(null, {\n        verify: 'lol'\n      }), /TypeError: option verify must be function/);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should error from verify","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":239,"column":32,"index":9447},"line":239,"code":"    it('should error from verify', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x20) throw new Error('no leading space');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'text/plain').send(' user is tobi').expect(403, '[entity.verify.failed] no leading space', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should allow custom codes","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":247,"column":33,"index":9824},"line":247,"code":"    it('should allow custom codes', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] !== 0x20) return;\n          var err = new Error('no leading space');\n          err.status = 400;\n          throw err;\n        }\n      });\n      request(server).post('/').set('Content-Type', 'text/plain').send(' user is tobi').expect(400, '[entity.verify.failed] no leading space', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should allow pass-through","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":258,"column":33,"index":10272},"line":258,"code":"    it('should allow pass-through', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x20) throw new Error('no leading space');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'text/plain').send('user is tobi').expect(200, '\"user is tobi\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown charset prior to verify","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":266,"column":53,"index":10643},"line":266,"code":"    it('should 415 on unknown charset prior to verify', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          throw new Error('unexpected verify call');\n        }\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'text/plain; charset=x-bogus');\n      test.write(Buffer.from('00000000', 'hex'));\n      test.expect(415, '[charset.unsupported] unsupported charset \"X-BOGUS\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should presist store","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":297,"column":28,"index":11722},"line":297,"code":"    it('should presist store', function (done) {\n      request(this.server).post('/').set('Content-Type', 'text/plain').send('user is tobi').expect(200).expect('x-store-foo', 'bar').expect('\"user is tobi\"').end(done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should presist store when unmatched content-type","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":300,"column":56,"index":11976},"line":300,"code":"    it('should presist store when unmatched content-type', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/fizzbuzz').send('buzz').expect(200).expect('x-store-foo', 'bar').expect('{}').end(done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should presist store when inflated","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":303,"column":42,"index":12206},"line":303,"code":"    it('should presist store when inflated', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4d55c82c5678b16e170072b3e0200b000000', 'hex'));\n      test.expect(200);\n      test.expect('x-store-foo', 'bar');\n      test.expect('\"name is 论\"');\n      test.end(done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should presist store when inflate error","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":313,"column":47,"index":12646},"line":313,"code":"    it('should presist store when inflate error', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4d55c82c5678b16e170072b3e0200b0000', 'hex'));\n      test.expect(400);\n      test.expect('x-store-foo', 'bar');\n      test.end(done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should presist store when limit exceeded","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":322,"column":48,"index":13051},"line":322,"code":"    it('should presist store when limit exceeded', function (done) {\n      request(this.server).post('/').set('Content-Type', 'text/plain').send('user is ' + Buffer.alloc(1024 * 100, '.').toString()).expect(413).expect('x-store-foo', 'bar').end(done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse utf-8","suites":["bodyParser.text()","charset"],"updatePoint":{"line":330,"column":26,"index":13400},"line":330,"code":"    it('should parse utf-8', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'text/plain; charset=utf-8');\n      test.write(Buffer.from('6e616d6520697320e8aeba', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse codepage charsets","suites":["bodyParser.text()","charset"],"updatePoint":{"line":336,"column":38,"index":13686},"line":336,"code":"    it('should parse codepage charsets', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'text/plain; charset=koi8-r');\n      test.write(Buffer.from('6e616d6520697320cec5d4', 'hex'));\n      test.expect(200, '\"name is нет\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse when content-length != char length","suites":["bodyParser.text()","charset"],"updatePoint":{"line":342,"column":55,"index":13992},"line":342,"code":"    it('should parse when content-length != char length', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'text/plain; charset=utf-8');\n      test.set('Content-Length', '11');\n      test.write(Buffer.from('6e616d6520697320e8aeba', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should default to utf-8","suites":["bodyParser.text()","charset"],"updatePoint":{"line":349,"column":31,"index":14311},"line":349,"code":"    it('should default to utf-8', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('6e616d6520697320e8aeba', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown charset","suites":["bodyParser.text()","charset"],"updatePoint":{"line":355,"column":37,"index":14581},"line":355,"code":"    it('should 415 on unknown charset', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'text/plain; charset=x-bogus');\n      test.write(Buffer.from('00000000', 'hex'));\n      test.expect(415, '[charset.unsupported] unsupported charset \"X-BOGUS\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse without encoding","suites":["bodyParser.text()","encoding"],"updatePoint":{"line":368,"column":37,"index":15037},"line":368,"code":"    it('should parse without encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('6e616d6520697320e8aeba', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should support identity encoding","suites":["bodyParser.text()","encoding"],"updatePoint":{"line":374,"column":40,"index":15310},"line":374,"code":"    it('should support identity encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'identity');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('6e616d6520697320e8aeba', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should support gzip encoding","suites":["bodyParser.text()","encoding"],"updatePoint":{"line":381,"column":36,"index":15627},"line":381,"code":"    it('should support gzip encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4d55c82c5678b16e170072b3e0200b000000', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should support deflate encoding","suites":["bodyParser.text()","encoding"],"updatePoint":{"line":388,"column":39,"index":15983},"line":388,"code":"    it('should support deflate encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'deflate');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('789ccb4bcc4d55c82c5678b16e17001a6f050e', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should be case-insensitive","suites":["bodyParser.text()","encoding"],"updatePoint":{"line":395,"column":34,"index":16313},"line":395,"code":"    it('should be case-insensitive', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'GZIP');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4d55c82c5678b16e170072b3e0200b000000', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown encoding","suites":["bodyParser.text()","encoding"],"updatePoint":{"line":402,"column":38,"index":16668},"line":402,"code":"    it('should 415 on unknown encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'nulls');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('000000000000', 'hex'));\n      test.expect(415, '[encoding.unsupported] unsupported content encoding \"nulls\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse x-www-form-urlencoded","suites":["bodyParser.urlencoded()"],"updatePoint":{"line":12,"column":40,"index":474},"line":12,"code":"  it('should parse x-www-form-urlencoded', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n  });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 400 when invalid content-length","suites":["bodyParser.urlencoded()"],"updatePoint":{"line":15,"column":44,"index":693},"line":15,"code":"  it('should 400 when invalid content-length', function (done) {\n    var urlencodedParser = bodyParser.urlencoded();\n    var server = createServer(function (req, res, next) {\n      req.headers['content-length'] = '20'; // bad length\n      urlencodedParser(req, res, next);\n    });\n    request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('str=').expect(400, /content length/, done);\n  });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should handle Content-Length: 0","suites":["bodyParser.urlencoded()"],"updatePoint":{"line":23,"column":37,"index":1110},"line":23,"code":"  it('should handle Content-Length: 0', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').set('Content-Length', '0').send('').expect(200, '{}', done);\n  });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should handle empty message-body","suites":["bodyParser.urlencoded()"],"updatePoint":{"line":26,"column":38,"index":1328},"line":26,"code":"  it('should handle empty message-body', function (done) {\n    request(createServer({\n      limit: '1kb'\n    })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').set('Transfer-Encoding', 'chunked').send('').expect(200, '{}', done);\n  });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 500 if stream not readable","suites":["bodyParser.urlencoded()"],"updatePoint":{"line":31,"column":39,"index":1585},"line":31,"code":"  it('should 500 if stream not readable', function (done) {\n    var urlencodedParser = bodyParser.urlencoded();\n    var server = createServer(function (req, res, next) {\n      req.on('end', function () {\n        urlencodedParser(req, res, next);\n      });\n      req.resume();\n    });\n    request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(500, '[stream.not.readable] stream is not readable', done);\n  });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should handle duplicated middleware","suites":["bodyParser.urlencoded()"],"updatePoint":{"line":41,"column":41,"index":2049},"line":41,"code":"  it('should handle duplicated middleware', function (done) {\n    var urlencodedParser = bodyParser.urlencoded();\n    var server = createServer(function (req, res, next) {\n      urlencodedParser(req, res, function (err) {\n        if (err) return next(err);\n        urlencodedParser(req, res, next);\n      });\n    });\n    request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n  });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse extended syntax","suites":["bodyParser.urlencoded()"],"updatePoint":{"line":51,"column":34,"index":2508},"line":51,"code":"  it('should parse extended syntax', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user[name][first]=Tobi').expect(200, '{\"user\":{\"name\":{\"first\":\"Tobi\"}}}', done);\n  });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should not parse extended syntax","suites":["bodyParser.urlencoded()","with extended option","when false"],"updatePoint":{"line":61,"column":42,"index":2959},"line":61,"code":"      it('should not parse extended syntax', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user[name][first]=Tobi').expect(200, '{\"user[name][first]\":\"Tobi\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse multiple key instances","suites":["bodyParser.urlencoded()","with extended option","when false"],"updatePoint":{"line":64,"column":45,"index":3213},"line":64,"code":"      it('should parse multiple key instances', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=Tobi&user=Loki').expect(200, '{\"user\":[\"Tobi\",\"Loki\"]}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse multiple key instances","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":74,"column":45,"index":3619},"line":74,"code":"      it('should parse multiple key instances', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=Tobi&user=Loki').expect(200, '{\"user\":[\"Tobi\",\"Loki\"]}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse extended syntax","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":77,"column":38,"index":3859},"line":77,"code":"      it('should parse extended syntax', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user[name][first]=Tobi').expect(200, '{\"user\":{\"name\":{\"first\":\"Tobi\"}}}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse parameters with dots","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":80,"column":43,"index":4117},"line":80,"code":"      it('should parse parameters with dots', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user.name=Tobi').expect(200, '{\"user.name\":\"Tobi\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse fully-encoded extended syntax","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":83,"column":52,"index":4362},"line":83,"code":"      it('should parse fully-encoded extended syntax', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user%5Bname%5D%5Bfirst%5D=Tobi').expect(200, '{\"user\":{\"name\":{\"first\":\"Tobi\"}}}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse array index notation","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":86,"column":43,"index":4628},"line":86,"code":"      it('should parse array index notation', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('foo[0]=bar&foo[1]=baz').expect(200, '{\"foo\":[\"bar\",\"baz\"]}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse array index notation with large array","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":89,"column":60,"index":4889},"line":89,"code":"      it('should parse array index notation with large array', function (done) {\n        var str = 'f[0]=0';\n        for (var i = 1; i < 500; i++) {\n          str += '&f[' + i + ']=' + i.toString(16);\n        }\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(str).expect(function (res) {\n          var obj = JSON.parse(res.text);\n          assert.strictEqual(Object.keys(obj).length, 1);\n          assert.strictEqual(Array.isArray(obj.f), true);\n          assert.strictEqual(obj.f.length, 500);\n        }).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse array of objects syntax","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":101,"column":46,"index":5463},"line":101,"code":"      it('should parse array of objects syntax', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('foo[0][bar]=baz&foo[0][fizz]=buzz&foo[]=done!').expect(200, '{\"foo\":[{\"bar\":\"baz\",\"fizz\":\"buzz\"},\"done!\"]}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse deep object","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":104,"column":34,"index":5746},"line":104,"code":"      it('should parse deep object', function (done) {\n        var str = 'foo';\n        for (var i = 0; i < 500; i++) {\n          str += '[p]';\n        }\n        str += '=bar';\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(str).expect(function (res) {\n          var obj = JSON.parse(res.text);\n          assert.strictEqual(Object.keys(obj).length, 1);\n          assert.strictEqual(typeof obj.foo, 'object');\n          var depth = 0;\n          var ref = obj.foo;\n          while (ref = ref.p) {\n            depth++;\n          }\n          assert.strictEqual(depth, 500);\n        }).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should not accept content-encoding","suites":["bodyParser.urlencoded()","with inflate option","when false"],"updatePoint":{"line":131,"column":44,"index":6634},"line":131,"code":"      it('should not accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'application/x-www-form-urlencoded');\n        test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n        test.expect(415, '[encoding.unsupported] content encoding unsupported', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should accept content-encoding","suites":["bodyParser.urlencoded()","with inflate option","when true"],"updatePoint":{"line":145,"column":40,"index":7218},"line":145,"code":"      it('should accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'application/x-www-form-urlencoded');\n        test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n        test.expect(200, '{\"name\":\"论\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with Content-Length","suites":["bodyParser.urlencoded()","with limit option"],"updatePoint":{"line":155,"column":54,"index":7679},"line":155,"code":"    it('should 413 when over limit with Content-Length', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      request(createServer({\n        limit: '1kb'\n      })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').set('Content-Length', '1028').send('str=' + buf.toString()).expect(413, done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with chunked encoding","suites":["bodyParser.urlencoded()","with limit option"],"updatePoint":{"line":161,"column":56,"index":8011},"line":161,"code":"    it('should 413 when over limit with chunked encoding', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.set('Transfer-Encoding', 'chunked');\n      test.write('str=');\n      test.write(buf.toString());\n      test.expect(413, done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 413 when inflated body over limit","suites":["bodyParser.urlencoded()","with limit option"],"updatePoint":{"line":173,"column":48,"index":8445},"line":173,"code":"    it('should 413 when inflated body over limit', function (done) {\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('1f8b080000000000000a2b2e29b2d51b05a360148c580000a0351f9204040000', 'hex'));\n      test.expect(413, done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should accept number of bytes","suites":["bodyParser.urlencoded()","with limit option"],"updatePoint":{"line":183,"column":37,"index":8869},"line":183,"code":"    it('should accept number of bytes', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      request(createServer({\n        limit: 1024\n      })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('str=' + buf.toString()).expect(413, done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should not change when options altered","suites":["bodyParser.urlencoded()","with limit option"],"updatePoint":{"line":189,"column":46,"index":9160},"line":189,"code":"    it('should not change when options altered', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      var options = {\n        limit: '1kb'\n      };\n      var server = createServer(options);\n      options.limit = '100kb';\n      request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('str=' + buf.toString()).expect(413, done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should not hang response","suites":["bodyParser.urlencoded()","with limit option"],"updatePoint":{"line":198,"column":32,"index":9525},"line":198,"code":"    it('should not hang response', function (done) {\n      var buf = Buffer.alloc(10240, '.');\n      var server = createServer({\n        limit: '8kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(buf);\n      test.write(buf);\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should not error when inflating","suites":["bodyParser.urlencoded()","with limit option"],"updatePoint":{"line":210,"column":39,"index":9912},"line":210,"code":"    it('should not error when inflating', function (done) {\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('1f8b080000000000000a2b2e29b2d51b05a360148c580000a0351f92040400', 'hex'));\n      test.expect(413, done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should reject 0","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: false"],"updatePoint":{"line":223,"column":25,"index":10434},"line":223,"code":"      it('should reject 0', function () {\n        assert.throws(createServer.bind(null, {\n          extended: false,\n          parameterLimit: 0\n        }), /TypeError: option parameterLimit must be a positive number/);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should reject string","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: false"],"updatePoint":{"line":229,"column":30,"index":10669},"line":229,"code":"      it('should reject string', function () {\n        assert.throws(createServer.bind(null, {\n          extended: false,\n          parameterLimit: 'beep'\n        }), /TypeError: option parameterLimit must be a positive number/);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 413 if over limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: false"],"updatePoint":{"line":235,"column":34,"index":10913},"line":235,"code":"      it('should 413 if over limit', function (done) {\n        request(createServer({\n          extended: false,\n          parameterLimit: 10\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(11)).expect(413, '[parameters.too.many] too many parameters', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work when at the limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: false"],"updatePoint":{"line":241,"column":39,"index":11240},"line":241,"code":"      it('should work when at the limit', function (done) {\n        request(createServer({\n          extended: false,\n          parameterLimit: 10\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(10)).expect(expectKeyCount(10)).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work if number is floating point","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: false"],"updatePoint":{"line":247,"column":49,"index":11559},"line":247,"code":"      it('should work if number is floating point', function (done) {\n        request(createServer({\n          extended: false,\n          parameterLimit: 10.1\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(11)).expect(413, /too many parameters/, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work with large limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: false"],"updatePoint":{"line":253,"column":38,"index":11865},"line":253,"code":"      it('should work with large limit', function (done) {\n        request(createServer({\n          extended: false,\n          parameterLimit: 5000\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(5000)).expect(expectKeyCount(5000)).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work with Infinity limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: false"],"updatePoint":{"line":259,"column":41,"index":12182},"line":259,"code":"      it('should work with Infinity limit', function (done) {\n        request(createServer({\n          extended: false,\n          parameterLimit: Infinity\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(10000)).expect(expectKeyCount(10000)).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should reject 0","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: true"],"updatePoint":{"line":267,"column":25,"index":12547},"line":267,"code":"      it('should reject 0', function () {\n        assert.throws(createServer.bind(null, {\n          extended: true,\n          parameterLimit: 0\n        }), /TypeError: option parameterLimit must be a positive number/);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should reject string","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: true"],"updatePoint":{"line":273,"column":30,"index":12781},"line":273,"code":"      it('should reject string', function () {\n        assert.throws(createServer.bind(null, {\n          extended: true,\n          parameterLimit: 'beep'\n        }), /TypeError: option parameterLimit must be a positive number/);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 413 if over limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: true"],"updatePoint":{"line":279,"column":34,"index":13024},"line":279,"code":"      it('should 413 if over limit', function (done) {\n        request(createServer({\n          extended: true,\n          parameterLimit: 10\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(11)).expect(413, '[parameters.too.many] too many parameters', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work when at the limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: true"],"updatePoint":{"line":285,"column":39,"index":13350},"line":285,"code":"      it('should work when at the limit', function (done) {\n        request(createServer({\n          extended: true,\n          parameterLimit: 10\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(10)).expect(expectKeyCount(10)).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work if number is floating point","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: true"],"updatePoint":{"line":291,"column":49,"index":13668},"line":291,"code":"      it('should work if number is floating point', function (done) {\n        request(createServer({\n          extended: true,\n          parameterLimit: 10.1\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(11)).expect(413, /too many parameters/, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work with large limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: true"],"updatePoint":{"line":297,"column":38,"index":13973},"line":297,"code":"      it('should work with large limit', function (done) {\n        request(createServer({\n          extended: true,\n          parameterLimit: 5000\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(5000)).expect(expectKeyCount(5000)).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work with Infinity limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: true"],"updatePoint":{"line":303,"column":41,"index":14289},"line":303,"code":"      it('should work with Infinity limit', function (done) {\n        request(createServer({\n          extended: true,\n          parameterLimit: Infinity\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(10000)).expect(expectKeyCount(10000)).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse for custom type","suites":["bodyParser.urlencoded()","with type option","when \"application/vnd.x-www-form-urlencoded\""],"updatePoint":{"line":318,"column":38,"index":14884},"line":318,"code":"      it('should parse for custom type', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/vnd.x-www-form-urlencoded').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should ignore standard type","suites":["bodyParser.urlencoded()","with type option","when \"application/vnd.x-www-form-urlencoded\""],"updatePoint":{"line":321,"column":37,"index":15108},"line":321,"code":"      it('should ignore standard type', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200, '{}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse \"application/x-www-form-urlencoded\"","suites":["bodyParser.urlencoded()","with type option","when [\"urlencoded\", \"application/x-pairs\"]"],"updatePoint":{"line":331,"column":58,"index":15557},"line":331,"code":"      it('should parse \"application/x-www-form-urlencoded\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse \"application/x-pairs\"","suites":["bodyParser.urlencoded()","with type option","when [\"urlencoded\", \"application/x-pairs\"]"],"updatePoint":{"line":334,"column":44,"index":15784},"line":334,"code":"      it('should parse \"application/x-pairs\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-pairs').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should ignore application/x-foo","suites":["bodyParser.urlencoded()","with type option","when [\"urlencoded\", \"application/x-pairs\"]"],"updatePoint":{"line":337,"column":41,"index":15994},"line":337,"code":"      it('should ignore application/x-foo', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-foo').send('user=tobi').expect(200, '{}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse when truthy value returned","suites":["bodyParser.urlencoded()","with type option","when a function"],"updatePoint":{"line":342,"column":49,"index":16251},"line":342,"code":"      it('should parse when truthy value returned', function (done) {\n        var server = createServer({\n          type: accept\n        });\n        function accept(req) {\n          return req.headers['content-type'] === 'application/vnd.something';\n        }\n        request(server).post('/').set('Content-Type', 'application/vnd.something').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work without content-type","suites":["bodyParser.urlencoded()","with type option","when a function"],"updatePoint":{"line":351,"column":42,"index":16653},"line":351,"code":"      it('should work without content-type', function (done) {\n        var server = createServer({\n          type: accept\n        });\n        function accept(req) {\n          return true;\n        }\n        var test = request(server).post('/');\n        test.write('user=tobi');\n        test.expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should not invoke without a body","suites":["bodyParser.urlencoded()","with type option","when a function"],"updatePoint":{"line":362,"column":42,"index":16991},"line":362,"code":"      it('should not invoke without a body', function (done) {\n        var server = createServer({\n          type: accept\n        });\n        function accept(req) {\n          throw new Error('oops!');\n        }\n        request(server).get('/').expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should assert value if function","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":374,"column":39,"index":17322},"line":374,"code":"    it('should assert value if function', function () {\n      assert.throws(createServer.bind(null, {\n        verify: 'lol'\n      }), /TypeError: option verify must be function/);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should error from verify","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":379,"column":32,"index":17503},"line":379,"code":"    it('should error from verify', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x20) throw new Error('no leading space');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(' user=tobi').expect(403, '[entity.verify.failed] no leading space', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should allow custom codes","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":387,"column":33,"index":17900},"line":387,"code":"    it('should allow custom codes', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] !== 0x20) return;\n          var err = new Error('no leading space');\n          err.status = 400;\n          throw err;\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(' user=tobi').expect(400, '[entity.verify.failed] no leading space', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should allow custom type","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":398,"column":32,"index":18367},"line":398,"code":"    it('should allow custom type', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] !== 0x20) return;\n          var err = new Error('no leading space');\n          err.type = 'foo.bar';\n          throw err;\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(' user=tobi').expect(403, '[foo.bar] no leading space', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should allow pass-through","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":409,"column":33,"index":18826},"line":409,"code":"    it('should allow pass-through', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x5b) throw new Error('no arrays');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown charset prior to verify","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":417,"column":53,"index":19211},"line":417,"code":"    it('should 415 on unknown charset prior to verify', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          throw new Error('unexpected verify call');\n        }\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded; charset=x-bogus');\n      test.write(Buffer.from('00000000', 'hex'));\n      test.expect(415, '[charset.unsupported] unsupported charset \"X-BOGUS\"', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should presist store","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":448,"column":28,"index":20331},"line":448,"code":"    it('should presist store', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200).expect('x-store-foo', 'bar').expect('{\"user\":\"tobi\"}').end(done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should presist store when unmatched content-type","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":451,"column":56,"index":20606},"line":451,"code":"    it('should presist store when unmatched content-type', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/fizzbuzz').send('buzz').expect(200).expect('x-store-foo', 'bar').expect('{}').end(done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should presist store when inflated","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":454,"column":42,"index":20836},"line":454,"code":"    it('should presist store when inflated', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n      test.expect(200);\n      test.expect('x-store-foo', 'bar');\n      test.expect('{\"name\":\"论\"}');\n      test.end(done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should presist store when inflate error","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":464,"column":47,"index":21294},"line":464,"code":"    it('should presist store when inflate error', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad6080000', 'hex'));\n      test.expect(400);\n      test.expect('x-store-foo', 'bar');\n      test.end(done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should presist store when limit exceeded","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":473,"column":48,"index":21716},"line":473,"code":"    it('should presist store when limit exceeded', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=' + Buffer.alloc(1024 * 100, '.').toString()).expect(413).expect('x-store-foo', 'bar').end(done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse utf-8","suites":["bodyParser.urlencoded()","charset"],"updatePoint":{"line":481,"column":26,"index":22085},"line":481,"code":"    it('should parse utf-8', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded; charset=utf-8');\n      test.write(Buffer.from('6e616d653de8aeba', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse when content-length != char length","suites":["bodyParser.urlencoded()","charset"],"updatePoint":{"line":487,"column":55,"index":22406},"line":487,"code":"    it('should parse when content-length != char length', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded; charset=utf-8');\n      test.set('Content-Length', '7');\n      test.write(Buffer.from('746573743dc3a5', 'hex'));\n      test.expect(200, '{\"test\":\"å\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should default to utf-8","suites":["bodyParser.urlencoded()","charset"],"updatePoint":{"line":494,"column":31,"index":22740},"line":494,"code":"    it('should default to utf-8', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('6e616d653de8aeba', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should fail on unknown charset","suites":["bodyParser.urlencoded()","charset"],"updatePoint":{"line":500,"column":38,"index":23029},"line":500,"code":"    it('should fail on unknown charset', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded; charset=koi8-r');\n      test.write(Buffer.from('6e616d653dcec5d4', 'hex'));\n      test.expect(415, '[charset.unsupported] unsupported charset \"KOI8-R\"', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse without encoding","suites":["bodyParser.urlencoded()","encoding"],"updatePoint":{"line":513,"column":37,"index":23514},"line":513,"code":"    it('should parse without encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('6e616d653de8aeba', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should support identity encoding","suites":["bodyParser.urlencoded()","encoding"],"updatePoint":{"line":519,"column":40,"index":23805},"line":519,"code":"    it('should support identity encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'identity');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('6e616d653de8aeba', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should support gzip encoding","suites":["bodyParser.urlencoded()","encoding"],"updatePoint":{"line":526,"column":36,"index":24140},"line":526,"code":"    it('should support gzip encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should support deflate encoding","suites":["bodyParser.urlencoded()","encoding"],"updatePoint":{"line":533,"column":39,"index":24514},"line":533,"code":"    it('should support deflate encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'deflate');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('789ccb4bcc4db57db16e17001068042f', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should be case-insensitive","suites":["bodyParser.urlencoded()","encoding"],"updatePoint":{"line":540,"column":34,"index":24862},"line":540,"code":"    it('should be case-insensitive', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'GZIP');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown encoding","suites":["bodyParser.urlencoded()","encoding"],"updatePoint":{"line":547,"column":38,"index":25235},"line":547,"code":"    it('should 415 on unknown encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'nulls');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('000000000000', 'hex'));\n      test.expect(415, '[encoding.unsupported] unsupported content encoding \"nulls\"', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"}]}
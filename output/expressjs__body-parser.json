{"repo":"expressjs/body-parser","url":"https://github.com/expressjs/body-parser","branch":"master","configs":[{"package":"body-parser","lang":"js","dir":"test","framework":"mocha","pattern":"**/*.{js,ts}"}],"tests":[{"name":"should default to {}","suites":["bodyParser()"],"updatePoint":{"line":13,"column":26,"index":263},"line":13,"code":"  it('should default to {}', function (done) {\n    request(this.server).post('/').expect(200, '{}', done);\n  });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should parse JSON","suites":["bodyParser()"],"updatePoint":{"line":16,"column":23,"index":373},"line":16,"code":"  it('should parse JSON', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n  });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should parse x-www-form-urlencoded","suites":["bodyParser()"],"updatePoint":{"line":19,"column":40,"index":577},"line":19,"code":"  it('should parse x-www-form-urlencoded', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n  });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should handle duplicated middleware","suites":["bodyParser()"],"updatePoint":{"line":22,"column":41,"index":793},"line":22,"code":"  it('should handle duplicated middleware', function (done) {\n    var _bodyParser = bodyParser();\n\n    var server = http.createServer(function (req, res) {\n      _bodyParser(req, res, function (err0) {\n        _bodyParser(req, res, function (err1) {\n          var err = err0 || err1;\n          res.statusCode = err ? err.status || 500 : 200;\n          res.end(err ? err.message : JSON.stringify(req.body));\n        });\n      });\n    });\n    request(server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n  });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should parse JSON","suites":["bodyParser()","with type option"],"updatePoint":{"line":71,"column":25,"index":2487},"line":71,"code":"    it('should parse JSON', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n    });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should parse x-www-form-urlencoded","suites":["bodyParser()","with type option"],"updatePoint":{"line":74,"column":42,"index":2697},"line":74,"code":"    it('should parse x-www-form-urlencoded', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n    });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should apply to json","suites":["bodyParser()","with verify option"],"updatePoint":{"line":79,"column":28,"index":2957},"line":79,"code":"    it('should apply to json', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x20) throw new Error('no leading space');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/json').send(' {\"user\":\"tobi\"}').expect(403, '[entity.verify.failed] no leading space', done);\n    });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should apply to urlencoded","suites":["bodyParser()","with verify option"],"updatePoint":{"line":87,"column":34,"index":3344},"line":87,"code":"    it('should apply to urlencoded', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x20) throw new Error('no leading space');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(' user=tobi').expect(403, '[entity.verify.failed] no leading space', done);\n    });","file":"body-parser.js","skipped":false,"dir":"test"},{"name":"should parse JSON","suites":["bodyParser.json()"],"updatePoint":{"line":15,"column":23,"index":394},"line":15,"code":"  it('should parse JSON', function (done) {\n    request(createServer()).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should handle Content-Length: 0","suites":["bodyParser.json()"],"updatePoint":{"line":18,"column":37,"index":598},"line":18,"code":"  it('should handle Content-Length: 0', function (done) {\n    request(createServer()).get('/').set('Content-Type', 'application/json').set('Content-Length', '0').expect(200, '{}', done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should handle empty message-body","suites":["bodyParser.json()"],"updatePoint":{"line":21,"column":38,"index":792},"line":21,"code":"  it('should handle empty message-body', function (done) {\n    request(createServer()).get('/').set('Content-Type', 'application/json').set('Transfer-Encoding', 'chunked').expect(200, '{}', done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should handle no message-body","suites":["bodyParser.json()"],"updatePoint":{"line":24,"column":35,"index":992},"line":24,"code":"  it('should handle no message-body', function (done) {\n    request(createServer()).get('/').set('Content-Type', 'application/json').unset('Transfer-Encoding').expect(200, '{}', done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 400 when only whitespace","suites":["bodyParser.json()"],"updatePoint":{"line":27,"column":37,"index":1185},"line":27,"code":"  it('should 400 when only whitespace', function (done) {\n    request(createServer()).post('/').set('Content-Type', 'application/json').send('  \\n').expect(400, '[entity.parse.failed] ' + parseError(' '), done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 400 when invalid content-length","suites":["bodyParser.json()"],"updatePoint":{"line":30,"column":44,"index":1410},"line":30,"code":"  it('should 400 when invalid content-length', function (done) {\n    var jsonParser = bodyParser.json();\n    var server = createServer(function (req, res, next) {\n      req.headers['content-length'] = '20'; // bad length\n\n      jsonParser(req, res, next);\n    });\n    request(server).post('/').set('Content-Type', 'application/json').send('{\"str\":').expect(400, /content length/, done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 500 if stream not readable","suites":["bodyParser.json()"],"updatePoint":{"line":39,"column":39,"index":1798},"line":39,"code":"  it('should 500 if stream not readable', function (done) {\n    var jsonParser = bodyParser.json();\n    var server = createServer(function (req, res, next) {\n      req.on('end', function () {\n        jsonParser(req, res, next);\n      });\n      req.resume();\n    });\n    request(server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(500, '[stream.not.readable] stream is not readable', done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should handle duplicated middleware","suites":["bodyParser.json()"],"updatePoint":{"line":49,"column":41,"index":2233},"line":49,"code":"  it('should handle duplicated middleware', function (done) {\n    var jsonParser = bodyParser.json();\n    var server = createServer(function (req, res, next) {\n      jsonParser(req, res, function (err) {\n        if (err) return next(err);\n        jsonParser(req, res, next);\n      });\n    });\n    request(server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n  });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 400 for bad token","suites":["bodyParser.json()","when JSON is invalid"],"updatePoint":{"line":63,"column":32,"index":2773},"line":63,"code":"    it('should 400 for bad token', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/json').send('{:').expect(400, '[entity.parse.failed] ' + parseError('{:'), done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 400 for incomplete","suites":["bodyParser.json()","when JSON is invalid"],"updatePoint":{"line":66,"column":33,"index":2987},"line":66,"code":"    it('should 400 for incomplete', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\"').expect(400, '[entity.parse.failed] ' + parseError('{\"user\"'), done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should include original body on error object","suites":["bodyParser.json()","when JSON is invalid"],"updatePoint":{"line":69,"column":52,"index":3230},"line":69,"code":"    it('should include original body on error object', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/json').set('X-Error-Property', 'body').send(' {\"user\"').expect(400, ' {\"user\"', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with Content-Length","suites":["bodyParser.json()","with limit option"],"updatePoint":{"line":74,"column":54,"index":3522},"line":74,"code":"    it('should 413 when over limit with Content-Length', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      request(createServer({\n        limit: '1kb'\n      })).post('/').set('Content-Type', 'application/json').set('Content-Length', '1034').send(JSON.stringify({\n        str: buf.toString()\n      })).expect(413, '[entity.too.large] request entity too large', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with chunked encoding","suites":["bodyParser.json()","with limit option"],"updatePoint":{"line":82,"column":56,"index":3914},"line":82,"code":"    it('should 413 when over limit with chunked encoding', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/json');\n      test.set('Transfer-Encoding', 'chunked');\n      test.write('{\"str\":');\n      test.write('\"' + buf.toString() + '\"}');\n      test.expect(413, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 413 when inflated body over limit","suites":["bodyParser.json()","with limit option"],"updatePoint":{"line":94,"column":48,"index":4347},"line":94,"code":"    it('should 413 when inflated body over limit', function (done) {\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000aab562a2e2952b252d21b05a360148c58a0540b0066f7ce1e0a040000', 'hex'));\n      test.expect(413, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should accept number of bytes","suites":["bodyParser.json()","with limit option"],"updatePoint":{"line":104,"column":37,"index":4766},"line":104,"code":"    it('should accept number of bytes', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      request(createServer({\n        limit: 1024\n      })).post('/').set('Content-Type', 'application/json').send(JSON.stringify({\n        str: buf.toString()\n      })).expect(413, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should not change when options altered","suites":["bodyParser.json()","with limit option"],"updatePoint":{"line":112,"column":46,"index":5070},"line":112,"code":"    it('should not change when options altered', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      var options = {\n        limit: '1kb'\n      };\n      var server = createServer(options);\n      options.limit = '100kb';\n      request(server).post('/').set('Content-Type', 'application/json').send(JSON.stringify({\n        str: buf.toString()\n      })).expect(413, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should not hang response","suites":["bodyParser.json()","with limit option"],"updatePoint":{"line":123,"column":32,"index":5448},"line":123,"code":"    it('should not hang response', function (done) {\n      var buf = Buffer.alloc(10240, '.');\n      var server = createServer({\n        limit: '8kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/json');\n      test.write(buf);\n      test.write(buf);\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should not accept content-encoding","suites":["bodyParser.json()","with inflate option","when false"],"updatePoint":{"line":143,"column":44,"index":6029},"line":143,"code":"      it('should not accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'application/json');\n        test.write(Buffer.from('1f8b080000000000000bab56ca4bcc4d55b2527ab16e97522d00515be1cc0e000000', 'hex'));\n        test.expect(415, '[encoding.unsupported] content encoding unsupported', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should accept content-encoding","suites":["bodyParser.json()","with inflate option","when true"],"updatePoint":{"line":157,"column":40,"index":6608},"line":157,"code":"      it('should accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'application/json');\n        test.write(Buffer.from('1f8b080000000000000bab56ca4bcc4d55b2527ab16e97522d00515be1cc0e000000', 'hex'));\n        test.expect(200, '{\"name\":\"论\"}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 400 on primitives","suites":["bodyParser.json()","with strict option","when undefined"],"updatePoint":{"line":171,"column":34,"index":7165},"line":171,"code":"      it('should 400 on primitives', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').send('true').expect(400, '[entity.parse.failed] ' + parseError('#rue').replace('#', 't'), done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse primitives","suites":["bodyParser.json()","with strict option","when false"],"updatePoint":{"line":181,"column":33,"index":7564},"line":181,"code":"      it('should parse primitives', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').send('true').expect(200, 'true', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should not parse primitives","suites":["bodyParser.json()","with strict option","when true"],"updatePoint":{"line":191,"column":37,"index":7908},"line":191,"code":"      it('should not parse primitives', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').send('true').expect(400, '[entity.parse.failed] ' + parseError('#rue').replace('#', 't'), done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should not parse primitives with leading whitespaces","suites":["bodyParser.json()","with strict option","when true"],"updatePoint":{"line":194,"column":62,"index":8177},"line":194,"code":"      it('should not parse primitives with leading whitespaces', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').send('    true').expect(400, '[entity.parse.failed] ' + parseError('    #rue').replace('#', 't'), done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should allow leading whitespaces in JSON","suites":["bodyParser.json()","with strict option","when true"],"updatePoint":{"line":197,"column":50,"index":8442},"line":197,"code":"      it('should allow leading whitespaces in JSON', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').send('   { \"user\": \"tobi\" }').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should include correct message in stack trace","suites":["bodyParser.json()","with strict option","when true"],"updatePoint":{"line":200,"column":55,"index":8675},"line":200,"code":"      it('should include correct message in stack trace', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').set('X-Error-Property', 'stack').send('true').expect(400).expect(shouldContainInBody(parseError('#rue').replace('#', 't'))).end(done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse JSON for custom type","suites":["bodyParser.json()","with type option","when \"application/vnd.api+json\""],"updatePoint":{"line":212,"column":43,"index":9213},"line":212,"code":"      it('should parse JSON for custom type', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/vnd.api+json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should ignore standard type","suites":["bodyParser.json()","with type option","when \"application/vnd.api+json\""],"updatePoint":{"line":215,"column":37,"index":9430},"line":215,"code":"      it('should ignore standard type', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse JSON for \"application/json\"","suites":["bodyParser.json()","with type option","when [\"application/json\", \"application/vnd.api+json\"]"],"updatePoint":{"line":225,"column":50,"index":9882},"line":225,"code":"      it('should parse JSON for \"application/json\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse JSON for \"application/vnd.api+json\"","suites":["bodyParser.json()","with type option","when [\"application/json\", \"application/vnd.api+json\"]"],"updatePoint":{"line":228,"column":58,"index":10112},"line":228,"code":"      it('should parse JSON for \"application/vnd.api+json\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/vnd.api+json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should ignore \"application/x-json\"","suites":["bodyParser.json()","with type option","when [\"application/json\", \"application/vnd.api+json\"]"],"updatePoint":{"line":231,"column":44,"index":10336},"line":231,"code":"      it('should ignore \"application/x-json\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-json').send('{\"user\":\"tobi\"}').expect(200, '{}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse when truthy value returned","suites":["bodyParser.json()","with type option","when a function"],"updatePoint":{"line":236,"column":49,"index":10600},"line":236,"code":"      it('should parse when truthy value returned', function (done) {\n        var server = createServer({\n          type: accept\n        });\n\n        function accept(req) {\n          return req.headers['content-type'] === 'application/vnd.api+json';\n        }\n\n        request(server).post('/').set('Content-Type', 'application/vnd.api+json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should work without content-type","suites":["bodyParser.json()","with type option","when a function"],"updatePoint":{"line":247,"column":42,"index":11008},"line":247,"code":"      it('should work without content-type', function (done) {\n        var server = createServer({\n          type: accept\n        });\n\n        function accept(req) {\n          return true;\n        }\n\n        var test = request(server).post('/');\n        test.write('{\"user\":\"tobi\"}');\n        test.expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should not invoke without a body","suites":["bodyParser.json()","with type option","when a function"],"updatePoint":{"line":260,"column":42,"index":11354},"line":260,"code":"      it('should not invoke without a body', function (done) {\n        var server = createServer({\n          type: accept\n        });\n\n        function accept(req) {\n          throw new Error('oops!');\n        }\n\n        request(server).get('/').expect(200, done);\n      });","file":"json.js","skipped":false,"dir":"test"},{"name":"should assert value if function","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":274,"column":39,"index":11687},"line":274,"code":"    it('should assert value if function', function () {\n      assert.throws(createServer.bind(null, {\n        verify: 'lol'\n      }), /TypeError: option verify must be function/);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should error from verify","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":279,"column":32,"index":11868},"line":279,"code":"    it('should error from verify', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x5b) throw new Error('no arrays');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/json').send('[\"tobi\"]').expect(403, '[entity.verify.failed] no arrays', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should allow custom codes","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":287,"column":33,"index":12232},"line":287,"code":"    it('should allow custom codes', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] !== 0x5b) return;\n          var err = new Error('no arrays');\n          err.status = 400;\n          throw err;\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/json').send('[\"tobi\"]').expect(400, '[entity.verify.failed] no arrays', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should allow custom type","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":298,"column":32,"index":12666},"line":298,"code":"    it('should allow custom type', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] !== 0x5b) return;\n          var err = new Error('no arrays');\n          err.type = 'foo.bar';\n          throw err;\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/json').send('[\"tobi\"]').expect(403, '[foo.bar] no arrays', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should include original body on error object","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":309,"column":52,"index":13111},"line":309,"code":"    it('should include original body on error object', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x5b) throw new Error('no arrays');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/json').set('X-Error-Property', 'body').send('[\"tobi\"]').expect(403, '[\"tobi\"]', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should allow pass-through","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":317,"column":33,"index":13483},"line":317,"code":"    it('should allow pass-through', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x5b) throw new Error('no arrays');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200, '{\"user\":\"tobi\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should work with different charsets","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":325,"column":43,"index":13847},"line":325,"code":"    it('should work with different charsets', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x5b) throw new Error('no arrays');\n        }\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/json; charset=utf-16');\n      test.write(Buffer.from('feff007b0022006e0061006d00650022003a00228bba0022007d', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown charset prior to verify","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":336,"column":53,"index":14339},"line":336,"code":"    it('should 415 on unknown charset prior to verify', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          throw new Error('unexpected verify call');\n        }\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/json; charset=x-bogus');\n      test.write(Buffer.from('00000000', 'hex'));\n      test.expect(415, '[charset.unsupported] unsupported charset \"X-BOGUS\"', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should presist store","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":369,"column":28,"index":15426},"line":369,"code":"    it('should presist store', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"tobi\"}').expect(200).expect('x-store-foo', 'bar').expect('{\"user\":\"tobi\"}').end(done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should presist store when unmatched content-type","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":372,"column":56,"index":15690},"line":372,"code":"    it('should presist store when unmatched content-type', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/fizzbuzz').send('buzz').expect(200).expect('x-store-foo', 'bar').expect('{}').end(done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should presist store when inflated","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":375,"column":42,"index":15920},"line":375,"code":"    it('should presist store when inflated', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000bab56ca4bcc4d55b2527ab16e97522d00515be1cc0e000000', 'hex'));\n      test.expect(200);\n      test.expect('x-store-foo', 'bar');\n      test.expect('{\"name\":\"论\"}');\n      test.end(done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should presist store when inflate error","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":385,"column":47,"index":16373},"line":385,"code":"    it('should presist store when inflate error', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000bab56cc4d55b2527ab16e97522d00515be1cc0e000000', 'hex'));\n      test.expect(400);\n      test.expect('x-store-foo', 'bar');\n      test.end(done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should presist store when parse error","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":394,"column":45,"index":16785},"line":394,"code":"    it('should presist store when parse error', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\":').expect(400).expect('x-store-foo', 'bar').end(done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should presist store when limit exceeded","suites":["bodyParser.json()","with verify option"],"updatePoint":{"line":397,"column":48,"index":17008},"line":397,"code":"    it('should presist store when limit exceeded', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/json').send('{\"user\":\"' + Buffer.alloc(1024 * 100, '.').toString() + '\"}').expect(413).expect('x-store-foo', 'bar').end(done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse utf-8","suites":["bodyParser.json()","charset"],"updatePoint":{"line":405,"column":26,"index":17371},"line":405,"code":"    it('should parse utf-8', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/json; charset=utf-8');\n      test.write(Buffer.from('7b226e616d65223a22e8aeba227d', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse utf-16","suites":["bodyParser.json()","charset"],"updatePoint":{"line":411,"column":27,"index":17659},"line":411,"code":"    it('should parse utf-16', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/json; charset=utf-16');\n      test.write(Buffer.from('feff007b0022006e0061006d00650022003a00228bba0022007d', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse when content-length != char length","suites":["bodyParser.json()","charset"],"updatePoint":{"line":417,"column":55,"index":18000},"line":417,"code":"    it('should parse when content-length != char length', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/json; charset=utf-8');\n      test.set('Content-Length', '13');\n      test.write(Buffer.from('7b2274657374223a22c3a5227d', 'hex'));\n      test.expect(200, '{\"test\":\"å\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should default to utf-8","suites":["bodyParser.json()","charset"],"updatePoint":{"line":424,"column":31,"index":18330},"line":424,"code":"    it('should default to utf-8', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('7b226e616d65223a22e8aeba227d', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should fail on unknown charset","suites":["bodyParser.json()","charset"],"updatePoint":{"line":430,"column":38,"index":18614},"line":430,"code":"    it('should fail on unknown charset', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/json; charset=koi8-r');\n      test.write(Buffer.from('7b226e616d65223a22cec5d4227d', 'hex'));\n      test.expect(415, '[charset.unsupported] unsupported charset \"KOI8-R\"', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse without encoding","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":443,"column":37,"index":19093},"line":443,"code":"    it('should parse without encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('7b226e616d65223a22e8aeba227d', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should support identity encoding","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":449,"column":40,"index":19379},"line":449,"code":"    it('should support identity encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'identity');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('7b226e616d65223a22e8aeba227d', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should support gzip encoding","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":456,"column":36,"index":19709},"line":456,"code":"    it('should support gzip encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000bab56ca4bcc4d55b2527ab16e97522d00515be1cc0e000000', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should support deflate encoding","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":463,"column":39,"index":20078},"line":463,"code":"    it('should support deflate encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'deflate');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('789cab56ca4bcc4d55b2527ab16e97522d00274505ac', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should be case-insensitive","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":470,"column":34,"index":20421},"line":470,"code":"    it('should be case-insensitive', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'GZIP');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000bab56ca4bcc4d55b2527ab16e97522d00515be1cc0e000000', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown encoding","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":477,"column":38,"index":20789},"line":477,"code":"    it('should 415 on unknown encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'nulls');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('000000000000', 'hex'));\n      test.expect(415, '[encoding.unsupported] unsupported content encoding \"nulls\"', done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 400 on malformed encoding","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":484,"column":40,"index":21151},"line":484,"code":"    it('should 400 on malformed encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000bab56cc4d55b2527ab16e97522d00515be1cc0e000000', 'hex'));\n      test.expect(400, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should 413 when inflated value exceeds limit","suites":["bodyParser.json()","encoding"],"updatePoint":{"line":491,"column":52,"index":21513},"line":491,"code":"    it('should 413 when inflated value exceeds limit', function (done) {\n      // gzip'd data exceeds 1kb, but deflated below 1kb\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/json');\n      test.write(Buffer.from('1f8b080000000000000bedc1010d000000c2a0f74f6d0f071400000000000000', 'hex'));\n      test.write(Buffer.from('0000000000000000000000000000000000000000000000000000000000000000', 'hex'));\n      test.write(Buffer.from('0000000000000000004f0625b3b71650c30000', 'hex'));\n      test.expect(413, done);\n    });","file":"json.js","skipped":false,"dir":"test"},{"name":"should parse application/octet-stream","suites":["bodyParser.raw()"],"updatePoint":{"line":18,"column":43,"index":476},"line":18,"code":"  it('should parse application/octet-stream', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/octet-stream').send('the user is tobi').expect(200, 'buf:746865207573657220697320746f6269', done);\n  });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should 400 when invalid content-length","suites":["bodyParser.raw()"],"updatePoint":{"line":21,"column":44,"index":714},"line":21,"code":"  it('should 400 when invalid content-length', function (done) {\n    var rawParser = bodyParser.raw();\n    var server = createServer(function (req, res, next) {\n      req.headers['content-length'] = '20'; // bad length\n\n      rawParser(req, res, next);\n    });\n    request(server).post('/').set('Content-Type', 'application/octet-stream').send('stuff').expect(400, /content length/, done);\n  });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should handle Content-Length: 0","suites":["bodyParser.raw()"],"updatePoint":{"line":30,"column":37,"index":1103},"line":30,"code":"  it('should handle Content-Length: 0', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/octet-stream').set('Content-Length', '0').expect(200, 'buf:', done);\n  });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should handle empty message-body","suites":["bodyParser.raw()"],"updatePoint":{"line":33,"column":38,"index":1305},"line":33,"code":"  it('should handle empty message-body', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/octet-stream').set('Transfer-Encoding', 'chunked').send('').expect(200, 'buf:', done);\n  });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should 500 if stream not readable","suites":["bodyParser.raw()"],"updatePoint":{"line":36,"column":39,"index":1526},"line":36,"code":"  it('should 500 if stream not readable', function (done) {\n    var rawParser = bodyParser.raw();\n    var server = createServer(function (req, res, next) {\n      req.on('end', function () {\n        rawParser(req, res, next);\n      });\n      req.resume();\n    });\n    request(server).post('/').set('Content-Type', 'application/octet-stream').send('the user is tobi').expect(500, '[stream.not.readable] stream is not readable', done);\n  });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should handle duplicated middleware","suites":["bodyParser.raw()"],"updatePoint":{"line":46,"column":41,"index":1967},"line":46,"code":"  it('should handle duplicated middleware', function (done) {\n    var rawParser = bodyParser.raw();\n    var server = createServer(function (req, res, next) {\n      rawParser(req, res, function (err) {\n        if (err) return next(err);\n        rawParser(req, res, next);\n      });\n    });\n    request(server).post('/').set('Content-Type', 'application/octet-stream').send('the user is tobi').expect(200, 'buf:746865207573657220697320746f6269', done);\n  });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with Content-Length","suites":["bodyParser.raw()","with limit option"],"updatePoint":{"line":57,"column":54,"index":2483},"line":57,"code":"    it('should 413 when over limit with Content-Length', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.set('Content-Length', '1028');\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with chunked encoding","suites":["bodyParser.raw()","with limit option"],"updatePoint":{"line":68,"column":56,"index":2873},"line":68,"code":"    it('should 413 when over limit with chunked encoding', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.set('Transfer-Encoding', 'chunked');\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should 413 when inflated body over limit","suites":["bodyParser.raw()","with limit option"],"updatePoint":{"line":79,"column":48,"index":3261},"line":79,"code":"    it('should 413 when inflated body over limit', function (done) {\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('1f8b080000000000000ad3d31b05a360148c64000087e5a14704040000', 'hex'));\n      test.expect(413, done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should accept number of bytes","suites":["bodyParser.raw()","with limit option"],"updatePoint":{"line":89,"column":37,"index":3670},"line":89,"code":"    it('should accept number of bytes', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      var server = createServer({\n        limit: 1024\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should not change when options altered","suites":["bodyParser.raw()","with limit option"],"updatePoint":{"line":99,"column":46,"index":4007},"line":99,"code":"    it('should not change when options altered', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      var options = {\n        limit: '1kb'\n      };\n      var server = createServer(options);\n      options.limit = '100kb';\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should not hang response","suites":["bodyParser.raw()","with limit option"],"updatePoint":{"line":111,"column":32,"index":4391},"line":111,"code":"    it('should not hang response', function (done) {\n      var buf = Buffer.alloc(10240, '.');\n      var server = createServer({\n        limit: '8kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(buf);\n      test.write(buf);\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should not accept content-encoding","suites":["bodyParser.raw()","with inflate option","when false"],"updatePoint":{"line":131,"column":44,"index":4980},"line":131,"code":"      it('should not accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'application/octet-stream');\n        test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n        test.expect(415, '[encoding.unsupported] content encoding unsupported', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should accept content-encoding","suites":["bodyParser.raw()","with inflate option","when true"],"updatePoint":{"line":145,"column":40,"index":5555},"line":145,"code":"      it('should accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'application/octet-stream');\n        test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n        test.expect(200, 'buf:6e616d653de8aeba', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should parse for custom type","suites":["bodyParser.raw()","with type option","when \"application/vnd+octets\""],"updatePoint":{"line":161,"column":38,"index":6185},"line":161,"code":"      it('should parse for custom type', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Type', 'application/vnd+octets');\n        test.write(Buffer.from('000102', 'hex'));\n        test.expect(200, 'buf:000102', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should ignore standard type","suites":["bodyParser.raw()","with type option","when \"application/vnd+octets\""],"updatePoint":{"line":167,"column":37,"index":6460},"line":167,"code":"      it('should ignore standard type', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Type', 'application/octet-stream');\n        test.write(Buffer.from('000102', 'hex'));\n        test.expect(200, '{}', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should parse \"application/octet-stream\"","suites":["bodyParser.raw()","with type option","when [\"application/octet-stream\", \"application/vnd+octets\"]"],"updatePoint":{"line":180,"column":49,"index":6996},"line":180,"code":"      it('should parse \"application/octet-stream\"', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Type', 'application/octet-stream');\n        test.write(Buffer.from('000102', 'hex'));\n        test.expect(200, 'buf:000102', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should parse \"application/vnd+octets\"","suites":["bodyParser.raw()","with type option","when [\"application/octet-stream\", \"application/vnd+octets\"]"],"updatePoint":{"line":186,"column":47,"index":7283},"line":186,"code":"      it('should parse \"application/vnd+octets\"', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Type', 'application/vnd+octets');\n        test.write(Buffer.from('000102', 'hex'));\n        test.expect(200, 'buf:000102', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should ignore \"application/x-foo\"","suites":["bodyParser.raw()","with type option","when [\"application/octet-stream\", \"application/vnd+octets\"]"],"updatePoint":{"line":192,"column":43,"index":7564},"line":192,"code":"      it('should ignore \"application/x-foo\"', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Type', 'application/x-foo');\n        test.write(Buffer.from('000102', 'hex'));\n        test.expect(200, '{}', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should parse when truthy value returned","suites":["bodyParser.raw()","with type option","when a function"],"updatePoint":{"line":200,"column":49,"index":7892},"line":200,"code":"      it('should parse when truthy value returned', function (done) {\n        var server = createServer({\n          type: accept\n        });\n\n        function accept(req) {\n          return req.headers['content-type'] === 'application/vnd.octet';\n        }\n\n        var test = request(server).post('/');\n        test.set('Content-Type', 'application/vnd.octet');\n        test.write(Buffer.from('000102', 'hex'));\n        test.expect(200, 'buf:000102', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should work without content-type","suites":["bodyParser.raw()","with type option","when a function"],"updatePoint":{"line":214,"column":42,"index":8354},"line":214,"code":"      it('should work without content-type', function (done) {\n        var server = createServer({\n          type: accept\n        });\n\n        function accept(req) {\n          return true;\n        }\n\n        var test = request(server).post('/');\n        test.write(Buffer.from('000102', 'hex'));\n        test.expect(200, 'buf:000102', done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should not invoke without a body","suites":["bodyParser.raw()","with type option","when a function"],"updatePoint":{"line":227,"column":42,"index":8706},"line":227,"code":"      it('should not invoke without a body', function (done) {\n        var server = createServer({\n          type: accept\n        });\n\n        function accept(req) {\n          throw new Error('oops!');\n        }\n\n        request(server).get('/').expect(200, done);\n      });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should assert value is function","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":241,"column":39,"index":9039},"line":241,"code":"    it('should assert value is function', function () {\n      assert.throws(createServer.bind(null, {\n        verify: 'lol'\n      }), /TypeError: option verify must be function/);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should error from verify","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":246,"column":32,"index":9220},"line":246,"code":"    it('should error from verify', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x00) throw new Error('no leading null');\n        }\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('000102', 'hex'));\n      test.expect(403, '[entity.verify.failed] no leading null', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should allow custom codes","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":257,"column":33,"index":9670},"line":257,"code":"    it('should allow custom codes', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] !== 0x00) return;\n          var err = new Error('no leading null');\n          err.status = 400;\n          throw err;\n        }\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('000102', 'hex'));\n      test.expect(400, '[entity.verify.failed] no leading null', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should allow pass-through","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":271,"column":33,"index":10191},"line":271,"code":"    it('should allow pass-through', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x00) throw new Error('no leading null');\n        }\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('0102', 'hex'));\n      test.expect(200, 'buf:0102', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should presist store","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":304,"column":28,"index":11233},"line":304,"code":"    it('should presist store', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/octet-stream').send('the user is tobi').expect(200).expect('x-store-foo', 'bar').expect('buf:746865207573657220697320746f6269').end(done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should presist store when unmatched content-type","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":307,"column":56,"index":11527},"line":307,"code":"    it('should presist store when unmatched content-type', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/fizzbuzz').send('buzz').expect(200).expect('x-store-foo', 'bar').expect('{}').end(done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should presist store when inflated","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":310,"column":42,"index":11757},"line":310,"code":"    it('should presist store when inflated', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n      test.expect(200);\n      test.expect('x-store-foo', 'bar');\n      test.expect('buf:6e616d653de8aeba');\n      test.end(done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should presist store when inflate error","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":320,"column":47,"index":12214},"line":320,"code":"    it('should presist store when inflate error', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad6080000', 'hex'));\n      test.expect(400);\n      test.expect('x-store-foo', 'bar');\n      test.end(done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should presist store when limit exceeded","suites":["bodyParser.raw()","with verify option"],"updatePoint":{"line":329,"column":48,"index":12627},"line":329,"code":"    it('should presist store when limit exceeded', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/octet-stream').send('the user is ' + Buffer.alloc(1024 * 100, '.').toString()).expect(413).expect('x-store-foo', 'bar').end(done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should ignore charset","suites":["bodyParser.raw()","charset"],"updatePoint":{"line":337,"column":29,"index":12997},"line":337,"code":"    it('should ignore charset', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/octet-stream; charset=utf-8');\n      test.write(Buffer.from('6e616d6520697320e8aeba', 'hex'));\n      test.expect(200, 'buf:6e616d6520697320e8aeba', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should parse without encoding","suites":["bodyParser.raw()","encoding"],"updatePoint":{"line":350,"column":37,"index":13454},"line":350,"code":"    it('should parse without encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('6e616d653de8aeba', 'hex'));\n      test.expect(200, 'buf:6e616d653de8aeba', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should support identity encoding","suites":["bodyParser.raw()","encoding"],"updatePoint":{"line":356,"column":40,"index":13744},"line":356,"code":"    it('should support identity encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'identity');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('6e616d653de8aeba', 'hex'));\n      test.expect(200, 'buf:6e616d653de8aeba', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should support gzip encoding","suites":["bodyParser.raw()","encoding"],"updatePoint":{"line":363,"column":36,"index":14078},"line":363,"code":"    it('should support gzip encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n      test.expect(200, 'buf:6e616d653de8aeba', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should support deflate encoding","suites":["bodyParser.raw()","encoding"],"updatePoint":{"line":370,"column":39,"index":14451},"line":370,"code":"    it('should support deflate encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'deflate');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('789ccb4bcc4db57db16e17001068042f', 'hex'));\n      test.expect(200, 'buf:6e616d653de8aeba', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should be case-insensitive","suites":["bodyParser.raw()","encoding"],"updatePoint":{"line":377,"column":34,"index":14798},"line":377,"code":"    it('should be case-insensitive', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'GZIP');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n      test.expect(200, 'buf:6e616d653de8aeba', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown encoding","suites":["bodyParser.raw()","encoding"],"updatePoint":{"line":384,"column":38,"index":15170},"line":384,"code":"    it('should 415 on unknown encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'nulls');\n      test.set('Content-Type', 'application/octet-stream');\n      test.write(Buffer.from('000000000000', 'hex'));\n      test.expect(415, '[encoding.unsupported] unsupported content encoding \"nulls\"', done);\n    });","file":"raw.js","skipped":false,"dir":"test"},{"name":"should parse text/plain","suites":["bodyParser.text()"],"updatePoint":{"line":18,"column":29,"index":463},"line":18,"code":"  it('should parse text/plain', function (done) {\n    request(this.server).post('/').set('Content-Type', 'text/plain').send('user is tobi').expect(200, '\"user is tobi\"', done);\n  });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 400 when invalid content-length","suites":["bodyParser.text()"],"updatePoint":{"line":21,"column":44,"index":661},"line":21,"code":"  it('should 400 when invalid content-length', function (done) {\n    var textParser = bodyParser.text();\n    var server = createServer(function (req, res, next) {\n      req.headers['content-length'] = '20'; // bad length\n\n      textParser(req, res, next);\n    });\n    request(server).post('/').set('Content-Type', 'text/plain').send('user').expect(400, /content length/, done);\n  });","file":"text.js","skipped":false,"dir":"test"},{"name":"should handle Content-Length: 0","suites":["bodyParser.text()"],"updatePoint":{"line":30,"column":37,"index":1038},"line":30,"code":"  it('should handle Content-Length: 0', function (done) {\n    request(createServer({\n      limit: '1kb'\n    })).post('/').set('Content-Type', 'text/plain').set('Content-Length', '0').expect(200, '\"\"', done);\n  });","file":"text.js","skipped":false,"dir":"test"},{"name":"should handle empty message-body","suites":["bodyParser.text()"],"updatePoint":{"line":35,"column":38,"index":1253},"line":35,"code":"  it('should handle empty message-body', function (done) {\n    request(createServer({\n      limit: '1kb'\n    })).post('/').set('Content-Type', 'text/plain').set('Transfer-Encoding', 'chunked').send('').expect(200, '\"\"', done);\n  });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 500 if stream not readable","suites":["bodyParser.text()"],"updatePoint":{"line":40,"column":39,"index":1487},"line":40,"code":"  it('should 500 if stream not readable', function (done) {\n    var textParser = bodyParser.text();\n    var server = createServer(function (req, res, next) {\n      req.on('end', function () {\n        textParser(req, res, next);\n      });\n      req.resume();\n    });\n    request(server).post('/').set('Content-Type', 'text/plain').send('user is tobi').expect(500, '[stream.not.readable] stream is not readable', done);\n  });","file":"text.js","skipped":false,"dir":"test"},{"name":"should handle duplicated middleware","suites":["bodyParser.text()"],"updatePoint":{"line":50,"column":41,"index":1913},"line":50,"code":"  it('should handle duplicated middleware', function (done) {\n    var textParser = bodyParser.text();\n    var server = createServer(function (req, res, next) {\n      textParser(req, res, function (err) {\n        if (err) return next(err);\n        textParser(req, res, next);\n      });\n    });\n    request(server).post('/').set('Content-Type', 'text/plain').send('user is tobi').expect(200, '\"user is tobi\"', done);\n  });","file":"text.js","skipped":false,"dir":"test"},{"name":"should change default charset","suites":["bodyParser.text()","with defaultCharset option"],"updatePoint":{"line":61,"column":37,"index":2385},"line":61,"code":"    it('should change default charset', function (done) {\n      var server = createServer({\n        defaultCharset: 'koi8-r'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('6e616d6520697320cec5d4', 'hex'));\n      test.expect(200, '\"name is нет\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should honor content-type charset","suites":["bodyParser.text()","with defaultCharset option"],"updatePoint":{"line":70,"column":41,"index":2733},"line":70,"code":"    it('should honor content-type charset', function (done) {\n      var server = createServer({\n        defaultCharset: 'koi8-r'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'text/plain; charset=utf-8');\n      test.write(Buffer.from('6e616d6520697320e8aeba', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with Content-Length","suites":["bodyParser.text()","with limit option"],"updatePoint":{"line":81,"column":54,"index":3159},"line":81,"code":"    it('should 413 when over limit with Content-Length', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      request(createServer({\n        limit: '1kb'\n      })).post('/').set('Content-Type', 'text/plain').set('Content-Length', '1028').send(buf.toString()).expect(413, done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with chunked encoding","suites":["bodyParser.text()","with limit option"],"updatePoint":{"line":87,"column":56,"index":3459},"line":87,"code":"    it('should 413 when over limit with chunked encoding', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'text/plain');\n      test.set('Transfer-Encoding', 'chunked');\n      test.write(buf.toString());\n      test.expect(413, done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 413 when inflated body over limit","suites":["bodyParser.text()","with limit option"],"updatePoint":{"line":98,"column":48,"index":3844},"line":98,"code":"    it('should 413 when inflated body over limit', function (done) {\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('1f8b080000000000000ad3d31b05a360148c64000087e5a14704040000', 'hex'));\n      test.expect(413, done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should accept number of bytes","suites":["bodyParser.text()","with limit option"],"updatePoint":{"line":108,"column":37,"index":4239},"line":108,"code":"    it('should accept number of bytes', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      request(createServer({\n        limit: 1024\n      })).post('/').set('Content-Type', 'text/plain').send(buf.toString()).expect(413, done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should not change when options altered","suites":["bodyParser.text()","with limit option"],"updatePoint":{"line":114,"column":46,"index":4498},"line":114,"code":"    it('should not change when options altered', function (done) {\n      var buf = Buffer.alloc(1028, '.');\n      var options = {\n        limit: '1kb'\n      };\n      var server = createServer(options);\n      options.limit = '100kb';\n      request(server).post('/').set('Content-Type', 'text/plain').send(buf.toString()).expect(413, done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should not hang response","suites":["bodyParser.text()","with limit option"],"updatePoint":{"line":123,"column":32,"index":4831},"line":123,"code":"    it('should not hang response', function (done) {\n      var buf = Buffer.alloc(10240, '.');\n      var server = createServer({\n        limit: '8kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'text/plain');\n      test.write(buf);\n      test.write(buf);\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should not accept content-encoding","suites":["bodyParser.text()","with inflate option","when false"],"updatePoint":{"line":143,"column":44,"index":5406},"line":143,"code":"      it('should not accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'text/plain');\n        test.write(Buffer.from('1f8b080000000000000bcb4bcc4d55c82c5678b16e170072b3e0200b000000', 'hex'));\n        test.expect(415, '[encoding.unsupported] content encoding unsupported', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should accept content-encoding","suites":["bodyParser.text()","with inflate option","when true"],"updatePoint":{"line":157,"column":40,"index":5973},"line":157,"code":"      it('should accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'text/plain');\n        test.write(Buffer.from('1f8b080000000000000bcb4bcc4d55c82c5678b16e170072b3e0200b000000', 'hex'));\n        test.expect(200, '\"name is 论\"', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse for custom type","suites":["bodyParser.text()","with type option","when \"text/html\""],"updatePoint":{"line":173,"column":38,"index":6560},"line":173,"code":"      it('should parse for custom type', function (done) {\n        request(this.server).post('/').set('Content-Type', 'text/html').send('<b>tobi</b>').expect(200, '\"<b>tobi</b>\"', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should ignore standard type","suites":["bodyParser.text()","with type option","when \"text/html\""],"updatePoint":{"line":176,"column":37,"index":6756},"line":176,"code":"      it('should ignore standard type', function (done) {\n        request(this.server).post('/').set('Content-Type', 'text/plain').send('user is tobi').expect(200, '{}', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse \"text/html\"","suites":["bodyParser.text()","with type option","when [\"text/html\", \"text/plain\"]"],"updatePoint":{"line":186,"column":34,"index":7141},"line":186,"code":"      it('should parse \"text/html\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'text/html').send('<b>tobi</b>').expect(200, '\"<b>tobi</b>\"', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse \"text/plain\"","suites":["bodyParser.text()","with type option","when [\"text/html\", \"text/plain\"]"],"updatePoint":{"line":189,"column":35,"index":7335},"line":189,"code":"      it('should parse \"text/plain\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'text/plain').send('tobi').expect(200, '\"tobi\"', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should ignore \"text/xml\"","suites":["bodyParser.text()","with type option","when [\"text/html\", \"text/plain\"]"],"updatePoint":{"line":192,"column":34,"index":7515},"line":192,"code":"      it('should ignore \"text/xml\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'text/xml').send('<user>tobi</user>').expect(200, '{}', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse when truthy value returned","suites":["bodyParser.text()","with type option","when a function"],"updatePoint":{"line":197,"column":49,"index":7771},"line":197,"code":"      it('should parse when truthy value returned', function (done) {\n        var server = createServer({\n          type: accept\n        });\n\n        function accept(req) {\n          return req.headers['content-type'] === 'text/vnd.something';\n        }\n\n        request(server).post('/').set('Content-Type', 'text/vnd.something').send('user is tobi').expect(200, '\"user is tobi\"', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should work without content-type","suites":["bodyParser.text()","with type option","when a function"],"updatePoint":{"line":208,"column":42,"index":8163},"line":208,"code":"      it('should work without content-type', function (done) {\n        var server = createServer({\n          type: accept\n        });\n\n        function accept(req) {\n          return true;\n        }\n\n        var test = request(server).post('/');\n        test.write('user is tobi');\n        test.expect(200, '\"user is tobi\"', done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should not invoke without a body","suites":["bodyParser.text()","with type option","when a function"],"updatePoint":{"line":221,"column":42,"index":8505},"line":221,"code":"      it('should not invoke without a body', function (done) {\n        var server = createServer({\n          type: accept\n        });\n\n        function accept(req) {\n          throw new Error('oops!');\n        }\n\n        request(server).get('/').expect(200, done);\n      });","file":"text.js","skipped":false,"dir":"test"},{"name":"should assert value is function","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":235,"column":39,"index":8838},"line":235,"code":"    it('should assert value is function', function () {\n      assert.throws(createServer.bind(null, {\n        verify: 'lol'\n      }), /TypeError: option verify must be function/);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should error from verify","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":240,"column":32,"index":9019},"line":240,"code":"    it('should error from verify', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x20) throw new Error('no leading space');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'text/plain').send(' user is tobi').expect(403, '[entity.verify.failed] no leading space', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should allow custom codes","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":248,"column":33,"index":9396},"line":248,"code":"    it('should allow custom codes', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] !== 0x20) return;\n          var err = new Error('no leading space');\n          err.status = 400;\n          throw err;\n        }\n      });\n      request(server).post('/').set('Content-Type', 'text/plain').send(' user is tobi').expect(400, '[entity.verify.failed] no leading space', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should allow pass-through","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":259,"column":33,"index":9844},"line":259,"code":"    it('should allow pass-through', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x20) throw new Error('no leading space');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'text/plain').send('user is tobi').expect(200, '\"user is tobi\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown charset prior to verify","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":267,"column":53,"index":10215},"line":267,"code":"    it('should 415 on unknown charset prior to verify', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          throw new Error('unexpected verify call');\n        }\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'text/plain; charset=x-bogus');\n      test.write(Buffer.from('00000000', 'hex'));\n      test.expect(415, '[charset.unsupported] unsupported charset \"X-BOGUS\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should presist store","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":300,"column":28,"index":11296},"line":300,"code":"    it('should presist store', function (done) {\n      request(this.server).post('/').set('Content-Type', 'text/plain').send('user is tobi').expect(200).expect('x-store-foo', 'bar').expect('\"user is tobi\"').end(done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should presist store when unmatched content-type","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":303,"column":56,"index":11550},"line":303,"code":"    it('should presist store when unmatched content-type', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/fizzbuzz').send('buzz').expect(200).expect('x-store-foo', 'bar').expect('{}').end(done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should presist store when inflated","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":306,"column":42,"index":11780},"line":306,"code":"    it('should presist store when inflated', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4d55c82c5678b16e170072b3e0200b000000', 'hex'));\n      test.expect(200);\n      test.expect('x-store-foo', 'bar');\n      test.expect('\"name is 论\"');\n      test.end(done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should presist store when inflate error","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":316,"column":47,"index":12220},"line":316,"code":"    it('should presist store when inflate error', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4d55c82c5678b16e170072b3e0200b0000', 'hex'));\n      test.expect(400);\n      test.expect('x-store-foo', 'bar');\n      test.end(done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should presist store when limit exceeded","suites":["bodyParser.text()","with verify option"],"updatePoint":{"line":325,"column":48,"index":12625},"line":325,"code":"    it('should presist store when limit exceeded', function (done) {\n      request(this.server).post('/').set('Content-Type', 'text/plain').send('user is ' + Buffer.alloc(1024 * 100, '.').toString()).expect(413).expect('x-store-foo', 'bar').end(done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse utf-8","suites":["bodyParser.text()","charset"],"updatePoint":{"line":333,"column":26,"index":12974},"line":333,"code":"    it('should parse utf-8', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'text/plain; charset=utf-8');\n      test.write(Buffer.from('6e616d6520697320e8aeba', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse codepage charsets","suites":["bodyParser.text()","charset"],"updatePoint":{"line":339,"column":38,"index":13260},"line":339,"code":"    it('should parse codepage charsets', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'text/plain; charset=koi8-r');\n      test.write(Buffer.from('6e616d6520697320cec5d4', 'hex'));\n      test.expect(200, '\"name is нет\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse when content-length != char length","suites":["bodyParser.text()","charset"],"updatePoint":{"line":345,"column":55,"index":13566},"line":345,"code":"    it('should parse when content-length != char length', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'text/plain; charset=utf-8');\n      test.set('Content-Length', '11');\n      test.write(Buffer.from('6e616d6520697320e8aeba', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should default to utf-8","suites":["bodyParser.text()","charset"],"updatePoint":{"line":352,"column":31,"index":13885},"line":352,"code":"    it('should default to utf-8', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('6e616d6520697320e8aeba', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown charset","suites":["bodyParser.text()","charset"],"updatePoint":{"line":358,"column":37,"index":14155},"line":358,"code":"    it('should 415 on unknown charset', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'text/plain; charset=x-bogus');\n      test.write(Buffer.from('00000000', 'hex'));\n      test.expect(415, '[charset.unsupported] unsupported charset \"X-BOGUS\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse without encoding","suites":["bodyParser.text()","encoding"],"updatePoint":{"line":371,"column":37,"index":14611},"line":371,"code":"    it('should parse without encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('6e616d6520697320e8aeba', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should support identity encoding","suites":["bodyParser.text()","encoding"],"updatePoint":{"line":377,"column":40,"index":14884},"line":377,"code":"    it('should support identity encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'identity');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('6e616d6520697320e8aeba', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should support gzip encoding","suites":["bodyParser.text()","encoding"],"updatePoint":{"line":384,"column":36,"index":15201},"line":384,"code":"    it('should support gzip encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4d55c82c5678b16e170072b3e0200b000000', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should support deflate encoding","suites":["bodyParser.text()","encoding"],"updatePoint":{"line":391,"column":39,"index":15557},"line":391,"code":"    it('should support deflate encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'deflate');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('789ccb4bcc4d55c82c5678b16e17001a6f050e', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should be case-insensitive","suites":["bodyParser.text()","encoding"],"updatePoint":{"line":398,"column":34,"index":15887},"line":398,"code":"    it('should be case-insensitive', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'GZIP');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4d55c82c5678b16e170072b3e0200b000000', 'hex'));\n      test.expect(200, '\"name is 论\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown encoding","suites":["bodyParser.text()","encoding"],"updatePoint":{"line":405,"column":38,"index":16242},"line":405,"code":"    it('should 415 on unknown encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'nulls');\n      test.set('Content-Type', 'text/plain');\n      test.write(Buffer.from('000000000000', 'hex'));\n      test.expect(415, '[encoding.unsupported] unsupported content encoding \"nulls\"', done);\n    });","file":"text.js","skipped":false,"dir":"test"},{"name":"should parse x-www-form-urlencoded","suites":["bodyParser.urlencoded()"],"updatePoint":{"line":18,"column":40,"index":480},"line":18,"code":"  it('should parse x-www-form-urlencoded', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n  });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 400 when invalid content-length","suites":["bodyParser.urlencoded()"],"updatePoint":{"line":21,"column":44,"index":699},"line":21,"code":"  it('should 400 when invalid content-length', function (done) {\n    var urlencodedParser = bodyParser.urlencoded();\n    var server = createServer(function (req, res, next) {\n      req.headers['content-length'] = '20'; // bad length\n\n      urlencodedParser(req, res, next);\n    });\n    request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('str=').expect(400, /content length/, done);\n  });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should handle Content-Length: 0","suites":["bodyParser.urlencoded()"],"updatePoint":{"line":30,"column":37,"index":1117},"line":30,"code":"  it('should handle Content-Length: 0', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').set('Content-Length', '0').send('').expect(200, '{}', done);\n  });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should handle empty message-body","suites":["bodyParser.urlencoded()"],"updatePoint":{"line":33,"column":38,"index":1335},"line":33,"code":"  it('should handle empty message-body', function (done) {\n    request(createServer({\n      limit: '1kb'\n    })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').set('Transfer-Encoding', 'chunked').send('').expect(200, '{}', done);\n  });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 500 if stream not readable","suites":["bodyParser.urlencoded()"],"updatePoint":{"line":38,"column":39,"index":1592},"line":38,"code":"  it('should 500 if stream not readable', function (done) {\n    var urlencodedParser = bodyParser.urlencoded();\n    var server = createServer(function (req, res, next) {\n      req.on('end', function () {\n        urlencodedParser(req, res, next);\n      });\n      req.resume();\n    });\n    request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(500, '[stream.not.readable] stream is not readable', done);\n  });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should handle duplicated middleware","suites":["bodyParser.urlencoded()"],"updatePoint":{"line":48,"column":41,"index":2056},"line":48,"code":"  it('should handle duplicated middleware', function (done) {\n    var urlencodedParser = bodyParser.urlencoded();\n    var server = createServer(function (req, res, next) {\n      urlencodedParser(req, res, function (err) {\n        if (err) return next(err);\n        urlencodedParser(req, res, next);\n      });\n    });\n    request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n  });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse extended syntax","suites":["bodyParser.urlencoded()"],"updatePoint":{"line":58,"column":34,"index":2515},"line":58,"code":"  it('should parse extended syntax', function (done) {\n    request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user[name][first]=Tobi').expect(200, '{\"user\":{\"name\":{\"first\":\"Tobi\"}}}', done);\n  });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should not parse extended syntax","suites":["bodyParser.urlencoded()","with extended option","when false"],"updatePoint":{"line":68,"column":42,"index":2966},"line":68,"code":"      it('should not parse extended syntax', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user[name][first]=Tobi').expect(200, '{\"user[name][first]\":\"Tobi\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse multiple key instances","suites":["bodyParser.urlencoded()","with extended option","when false"],"updatePoint":{"line":71,"column":45,"index":3220},"line":71,"code":"      it('should parse multiple key instances', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=Tobi&user=Loki').expect(200, '{\"user\":[\"Tobi\",\"Loki\"]}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse multiple key instances","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":81,"column":45,"index":3626},"line":81,"code":"      it('should parse multiple key instances', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=Tobi&user=Loki').expect(200, '{\"user\":[\"Tobi\",\"Loki\"]}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse extended syntax","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":84,"column":38,"index":3866},"line":84,"code":"      it('should parse extended syntax', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user[name][first]=Tobi').expect(200, '{\"user\":{\"name\":{\"first\":\"Tobi\"}}}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse parameters with dots","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":87,"column":43,"index":4124},"line":87,"code":"      it('should parse parameters with dots', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user.name=Tobi').expect(200, '{\"user.name\":\"Tobi\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse fully-encoded extended syntax","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":90,"column":52,"index":4369},"line":90,"code":"      it('should parse fully-encoded extended syntax', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user%5Bname%5D%5Bfirst%5D=Tobi').expect(200, '{\"user\":{\"name\":{\"first\":\"Tobi\"}}}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse array index notation","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":93,"column":43,"index":4635},"line":93,"code":"      it('should parse array index notation', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('foo[0]=bar&foo[1]=baz').expect(200, '{\"foo\":[\"bar\",\"baz\"]}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse array index notation with large array","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":96,"column":60,"index":4896},"line":96,"code":"      it('should parse array index notation with large array', function (done) {\n        var str = 'f[0]=0';\n\n        for (var i = 1; i < 500; i++) {\n          str += '&f[' + i + ']=' + i.toString(16);\n        }\n\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(str).expect(function (res) {\n          var obj = JSON.parse(res.text);\n          assert.strictEqual(Object.keys(obj).length, 1);\n          assert.strictEqual(Array.isArray(obj.f), true);\n          assert.strictEqual(obj.f.length, 500);\n        }).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse array of objects syntax","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":110,"column":46,"index":5472},"line":110,"code":"      it('should parse array of objects syntax', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('foo[0][bar]=baz&foo[0][fizz]=buzz&foo[]=done!').expect(200, '{\"foo\":[{\"bar\":\"baz\",\"fizz\":\"buzz\"},\"done!\"]}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse deep object","suites":["bodyParser.urlencoded()","with extended option","when true"],"updatePoint":{"line":113,"column":34,"index":5755},"line":113,"code":"      it('should parse deep object', function (done) {\n        var str = 'foo';\n\n        for (var i = 0; i < 500; i++) {\n          str += '[p]';\n        }\n\n        str += '=bar';\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(str).expect(function (res) {\n          var obj = JSON.parse(res.text);\n          assert.strictEqual(Object.keys(obj).length, 1);\n          assert.strictEqual(typeof obj.foo, 'object');\n          var depth = 0;\n          var ref = obj.foo;\n\n          while (ref = ref.p) {\n            depth++;\n          }\n\n          assert.strictEqual(depth, 500);\n        }).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should not accept content-encoding","suites":["bodyParser.urlencoded()","with inflate option","when false"],"updatePoint":{"line":144,"column":44,"index":6647},"line":144,"code":"      it('should not accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'application/x-www-form-urlencoded');\n        test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n        test.expect(415, '[encoding.unsupported] content encoding unsupported', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should accept content-encoding","suites":["bodyParser.urlencoded()","with inflate option","when true"],"updatePoint":{"line":158,"column":40,"index":7231},"line":158,"code":"      it('should accept content-encoding', function (done) {\n        var test = request(this.server).post('/');\n        test.set('Content-Encoding', 'gzip');\n        test.set('Content-Type', 'application/x-www-form-urlencoded');\n        test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n        test.expect(200, '{\"name\":\"论\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with Content-Length","suites":["bodyParser.urlencoded()","with limit option"],"updatePoint":{"line":168,"column":54,"index":7692},"line":168,"code":"    it('should 413 when over limit with Content-Length', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      request(createServer({\n        limit: '1kb'\n      })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').set('Content-Length', '1028').send('str=' + buf.toString()).expect(413, done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 413 when over limit with chunked encoding","suites":["bodyParser.urlencoded()","with limit option"],"updatePoint":{"line":174,"column":56,"index":8024},"line":174,"code":"    it('should 413 when over limit with chunked encoding', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.set('Transfer-Encoding', 'chunked');\n      test.write('str=');\n      test.write(buf.toString());\n      test.expect(413, done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 413 when inflated body over limit","suites":["bodyParser.urlencoded()","with limit option"],"updatePoint":{"line":186,"column":48,"index":8458},"line":186,"code":"    it('should 413 when inflated body over limit', function (done) {\n      var server = createServer({\n        limit: '1kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('1f8b080000000000000a2b2e29b2d51b05a360148c580000a0351f9204040000', 'hex'));\n      test.expect(413, done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should accept number of bytes","suites":["bodyParser.urlencoded()","with limit option"],"updatePoint":{"line":196,"column":37,"index":8882},"line":196,"code":"    it('should accept number of bytes', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      request(createServer({\n        limit: 1024\n      })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('str=' + buf.toString()).expect(413, done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should not change when options altered","suites":["bodyParser.urlencoded()","with limit option"],"updatePoint":{"line":202,"column":46,"index":9173},"line":202,"code":"    it('should not change when options altered', function (done) {\n      var buf = Buffer.alloc(1024, '.');\n      var options = {\n        limit: '1kb'\n      };\n      var server = createServer(options);\n      options.limit = '100kb';\n      request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('str=' + buf.toString()).expect(413, done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should not hang response","suites":["bodyParser.urlencoded()","with limit option"],"updatePoint":{"line":211,"column":32,"index":9538},"line":211,"code":"    it('should not hang response', function (done) {\n      var buf = Buffer.alloc(10240, '.');\n      var server = createServer({\n        limit: '8kb'\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(buf);\n      test.write(buf);\n      test.write(buf);\n      test.expect(413, done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should reject 0","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: false"],"updatePoint":{"line":226,"column":25,"index":10023},"line":226,"code":"      it('should reject 0', function () {\n        assert.throws(createServer.bind(null, {\n          extended: false,\n          parameterLimit: 0\n        }), /TypeError: option parameterLimit must be a positive number/);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should reject string","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: false"],"updatePoint":{"line":232,"column":30,"index":10258},"line":232,"code":"      it('should reject string', function () {\n        assert.throws(createServer.bind(null, {\n          extended: false,\n          parameterLimit: 'beep'\n        }), /TypeError: option parameterLimit must be a positive number/);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 413 if over limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: false"],"updatePoint":{"line":238,"column":34,"index":10502},"line":238,"code":"      it('should 413 if over limit', function (done) {\n        request(createServer({\n          extended: false,\n          parameterLimit: 10\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(11)).expect(413, '[parameters.too.many] too many parameters', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work when at the limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: false"],"updatePoint":{"line":244,"column":39,"index":10829},"line":244,"code":"      it('should work when at the limit', function (done) {\n        request(createServer({\n          extended: false,\n          parameterLimit: 10\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(10)).expect(expectKeyCount(10)).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work if number is floating point","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: false"],"updatePoint":{"line":250,"column":49,"index":11148},"line":250,"code":"      it('should work if number is floating point', function (done) {\n        request(createServer({\n          extended: false,\n          parameterLimit: 10.1\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(11)).expect(413, /too many parameters/, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work with large limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: false"],"updatePoint":{"line":256,"column":38,"index":11454},"line":256,"code":"      it('should work with large limit', function (done) {\n        request(createServer({\n          extended: false,\n          parameterLimit: 5000\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(5000)).expect(expectKeyCount(5000)).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work with Infinity limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: false"],"updatePoint":{"line":262,"column":41,"index":11771},"line":262,"code":"      it('should work with Infinity limit', function (done) {\n        request(createServer({\n          extended: false,\n          parameterLimit: Infinity\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(10000)).expect(expectKeyCount(10000)).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should reject 0","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: true"],"updatePoint":{"line":270,"column":25,"index":12136},"line":270,"code":"      it('should reject 0', function () {\n        assert.throws(createServer.bind(null, {\n          extended: true,\n          parameterLimit: 0\n        }), /TypeError: option parameterLimit must be a positive number/);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should reject string","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: true"],"updatePoint":{"line":276,"column":30,"index":12370},"line":276,"code":"      it('should reject string', function () {\n        assert.throws(createServer.bind(null, {\n          extended: true,\n          parameterLimit: 'beep'\n        }), /TypeError: option parameterLimit must be a positive number/);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 413 if over limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: true"],"updatePoint":{"line":282,"column":34,"index":12613},"line":282,"code":"      it('should 413 if over limit', function (done) {\n        request(createServer({\n          extended: true,\n          parameterLimit: 10\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(11)).expect(413, '[parameters.too.many] too many parameters', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work when at the limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: true"],"updatePoint":{"line":288,"column":39,"index":12939},"line":288,"code":"      it('should work when at the limit', function (done) {\n        request(createServer({\n          extended: true,\n          parameterLimit: 10\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(10)).expect(expectKeyCount(10)).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work if number is floating point","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: true"],"updatePoint":{"line":294,"column":49,"index":13257},"line":294,"code":"      it('should work if number is floating point', function (done) {\n        request(createServer({\n          extended: true,\n          parameterLimit: 10.1\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(11)).expect(413, /too many parameters/, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work with large limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: true"],"updatePoint":{"line":300,"column":38,"index":13562},"line":300,"code":"      it('should work with large limit', function (done) {\n        request(createServer({\n          extended: true,\n          parameterLimit: 5000\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(5000)).expect(expectKeyCount(5000)).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work with Infinity limit","suites":["bodyParser.urlencoded()","with parameterLimit option","with extended: true"],"updatePoint":{"line":306,"column":41,"index":13878},"line":306,"code":"      it('should work with Infinity limit', function (done) {\n        request(createServer({\n          extended: true,\n          parameterLimit: Infinity\n        })).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(createManyParams(10000)).expect(expectKeyCount(10000)).expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse for custom type","suites":["bodyParser.urlencoded()","with type option","when \"application/vnd.x-www-form-urlencoded\""],"updatePoint":{"line":321,"column":38,"index":14473},"line":321,"code":"      it('should parse for custom type', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/vnd.x-www-form-urlencoded').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should ignore standard type","suites":["bodyParser.urlencoded()","with type option","when \"application/vnd.x-www-form-urlencoded\""],"updatePoint":{"line":324,"column":37,"index":14697},"line":324,"code":"      it('should ignore standard type', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200, '{}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse \"application/x-www-form-urlencoded\"","suites":["bodyParser.urlencoded()","with type option","when [\"urlencoded\", \"application/x-pairs\"]"],"updatePoint":{"line":334,"column":58,"index":15146},"line":334,"code":"      it('should parse \"application/x-www-form-urlencoded\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse \"application/x-pairs\"","suites":["bodyParser.urlencoded()","with type option","when [\"urlencoded\", \"application/x-pairs\"]"],"updatePoint":{"line":337,"column":44,"index":15373},"line":337,"code":"      it('should parse \"application/x-pairs\"', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-pairs').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should ignore application/x-foo","suites":["bodyParser.urlencoded()","with type option","when [\"urlencoded\", \"application/x-pairs\"]"],"updatePoint":{"line":340,"column":41,"index":15583},"line":340,"code":"      it('should ignore application/x-foo', function (done) {\n        request(this.server).post('/').set('Content-Type', 'application/x-foo').send('user=tobi').expect(200, '{}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse when truthy value returned","suites":["bodyParser.urlencoded()","with type option","when a function"],"updatePoint":{"line":345,"column":49,"index":15840},"line":345,"code":"      it('should parse when truthy value returned', function (done) {\n        var server = createServer({\n          type: accept\n        });\n\n        function accept(req) {\n          return req.headers['content-type'] === 'application/vnd.something';\n        }\n\n        request(server).post('/').set('Content-Type', 'application/vnd.something').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should work without content-type","suites":["bodyParser.urlencoded()","with type option","when a function"],"updatePoint":{"line":356,"column":42,"index":16244},"line":356,"code":"      it('should work without content-type', function (done) {\n        var server = createServer({\n          type: accept\n        });\n\n        function accept(req) {\n          return true;\n        }\n\n        var test = request(server).post('/');\n        test.write('user=tobi');\n        test.expect(200, '{\"user\":\"tobi\"}', done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should not invoke without a body","suites":["bodyParser.urlencoded()","with type option","when a function"],"updatePoint":{"line":369,"column":42,"index":16584},"line":369,"code":"      it('should not invoke without a body', function (done) {\n        var server = createServer({\n          type: accept\n        });\n\n        function accept(req) {\n          throw new Error('oops!');\n        }\n\n        request(server).get('/').expect(200, done);\n      });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should assert value if function","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":383,"column":39,"index":16917},"line":383,"code":"    it('should assert value if function', function () {\n      assert.throws(createServer.bind(null, {\n        verify: 'lol'\n      }), /TypeError: option verify must be function/);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should error from verify","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":388,"column":32,"index":17098},"line":388,"code":"    it('should error from verify', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x20) throw new Error('no leading space');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(' user=tobi').expect(403, '[entity.verify.failed] no leading space', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should allow custom codes","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":396,"column":33,"index":17495},"line":396,"code":"    it('should allow custom codes', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] !== 0x20) return;\n          var err = new Error('no leading space');\n          err.status = 400;\n          throw err;\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(' user=tobi').expect(400, '[entity.verify.failed] no leading space', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should allow custom type","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":407,"column":32,"index":17962},"line":407,"code":"    it('should allow custom type', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] !== 0x20) return;\n          var err = new Error('no leading space');\n          err.type = 'foo.bar';\n          throw err;\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send(' user=tobi').expect(403, '[foo.bar] no leading space', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should allow pass-through","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":418,"column":33,"index":18421},"line":418,"code":"    it('should allow pass-through', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          if (buf[0] === 0x5b) throw new Error('no arrays');\n        }\n      });\n      request(server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200, '{\"user\":\"tobi\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown charset prior to verify","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":426,"column":53,"index":18806},"line":426,"code":"    it('should 415 on unknown charset prior to verify', function (done) {\n      var server = createServer({\n        verify: function (req, res, buf) {\n          throw new Error('unexpected verify call');\n        }\n      });\n      var test = request(server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded; charset=x-bogus');\n      test.write(Buffer.from('00000000', 'hex'));\n      test.expect(415, '[charset.unsupported] unsupported charset \"X-BOGUS\"', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should presist store","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":459,"column":28,"index":19928},"line":459,"code":"    it('should presist store', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=tobi').expect(200).expect('x-store-foo', 'bar').expect('{\"user\":\"tobi\"}').end(done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should presist store when unmatched content-type","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":462,"column":56,"index":20203},"line":462,"code":"    it('should presist store when unmatched content-type', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/fizzbuzz').send('buzz').expect(200).expect('x-store-foo', 'bar').expect('{}').end(done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should presist store when inflated","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":465,"column":42,"index":20433},"line":465,"code":"    it('should presist store when inflated', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n      test.expect(200);\n      test.expect('x-store-foo', 'bar');\n      test.expect('{\"name\":\"论\"}');\n      test.end(done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should presist store when inflate error","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":475,"column":47,"index":20891},"line":475,"code":"    it('should presist store when inflate error', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad6080000', 'hex'));\n      test.expect(400);\n      test.expect('x-store-foo', 'bar');\n      test.end(done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should presist store when limit exceeded","suites":["bodyParser.urlencoded()","with verify option"],"updatePoint":{"line":484,"column":48,"index":21313},"line":484,"code":"    it('should presist store when limit exceeded', function (done) {\n      request(this.server).post('/').set('Content-Type', 'application/x-www-form-urlencoded').send('user=' + Buffer.alloc(1024 * 100, '.').toString()).expect(413).expect('x-store-foo', 'bar').end(done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse utf-8","suites":["bodyParser.urlencoded()","charset"],"updatePoint":{"line":492,"column":26,"index":21682},"line":492,"code":"    it('should parse utf-8', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded; charset=utf-8');\n      test.write(Buffer.from('6e616d653de8aeba', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse when content-length != char length","suites":["bodyParser.urlencoded()","charset"],"updatePoint":{"line":498,"column":55,"index":22003},"line":498,"code":"    it('should parse when content-length != char length', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded; charset=utf-8');\n      test.set('Content-Length', '7');\n      test.write(Buffer.from('746573743dc3a5', 'hex'));\n      test.expect(200, '{\"test\":\"å\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should default to utf-8","suites":["bodyParser.urlencoded()","charset"],"updatePoint":{"line":505,"column":31,"index":22337},"line":505,"code":"    it('should default to utf-8', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('6e616d653de8aeba', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should fail on unknown charset","suites":["bodyParser.urlencoded()","charset"],"updatePoint":{"line":511,"column":38,"index":22626},"line":511,"code":"    it('should fail on unknown charset', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded; charset=koi8-r');\n      test.write(Buffer.from('6e616d653dcec5d4', 'hex'));\n      test.expect(415, '[charset.unsupported] unsupported charset \"KOI8-R\"', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should parse without encoding","suites":["bodyParser.urlencoded()","encoding"],"updatePoint":{"line":524,"column":37,"index":23111},"line":524,"code":"    it('should parse without encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('6e616d653de8aeba', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should support identity encoding","suites":["bodyParser.urlencoded()","encoding"],"updatePoint":{"line":530,"column":40,"index":23402},"line":530,"code":"    it('should support identity encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'identity');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('6e616d653de8aeba', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should support gzip encoding","suites":["bodyParser.urlencoded()","encoding"],"updatePoint":{"line":537,"column":36,"index":23737},"line":537,"code":"    it('should support gzip encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'gzip');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should support deflate encoding","suites":["bodyParser.urlencoded()","encoding"],"updatePoint":{"line":544,"column":39,"index":24111},"line":544,"code":"    it('should support deflate encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'deflate');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('789ccb4bcc4db57db16e17001068042f', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should be case-insensitive","suites":["bodyParser.urlencoded()","encoding"],"updatePoint":{"line":551,"column":34,"index":24459},"line":551,"code":"    it('should be case-insensitive', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'GZIP');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('1f8b080000000000000bcb4bcc4db57db16e170099a4bad608000000', 'hex'));\n      test.expect(200, '{\"name\":\"论\"}', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"},{"name":"should 415 on unknown encoding","suites":["bodyParser.urlencoded()","encoding"],"updatePoint":{"line":558,"column":38,"index":24832},"line":558,"code":"    it('should 415 on unknown encoding', function (done) {\n      var test = request(this.server).post('/');\n      test.set('Content-Encoding', 'nulls');\n      test.set('Content-Type', 'application/x-www-form-urlencoded');\n      test.write(Buffer.from('000000000000', 'hex'));\n      test.expect(415, '[encoding.unsupported] unsupported content encoding \"nulls\"', done);\n    });","file":"urlencoded.js","skipped":false,"dir":"test"}]}
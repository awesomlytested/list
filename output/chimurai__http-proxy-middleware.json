{"repo":"chimurai/http-proxy-middleware","url":"https://github.com/chimurai/http-proxy-middleware","branch":"master","configs":[{"package":"http-proxy-middleware","lang":"ts","dir":"test","framework":"jest","pattern":"**/*[._-]{test,spec,unittest,unit}.{ts,js}"}],"tests":[{"name":"should propagate error to express","suites":["express error middleware"],"updatePoint":{"line":5,"column":39},"line":5,"code":"  it('should propagate error to express', async () => {\n    let httpProxyError: Error | undefined;\n\n    const proxyMiddleware = createProxyMiddleware({\n      changeOrigin: true,\n      router: (req) => undefined, // Trigger \"Error: Must provide a proper URL as target\"\n    });\n\n    const errorMiddleware = (err, req, res, next) => {\n      httpProxyError = err;\n      res.status(504).send('Something broke!');\n    };\n\n    const app = createApp(proxyMiddleware, errorMiddleware);\n    const response = await request(app).get('/get').expect(504);\n\n    expect(httpProxyError.message).toBe('Must provide a proper URL as target');\n    expect(response.text).toBe('Something broke!');\n  });","file":"e2e/express-error-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should still return a response when route does not match proxyConfig","suites":["Usage in Express","Express Sub Route"],"updatePoint":{"line":45,"column":76},"line":45,"code":"    it('should still return a response when route does not match proxyConfig', async () => {\n      const response = await agent.get('/sub/hello');\n      expect(response.body).toEqual({ content: 'foobar' });\n    });","file":"e2e/express-router.spec.ts","skipped":false,"dir":"test"},{"name":"should create a middleware","suites":["E2E http-proxy-middleware","http-proxy-middleware creation"],"updatePoint":{"line":10,"column":34},"line":10,"code":"    it('should create a middleware', () => {\n      const middleware = createProxyMiddleware({\n        target: `http://localhost:8000`,\n        pathFilter: '/api',\n      });\n      expect(typeof middleware).toBe('function');\n    });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should not proxy requests when request url does not match pathFilter","suites":["E2E http-proxy-middleware","pathFilter matching","do not proxy"],"updatePoint":{"line":36,"column":78},"line":36,"code":"      it('should not proxy requests when request url does not match pathFilter', () => {\n        expect(mockNext).toBeCalled();\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should have response body: \"HELLO WEB\"","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","basic setup, requests to target"],"updatePoint":{"line":67,"column":48},"line":67,"code":"      it('should have response body: \"HELLO WEB\"', async () => {\n        await mockTargetServer.get('/api').thenReply(200, 'HELLO WEB');\n        const response = await agent.get(`/api`).expect(200);\n        expect(response.text).toBe('HELLO WEB');\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should have proxied the uri-path and uri-query, but not the uri-hash","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","basic setup, requests to target"],"updatePoint":{"line":73,"column":78},"line":73,"code":"      it('should have proxied the uri-path and uri-query, but not the uri-hash', async () => {\n        await mockTargetServer\n          .get('/api/b/c/dp')\n          .withExactQuery('?q=1&r=[2,3]')\n          .thenReply(200, 'OK');\n\n        const response = await request(`http://localhost:${mockTargetServer.port}`)\n          .get(`/api/b/c/dp?q=1&r=[2,3]#s`)\n          .expect(200);\n\n        expect(response.text).toBe('OK');\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy request body from form","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","basic setup with configured body-parser"],"updatePoint":{"line":88,"column":45},"line":88,"code":"      it('should proxy request body from form', async () => {\n        agent = request(\n          createApp(\n            bodyParser.urlencoded({ extended: false }),\n            createProxyMiddleware({\n              target: `http://localhost:${mockTargetServer.port}`,\n              pathFilter: '/api',\n              on: {\n                proxyReq: fixRequestBody,\n              },\n            })\n          )\n        );\n\n        await mockTargetServer.post('/api').thenCallback((req) => {\n          expect(req.body.text).toBe('foo=bar&bar=baz');\n          return { status: 200 };\n        });\n        await agent.post('/api').send('foo=bar').send('bar=baz').expect(200);\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy request body from json","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","basic setup with configured body-parser"],"updatePoint":{"line":109,"column":45},"line":109,"code":"      it('should proxy request body from json', async () => {\n        agent = request(\n          createApp(\n            bodyParser.json(),\n            createProxyMiddleware({\n              target: `http://localhost:${mockTargetServer.port}`,\n              pathFilter: '/api',\n              on: {\n                proxyReq: fixRequestBody,\n              },\n            })\n          )\n        );\n\n        await mockTargetServer.post('/api').thenCallback((req) => {\n          expect(req.body.json).toEqual({ foo: 'bar', bar: 'baz', doubleByte: '文' });\n          return { status: 200 };\n        });\n        await agent.post('/api').send({ foo: 'bar', bar: 'baz', doubleByte: '文' }).expect(200);\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should have response body: \"HELLO WEB\"","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","custom pathFilter matcher/filter"],"updatePoint":{"line":132,"column":48},"line":132,"code":"      it('should have response body: \"HELLO WEB\"', async () => {\n        const filter = (path, req) => {\n          return true;\n        };\n\n        agent = request(\n          createApp(\n            createProxyMiddleware({\n              target: `http://localhost:${mockTargetServer.port}`,\n              pathFilter: filter,\n            })\n          )\n        );\n\n        await mockTargetServer.get('/api/b/c/d').thenReply(200, 'HELLO WEB');\n        const response = await agent.get(`/api/b/c/d`).expect(200);\n        expect(response.text).toBe('HELLO WEB');\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should not proxy when filter returns false","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","custom pathFilter matcher/filter"],"updatePoint":{"line":151,"column":52},"line":151,"code":"      it('should not proxy when filter returns false', async () => {\n        const filter = (path, req) => {\n          return false;\n        };\n\n        agent = request(\n          createApp(\n            createProxyMiddleware({\n              target: `http://localhost:${mockTargetServer.port}`,\n              pathFilter: filter,\n            })\n          )\n        );\n\n        await mockTargetServer.get('/api/b/c/d').thenReply(200, 'HELLO WEB');\n        const response = await agent.get(`/api/b/c/d`).expect(404);\n        expect(response.status).toBe(404);\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy to path /api","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","multi path"],"updatePoint":{"line":183,"column":35},"line":183,"code":"      it('should proxy to path /api', async () => {\n        await mockTargetServer.get(/\\/api\\/.+/).thenReply(200, 'HELLO /API');\n        const response = await agent.get(`/api/b/c/d`).expect(200);\n        expect(response.text).toBe('HELLO /API');\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy to path /ajax","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","multi path"],"updatePoint":{"line":189,"column":36},"line":189,"code":"      it('should proxy to path /ajax', async () => {\n        await mockTargetServer.get(/\\/ajax\\/.+/).thenReply(200, 'HELLO /AJAX');\n        const response = await agent.get(`/ajax/b/c/d`).expect(200);\n        expect(response.text).toBe('HELLO /AJAX');\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should not proxy with no matching path","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","multi path"],"updatePoint":{"line":195,"column":48},"line":195,"code":"      it('should not proxy with no matching path', async () => {\n        const response = await agent.get(`/lorum/ipsum`).expect(404);\n        expect(response.status).toBe(404);\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy to path","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","wildcard path matching"],"updatePoint":{"line":213,"column":30},"line":213,"code":"      it('should proxy to path', async () => {\n        await mockTargetServer.get(/\\/api\\/.+/).thenReply(200, 'HELLO /api');\n        const response = await agent.get(`/api/b/c/d`).expect(200);\n        expect(response.text).toBe('HELLO /api');\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy to paths ending with *.html","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","multi glob wildcard path matching"],"updatePoint":{"line":232,"column":50},"line":232,"code":"      it('should proxy to paths ending with *.html', async () => {\n        await mockTargetServer.get(/.+html$/).thenReply(200, 'HELLO .html');\n        const response = await agent.get(`/api/some/endpoint/index.html`).expect(200);\n        expect(response.text).toBe('HELLO .html');\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should not proxy to paths ending with *.json","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","multi glob wildcard path matching"],"updatePoint":{"line":238,"column":54},"line":238,"code":"      it('should not proxy to paths ending with *.json', async () => {\n        await mockTargetServer.get(/.+json$/).thenReply(200, 'HELLO .html');\n        const response = await agent.get(`/api/some/endpoint/data.json`).expect(404);\n        expect(response.status).toBe(404);\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should send request header \"host\" to target server","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","option.headers - additional request headers"],"updatePoint":{"line":258,"column":60},"line":258,"code":"      it('should send request header \"host\" to target server', async () => {\n        let completedRequest: CompletedRequest;\n\n        await mockTargetServer.get().thenCallback((req) => {\n          completedRequest = req;\n          return { statusCode: 200, body: 'OK' };\n        });\n\n        const response = await agent.get(`/api/some/endpoint/index.html`).expect(200);\n        expect(response.text).toBe('OK');\n        expect(completedRequest.headers.host).toBe('foobar.dev');\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should handle errors when host is not reachable","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","default httpProxy on error handling"],"updatePoint":{"line":283,"column":57},"line":283,"code":"      it('should handle errors when host is not reachable', async () => {\n        const response = await agent.get(`/api/some/endpoint`).expect(504);\n        expect(response.status).toBe(504);\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should respond with custom http status code","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","option.on.error - custom error handler"],"updatePoint":{"line":308,"column":53},"line":308,"code":"      it('should respond with custom http status code', async () => {\n        const response = await agent.get(`/api/some/endpoint`).expect(418);\n        expect(response.status).toBe(418);\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should respond with custom status message","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","option.on.error - custom error handler"],"updatePoint":{"line":313,"column":51},"line":313,"code":"      it('should respond with custom status message', async () => {\n        const response = await agent.get(`/api/some/endpoint`).expect(418);\n        expect(response.text).toBe(\"I'm a teapot\");\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should add `x-added` as custom header to response\"","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","option.onProxyRes"],"updatePoint":{"line":339,"column":60},"line":339,"code":"      it('should add `x-added` as custom header to response\"', async () => {\n        await mockTargetServer.get().thenReply(200, 'HELLO .html');\n        const response = await agent.get(`/api/some/endpoint/index.html`).expect(200);\n        expect(response.header['x-added']).toBe('foobar');\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should remove `x-removed` field from response header\"","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","option.onProxyRes"],"updatePoint":{"line":345,"column":63},"line":345,"code":"      it('should remove `x-removed` field from response header\"', async () => {\n        await mockTargetServer.get().thenCallback((req) => {\n          return {\n            statusCode: 200,\n            headers: {\n              'x-removed': 'this should be removed',\n            },\n          };\n        });\n        const response = await agent.get(`/api/some/endpoint/index.html`).expect(200);\n        expect(response.header['x-removed']).toBeUndefined();\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should add `x-added` as custom header to request\"","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","option.onProxyReq"],"updatePoint":{"line":376,"column":59},"line":376,"code":"      it('should add `x-added` as custom header to request\"', async () => {\n        let completedRequest: CompletedRequest;\n        await mockTargetServer.get().thenCallback((req) => {\n          completedRequest = req;\n          return { statusCode: 200 };\n        });\n\n        await agent.get(`/api/foo/bar`).expect(200);\n\n        expect(completedRequest.headers['x-added']).toBe('added-from-hpm');\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should have rewritten path from \"/api/foo/bar\" to \"/rest/foo/bar\"","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","option.pathRewrite"],"updatePoint":{"line":404,"column":75},"line":404,"code":"      it('should have rewritten path from \"/api/foo/bar\" to \"/rest/foo/bar\"', async () => {\n        await mockTargetServer.get('/rest/foo/bar').thenReply(200, 'HELLO /rest/foo/bar');\n        const response = await agent.get(`/api/foo/bar`).expect(200);\n        expect(response.text).toBe('HELLO /rest/foo/bar');\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should have removed path from \"/remove/api/lipsum\" to \"/api/lipsum\"","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","option.pathRewrite"],"updatePoint":{"line":410,"column":77},"line":410,"code":"      it('should have removed path from \"/remove/api/lipsum\" to \"/api/lipsum\"', async () => {\n        await mockTargetServer.get('/api/lipsum').thenReply(200, 'HELLO /api/lipsum');\n        const response = await agent.get(`/remove/api/lipsum`).expect(200);\n        expect(response.text).toBe('HELLO /api/lipsum');\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy to target with the baseUrl","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","express with path + proxy"],"updatePoint":{"line":427,"column":49},"line":427,"code":"      it('should proxy to target with the baseUrl', async () => {\n        await mockTargetServer.get('/api/foo/bar').thenReply(200, 'HELLO /api/foo/bar');\n        const response = await agent.get(`/api/foo/bar`).expect(200);\n        expect(response.text).toBe('HELLO /api/foo/bar');\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should have logged messages","suites":["E2E http-proxy-middleware","http-proxy-middleware in actual server","option.logger"],"updatePoint":{"line":456,"column":37},"line":456,"code":"      it('should have logged messages', async () => {\n        await mockTargetServer.get('/api/foo/bar').thenReply(200);\n        await agent.get(`/api/foo/bar`).expect(200);\n\n        expect(logMessages).not.toBeUndefined();\n        expect(logMessages.length).toBe(1);\n        expect(logMessages[0]).toBe('[HPM] GET /api/foo/bar -> http://localhost/api/foo/bar [200]');\n      });","file":"e2e/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should work with raw node http RequestHandler","suites":["http integration"],"updatePoint":{"line":6,"column":51},"line":6,"code":"  it('should work with raw node http RequestHandler', async () => {\n    const handler = createProxyMiddleware({\n      changeOrigin: true,\n      target: 'http://httpbin.org',\n    });\n\n    const server = http.createServer(handler);\n    const response = await request(server).get('/get').expect(200);\n\n    expect(response.ok).toBe(true);\n    expect(response.body.url).toBe('http://httpbin.org/get');\n  });","file":"e2e/http-server.spec.ts","skipped":false,"dir":"test"},{"name":"should remove \"/foobar\" from path","suites":["E2E pathRewrite","Rewrite paths with rules table"],"updatePoint":{"line":18,"column":41},"line":18,"code":"    it('should remove \"/foobar\" from path', async () => {\n      mockTargetServer.get('/api/lorum/ipsum').thenReply(200, '/API RESPONSE AFTER PATH REWRITE');\n\n      const agent = request(\n        createApp(\n          createProxyMiddleware({\n            target: `http://localhost:${mockTargetServer.port}`,\n            pathRewrite: {\n              '^/foobar/api/': '/api/',\n            },\n          })\n        )\n      );\n\n      const response = await agent.get('/foobar/api/lorum/ipsum').expect(200);\n\n      expect(response.text).toBe('/API RESPONSE AFTER PATH REWRITE');\n    });","file":"e2e/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should remove \"/foobar\" from path","suites":["E2E pathRewrite","Rewrite paths with function"],"updatePoint":{"line":39,"column":41},"line":39,"code":"    it('should remove \"/foobar\" from path', async () => {\n      mockTargetServer\n        .get('/api/lorum/ipsum')\n        .thenReply(200, '/API RESPONSE AFTER PATH REWRITE FUNCTION');\n\n      const agent = request(\n        createApp(\n          createProxyMiddleware({\n            target: `http://localhost:${mockTargetServer.port}`,\n            pathRewrite(path, req) {\n              return path.replace('/foobar', '');\n            },\n          })\n        )\n      );\n\n      const response = await agent.get('/foobar/api/lorum/ipsum').expect(200);\n      expect(response.text).toBe('/API RESPONSE AFTER PATH REWRITE FUNCTION');\n    });","file":"e2e/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy with requested path","suites":["E2E pathRewrite","Rewrite paths with function which return undefined"],"updatePoint":{"line":61,"column":40},"line":61,"code":"    it('should proxy with requested path', async () => {\n      mockTargetServer\n        .get('/api/lorum/ipsum')\n        .thenReply(200, '/API RESPONSE AFTER PATH REWRITE FUNCTION');\n\n      const agent = request(\n        createApp(\n          createProxyMiddleware({\n            target: `http://localhost:${mockTargetServer.port}`,\n            pathRewrite(path, req) {\n              return undefined;\n            },\n          })\n        )\n      );\n\n      const response = await agent.get('/api/lorum/ipsum').expect(200);\n      expect(response.text).toBe('/API RESPONSE AFTER PATH REWRITE FUNCTION');\n    });","file":"e2e/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should register a plugin and access the http-proxy object","suites":["E2E Plugins"],"updatePoint":{"line":18,"column":63},"line":18,"code":"  it('should register a plugin and access the http-proxy object', async () => {\n    let proxyReqUrl: string;\n    let responseStatusCode: number;\n\n    mockTargetServer.forGet('/users/1').thenReply(200, '{\"userName\":\"John\"}');\n\n    const simplePlugin: Plugin = (proxy) => {\n      proxy.on('proxyReq', (proxyReq, req, res, options) => (proxyReqUrl = req.url));\n      proxy.on('proxyRes', (proxyRes, req, res) => (responseStatusCode = proxyRes.statusCode));\n    };\n\n    const config: Options = {\n      target: `http://localhost:${mockTargetServer.port}`,\n      plugins: [simplePlugin], // register a plugin\n    };\n    const proxyMiddleware = createProxyMiddleware(config);\n    const app = createApp(proxyMiddleware);\n    const agent = request(app);\n\n    const response = await agent.get('/users/1').expect(200);\n\n    expect(proxyReqUrl).toBe('/users/1');\n    expect(response.text).toBe('{\"userName\":\"John\"}');\n    expect(responseStatusCode).toBe(200);\n  });","file":"e2e/plugins.spec.ts","skipped":false,"dir":"test"},{"name":"should return totally different response from http://httpbin.org/json","suites":["responseInterceptor()","intercept responses"],"updatePoint":{"line":27,"column":77},"line":27,"code":"    it('should return totally different response from http://httpbin.org/json', async () => {\n      const response = await agent.get(`/json`).expect(200);\n      expect(response.body.foo).toEqual('bar');\n    });","file":"e2e/response-interceptor.spec.ts","skipped":false,"dir":"test"},{"name":"should return totally different response from http://httpbin.org/image","suites":["responseInterceptor()","intercept responses"],"updatePoint":{"line":32,"column":78},"line":32,"code":"    it('should return totally different response from http://httpbin.org/image', async () => {\n      const response = await agent\n        .get(`/image`)\n        .expect('Content-Type', 'application/json; charset=utf-8')\n        .expect(200);\n      expect(response.body.foo).toEqual('bar');\n    });","file":"e2e/response-interceptor.spec.ts","skipped":false,"dir":"test"},{"name":"should support double bytes characters http://httpbin.org/json","suites":["responseInterceptor()","intercept responses"],"updatePoint":{"line":40,"column":70},"line":40,"code":"    it('should support double bytes characters http://httpbin.org/json', async () => {\n      const response = await agent.get(`/json`).expect(200);\n      expect(response.body.favorite).toEqual('叉燒包');\n    });","file":"e2e/response-interceptor.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy and return original headers from http://httpbin.org/cookies/set/cookie/monster","suites":["responseInterceptor()","intercept responses with original headers"],"updatePoint":{"line":64,"column":99},"line":64,"code":"    it('should proxy and return original headers from http://httpbin.org/cookies/set/cookie/monster', async () => {\n      return agent\n        .get(`/cookies/set/cookie/monster`)\n        .expect('Access-Control-Allow-Origin', '*')\n        .expect('Date', /.+/)\n        .expect('set-cookie', /.*cookie=monster.*/)\n        .expect(302);\n    });","file":"e2e/response-interceptor.spec.ts","skipped":false,"dir":"test"},{"name":"should return decompressed brotli response http://httpbin.org/brotli","suites":["responseInterceptor()","intercept compressed responses"],"updatePoint":{"line":90,"column":76},"line":90,"code":"    it('should return decompressed brotli response http://httpbin.org/brotli', async () => {\n      const response = await agent.get(`/brotli`).expect(200);\n      expect(response.body.brotli).toBe(true);\n    });","file":"e2e/response-interceptor.spec.ts","skipped":false,"dir":"test"},{"name":"should return decompressed gzipped response from http://httpbin.org/gzip","suites":["responseInterceptor()","intercept compressed responses"],"updatePoint":{"line":95,"column":80},"line":95,"code":"    it('should return decompressed gzipped response from http://httpbin.org/gzip', async () => {\n      const response = await agent.get(`/gzip`).expect(200);\n      expect(response.body.gzipped).toBe(true);\n    });","file":"e2e/response-interceptor.spec.ts","skipped":false,"dir":"test"},{"name":"should return decompressed deflated response from http://httpbin.org/deflate","suites":["responseInterceptor()","intercept compressed responses"],"updatePoint":{"line":100,"column":84},"line":100,"code":"    it('should return decompressed deflated response from http://httpbin.org/deflate', async () => {\n      const response = await agent.get(`/deflate`).expect(200);\n      expect(response.body.deflated).toBe(true);\n    });","file":"e2e/response-interceptor.spec.ts","skipped":false,"dir":"test"},{"name":"should work with a string","suites":["E2E router","router with req"],"updatePoint":{"line":61,"column":33},"line":61,"code":"    it('should work with a string', async () => {\n      const app = createApp(\n        createProxyMiddleware({\n          target: `https://localhost:${targetPortA}`,\n          secure: false,\n          changeOrigin: true,\n          router(req) {\n            return `https://localhost:${targetPortC}`;\n          },\n        })\n      );\n\n      const agent = request(app);\n      const response = await agent.get('/api').expect(200);\n      expect(response.text).toBe('C');\n    });","file":"e2e/router.spec.ts","skipped":false,"dir":"test"},{"name":"should work with an object","suites":["E2E router","router with req"],"updatePoint":{"line":78,"column":34},"line":78,"code":"    it('should work with an object', async () => {\n      const app = createApp(\n        createProxyMiddleware({\n          target: `https://localhost:${targetPortA}`,\n          secure: false,\n          changeOrigin: true,\n          router(req) {\n            return { host: 'localhost', port: targetPortC, protocol: 'https:' };\n          },\n        })\n      );\n      const agent = request(app);\n      const response = await agent.get('/api').expect(200);\n      expect(response.text).toBe('C');\n    });","file":"e2e/router.spec.ts","skipped":false,"dir":"test"},{"name":"should work with an async callback","suites":["E2E router","router with req"],"updatePoint":{"line":94,"column":42},"line":94,"code":"    it('should work with an async callback', async () => {\n      const app = createApp(\n        createProxyMiddleware({\n          target: `https://localhost:${targetPortA}`,\n          secure: false,\n          changeOrigin: true,\n          router: async (req) => {\n            return new Promise((resolve) =>\n              resolve({ host: 'localhost', port: targetPortC, protocol: 'https:' })\n            );\n          },\n        })\n      );\n\n      const agent = request(app);\n      const response = await agent.get('/api').expect(200);\n      expect(response.text).toBe('C');\n    });","file":"e2e/router.spec.ts","skipped":false,"dir":"test"},{"name":"should handle promise rejection in router","suites":["E2E router","router with req"],"updatePoint":{"line":113,"column":49},"line":113,"code":"    it('should handle promise rejection in router', async () => {\n      const app = createApp(\n        createProxyMiddleware({\n          target: `https://localhost:${targetPortA}`,\n          secure: false,\n          changeOrigin: true,\n          router: async (req) => {\n            throw new Error('An error thrown in the router');\n          },\n        })\n      );\n      const errorHandler: ErrorRequestHandler = (err: Error, req, res, next) => {\n        res.status(502).send(err.message);\n      };\n      app.use(errorHandler);\n\n      const agent = request(app);\n      const response = await agent.get('/api').expect(502);\n      expect(response.text).toBe('An error thrown in the router');\n    });","file":"e2e/router.spec.ts","skipped":false,"dir":"test"},{"name":"missing a : will cause it to use http","suites":["E2E router","router with req"],"updatePoint":{"line":134,"column":45},"line":134,"code":"    it('missing a : will cause it to use http', async () => {\n      const app = createApp(\n        createProxyMiddleware({\n          target: `https://localhost:${targetPortA}`,\n          secure: false,\n          changeOrigin: true,\n          router: async (req) => {\n            return new Promise((resolve) =>\n              resolve({ host: 'localhost', port: targetPortC, protocol: 'https' })\n            );\n          },\n        })\n      );\n\n      const agent = request(app);\n      const response = await agent.get('/api').expect(200);\n      expect(response.text).toBe('NOT HTTPS C');\n    });","file":"e2e/router.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy to option.target","suites":["E2E router","router with proxyTable"],"updatePoint":{"line":175,"column":37},"line":175,"code":"    it('should proxy to option.target', async () => {\n      const response = await agent.get('/api').expect(200);\n\n      expect(response.text).toBe('A');\n    });","file":"e2e/router.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy when host is \"alpha.localhost\"","suites":["E2E router","router with proxyTable"],"updatePoint":{"line":181,"column":51},"line":181,"code":"    it('should proxy when host is \"alpha.localhost\"', async () => {\n      const response = await agent.get('/api').set('host', 'alpha.localhost:6000').expect(200);\n\n      expect(response.text).toBe('A');\n    });","file":"e2e/router.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy when host is \"beta.localhost\"","suites":["E2E router","router with proxyTable"],"updatePoint":{"line":187,"column":50},"line":187,"code":"    it('should proxy when host is \"beta.localhost\"', async () => {\n      const response = await agent.get('/api').set('host', 'beta.localhost:6000').expect(200);\n\n      expect(response.text).toBe('B');\n    });","file":"e2e/router.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy with host & path config: \"localhost:6000/api\"","suites":["E2E router","router with proxyTable"],"updatePoint":{"line":193,"column":66},"line":193,"code":"    it('should proxy with host & path config: \"localhost:6000/api\"', async () => {\n      const response = await agent.get('/api').set('host', 'localhost:6000').expect(200);\n\n      expect(response.text).toBe('C');\n    });","file":"e2e/router.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy to path","suites":["E2E WebSocket proxy","option.ws"],"updatePoint":{"line":69,"column":28},"line":69,"code":"    it('should proxy to path', (done) => {\n      ws.on('message', (data, isBinary) => {\n        const message = isBinary ? data : data.toString();\n        expect(message).toBe('foobar');\n        done();\n      });\n      ws.send('foobar');\n    });","file":"e2e/websocket.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy to path","suites":["E2E WebSocket proxy","option.ws with external server \"upgrade\""],"updatePoint":{"line":88,"column":28},"line":88,"code":"    it('should proxy to path', (done) => {\n      ws.on('message', (data, isBinary) => {\n        const message = isBinary ? data : data.toString();\n        expect(message).toBe('foobar');\n        done();\n      });\n      ws.send('foobar');\n    });","file":"e2e/websocket.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy to path","suites":["E2E WebSocket proxy","with router and pathRewrite"],"updatePoint":{"line":118,"column":28},"line":118,"code":"    it('should proxy to path', (done) => {\n      ws.on('message', (data, isBinary) => {\n        const message = isBinary ? data : data.toString();\n        expect(message).toBe('foobar');\n        done();\n      });\n      ws.send('foobar');\n    });","file":"e2e/websocket.spec.ts","skipped":false,"dir":"test"},{"name":"should throw when short hand is used","suites":["legacyCreateProxyMiddleware()"],"updatePoint":{"line":12,"column":42},"line":12,"code":"  it('should throw when short hand is used', () => {\n    expect(() => legacyCreateProxyMiddleware(`http://localhost:${mockServer.port}`))\n      .toThrowErrorMatchingInlineSnapshot(`\n      \"Shorthand syntax is removed from legacyCreateProxyMiddleware().\n            Please use \\\\\"legacyCreateProxyMiddleware({ target: 'http://www.example.org' })\\\\\" instead.\"\n    `);\n  });","file":"legacy/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should expose external websocket upgrade handler","suites":["legacyCreateProxyMiddleware()"],"updatePoint":{"line":20,"column":54},"line":20,"code":"  it('should expose external websocket upgrade handler', () => {\n    const proxyMiddleware = legacyCreateProxyMiddleware({\n      target: `http://localhost:${mockServer.port}`,\n    });\n    expect(proxyMiddleware.upgrade).toBeDefined();\n  });","file":"legacy/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy to /users","suites":["legacyCreateProxyMiddleware()"],"updatePoint":{"line":27,"column":28},"line":27,"code":"  it('should proxy to /users', async () => {\n    mockServer.forGet('/users').thenReply(200, 'legacy OK');\n\n    const proxyMiddleware = legacyCreateProxyMiddleware({\n      target: `http://localhost:${mockServer.port}`,\n    });\n\n    const app = createApp(proxyMiddleware);\n    const response = await request(app).get('/users').expect(200);\n\n    expect(response.text).toBe('legacy OK');\n  });","file":"legacy/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy with old context option","suites":["legacyCreateProxyMiddleware()"],"updatePoint":{"line":40,"column":42},"line":40,"code":"  it('should proxy with old context option', async () => {\n    mockServer.forGet('/admin/users').thenReply(200, 'legacy OK');\n\n    const proxyMiddleware = legacyCreateProxyMiddleware('/admin', {\n      target: `http://localhost:${mockServer.port}`,\n    });\n\n    const app = createApp(proxyMiddleware);\n    const response = await request(app).get('/admin/users').expect(200);\n\n    expect(response.text).toBe('legacy OK');\n  });","file":"legacy/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should proxy to /users with legacy patched req.url behavior","suites":["legacyCreateProxyMiddleware()"],"updatePoint":{"line":53,"column":65},"line":53,"code":"  it('should proxy to /users with legacy patched req.url behavior', async () => {\n    mockServer.forGet('/users').thenReply(200, 'legacy OK');\n\n    const proxyMiddleware = legacyCreateProxyMiddleware({\n      target: `http://localhost:${mockServer.port}`,\n    });\n\n    const app = createAppWithPath('/users', proxyMiddleware);\n    const response = await request(app).get('/users').expect(200);\n\n    expect(response.text).toBe('legacy OK');\n  });","file":"legacy/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should fail to proxy to /users with legacy patched req.url behavior","suites":["legacyCreateProxyMiddleware()"],"updatePoint":{"line":66,"column":73},"line":66,"code":"  it('should fail to proxy to /users with legacy patched req.url behavior', async () => {\n    mockServer.forGet('/users').thenReply(200, 'legacy OK');\n\n    const proxyMiddleware = legacyCreateProxyMiddleware({\n      target: `http://localhost:${mockServer.port}/users`,\n    });\n\n    const app = createAppWithPath('/users', proxyMiddleware);\n    await request(app).get('/users').expect(503);\n  });","file":"legacy/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should respond with legacy onError handler and log error","suites":["legacyCreateProxyMiddleware()"],"updatePoint":{"line":77,"column":62},"line":77,"code":"  it('should respond with legacy onError handler and log error', async () => {\n    mockServer.forGet('/users').thenCloseConnection();\n\n    const mockLogger = {\n      info: jest.fn(),\n      warn: jest.fn(),\n      error: jest.fn(),\n    };\n\n    const legacyOptions: LegacyOptions = {\n      target: `http://localhost:${mockServer.port}`,\n      logLevel: 'error',\n      logProvider: () => mockLogger,\n      onError(err, req, res) {\n        res.status(500).send('my legacy error');\n      },\n    };\n\n    const proxyMiddleware = legacyCreateProxyMiddleware(legacyOptions);\n\n    const app = createAppWithPath('/users', proxyMiddleware);\n    const response = await request(app).get('/users').expect(500);\n\n    expect(response.text).toBe('my legacy error');\n\n    expect(mockLogger.error).toHaveBeenCalledTimes(1);\n    expect(mockLogger.warn).toHaveBeenCalledTimes(2);\n  });","file":"legacy/http-proxy-middleware.spec.ts","skipped":false,"dir":"test"},{"name":"should create proxy with just options","suites":["http-proxy-middleware TypeScript Types","createProxyMiddleware()"],"updatePoint":{"line":17,"column":45},"line":17,"code":"    it('should create proxy with just options', () => {\n      const proxy = middleware(options);\n      expect(proxy).toBeDefined();\n    });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should create proxy and accept base http types (req, res) from native http server","suites":["http-proxy-middleware TypeScript Types","createProxyMiddleware()"],"updatePoint":{"line":22,"column":89},"line":22,"code":"    it('should create proxy and accept base http types (req, res) from native http server', () => {\n      const proxy = middleware(options);\n      const server = http.createServer(proxy);\n\n      expect(proxy).toBeDefined();\n      expect(server).toBeDefined();\n    });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should create proxy with path filter","suites":["http-proxy-middleware TypeScript Types","HPM Filters"],"updatePoint":{"line":32,"column":44},"line":32,"code":"    it('should create proxy with path filter', () => {\n      const proxy = middleware({ ...options, pathFilter: '/api' });\n      expect(proxy).toBeDefined();\n    });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should create proxy with glob filter","suites":["http-proxy-middleware TypeScript Types","HPM Filters"],"updatePoint":{"line":37,"column":44},"line":37,"code":"    it('should create proxy with glob filter', () => {\n      const proxy = middleware({ ...options, pathFilter: ['/path/**'] });\n      expect(proxy).toBeDefined();\n    });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should create proxy with custom filter","suites":["http-proxy-middleware TypeScript Types","HPM Filters"],"updatePoint":{"line":42,"column":46},"line":42,"code":"    it('should create proxy with custom filter', () => {\n      const proxy = middleware({ ...options, pathFilter: (path, req) => true });\n      expect(proxy).toBeDefined();\n    });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should create proxy with manual websocket upgrade function","suites":["http-proxy-middleware TypeScript Types","HPM Filters"],"updatePoint":{"line":47,"column":66},"line":47,"code":"    it('should create proxy with manual websocket upgrade function', () => {\n      const proxy = middleware({ ...options, pathFilter: (path, req) => true });\n      expect(proxy.upgrade).toBeDefined();\n    });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should extend from http-proxy options","suites":["http-proxy-middleware TypeScript Types","http-proxy options"],"updatePoint":{"line":54,"column":45},"line":54,"code":"    it('should extend from http-proxy options', () => {\n      options = {\n        target: 'http://example',\n        ws: true,\n      };\n      expect(options).toBeDefined();\n    });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should have pathRewrite Type with table","suites":["http-proxy-middleware TypeScript Types","http-proxy-middleware options","pathRewrite"],"updatePoint":{"line":65,"column":49},"line":65,"code":"      it('should have pathRewrite Type with table', () => {\n        options = { pathRewrite: { '^/from': '/to' } };\n        expect(options).toBeDefined();\n      });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should have pathRewrite Type with function","suites":["http-proxy-middleware TypeScript Types","http-proxy-middleware options","pathRewrite"],"updatePoint":{"line":70,"column":52},"line":70,"code":"      it('should have pathRewrite Type with function', () => {\n        options = { pathRewrite: (path, req) => '/path' };\n        expect(options).toBeDefined();\n      });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should have pathRewrite Type with async function","suites":["http-proxy-middleware TypeScript Types","http-proxy-middleware options","pathRewrite"],"updatePoint":{"line":75,"column":58},"line":75,"code":"      it('should have pathRewrite Type with async function', () => {\n        options = { pathRewrite: async (path, req) => '/path' };\n        expect(options).toBeDefined();\n      });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should have router Type with table","suites":["http-proxy-middleware TypeScript Types","http-proxy-middleware options","router"],"updatePoint":{"line":82,"column":44},"line":82,"code":"      it('should have router Type with table', () => {\n        options = { router: { '^/from': '/to' } };\n        expect(options).toBeDefined();\n      });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should have router Type with function","suites":["http-proxy-middleware TypeScript Types","http-proxy-middleware options","router"],"updatePoint":{"line":87,"column":47},"line":87,"code":"      it('should have router Type with function', () => {\n        options = { router: (path) => '/path' };\n        expect(options).toBeDefined();\n      });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should have router Type with async function","suites":["http-proxy-middleware TypeScript Types","http-proxy-middleware options","router"],"updatePoint":{"line":92,"column":53},"line":92,"code":"      it('should have router Type with async function', () => {\n        options = { router: async (path) => '/path' };\n        expect(options).toBeDefined();\n      });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should have logger option","suites":["http-proxy-middleware TypeScript Types","http-proxy-middleware options","logger"],"updatePoint":{"line":99,"column":35},"line":99,"code":"      it('should have logger option', () => {\n        options = { logger: console };\n        expect(options).toBeDefined();\n      });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should have on events","suites":["http-proxy-middleware TypeScript Types","http-proxy-middleware options","on"],"updatePoint":{"line":106,"column":31},"line":106,"code":"      it('should have on events', () => {\n        options = {\n          on: {\n            error: (error, req, res, target) => {},\n            proxyReq: (proxyReq, req, res, options) => {},\n            proxyReqWs: (proxyReq, req, socket, options) => {},\n            proxyRes: (proxyRes, req, res) => {},\n            open: (proxySocket) => {},\n            close: (proxyRes, proxySocket, proxyHead) => {},\n            start: (req, res, target) => {},\n            end: (req, res, proxyRes) => {},\n            econnreset: (error, req, res, target) => {},\n\n            // @ts-expect-error explanation: should error when unknown event is passed\n            unknownEventName: () => {},\n          },\n        };\n        expect(options).toBeDefined();\n      });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should get TypeScript errors when express specific properties are used","suites":["http-proxy-middleware TypeScript Types","express request and response types"],"updatePoint":{"line":129,"column":78},"line":129,"code":"    it('should get TypeScript errors when express specific properties are used', () => {\n      options = {\n        on: {\n          proxyReq(proxyReq, req, res, options) {\n            // @ts-expect-error explanation: should error when express properties are used\n            req.params;\n          },\n          proxyRes(proxyRes, req, res) {\n            // @ts-expect-error explanation: should error when express properties are used\n            res.status(200).send('OK');\n          },\n        },\n      };\n\n      expect(options).toBeDefined();\n    });","file":"types.spec.ts","skipped":false,"dir":"test"},{"name":"should throw an error when target and router option are missing","suites":["configFactory","verifyConfig()","missing option.target"],"updatePoint":{"line":14,"column":73},"line":14,"code":"      it('should throw an error when target and router option are missing', () => {\n        expect(fn).toThrowError(Error);\n      });","file":"unit/configuration.spec.ts","skipped":false,"dir":"test"},{"name":"should not throw an error when target option is missing when router is used","suites":["configFactory","verifyConfig()","optional option.target when option.router is used"],"updatePoint":{"line":31,"column":85},"line":31,"code":"      it('should not throw an error when target option is missing when router is used', () => {\n        expect(fn).not.toThrowError(Error);\n      });","file":"unit/configuration.spec.ts","skipped":false,"dir":"test"},{"name":"should not write when body is undefined","suites":["fixRequestBody"],"updatePoint":{"line":16,"column":45},"line":16,"code":"  it('should not write when body is undefined', () => {\n    const proxyRequest = fakeProxyRequest();\n\n    jest.spyOn(proxyRequest, 'setHeader');\n    jest.spyOn(proxyRequest, 'write');\n\n    fixRequestBody(proxyRequest, { body: undefined } as Request<express.Request>);\n\n    expect(proxyRequest.setHeader).not.toHaveBeenCalled();\n    expect(proxyRequest.write).not.toHaveBeenCalled();\n  });","file":"unit/fix-request-body.spec.ts","skipped":false,"dir":"test"},{"name":"should write when body is an empty JSON object","suites":["fixRequestBody"],"updatePoint":{"line":28,"column":52},"line":28,"code":"  it('should write when body is an empty JSON object', () => {\n    const proxyRequest = fakeProxyRequest();\n    proxyRequest.setHeader('content-type', 'application/json; charset=utf-8');\n\n    jest.spyOn(proxyRequest, 'setHeader');\n    jest.spyOn(proxyRequest, 'write');\n\n    fixRequestBody(proxyRequest, { body: {} } as Request<express.Request>);\n\n    expect(proxyRequest.setHeader).toHaveBeenCalled();\n    expect(proxyRequest.write).toHaveBeenCalled();\n  });","file":"unit/fix-request-body.spec.ts","skipped":false,"dir":"test"},{"name":"should write when body is not empty and Content-Type is application/json","suites":["fixRequestBody"],"updatePoint":{"line":41,"column":78},"line":41,"code":"  it('should write when body is not empty and Content-Type is application/json', () => {\n    const proxyRequest = fakeProxyRequest();\n    proxyRequest.setHeader('content-type', 'application/json; charset=utf-8');\n\n    jest.spyOn(proxyRequest, 'setHeader');\n    jest.spyOn(proxyRequest, 'write');\n\n    fixRequestBody(proxyRequest, { body: { someField: 'some value' } } as Request<express.Request>);\n\n    const expectedBody = JSON.stringify({ someField: 'some value' });\n    expect(proxyRequest.setHeader).toHaveBeenCalledWith('Content-Length', expectedBody.length);\n    expect(proxyRequest.write).toHaveBeenCalledWith(expectedBody);\n  });","file":"unit/fix-request-body.spec.ts","skipped":false,"dir":"test"},{"name":"should write when body is not empty and Content-Type is application/x-www-form-urlencoded","suites":["fixRequestBody"],"updatePoint":{"line":55,"column":95},"line":55,"code":"  it('should write when body is not empty and Content-Type is application/x-www-form-urlencoded', () => {\n    const proxyRequest = fakeProxyRequest();\n    proxyRequest.setHeader('content-type', 'application/x-www-form-urlencoded');\n\n    jest.spyOn(proxyRequest, 'setHeader');\n    jest.spyOn(proxyRequest, 'write');\n\n    fixRequestBody(proxyRequest, { body: { someField: 'some value' } } as Request<express.Request>);\n\n    const expectedBody = querystring.stringify({ someField: 'some value' });\n    expect(proxyRequest.setHeader).toHaveBeenCalledWith('Content-Length', expectedBody.length);\n    expect(proxyRequest.write).toHaveBeenCalledWith(expectedBody);\n  });","file":"unit/fix-request-body.spec.ts","skipped":false,"dir":"test"},{"name":"should write when body is not empty and Content-Type includes application/x-www-form-urlencoded","suites":["fixRequestBody"],"updatePoint":{"line":69,"column":101},"line":69,"code":"  it('should write when body is not empty and Content-Type includes application/x-www-form-urlencoded', () => {\n    const proxyRequest = fakeProxyRequest();\n    proxyRequest.setHeader('content-type', 'application/x-www-form-urlencoded; charset=UTF-8');\n\n    jest.spyOn(proxyRequest, 'setHeader');\n    jest.spyOn(proxyRequest, 'write');\n\n    fixRequestBody(proxyRequest, { body: { someField: 'some value' } } as Request<express.Request>);\n\n    const expectedBody = querystring.stringify({ someField: 'some value' });\n    expect(proxyRequest.setHeader).toHaveBeenCalledWith('Content-Length', expectedBody.length);\n    expect(proxyRequest.write).toHaveBeenCalledWith(expectedBody);\n  });","file":"unit/fix-request-body.spec.ts","skipped":false,"dir":"test"},{"name":"should return default plugins when no user plugins are provided","suites":["getPlugins"],"updatePoint":{"line":13,"column":69},"line":13,"code":"  it('should return default plugins when no user plugins are provided', () => {\n    plugins = getPlugins({});\n\n    expect(plugins).toHaveLength(4);\n    expect(plugins.map((plugin) => plugin.name)).toMatchInlineSnapshot(`\n      Array [\n        \"debugProxyErrorsPlugin\",\n        \"proxyEventsPlugin\",\n        \"loggerPlugin\",\n        \"errorResponsePlugin\",\n      ]\n    `);\n  });","file":"unit/get-plugins.spec.ts","skipped":false,"dir":"test"},{"name":"should return no plugins when ejectPlugins is configured in option","suites":["getPlugins"],"updatePoint":{"line":27,"column":72},"line":27,"code":"  it('should return no plugins when ejectPlugins is configured in option', () => {\n    plugins = getPlugins({\n      ejectPlugins: true,\n    });\n\n    expect(plugins).toHaveLength(0);\n  });","file":"unit/get-plugins.spec.ts","skipped":false,"dir":"test"},{"name":"should return user plugins with default plugins when user plugins are provided","suites":["getPlugins"],"updatePoint":{"line":35,"column":84},"line":35,"code":"  it('should return user plugins with default plugins when user plugins are provided', () => {\n    const myPlugin: Plugin = () => {\n      /* noop */\n    };\n    plugins = getPlugins({\n      plugins: [myPlugin],\n    });\n\n    expect(plugins).toHaveLength(5);\n    expect(plugins.map((plugin) => plugin.name)).toMatchInlineSnapshot(`\n      Array [\n        \"debugProxyErrorsPlugin\",\n        \"proxyEventsPlugin\",\n        \"loggerPlugin\",\n        \"errorResponsePlugin\",\n        \"myPlugin\",\n      ]\n    `);\n  });","file":"unit/get-plugins.spec.ts","skipped":false,"dir":"test"},{"name":"should only return user plugins when user plugins are provided with ejectPlugins option","suites":["getPlugins"],"updatePoint":{"line":55,"column":93},"line":55,"code":"  it('should only return user plugins when user plugins are provided with ejectPlugins option', () => {\n    const myPlugin: Plugin = () => {\n      /* noop */\n    };\n    plugins = getPlugins({\n      ejectPlugins: true,\n      plugins: [myPlugin],\n    });\n\n    expect(plugins).toHaveLength(1);\n    expect(plugins.map((plugin) => plugin.name)).toMatchInlineSnapshot(`\n      Array [\n        \"myPlugin\",\n      ]\n    `);\n  });","file":"unit/get-plugins.spec.ts","skipped":false,"dir":"test"},{"name":"should return manually added default plugins in different order after using ejectPlugins","suites":["getPlugins"],"updatePoint":{"line":72,"column":94},"line":72,"code":"  it('should return manually added default plugins in different order after using ejectPlugins', () => {\n    plugins = getPlugins({\n      ejectPlugins: true,\n      plugins: [debugProxyErrorsPlugin, errorResponsePlugin, loggerPlugin, proxyEventsPlugin], // alphabetical order\n    });\n\n    expect(plugins).toHaveLength(4);\n    expect(plugins.map((plugin) => plugin.name)).toMatchInlineSnapshot(`\n      Array [\n        \"debugProxyErrorsPlugin\",\n        \"errorResponsePlugin\",\n        \"loggerPlugin\",\n        \"proxyEventsPlugin\",\n      ]\n    `);\n  });","file":"unit/get-plugins.spec.ts","skipped":false,"dir":"test"},{"name":"should not configure errorResponsePlugin when user specifies their own error handler","suites":["getPlugins"],"updatePoint":{"line":89,"column":90},"line":89,"code":"  it('should not configure errorResponsePlugin when user specifies their own error handler', () => {\n    const myErrorHandler = () => {\n      /* noop */\n    };\n    plugins = getPlugins({\n      on: {\n        error: myErrorHandler,\n      },\n    });\n\n    expect(plugins).toHaveLength(3);\n    expect(plugins.map((plugin) => plugin.name)).toMatchInlineSnapshot(`\n      Array [\n        \"debugProxyErrorsPlugin\",\n        \"proxyEventsPlugin\",\n        \"loggerPlugin\",\n      ]\n    `);\n  });","file":"unit/get-plugins.spec.ts","skipped":false,"dir":"test"},{"name":"should return global \"console\" logger when configured in Options","suites":["Logger"],"updatePoint":{"line":4,"column":70},"line":4,"code":"  it('should return global \"console\" logger when configured in Options', () => {\n    const logger = getLogger({ logger: console });\n    expect(logger).toBe(console);\n  });","file":"unit/logger.spec.ts","skipped":false,"dir":"test"},{"name":"should return noop logger when not configured in Options","suites":["Logger"],"updatePoint":{"line":9,"column":62},"line":9,"code":"  it('should return noop logger when not configured in Options', () => {\n    const logger = getLogger({});\n    expect(Object.keys(logger)).toMatchInlineSnapshot(`\n      Array [\n        \"info\",\n        \"warn\",\n        \"error\",\n      ]\n    `);\n  });","file":"unit/logger.spec.ts","skipped":false,"dir":"test"},{"name":"should match all paths","suites":["Path Filter","String path matching","Single path matching"],"updatePoint":{"line":11,"column":32},"line":11,"code":"      it('should match all paths', () => {\n        result = matchPathFilter('', 'http://localhost/api/foo/bar', fakeReq);\n        expect(result).toBe(true);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should match all paths starting with forward-slash","suites":["Path Filter","String path matching","Single path matching"],"updatePoint":{"line":16,"column":60},"line":16,"code":"      it('should match all paths starting with forward-slash', () => {\n        result = matchPathFilter('/', 'http://localhost/api/foo/bar', fakeReq);\n        expect(result).toBe(true);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should return true when the pathFilter is present in url","suites":["Path Filter","String path matching","Single path matching"],"updatePoint":{"line":21,"column":66},"line":21,"code":"      it('should return true when the pathFilter is present in url', () => {\n        result = matchPathFilter('/api', 'http://localhost/api/foo/bar', fakeReq);\n        expect(result).toBe(true);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should return false when the pathFilter is not present in url","suites":["Path Filter","String path matching","Single path matching"],"updatePoint":{"line":26,"column":71},"line":26,"code":"      it('should return false when the pathFilter is not present in url', () => {\n        result = matchPathFilter('/abc', 'http://localhost/api/foo/bar', fakeReq);\n        expect(result).toBe(false);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should return false when the pathFilter is present half way in url","suites":["Path Filter","String path matching","Single path matching"],"updatePoint":{"line":31,"column":76},"line":31,"code":"      it('should return false when the pathFilter is present half way in url', () => {\n        result = matchPathFilter('/foo', 'http://localhost/api/foo/bar', fakeReq);\n        expect(result).toBe(false);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should return false when the pathFilter does not start with /","suites":["Path Filter","String path matching","Single path matching"],"updatePoint":{"line":36,"column":71},"line":36,"code":"      it('should return false when the pathFilter does not start with /', () => {\n        result = matchPathFilter('api', 'http://localhost/api/foo/bar', fakeReq);\n        expect(result).toBe(false);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should return true when the pathFilter is present in url","suites":["Path Filter","String path matching","Multi path matching"],"updatePoint":{"line":43,"column":66},"line":43,"code":"      it('should return true when the pathFilter is present in url', () => {\n        result = matchPathFilter(['/api'], 'http://localhost/api/foo/bar', fakeReq);\n        expect(result).toBe(true);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should return true when the pathFilter is present in url","suites":["Path Filter","String path matching","Multi path matching"],"updatePoint":{"line":48,"column":66},"line":48,"code":"      it('should return true when the pathFilter is present in url', () => {\n        result = matchPathFilter(['/api', '/ajax'], 'http://localhost/ajax/foo/bar', fakeReq);\n        expect(result).toBe(true);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should return false when the pathFilter does not match url","suites":["Path Filter","String path matching","Multi path matching"],"updatePoint":{"line":53,"column":68},"line":53,"code":"      it('should return false when the pathFilter does not match url', () => {\n        result = matchPathFilter(['/api', '/ajax'], 'http://localhost/foo/bar', fakeReq);\n        expect(result).toBe(false);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should return false when empty array provided","suites":["Path Filter","String path matching","Multi path matching"],"updatePoint":{"line":58,"column":55},"line":58,"code":"      it('should return false when empty array provided', () => {\n        result = matchPathFilter([], 'http://localhost/api/foo/bar', fakeReq);\n        expect(result).toBe(false);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should match any path","suites":["Path Filter","Wildcard path matching","Single glob","url-path matching"],"updatePoint":{"line":74,"column":33},"line":74,"code":"        it('should match any path', () => {\n          expect(matchPathFilter('**', url, fakeReq)).toBe(true);\n          expect(matchPathFilter('/**', url, fakeReq)).toBe(true);\n        });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should only match paths starting with \"/api\" ","suites":["Path Filter","Wildcard path matching","Single glob","url-path matching"],"updatePoint":{"line":79,"column":57},"line":79,"code":"        it('should only match paths starting with \"/api\" ', () => {\n          expect(matchPathFilter('/api/**', url, fakeReq)).toBe(true);\n          expect(matchPathFilter('/ajax/**', url, fakeReq)).toBe(false);\n        });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should only match paths starting with \"foo\" folder in it ","suites":["Path Filter","Wildcard path matching","Single glob","url-path matching"],"updatePoint":{"line":84,"column":69},"line":84,"code":"        it('should only match paths starting with \"foo\" folder in it ', () => {\n          expect(matchPathFilter('**/foo/**', url, fakeReq)).toBe(true);\n          expect(matchPathFilter('**/invalid/**', url, fakeReq)).toBe(false);\n        });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should match any path, file and extension","suites":["Path Filter","Wildcard path matching","Single glob","file matching"],"updatePoint":{"line":91,"column":53},"line":91,"code":"        it('should match any path, file and extension', () => {\n          expect(matchPathFilter('**', url, fakeReq)).toBe(true);\n          expect(matchPathFilter('**/*', url, fakeReq)).toBe(true);\n          expect(matchPathFilter('**/*.*', url, fakeReq)).toBe(true);\n          expect(matchPathFilter('/**', url, fakeReq)).toBe(true);\n          expect(matchPathFilter('/**/*', url, fakeReq)).toBe(true);\n          expect(matchPathFilter('/**/*.*', url, fakeReq)).toBe(true);\n        });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should only match .html files","suites":["Path Filter","Wildcard path matching","Single glob","file matching"],"updatePoint":{"line":100,"column":41},"line":100,"code":"        it('should only match .html files', () => {\n          expect(matchPathFilter('**/*.html', url, fakeReq)).toBe(true);\n          expect(matchPathFilter('/**/*.html', url, fakeReq)).toBe(true);\n          expect(matchPathFilter('/*.htm', url, fakeReq)).toBe(false);\n          expect(matchPathFilter('/*.jpg', url, fakeReq)).toBe(false);\n        });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should only match .html under root path","suites":["Path Filter","Wildcard path matching","Single glob","file matching"],"updatePoint":{"line":107,"column":51},"line":107,"code":"        it('should only match .html under root path', () => {\n          const pattern = '/*.html';\n          expect(matchPathFilter(pattern, 'http://localhost/index.html', fakeReq)).toBe(true);\n          expect(matchPathFilter(pattern, 'http://localhost/some/path/index.html', fakeReq)).toBe(\n            false\n          );\n        });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should ignore query params","suites":["Path Filter","Wildcard path matching","Single glob","file matching"],"updatePoint":{"line":115,"column":38},"line":115,"code":"        it('should ignore query params', () => {\n          expect(matchPathFilter('/**/*.php', 'http://localhost/a/b/c.php?d=e&e=f', fakeReq)).toBe(\n            true\n          );\n          expect(\n            matchPathFilter('/**/*.php?*', 'http://localhost/a/b/c.php?d=e&e=f', fakeReq)\n          ).toBe(false);\n        });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should only match any file in root path","suites":["Path Filter","Wildcard path matching","Single glob","file matching"],"updatePoint":{"line":124,"column":51},"line":124,"code":"        it('should only match any file in root path', () => {\n          expect(matchPathFilter('/*', 'http://localhost/bar.html', fakeReq)).toBe(true);\n          expect(matchPathFilter('/*.*', 'http://localhost/bar.html', fakeReq)).toBe(true);\n          expect(matchPathFilter('/*', 'http://localhost/foo/bar.html', fakeReq)).toBe(false);\n        });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should only match .html file is in root path","suites":["Path Filter","Wildcard path matching","Single glob","file matching"],"updatePoint":{"line":130,"column":56},"line":130,"code":"        it('should only match .html file is in root path', () => {\n          expect(matchPathFilter('/*.html', 'http://localhost/bar.html', fakeReq)).toBe(true);\n          expect(matchPathFilter('/*.html', 'http://localhost/api/foo/bar.html', fakeReq)).toBe(\n            false\n          );\n        });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should only match .html files in \"foo\" folder","suites":["Path Filter","Wildcard path matching","Single glob","file matching"],"updatePoint":{"line":137,"column":57},"line":137,"code":"        it('should only match .html files in \"foo\" folder', () => {\n          expect(matchPathFilter('**/foo/*.html', url, fakeReq)).toBe(true);\n          expect(matchPathFilter('**/bar/*.html', url, fakeReq)).toBe(false);\n        });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should not match .html files","suites":["Path Filter","Wildcard path matching","Single glob","file matching"],"updatePoint":{"line":142,"column":40},"line":142,"code":"        it('should not match .html files', () => {\n          expect(matchPathFilter('!**/*.html', url, fakeReq)).toBe(false);\n        });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should return true when both path patterns match","suites":["Path Filter","Wildcard path matching","Multi glob matching","Multiple patterns"],"updatePoint":{"line":150,"column":60},"line":150,"code":"        it('should return true when both path patterns match', () => {\n          const pattern = ['/api/**', '/ajax/**'];\n          expect(matchPathFilter(pattern, 'http://localhost/api/foo/bar.json', fakeReq)).toBe(true);\n          expect(matchPathFilter(pattern, 'http://localhost/ajax/foo/bar.json', fakeReq)).toBe(\n            true\n          );\n          expect(matchPathFilter(pattern, 'http://localhost/rest/foo/bar.json', fakeReq)).toBe(\n            false\n          );\n        });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should return true when both file extensions pattern match","suites":["Path Filter","Wildcard path matching","Multi glob matching","Multiple patterns"],"updatePoint":{"line":160,"column":70},"line":160,"code":"        it('should return true when both file extensions pattern match', () => {\n          const pattern = ['/**/*.html', '/**/*.jpeg'];\n          expect(matchPathFilter(pattern, 'http://localhost/api/foo/bar.html', fakeReq)).toBe(true);\n          expect(matchPathFilter(pattern, 'http://localhost/api/foo/bar.jpeg', fakeReq)).toBe(true);\n          expect(matchPathFilter(pattern, 'http://localhost/api/foo/bar.gif', fakeReq)).toBe(false);\n        });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should not match file extension","suites":["Path Filter","Wildcard path matching","Multi glob matching","Negation patterns"],"updatePoint":{"line":169,"column":43},"line":169,"code":"        it('should not match file extension', () => {\n          const url = 'http://localhost/api/foo/bar.html';\n          expect(matchPathFilter(['**', '!**/*.html'], url, fakeReq)).toBe(false);\n          expect(matchPathFilter(['**', '!**/*.json'], url, fakeReq)).toBe(true);\n        });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should match when function returns true","suites":["Path Filter","Use function for matching","truthy"],"updatePoint":{"line":188,"column":49},"line":188,"code":"      it('should match when function returns true', () => {\n        expect(testFunctionAsPathFilter(true)).toBeTruthy();\n        expect(testFunctionAsPathFilter('true')).toBeTruthy();\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should not match when function returns falsy value","suites":["Path Filter","Use function for matching","falsy"],"updatePoint":{"line":195,"column":60},"line":195,"code":"      it('should not match when function returns falsy value', () => {\n        expect(testFunctionAsPathFilter(undefined)).toBeFalsy();\n        expect(testFunctionAsPathFilter(false)).toBeFalsy();\n        expect(testFunctionAsPathFilter('')).toBeFalsy();\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should throw error with null","suites":["Path Filter","Test invalid pathFilters","Throw error"],"updatePoint":{"line":215,"column":38},"line":215,"code":"      it('should throw error with null', () => {\n        expect(testPathFilter(null)).toThrowError(Error);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should throw error with object literal","suites":["Path Filter","Test invalid pathFilters","Throw error"],"updatePoint":{"line":219,"column":48},"line":219,"code":"      it('should throw error with object literal', () => {\n        expect(testPathFilter(fakeReq)).toThrowError(Error);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should throw error with integers","suites":["Path Filter","Test invalid pathFilters","Throw error"],"updatePoint":{"line":223,"column":42},"line":223,"code":"      it('should throw error with integers', () => {\n        expect(testPathFilter(123)).toThrowError(Error);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should throw error with mixed string and glob pattern","suites":["Path Filter","Test invalid pathFilters","Throw error"],"updatePoint":{"line":227,"column":63},"line":227,"code":"      it('should throw error with mixed string and glob pattern', () => {\n        expect(testPathFilter(['/api', '!*.html'])).toThrowError(Error);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should not throw error with string","suites":["Path Filter","Test invalid pathFilters","Do not throw error"],"updatePoint":{"line":233,"column":44},"line":233,"code":"      it('should not throw error with string', () => {\n        expect(testPathFilter('/123')).not.toThrowError(Error);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should not throw error with Array","suites":["Path Filter","Test invalid pathFilters","Do not throw error"],"updatePoint":{"line":237,"column":43},"line":237,"code":"      it('should not throw error with Array', () => {\n        expect(testPathFilter(['/123'])).not.toThrowError(Error);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should not throw error with glob","suites":["Path Filter","Test invalid pathFilters","Do not throw error"],"updatePoint":{"line":240,"column":42},"line":240,"code":"      it('should not throw error with glob', () => {\n        expect(testPathFilter('/**')).not.toThrowError(Error);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should not throw error with Array of globs","suites":["Path Filter","Test invalid pathFilters","Do not throw error"],"updatePoint":{"line":244,"column":52},"line":244,"code":"      it('should not throw error with Array of globs', () => {\n        expect(testPathFilter(['/**', '!*.html'])).not.toThrowError(Error);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should not throw error with Function","suites":["Path Filter","Test invalid pathFilters","Do not throw error"],"updatePoint":{"line":248,"column":46},"line":248,"code":"      it('should not throw error with Function', () => {\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\n        expect(testPathFilter(() => {})).not.toThrowError(Error);\n      });","file":"unit/path-filter.spec.ts","skipped":false,"dir":"test"},{"name":"should rewrite path","suites":["Path rewriting","Rewrite rules configuration and usage"],"updatePoint":{"line":24,"column":27},"line":24,"code":"    it('should rewrite path', () => {\n      result = rewriter('/api/old/index.json');\n      expect(result).toBe('/api/new/index.json');\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should remove path","suites":["Path rewriting","Rewrite rules configuration and usage"],"updatePoint":{"line":29,"column":26},"line":29,"code":"    it('should remove path', () => {\n      result = rewriter('/remove/old/index.json');\n      expect(result).toBe('/old/index.json');\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should leave path intact","suites":["Path rewriting","Rewrite rules configuration and usage"],"updatePoint":{"line":34,"column":32},"line":34,"code":"    it('should leave path intact', () => {\n      result = rewriter('/foo/bar/index.json');\n      expect(result).toBe('/foo/bar/index.json');\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should not rewrite path when config-key does not match url with test(regex)","suites":["Path rewriting","Rewrite rules configuration and usage"],"updatePoint":{"line":39,"column":83},"line":39,"code":"    it('should not rewrite path when config-key does not match url with test(regex)', () => {\n      result = rewriter('/invalid/bar/foo.json');\n      expect(result).toBe('/path/new/bar/foo.json');\n      expect(result).not.toBe('/invalid/new/bar/foo.json');\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should rewrite path when config-key does match url with test(regex)","suites":["Path rewriting","Rewrite rules configuration and usage"],"updatePoint":{"line":45,"column":75},"line":45,"code":"    it('should rewrite path when config-key does match url with test(regex)', () => {\n      result = rewriter('/valid/foo/bar.json');\n      expect(result).toBe('/path/new/foo/bar.json');\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should return first match when similar paths are configured","suites":["Path rewriting","Rewrite rules configuration and usage"],"updatePoint":{"line":50,"column":67},"line":50,"code":"    it('should return first match when similar paths are configured', () => {\n      result = rewriter('/some/specific/path/bar.json');\n      expect(result).toBe('/awe/some/specific/path/bar.json');\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should add base path to requests","suites":["Path rewriting","Rewrite rule: add base path to requests"],"updatePoint":{"line":67,"column":40},"line":67,"code":"    it('should add base path to requests', () => {\n      result = rewriter('/api/books/123');\n      expect(result).toBe('/extra/base/path/api/books/123');\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should return unmodified path","suites":["Path rewriting","Rewrite function"],"updatePoint":{"line":82,"column":37},"line":82,"code":"    it('should return unmodified path', () => {\n      const rewriteFn = (path) => {\n        return path;\n      };\n\n      expect(rewriter(rewriteFn)).toBe('/123/456');\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should return alternative path","suites":["Path rewriting","Rewrite function"],"updatePoint":{"line":90,"column":38},"line":90,"code":"    it('should return alternative path', () => {\n      const rewriteFn = (path) => {\n        return '/foo/bar';\n      };\n\n      expect(rewriter(rewriteFn)).toBe('/foo/bar');\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should return replaced path","suites":["Path rewriting","Rewrite function"],"updatePoint":{"line":98,"column":35},"line":98,"code":"    it('should return replaced path', () => {\n      const rewriteFn = (path) => {\n        return path.replace('/456', '/789');\n      };\n\n      expect(rewriter(rewriteFn)).toBe('/123/789');\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"is async and should return unmodified path","suites":["Path rewriting","Rewrite function"],"updatePoint":{"line":108,"column":50},"line":108,"code":"    it('is async and should return unmodified path', () => {\n      const rewriteFn = async (path) => {\n        const promise = new Promise((resolve, reject) => {\n          resolve(path);\n        });\n        const changed = await promise;\n        return changed;\n      };\n\n      return expect(rewriter(rewriteFn)).resolves.toBe('/123/456');\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"is async and should return alternative path","suites":["Path rewriting","Rewrite function"],"updatePoint":{"line":120,"column":51},"line":120,"code":"    it('is async and should return alternative path', () => {\n      const rewriteFn = async (path) => {\n        const promise = new Promise((resolve, reject) => {\n          resolve('/foo/bar');\n        });\n        const changed = await promise;\n        return changed;\n      };\n\n      return expect(rewriter(rewriteFn)).resolves.toBe('/foo/bar');\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"is async and should return replaced path","suites":["Path rewriting","Rewrite function"],"updatePoint":{"line":132,"column":48},"line":132,"code":"    it('is async and should return replaced path', () => {\n      const rewriteFn = async (path) => {\n        const promise = new Promise((resolve, reject) => {\n          resolve(path.replace('/456', '/789'));\n        });\n        const changed = await promise;\n        return changed;\n      };\n\n      return expect(rewriter(rewriteFn)).resolves.toBe('/123/789');\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should return undefined when no config is provided","suites":["Path rewriting","Invalid configuration"],"updatePoint":{"line":156,"column":58},"line":156,"code":"    it('should return undefined when no config is provided', () => {\n      expect(badFn()()).toBeUndefined();\n      expect(badFn(null)()).toBeUndefined();\n      expect(badFn(undefined)()).toBeUndefined();\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should throw when bad config is provided","suites":["Path rewriting","Invalid configuration"],"updatePoint":{"line":162,"column":48},"line":162,"code":"    it('should throw when bad config is provided', () => {\n      expect(badFn(123)).toThrowError(Error);\n      expect(badFn('abc')).toThrowError(Error);\n      expect(badFn([])).toThrowError(Error);\n      expect(badFn([1, 2, 3])).toThrowError(Error);\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should not throw when empty Object config is provided","suites":["Path rewriting","Invalid configuration"],"updatePoint":{"line":169,"column":61},"line":169,"code":"    it('should not throw when empty Object config is provided', () => {\n      expect(badFn({})).not.toThrowError(Error);\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should not throw when function config is provided","suites":["Path rewriting","Invalid configuration"],"updatePoint":{"line":173,"column":57},"line":173,"code":"    it('should not throw when function config is provided', () => {\n      // eslint-disable-next-line @typescript-eslint/no-empty-function\n      expect(badFn(() => {})).not.toThrowError(Error);\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should not throw when async function config is provided","suites":["Path rewriting","Invalid configuration"],"updatePoint":{"line":178,"column":63},"line":178,"code":"    it('should not throw when async function config is provided', () => {\n      // eslint-disable-next-line @typescript-eslint/no-empty-function\n      expect(badFn(async () => {})).not.toThrowError(Error);\n    });","file":"unit/path-rewriter.spec.ts","skipped":false,"dir":"test"},{"name":"should write body on end proxy event","suites":["responseInterceptor"],"updatePoint":{"line":26,"column":42},"line":26,"code":"  it('should write body on end proxy event', async () => {\n    const httpIncomingMessage = fakeProxyResponse();\n    const response = fakeResponse();\n\n    responseInterceptor(async () => JSON.stringify({ someField: '' }))(\n      httpIncomingMessage,\n      null,\n      response\n    );\n\n    httpIncomingMessage.emit('end');\n    await waitInterceptorHandler();\n\n    const expectedBody = JSON.stringify({ someField: '' });\n    expect(response.setHeader).toHaveBeenCalledWith('content-length', expectedBody.length);\n    expect(response.write).toHaveBeenCalledWith(Buffer.from(expectedBody));\n    expect(response.end).toHaveBeenCalledWith();\n  });","file":"unit/response-interceptor.spec.ts","skipped":false,"dir":"test"},{"name":"should end with error when receive a proxy error event","suites":["responseInterceptor"],"updatePoint":{"line":45,"column":60},"line":45,"code":"  it('should end with error when receive a proxy error event', async () => {\n    const httpIncomingMessage = fakeProxyResponse();\n    const response = fakeResponse();\n\n    responseInterceptor(async () => JSON.stringify({ someField: '' }))(\n      httpIncomingMessage,\n      null,\n      response\n    );\n\n    httpIncomingMessage.emit('error', new Error('some error message'));\n\n    expect(response.setHeader).not.toHaveBeenCalled();\n    expect(response.write).not.toHaveBeenCalled();\n    expect(response.end).toHaveBeenCalledWith('Error fetching proxied request: some error message');\n  });","file":"unit/response-interceptor.spec.ts","skipped":false,"dir":"test"},{"name":"should provide the request object for dynamic routing","suites":["router unit test","router.getTarget from function","custom dynamic router function"],"updatePoint":{"line":38,"column":63},"line":38,"code":"      it('should provide the request object for dynamic routing', () => {\n        expect(request.headers.host).toBe('localhost');\n        expect(request.url).toBe('/');\n      });","file":"unit/router.spec.ts","skipped":false,"dir":"test"},{"name":"should return new target","suites":["router unit test","router.getTarget from function","custom dynamic router function"],"updatePoint":{"line":42,"column":34},"line":42,"code":"      it('should return new target', () => {\n        return expect(result).resolves.toBe('http://foobar.com:666');\n      });","file":"unit/router.spec.ts","skipped":false,"dir":"test"},{"name":"should provide the request object for dynamic routing","suites":["router unit test","router.getTarget from async function","custom dynamic router async function"],"updatePoint":{"line":64,"column":63},"line":64,"code":"      it('should provide the request object for dynamic routing', () => {\n        expect(request.headers.host).toBe('localhost');\n        expect(request.url).toBe('/');\n      });","file":"unit/router.spec.ts","skipped":false,"dir":"test"},{"name":"should return new target","suites":["router unit test","router.getTarget from async function","custom dynamic router async function"],"updatePoint":{"line":68,"column":34},"line":68,"code":"      it('should return new target', () => {\n        return expect(result).resolves.toBe('http://foobar.com:666');\n      });","file":"unit/router.spec.ts","skipped":false,"dir":"test"},{"name":"should return the normal target when router not present in config","suites":["router unit test","router.getTarget from table","without router config"],"updatePoint":{"line":91,"column":75},"line":91,"code":"      it('should return the normal target when router not present in config', () => {\n        result = getTarget(fakeReq, config);\n        return expect(result).resolves.toBeUndefined();\n      });","file":"unit/router.spec.ts","skipped":false,"dir":"test"},{"name":"should target http://localhost:6001 when for router:\"alpha.localhost\"","suites":["router unit test","router.getTarget from table","with just the host in router config"],"updatePoint":{"line":98,"column":79},"line":98,"code":"      it('should target http://localhost:6001 when for router:\"alpha.localhost\"', () => {\n        fakeReq.headers.host = 'alpha.localhost';\n        result = getTarget(fakeReq, proxyOptionWithRouter);\n        return expect(result).resolves.toBe('http://localhost:6001');\n      });","file":"unit/router.spec.ts","skipped":false,"dir":"test"},{"name":"should target http://localhost:6002 when for router:\"beta.localhost\"","suites":["router unit test","router.getTarget from table","with just the host in router config"],"updatePoint":{"line":104,"column":78},"line":104,"code":"      it('should target http://localhost:6002 when for router:\"beta.localhost\"', () => {\n        fakeReq.headers.host = 'beta.localhost';\n        result = getTarget(fakeReq, proxyOptionWithRouter);\n        return expect(result).resolves.toBe('http://localhost:6002');\n      });","file":"unit/router.spec.ts","skipped":false,"dir":"test"},{"name":"should target http://localhost:6004 without path","suites":["router unit test","router.getTarget from table","with host and host + path config"],"updatePoint":{"line":112,"column":58},"line":112,"code":"      it('should target http://localhost:6004 without path', () => {\n        fakeReq.headers.host = 'gamma.localhost';\n        result = getTarget(fakeReq, proxyOptionWithRouter);\n        return expect(result).resolves.toBe('http://localhost:6004');\n      });","file":"unit/router.spec.ts","skipped":false,"dir":"test"},{"name":"should target http://localhost:6003 exact path match","suites":["router unit test","router.getTarget from table","with host and host + path config"],"updatePoint":{"line":118,"column":62},"line":118,"code":"      it('should target http://localhost:6003 exact path match', () => {\n        fakeReq.headers.host = 'gamma.localhost';\n        fakeReq.url = '/api';\n        result = getTarget(fakeReq, proxyOptionWithRouter);\n        return expect(result).resolves.toBe('http://localhost:6003');\n      });","file":"unit/router.spec.ts","skipped":false,"dir":"test"},{"name":"should target http://localhost:6004 when contains path","suites":["router unit test","router.getTarget from table","with host and host + path config"],"updatePoint":{"line":125,"column":64},"line":125,"code":"      it('should target http://localhost:6004 when contains path', () => {\n        fakeReq.headers.host = 'gamma.localhost';\n        fakeReq.url = '/api/books/123';\n        result = getTarget(fakeReq, proxyOptionWithRouter);\n        return expect(result).resolves.toBe('http://localhost:6003');\n      });","file":"unit/router.spec.ts","skipped":false,"dir":"test"},{"name":"should target http://localhost:6005 with just a path as router config","suites":["router unit test","router.getTarget from table","with just the path"],"updatePoint":{"line":134,"column":79},"line":134,"code":"      it('should target http://localhost:6005 with just a path as router config', () => {\n        fakeReq.url = '/rest';\n        result = getTarget(fakeReq, proxyOptionWithRouter);\n        return expect(result).resolves.toBe('http://localhost:6005');\n      });","file":"unit/router.spec.ts","skipped":false,"dir":"test"},{"name":"should target http://localhost:6005 with just a path as router config","suites":["router unit test","router.getTarget from table","with just the path"],"updatePoint":{"line":140,"column":79},"line":140,"code":"      it('should target http://localhost:6005 with just a path as router config', () => {\n        fakeReq.url = '/rest/deep/path';\n        result = getTarget(fakeReq, proxyOptionWithRouter);\n        return expect(result).resolves.toBe('http://localhost:6005');\n      });","file":"unit/router.spec.ts","skipped":false,"dir":"test"},{"name":"should target http://localhost:6000 path in not present in router config","suites":["router unit test","router.getTarget from table","with just the path"],"updatePoint":{"line":146,"column":82},"line":146,"code":"      it('should target http://localhost:6000 path in not present in router config', () => {\n        fakeReq.url = '/unknown-path';\n        result = getTarget(fakeReq, proxyOptionWithRouter);\n        return expect(result).resolves.toBeUndefined();\n      });","file":"unit/router.spec.ts","skipped":false,"dir":"test"},{"name":"should return first matching target when similar paths are configured","suites":["router unit test","router.getTarget from table","matching order of router config"],"updatePoint":{"line":154,"column":79},"line":154,"code":"      it('should return first matching target when similar paths are configured', () => {\n        fakeReq.url = '/some/specific/path';\n        result = getTarget(fakeReq, proxyOptionWithRouter);\n        return expect(result).resolves.toBe('http://localhost:6006');\n      });","file":"unit/router.spec.ts","skipped":false,"dir":"test"},{"name":"should return http status code from error code","suites":["getStatusCode"],"updatePoint":{"line":14,"column":52},"line":14,"code":"  it('should return http status code from error code', () => {\n    Object.entries(errorCodes).forEach(([errorCode, statusCode]) => {\n      expect(getStatusCode(errorCode)).toBe(statusCode);\n    });\n  });","file":"unit/status-code.spec.ts","skipped":false,"dir":"test"},{"name":"should return Function name","suites":["getFunctionName()"],"updatePoint":{"line":5,"column":33},"line":5,"code":"  it('should return Function name', () => {\n    function myFunction() {}\n    expect(getFunctionName(myFunction)).toBe('myFunction');\n  });","file":"unit/utils/function.spec.ts","skipped":false,"dir":"test"},{"name":"should return arrow Function name","suites":["getFunctionName()"],"updatePoint":{"line":10,"column":39},"line":10,"code":"  it('should return arrow Function name', () => {\n    const myFunction = () => {};\n    expect(getFunctionName(myFunction)).toBe('myFunction');\n  });","file":"unit/utils/function.spec.ts","skipped":false,"dir":"test"},{"name":"should return anonymous Function name","suites":["getFunctionName()"],"updatePoint":{"line":15,"column":43},"line":15,"code":"  it('should return anonymous Function name', () => {\n    expect(getFunctionName(() => {})).toBe('[anonymous Function]');\n  });","file":"unit/utils/function.spec.ts","skipped":false,"dir":"test"}]}
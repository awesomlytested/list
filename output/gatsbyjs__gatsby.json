{"repo":"gatsbyjs/gatsby","url":"https://github.com/gatsbyjs/gatsby","branch":"master","configs":[{"package":"gatsby-example-using-reach-skip-nav","lang":"js","dir":"examples/using-reach-skip-nav/cypress","framework":"jest","pattern":"**/*[._-]{test,spec,unittest,unit}.{ts,js}"},{"package":"artifacts","lang":"js","dir":"integration-tests/artifacts/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"cache-resilience-tests","lang":"js","dir":"integration-tests/cache-resilience/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"functions","lang":"js","dir":"integration-tests/functions/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-cli-tests","lang":"js","dir":"integration-tests/gatsby-cli/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-starter-default","lang":"js","dir":"integration-tests/gatsby-pipeline/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-source-wordpress-integration-tests","lang":"js","dir":"integration-tests/gatsby-source-wordpress/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-image-test","lang":"ts","dir":"integration-tests/images/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-starter-hello-world","lang":"js","dir":"integration-tests/long-term-caching/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-node-manifest-test-site","lang":"js","dir":"integration-tests/node-manifest/__tests__","framework":"jest","pattern":"**/*[._-]{test,spec,unittest,unit}.{ts,js}"},{"package":"ssr","lang":"js","dir":"integration-tests/ssr/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"structured-logging-tests","lang":"js","dir":"integration-tests/structured-logging/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"lang":"js","dir":"e2e-tests","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"babel-plugin-remove-graphql-queries","lang":"js","dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"babel-preset-gatsby","lang":"ts","dir":"packages/babel-preset-gatsby/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"create-gatsby","lang":"ts","dir":"packages/create-gatsby/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-cli","lang":"ts","dir":"packages/gatsby-cli/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-core-utils","lang":"ts","dir":"packages/gatsby-core-utils/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-dev-cli","lang":"js","dir":"packages/gatsby-dev-cli/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-legacy-polyfills","lang":"js","dir":"packages/gatsby-legacy-polyfills/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-link","lang":"js","dir":"packages/gatsby-link/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-page-utils","lang":"ts","dir":"packages/gatsby-page-utils/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-canonical-urls","lang":"js","dir":"packages/gatsby-plugin-canonical-urls/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-catch-links","lang":"js","dir":"packages/gatsby-plugin-catch-links/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-coffeescript","lang":"js","dir":"packages/gatsby-plugin-coffeescript/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-create-client-paths","lang":"js","dir":"packages/gatsby-plugin-create-client-paths/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-cxs","lang":"js","dir":"packages/gatsby-plugin-cxs/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-emotion","lang":"js","dir":"packages/gatsby-plugin-emotion/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-facebook-analytics","lang":"js","dir":"packages/gatsby-plugin-facebook-analytics/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-feed","lang":"js","dir":"packages/gatsby-plugin-feed/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-flow","lang":"js","dir":"packages/gatsby-plugin-flow/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-fullstory","lang":"js","dir":"packages/gatsby-plugin-fullstory/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-gatsby-cloud","lang":"js","dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-google-analytics","lang":"js","dir":"packages/gatsby-plugin-google-analytics/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-google-gtag","lang":"js","dir":"packages/gatsby-plugin-google-gtag/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-google-tagmanager","lang":"js","dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-image","lang":"ts","dir":"packages/gatsby-plugin-image/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-less","lang":"js","dir":"packages/gatsby-plugin-less/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-manifest","lang":"js","dir":"packages/gatsby-plugin-manifest/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-mdx","lang":"js","dir":"packages/gatsby-plugin-mdx/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-nprogress","lang":"js","dir":"packages/gatsby-plugin-nprogress/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-offline","lang":"js","dir":"packages/gatsby-plugin-offline/src/__tests__","framework":"jest","pattern":"**/*[._-]{test,spec,unittest,unit}.{ts,js}"},{"package":"gatsby-plugin-page-creator","lang":"ts","dir":"packages/gatsby-plugin-page-creator/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-postcss","lang":"js","dir":"packages/gatsby-plugin-postcss/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-preact","lang":"js","dir":"packages/gatsby-plugin-preact/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-preload-fonts","lang":"js","dir":"packages/gatsby-plugin-preload-fonts/src/__tests__","framework":"jest","pattern":"**/*[._-]{test,spec,unittest,unit}.{ts,js}"},{"package":"gatsby-plugin-react-css-modules","lang":"js","dir":"packages/gatsby-plugin-react-css-modules/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-react-helmet","lang":"js","dir":"packages/gatsby-plugin-react-helmet/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-remove-trailing-slashes","lang":"js","dir":"packages/gatsby-plugin-remove-trailing-slashes/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-sass","lang":"js","dir":"packages/gatsby-plugin-sass/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-sharp","lang":"ts","dir":"packages/gatsby-plugin-sharp/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-sitemap","lang":"js","dir":"packages/gatsby-plugin-sitemap/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-stylus","lang":"js","dir":"packages/gatsby-plugin-stylus/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-twitter","lang":"js","dir":"packages/gatsby-plugin-twitter/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-typescript","lang":"js","dir":"packages/gatsby-plugin-typescript/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-typography","lang":"js","dir":"packages/gatsby-plugin-typography/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-plugin-utils","lang":"ts","dir":"packages/gatsby-plugin-utils/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-react-router-scroll","lang":"ts","dir":"packages/gatsby-react-router-scroll/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-remark-autolink-headers","lang":"js","dir":"packages/gatsby-remark-autolink-headers/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-remark-code-repls","lang":"js","dir":"packages/gatsby-remark-code-repls/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-remark-copy-linked-files","lang":"js","dir":"packages/gatsby-remark-copy-linked-files/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-remark-custom-blocks","lang":"js","dir":"packages/gatsby-remark-custom-blocks/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-remark-embed-snippet","lang":"js","dir":"packages/gatsby-remark-embed-snippet/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-remark-graphviz","lang":"js","dir":"packages/gatsby-remark-graphviz/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-remark-images-contentful","lang":"js","dir":"packages/gatsby-remark-images-contentful/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-remark-images","lang":"js","dir":"packages/gatsby-remark-images/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-remark-katex","lang":"js","dir":"packages/gatsby-remark-katex/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-remark-prismjs","lang":"js","dir":"packages/gatsby-remark-prismjs/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-remark-responsive-iframe","lang":"js","dir":"packages/gatsby-remark-responsive-iframe/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-remark-smartypants","lang":"js","dir":"packages/gatsby-remark-smartypants/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-source-contentful","lang":"js","dir":"packages/gatsby-source-contentful/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-source-drupal","lang":"js","dir":"packages/gatsby-source-drupal/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-source-faker","lang":"js","dir":"packages/gatsby-source-faker/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-source-filesystem","lang":"js","dir":"packages/gatsby-source-filesystem/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-source-graphql","lang":"js","dir":"packages/gatsby-source-graphql/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-source-lever","lang":"js","dir":"packages/gatsby-source-lever/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-source-medium","lang":"js","dir":"packages/gatsby-source-medium/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-source-mongodb","lang":"js","dir":"packages/gatsby-source-mongodb/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-source-npm-package-search","lang":"js","dir":"packages/gatsby-source-npm-package-search/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-source-shopify","lang":"ts","dir":"packages/gatsby-source-shopify/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-source-wordpress","lang":"js","dir":"packages/gatsby-source-wordpress/__tests__","framework":"jest","pattern":"**/*[._-]{test,spec,unittest,unit}.{ts,js}"},{"package":"gatsby-telemetry","lang":"ts","dir":"packages/gatsby-telemetry/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-asciidoc","lang":"js","dir":"packages/gatsby-transformer-asciidoc/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-csv","lang":"js","dir":"packages/gatsby-transformer-csv/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-documentationjs","lang":"js","dir":"packages/gatsby-transformer-documentationjs/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-excel","lang":"js","dir":"packages/gatsby-transformer-excel/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-hjson","lang":"js","dir":"packages/gatsby-transformer-hjson/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-javascript-frontmatter","lang":"js","dir":"packages/gatsby-transformer-javascript-frontmatter/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-json","lang":"js","dir":"packages/gatsby-transformer-json/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-pdf","lang":"js","dir":"packages/gatsby-transformer-pdf/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-react-docgen","lang":"js","dir":"packages/gatsby-transformer-react-docgen/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-remark","lang":"js","dir":"packages/gatsby-transformer-remark/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-sharp","lang":"js","dir":"packages/gatsby-transformer-sharp/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-sqip","lang":"js","dir":"packages/gatsby-transformer-sqip/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-toml","lang":"js","dir":"packages/gatsby-transformer-toml/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-xml","lang":"js","dir":"packages/gatsby-transformer-xml/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-transformer-yaml","lang":"js","dir":"packages/gatsby-transformer-yaml/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"gatsby-worker","lang":"ts","dir":"packages/gatsby-worker/src/__tests__","framework":"jest","pattern":"**/*.{js,ts}"},{"package":"webpack-theme-component-shadowing","lang":"js","dir":"packages/gatsby/src/internal-plugins/webpack-theme-component-shadowing/__tests__","framework":"jest","pattern":"**/*.{js,ts}"}],"tests":[{"name":"Has a skip link","suites":["Skip Navigation Test"],"updatePoint":{"line":2,"column":21,"index":69},"line":2,"code":"  it(\"Has a skip link\", function () {\n    cy.visit(\"/\");\n    cy.get(\"[data-reach-skip-link]\").should(\"exist\");\n  });","file":"integration/skip-nav.test.js","skipped":false,"dir":"examples/using-reach-skip-nav/cypress"},{"name":"focuses skip link on navigation","suites":["Skip Navigation Test"],"updatePoint":{"line":6,"column":37,"index":202},"line":6,"code":"  it(\"focuses skip link on navigation\", function () {\n    cy.get(\"[data-cy-page-link]\").click();\n    cy.focused().should(\"have.attr\", \"data-reach-skip-link\");\n  });","file":"integration/skip-nav.test.js","skipped":false,"dir":"examples/using-reach-skip-nav/cypress"},{"name":" file for \"%s\" ","suites":[],"line":100,"code":"  test.each(pagePaths)(`${type} file for \"%s\" ${shouldExist ? `exists` : `DOESN'T exist`}`, async pagePath => {\n    const filePath = pagePathToFilePath[type](pagePath);\n    const exists = await new Promise(resolve => {\n      fs.stat(filePath, err => {\n        resolve(err === null);\n      });\n    });\n    expect(exists).toBe(shouldExist);\n  });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"browser bundle  change","suites":["webpack bundle invalidation"],"updatePoint":{"line":116,"column":59,"index":3081},"line":116,"code":"    it(`browser bundle ${browser ? `DID` : `DIDN'T`} change`, () => {\n      if (browser) {\n        expect(manifest[runNumber].changedBrowserCompilationHash).not.toEqual(`not-changed`);\n      } else {\n        expect(manifest[runNumber].changedBrowserCompilationHash).toEqual(`not-changed`);\n      }\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"ssr bundle  change","suites":["webpack bundle invalidation"],"updatePoint":{"line":123,"column":51,"index":3379},"line":123,"code":"    it(`ssr bundle ${ssr ? `DID` : `DIDN'T`} change`, () => {\n      if (ssr) {\n        expect(manifest[runNumber].changedSsrCompilationHash).not.toEqual(`not-changed`);\n      } else {\n        expect(manifest[runNumber].changedSsrCompilationHash).toEqual(`not-changed`);\n      }\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"correct css is inlined in html file ()","suites":["/page-query-template-change/"],"updatePoint":{"line":142,"column":67,"index":4384},"line":142,"code":"    it(`correct css is inlined in html file (${expectedBackground})`, () => {\n      expect(htmlContent).toMatch(new RegExp(`<style>\\\\s*body\\\\s*{\\\\s*background:\\\\s*${expectedBackground};\\\\s*}\\\\s*<\\\\/style>`, `gm`));\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"html built is using correct template ()","suites":["/page-query-template-change/"],"updatePoint":{"line":145,"column":92,"index":4632},"line":145,"code":"    it(`html built is using correct template (${runNumber <= 1 ? `default` : `alternative`})`, () => {\n      expect(htmlContent).toContain(runNumber <= 1 ? `<h1>Default template for depPageQuery</h1>` : `<h1>Alternative template for depPageQuery</h1>`);\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"page data use correct componentChunkName ()","suites":["/page-query-template-change/"],"updatePoint":{"line":148,"column":80,"index":4882},"line":148,"code":"    it(`page data use correct componentChunkName (${expectedComponentChunkName})`, () => {\n      expect(pageDataContent.componentChunkName).toEqual(expectedComponentChunkName);\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"page query result is the same in every build","suites":["/page-query-template-change/"],"updatePoint":{"line":151,"column":52,"index":5039},"line":151,"code":"    it(`page query result is the same in every build`, () => {\n      // this test is only to assert that page query result doesn't change and something else\n      // cause this html file to rebuild\n      expect(pageDataContent.result).toEqual({\n        data: {\n          depPageQuery: {\n            label: `Stable (always created)`\n          }\n        },\n        pageContext: {\n          id: `page-query-template-change`\n        }\n      });\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"html is correctly generated using fresh page context","suites":["/changing-context/"],"updatePoint":{"line":173,"column":60,"index":5863},"line":173,"code":"    it(`html is correctly generated using fresh page context`, () => {\n      // remove <!-- --> from html content string as that's impl details of react ssr\n      expect(htmlContent.replace(/<!-- -->/g, ``)).toContain(`Dummy page for runNumber: ${runNumber}`);\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"page-data is correctly generated using fresh page context","suites":["/changing-context/"],"updatePoint":{"line":177,"column":65,"index":6137},"line":177,"code":"    it(`page-data is correctly generated using fresh page context`, () => {\n      expect(pageDataContent.result.pageContext).toEqual({\n        dummyId: `runNumber: ${runNumber}`\n      });\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"webpack plugin is used correctly (webpack cache gets invalidate on plugin change)","suites":["/webpack/local-plugin-1/"],"updatePoint":{"line":188,"column":89,"index":6586},"line":188,"code":"    it(`webpack plugin is used correctly (webpack cache gets invalidate on plugin change)`, () => {\n      expect(htmlContent).toContain(runNumber < 6 ? `localWebpackPlugin1_1` : `localWebpackPlugin1_2`);\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"webpack plugin is used correctly (webpack cache gets invalidate on plugin change)","suites":["/webpack/local-plugin-2/"],"updatePoint":{"line":197,"column":89,"index":7027},"line":197,"code":"    it(`webpack plugin is used correctly (webpack cache gets invalidate on plugin change)`, () => {\n      expect(htmlContent).toContain(runNumber < 7 ? `localWebpackPlugin2_1` : `localWebpackPlugin2_2`);\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"html is correctly generated using up to date code of file that changed extension","suites":["/extension-change/"],"updatePoint":{"line":206,"column":88,"index":7452},"line":206,"code":"    it(`html is correctly generated using up to date code of file that changed extension`, () => {\n      // remove <!-- --> from html content string as that's impl details of react ssr\n      expect(htmlContent.replace(/<!-- -->/g, ``)).toContain(`extension of imported file: ${runNumber === 10 ? `.ts` : `.js`}`);\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"html stitched correctly and slice is up to date","suites":["/slices/"],"updatePoint":{"line":216,"column":55,"index":7935},"line":216,"code":"    it(`html stitched correctly and slice is up to date`, () => {\n      expect(htmlContent).toContain(runNumber < 2 ? `Gatsby Slice Test (before edit)` : `Gatsby Slice Test (after edit)`);\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"has correct html when prop is passed to slice component","suites":["/slices/"],"updatePoint":{"line":219,"column":63,"index":8140},"line":219,"code":"    it(`has correct html when prop is passed to slice component`, () => {\n      expect(htmlContent).toContain(`a-large-header`);\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"html stitched correctly and slice is up to date","suites":["/slices/blog-1/"],"updatePoint":{"line":228,"column":55,"index":8480},"line":228,"code":"    it(`html stitched correctly and slice is up to date`, () => {\n      expect(htmlContent).toContain(runNumber < 2 ? `Gatsby Slice Test (before edit)` : `Gatsby Slice Test (after edit)`);\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"node change results in correct HTML for slice","suites":["/slices/blog-1/"],"updatePoint":{"line":231,"column":53,"index":8675},"line":231,"code":"    it(\"node change results in correct HTML for slice\", () => {\n      expect(htmlContent).toContain(runNumber < 2 ? `who lives and works in San Francisco building useful things(before edit)` : `who lives and works in San Francisco building useful things(after edit)`);\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"uses correct slice when a slice is changed in createPage mappping","suites":["/slices/blog-2/"],"updatePoint":{"line":240,"column":73,"index":9183},"line":240,"code":"    it(`uses correct slice when a slice is changed in createPage mappping`, () => {\n      expect(htmlContent).toContain(runNumber < 2 ? `Josh Johnson` : `Kyle Mathews`);\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"changing lazily imported component result in correct regeneration of html file","suites":["/react-lazy/"],"updatePoint":{"line":249,"column":86,"index":9576},"line":249,"code":"    it(`changing lazily imported component result in correct regeneration of html file`, () => {\n      expect(htmlContent).toContain(runNumber < 3 ? `before edit` : `after edit`);\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"nodes do not have repeating counters","suites":["node correctness"],"updatePoint":{"line":256,"column":44,"index":9813},"line":256,"code":"    it(`nodes do not have repeating counters`, () => {\n      const seenCounters = new Map();\n      const duplicates = [];\n      // Just a convenience step to display node ids with duplicate counters\n      manifest[runNumber].allNodeCounters.forEach(([id, counter]) => {\n        if (seenCounters.has(counter)) {\n          duplicates.push({\n            counter,\n            nodeIds: [id, seenCounters.get(counter)]\n          });\n        }\n        seenCounters.set(counter, id);\n      });\n      expect(manifest[runNumber].allNodeCounters.length).toBeGreaterThan(0);\n      expect(duplicates).toEqual([]);\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"Build was successful","suites":["node correctness"],"updatePoint":{"line":275,"column":26,"index":10449},"line":275,"code":"  it(`Build was successful`, () => {\n    expect(exitCode).toEqual(0);\n  });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"are written correctly when inline","suites":["First run (baseline)","Static Queries"],"updatePoint":{"line":306,"column":43,"index":11299},"line":306,"code":"    test(`are written correctly when inline`, async () => {\n      const queries = [titleQuery, ...globalQueries];\n      const pagePath = `/inline/`;\n      const {\n        staticQueryHashes\n      } = await readPageData(publicDir, pagePath);\n      expect(staticQueryHashes.sort()).toEqual(queries.map(hashQuery).sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"are written correctly when imported","suites":["First run (baseline)","Static Queries"],"updatePoint":{"line":314,"column":45,"index":11628},"line":314,"code":"    test(`are written correctly when imported`, async () => {\n      const queries = [titleQuery, ...globalQueries];\n      const pagePath = `/import/`;\n      const {\n        staticQueryHashes\n      } = await readPageData(publicDir, pagePath);\n      expect(staticQueryHashes.sort()).toEqual(queries.map(hashQuery).sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"are written correctly when a re-exported query is imported","suites":["First run (baseline)","Static Queries"],"updatePoint":{"line":322,"column":68,"index":11980},"line":322,"code":"    test(`are written correctly when a re-exported query is imported`, async () => {\n      const queries = [titleQuery, ...globalQueries];\n      const pagePath = `/import-re-export/`;\n      const {\n        staticQueryHashes\n      } = await readPageData(publicDir, pagePath);\n      expect(staticQueryHashes.sort()).toEqual(queries.map(hashQuery).sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"are written correctly when dynamically imported","suites":["First run (baseline)","Static Queries"],"updatePoint":{"line":330,"column":57,"index":12331},"line":330,"code":"    test(`are written correctly when dynamically imported`, async () => {\n      const queries = [titleQuery, ...globalQueries];\n      const pagePath = `/dynamic/`;\n      const {\n        staticQueryHashes\n      } = await readPageData(publicDir, pagePath);\n      expect(staticQueryHashes.sort()).toEqual(queries.map(hashQuery).sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"are written correctly in jsx","suites":["First run (baseline)","Static Queries"],"updatePoint":{"line":338,"column":38,"index":12654},"line":338,"code":"    test(`are written correctly in jsx`, async () => {\n      const queries = [titleQuery, ...globalQueries];\n      const pagePath = `/jsx/`;\n      const {\n        staticQueryHashes\n      } = await readPageData(publicDir, pagePath);\n      expect(staticQueryHashes.sort()).toEqual(queries.map(hashQuery).sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"are written correctly in tsx","suites":["First run (baseline)","Static Queries"],"updatePoint":{"line":346,"column":38,"index":12973},"line":346,"code":"    test(`are written correctly in tsx`, async () => {\n      const queries = [titleQuery, ...globalQueries];\n      const pagePath = `/tsx/`;\n      const {\n        staticQueryHashes\n      } = await readPageData(publicDir, pagePath);\n      expect(staticQueryHashes.sort()).toEqual(queries.map(hashQuery).sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"are written correctly in typescript","suites":["First run (baseline)","Static Queries"],"updatePoint":{"line":354,"column":45,"index":13299},"line":354,"code":"    test(`are written correctly in typescript`, async () => {\n      const queries = [titleQuery, ...globalQueries];\n      const pagePath = `/typescript/`;\n      const {\n        staticQueryHashes\n      } = await readPageData(publicDir, pagePath);\n      expect(staticQueryHashes.sort()).toEqual(queries.map(hashQuery).sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"are written correctly when nesting imports","suites":["First run (baseline)","Static Queries"],"updatePoint":{"line":362,"column":52,"index":13639},"line":362,"code":"    test(`are written correctly when nesting imports`, async () => {\n      const queries = [titleQuery, authorQuery, ...globalQueries];\n      const pagePath = `/import-import/`;\n      const {\n        staticQueryHashes\n      } = await readPageData(publicDir, pagePath);\n      expect(staticQueryHashes.sort()).toEqual(queries.map(hashQuery).sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"are written correctly when nesting dynamic imports","suites":["First run (baseline)","Static Queries"],"updatePoint":{"line":370,"column":60,"index":14003},"line":370,"code":"    test(`are written correctly when nesting dynamic imports`, async () => {\n      const queries = [titleQuery, ...globalQueries];\n      const pagePath = `/dynamic-dynamic/`;\n      const {\n        staticQueryHashes\n      } = await readPageData(publicDir, pagePath);\n      expect(staticQueryHashes.sort()).toEqual(queries.map(hashQuery).sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"are written correctly when nesting a dynamic import in a regular import","suites":["First run (baseline)","Static Queries"],"updatePoint":{"line":378,"column":81,"index":14377},"line":378,"code":"    test(`are written correctly when nesting a dynamic import in a regular import`, async () => {\n      const queries = [titleQuery, authorQuery, ...globalQueries];\n      const pagePath = `/import-dynamic/`;\n      const {\n        staticQueryHashes\n      } = await readPageData(publicDir, pagePath);\n      expect(staticQueryHashes.sort()).toEqual(queries.map(hashQuery).sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"are written correctly when nesting a regular import in a dynamic import","suites":["First run (baseline)","Static Queries"],"updatePoint":{"line":386,"column":81,"index":14763},"line":386,"code":"    test(`are written correctly when nesting a regular import in a dynamic import`, async () => {\n      const queries = [titleQuery, ...globalQueries];\n      const pagePath = `/dynamic-import/`;\n      const {\n        staticQueryHashes\n      } = await readPageData(publicDir, pagePath);\n      expect(staticQueryHashes.sort()).toEqual(queries.map(hashQuery).sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"are written correctly with circular dependency","suites":["First run (baseline)","Static Queries"],"updatePoint":{"line":394,"column":56,"index":15111},"line":394,"code":"    test(`are written correctly with circular dependency`, async () => {\n      const queries = [titleQuery, ...globalQueries];\n      const pagePath = `/circular-dep/`;\n      const {\n        staticQueryHashes\n      } = await readPageData(publicDir, pagePath);\n      expect(staticQueryHashes.sort()).toEqual(queries.map(hashQuery).sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"are written correctly when using gatsby-browser","suites":["First run (baseline)","Static Queries"],"updatePoint":{"line":402,"column":57,"index":15458},"line":402,"code":"    test(`are written correctly when using gatsby-browser`, async () => {\n      const queries = [...globalQueries];\n      const pagePath = `/gatsby-browser/`;\n      const {\n        staticQueryHashes\n      } = await readPageData(publicDir, pagePath);\n      expect(staticQueryHashes.sort()).toEqual(queries.map(hashQuery).sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"should create all html files","suites":["First run (baseline)","html files","shouldn't have unexpected html files"],"updatePoint":{"line":429,"column":36,"index":16472},"line":429,"code":"    it(`should create all html files`, () => {\n      expect(manifest[runNumber].generated.sort()).toEqual(manifest[runNumber].allPages.sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"has prefetch link (imported in \"app\")","suites":["First run (baseline)","html files","should add <link> for webpack's magic comments inside \"app\" bundle"],"updatePoint":{"line":437,"column":47,"index":16915},"line":437,"code":"      it(`has prefetch link (imported in \"app\")`, () => {\n        expect(htmlContent).toMatch(/<link\\s+as=\"script\"\\s+rel=\"prefetch\"\\s+href=\"\\/magic-comment-app-prefetch-\\w+.js\"\\s*\\/>/g);\n      });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"has preload link (imported in \"app\")","suites":["First run (baseline)","html files","should add <link> for webpack's magic comments inside \"app\" bundle"],"updatePoint":{"line":440,"column":46,"index":17111},"line":440,"code":"      it(`has preload link (imported in \"app\")`, () => {\n        expect(htmlContent).toMatch(/<link\\s+as=\"script\"\\s+rel=\"preload\"\\s+href=\"\\/magic-comment-app-preload-\\w+.js\"\\s*\\/>/g);\n      });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"doesn't have prefetch link (imported in template)","suites":["First run (baseline)","html files","should add <link> for webpack's magic comments inside \"app\" bundle"],"updatePoint":{"line":443,"column":59,"index":17318},"line":443,"code":"      it(`doesn't have prefetch link (imported in template)`, () => {\n        expect(htmlContent).not.toMatch(/<link\\s+as=\"script\"\\s+rel=\"prefetch\"\\s+href=\"\\/magic-comment-prefetch-\\w+.js\"\\s*\\/>/g);\n      });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"doesn't have preload link (imported in template)","suites":["First run (baseline)","html files","should add <link> for webpack's magic comments inside \"app\" bundle"],"updatePoint":{"line":446,"column":58,"index":17526},"line":446,"code":"      it(`doesn't have preload link (imported in template)`, () => {\n        expect(htmlContent).not.toMatch(/<link\\s+as=\"script\"\\s+rel=\"preload\"\\s+href=\"\\/magic-comment-preload-\\w+.js\"\\s*\\/>/g);\n      });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"should recreate only some html files","suites":["Second run (different pages created, data changed)","html files","shouldn't have unexpected html files"],"updatePoint":{"line":506,"column":44,"index":20028},"line":506,"code":"    it(`should recreate only some html files`, () => {\n      expect(manifest[runNumber].generated.sort()).toEqual(expectedPagesToBeGenerated.sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"should recreate only some html files","suites":["Third run (js template change, just pages of that template are recreated, all pages are stitched)","html files","shouldn't have unexpected html files"],"updatePoint":{"line":596,"column":44,"index":23990},"line":596,"code":"    it(`should recreate only some html files`, () => {\n      expect(manifest[runNumber].generated.sort()).toEqual(expectedPagesToBeGenerated.sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"should stitch fragments back in all html files (browser bundle changed)","suites":["Third run (js template change, just pages of that template are recreated, all pages are stitched)","html files","shouldn't have unexpected html files"],"updatePoint":{"line":599,"column":79,"index":24183},"line":599,"code":"    it(`should stitch fragments back in all html files (browser bundle changed)`, () => {\n      expect(manifest[runNumber].stitched.sort()).toEqual(manifest[runNumber].allPages.sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"should recreate all html files","suites":["Fourth run (gatsby-browser change - cache get invalidated)","html files","shouldn't have unexpected html files"],"updatePoint":{"line":666,"column":38,"index":26645},"line":666,"code":"    it(`should recreate all html files`, () => {\n      expect(manifest[runNumber].generated.sort()).toEqual(manifest[runNumber].allPages.sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"should recreate all html files","suites":["Fifth run (.cache is deleted but public isn't)","html files","shouldn't have unexpected html files"],"updatePoint":{"line":724,"column":38,"index":28585},"line":724,"code":"    it(`should recreate all html files`, () => {\n      expect(manifest[runNumber].generated.sort()).toEqual(manifest[runNumber].allPages.sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"should recreate all html files","suites":["Sixth run (change webpack plugin variant 1 - invalidate webpack cache)","html files","shouldn't have unexpected html files"],"updatePoint":{"line":789,"column":38,"index":31065},"line":789,"code":"    it(`should recreate all html files`, () => {\n      expect(manifest[runNumber].generated.sort()).toEqual(manifest[runNumber].allPages.sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"should recreate all html files","suites":["Seventh run (change webpack plugin variant 2 - invalidate webpack cache)","html files","shouldn't have unexpected html files"],"updatePoint":{"line":854,"column":38,"index":33531},"line":854,"code":"    it(`should recreate all html files`, () => {\n      expect(manifest[runNumber].generated.sort()).toEqual(manifest[runNumber].allPages.sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"should recreate all html files","suites":["Eight run (ssr-only change - only ssr compilation hash changes)","html files","shouldn't have unexpected html files"],"updatePoint":{"line":919,"column":38,"index":35999},"line":919,"code":"    it(`should recreate all html files`, () => {\n      expect(manifest[runNumber].generated.sort()).toEqual(manifest[runNumber].allPages.sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"should recreate all html files","suites":["Ninth run (no change in any file that is bundled, we change untracked file, but previous build used unsafe method so all should rebuild)","html files","shouldn't have unexpected html files"],"updatePoint":{"line":984,"column":38,"index":38486},"line":984,"code":"    it(`should recreate all html files`, () => {\n      expect(manifest[runNumber].generated.sort()).toEqual(manifest[runNumber].allPages.sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"should recreate all html files","suites":["Tenth run (changing extension and content of imported file - making sure webpack cache handles this well)","html files","shouldn't have unexpected html files"],"updatePoint":{"line":1056,"column":38,"index":41258},"line":1056,"code":"    it(`should recreate all html files`, () => {\n      expect(manifest[runNumber].generated.sort()).toEqual(manifest[runNumber].allPages.sort());\n    });","file":"index.js","skipped":false,"dir":"integration-tests/artifacts/__tests__"},{"name":"nodes are persisted between builds when nothing changes","suites":["nothing changed between gatsby runs","Nodes"],"updatePoint":{"line":119,"column":63,"index":3662},"line":119,"code":"    it(`nodes are persisted between builds when nothing changes`, () => {\n      const {\n        nodes: {\n          preBootstrapStateFromFirstRun,\n          postBuildStateFromFirstRun,\n          preBootstrapStateFromSecondRun,\n          postBuildStateFromSecondRun\n        }\n      } = states;\n      expect(preBootstrapStateFromFirstRun.size).toEqual(0);\n      // sanity check to make sure there are any nodes after first run\n      expect(postBuildStateFromFirstRun.size).toBeGreaterThan(0);\n      // no nodes where invalidated if nothing changes\n      expect(postBuildStateFromFirstRun).toEqual(preBootstrapStateFromSecondRun);\n      // final nodes store is the same after first and second run\n      expect(postBuildStateFromFirstRun).toEqual(postBuildStateFromSecondRun);\n    });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Sanity checks","suites":["Some plugins changed between gatsby runs","Nodes"],"updatePoint":{"line":153,"column":21,"index":4796},"line":153,"code":"    it(`Sanity checks`, () => {\n      // preconditions - we expect our cache to be empty on first run\n      expect(states.nodes.preBootstrapStateFromFirstRun.size).toEqual(0);\n    });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Not changing plugin doesn't invalidate nodes created by it","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins without transformers"],"updatePoint":{"line":158,"column":68,"index":5087},"line":158,"code":"      it(`Not changing plugin doesn't invalidate nodes created by it`, () => {\n        const {\n          plugins,\n          nodesTest\n        } = require(`../plugins/source/no-changes/scenario`);\n        nodesTest(getNodesTestArgs(states, plugins));\n      });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Adding plugin adds new node","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins without transformers"],"updatePoint":{"line":165,"column":37,"index":5316},"line":165,"code":"      it(`Adding plugin adds new node`, () => {\n        const {\n          plugins,\n          nodesTest\n        } = require(`../plugins/source/plugin-added/scenario`);\n        nodesTest(getNodesTestArgs(states, plugins));\n      });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Removing plugin clears nodes owned by it","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins without transformers"],"updatePoint":{"line":172,"column":50,"index":5560},"line":172,"code":"      it(`Removing plugin clears nodes owned by it`, () => {\n        const {\n          plugins,\n          nodesTest\n        } = require(`../plugins/source/plugin-removed/scenario`);\n        nodesTest(getNodesTestArgs(states, plugins));\n      });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Changing plugin clears nodes owned by it and recreate nodes","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins without transformers"],"updatePoint":{"line":179,"column":69,"index":5825},"line":179,"code":"      it(`Changing plugin clears nodes owned by it and recreate nodes`, () => {\n        const {\n          plugins,\n          nodesTest\n        } = require(`../plugins/source/plugin-changed/scenario`);\n        nodesTest(getNodesTestArgs(states, plugins));\n      });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Adding source plugin cause transformers to create child nodes","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins with transformers (child nodes)","Changes to source plugins"],"updatePoint":{"line":189,"column":73,"index":6225},"line":189,"code":"        it(`Adding source plugin cause transformers to create child nodes`, () => {\n          const {\n            plugins,\n            nodesTest\n          } = require(`../plugins/source-and-transformers-child-nodes/source-added/scenario`);\n          nodesTest(getNodesTestArgs(states, plugins));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Removing source plugin invalidate nodes owned by it and all children nodes","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins with transformers (child nodes)","Changes to source plugins"],"updatePoint":{"line":196,"column":86,"index":6546},"line":196,"code":"        it(`Removing source plugin invalidate nodes owned by it and all children nodes`, () => {\n          const {\n            plugins,\n            nodesTest\n          } = require(`../plugins/source-and-transformers-child-nodes/source-removed/scenario`);\n          nodesTest(getNodesTestArgs(states, plugins));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Changing source plugin invalidate nodes owned by it and all children nodes and recreates all nodes","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins with transformers (child nodes)","Changes to source plugins"],"updatePoint":{"line":203,"column":110,"index":6893},"line":203,"code":"        it(`Changing source plugin invalidate nodes owned by it and all children nodes and recreates all nodes`, () => {\n          const {\n            plugins,\n            nodesTest\n          } = require(`../plugins/source-and-transformers-child-nodes/source-changed/scenario`);\n          nodesTest(getNodesTestArgs(states, plugins));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Adding transformer adds child nodes to existing nodes","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins with transformers (child nodes)","Changes to transformer plugins"],"updatePoint":{"line":212,"column":65,"index":7262},"line":212,"code":"        it(`Adding transformer adds child nodes to existing nodes`, () => {\n          const {\n            plugins,\n            nodesTest\n          } = require(`../plugins/source-and-transformers-child-nodes/transformer-added/scenario`);\n          nodesTest(getNodesTestArgs(states, plugins));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Removing transformer clear nodes owned by it and remove children from parent nodes","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins with transformers (child nodes)","Changes to transformer plugins"],"updatePoint":{"line":219,"column":94,"index":7596},"line":219,"code":"        it(`Removing transformer clear nodes owned by it and remove children from parent nodes`, () => {\n          const {\n            plugins,\n            nodesTest\n          } = require(`../plugins/source-and-transformers-child-nodes/transformer-removed/scenario`);\n          nodesTest(getNodesTestArgs(states, plugins));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Changing transformer clears and recreates nodes owned by it","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins with transformers (child nodes)","Changes to transformer plugins"],"updatePoint":{"line":226,"column":71,"index":7909},"line":226,"code":"        it(`Changing transformer clears and recreates nodes owned by it`, () => {\n          const {\n            plugins,\n            nodesTest\n          } = require(`../plugins/source-and-transformers-child-nodes/transformer-changed/scenario`);\n          nodesTest(getNodesTestArgs(states, plugins));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Adding source plugin creates a node with fields","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins with transformers (node fields)","Changes to source plugins"],"updatePoint":{"line":237,"column":59,"index":8351},"line":237,"code":"        it(`Adding source plugin creates a node with fields`, () => {\n          const {\n            plugins,\n            nodesTest\n          } = require(`../plugins/source-and-transformers-node-fields/source-added/scenario`);\n          nodesTest(getNodesTestArgs(states, plugins));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Changing source plugin clears and recreates nodes owned by it","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins with transformers (node fields)","Changes to source plugins"],"updatePoint":{"line":244,"column":73,"index":8659},"line":244,"code":"        it(`Changing source plugin clears and recreates nodes owned by it`, () => {\n          const {\n            plugins,\n            nodesTest\n          } = require(`../plugins/source-and-transformers-node-fields/source-changed/scenario`);\n          nodesTest(getNodesTestArgs(states, plugins));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Adding transformer adds fields to node created by source plugin","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins with transformers (node fields)","Changes to transformer plugins"],"updatePoint":{"line":253,"column":75,"index":9038},"line":253,"code":"        it(`Adding transformer adds fields to node created by source plugin`, () => {\n          const {\n            plugins,\n            nodesTest\n          } = require(`../plugins/source-and-transformers-node-fields/transformer-added/scenario`);\n          nodesTest(getNodesTestArgs(states, plugins));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Removing transformer removes fields from node created by source plugin","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins with transformers (node fields)","Changes to transformer plugins"],"updatePoint":{"line":260,"column":82,"index":9360},"line":260,"code":"        it(`Removing transformer removes fields from node created by source plugin`, () => {\n          const {\n            plugins,\n            nodesTest\n          } = require(`../plugins/source-and-transformers-node-fields/transformer-removed/scenario`);\n          nodesTest(getNodesTestArgs(states, plugins));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Changing transformer removes fields from node created by source plugin and recreate fields","suites":["Some plugins changed between gatsby runs","Nodes","Source plugins with transformers (node fields)","Changes to transformer plugins"],"updatePoint":{"line":267,"column":102,"index":9704},"line":267,"code":"        it(`Changing transformer removes fields from node created by source plugin and recreate fields`, () => {\n          const {\n            plugins,\n            nodesTest\n          } = require(`../plugins/source-and-transformers-node-fields/transformer-changed/scenario`);\n          nodesTest(getNodesTestArgs(states, plugins));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Preserve disk cache if owner plugin did not changed","suites":["Some plugins changed between gatsby runs","Persisted key-value store (cache)"],"updatePoint":{"line":278,"column":59,"index":10085},"line":278,"code":"    it(`Preserve disk cache if owner plugin did not changed`, () => {\n      const {\n        persistedKeyValueStoreTest,\n        plugins\n      } = require(`../plugins/key-value-cache/no-changes/scenario`);\n      persistedKeyValueStoreTest(getDiskCacheSnapshotSubStateByPlugins(states, plugins));\n    });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Removing owner plugin clears disk cache","suites":["Some plugins changed between gatsby runs","Persisted key-value store (cache)"],"updatePoint":{"line":285,"column":47,"index":10376},"line":285,"code":"    it(`Removing owner plugin clears disk cache`, () => {\n      const {\n        persistedKeyValueStoreTest,\n        plugins\n      } = require(`../plugins/key-value-cache/plugin-removed/scenario`);\n      persistedKeyValueStoreTest(getDiskCacheSnapshotSubStateByPlugins(states, plugins));\n    });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Adding owner plugin creates disk cache","suites":["Some plugins changed between gatsby runs","Persisted key-value store (cache)"],"updatePoint":{"line":292,"column":46,"index":10670},"line":292,"code":"    it(`Adding owner plugin creates disk cache`, () => {\n      const {\n        persistedKeyValueStoreTest,\n        plugins\n      } = require(`../plugins/key-value-cache/plugin-added/scenario`);\n      persistedKeyValueStoreTest(getDiskCacheSnapshotSubStateByPlugins(states, plugins));\n    });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Changing owner plugin clears disk cache and recreates it","suites":["Some plugins changed between gatsby runs","Persisted key-value store (cache)"],"updatePoint":{"line":299,"column":64,"index":10980},"line":299,"code":"    it(`Changing owner plugin clears disk cache and recreates it`, () => {\n      const {\n        persistedKeyValueStoreTest,\n        plugins\n      } = require(`../plugins/key-value-cache/plugin-changed/scenario`);\n      persistedKeyValueStoreTest(getDiskCacheSnapshotSubStateByPlugins(states, plugins));\n    });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Not changing plugin doesn't change query results","suites":["Some plugins changed between gatsby runs","Query results","Source plugins without transformers"],"updatePoint":{"line":327,"column":58,"index":12180},"line":327,"code":"      it(`Not changing plugin doesn't change query results`, () => {\n        const scenarioName = `source/no-changes`;\n        const {\n          queriesTest\n        } = require(`../plugins/${scenarioName}/scenario`);\n        queriesTest(getQueryResultTestArgs(scenarioName));\n      });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Adding plugin adds a type to schema","suites":["Some plugins changed between gatsby runs","Query results","Source plugins without transformers"],"updatePoint":{"line":334,"column":45,"index":12453},"line":334,"code":"      it(`Adding plugin adds a type to schema`, () => {\n        const scenarioName = `source/plugin-added`;\n        const {\n          queriesTest\n        } = require(`../plugins/${scenarioName}/scenario`);\n        queriesTest(getQueryResultTestArgs(scenarioName));\n      });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Removing plugin removes a type from schema","suites":["Some plugins changed between gatsby runs","Query results","Source plugins without transformers"],"updatePoint":{"line":341,"column":52,"index":12735},"line":341,"code":"      it(`Removing plugin removes a type from schema`, () => {\n        const scenarioName = `source/plugin-removed`;\n        const {\n          queriesTest\n        } = require(`../plugins/${scenarioName}/scenario`);\n        queriesTest(getQueryResultTestArgs(scenarioName));\n      });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Changing plugin invalidates query results","suites":["Some plugins changed between gatsby runs","Query results","Source plugins without transformers"],"updatePoint":{"line":348,"column":51,"index":13018},"line":348,"code":"      it(`Changing plugin invalidates query results`, () => {\n        const scenarioName = `source/plugin-changed`;\n        const {\n          queriesTest\n        } = require(`../plugins/${scenarioName}/scenario`);\n        queriesTest(getQueryResultTestArgs(scenarioName));\n      });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Adding source plugin creates parent and child types in schema and they are queryable on second run","suites":["Some plugins changed between gatsby runs","Query results","Source plugins with transformers","Changes to source plugins"],"updatePoint":{"line":358,"column":110,"index":13477},"line":358,"code":"        it(`Adding source plugin creates parent and child types in schema and they are queryable on second run`, () => {\n          const scenarioName = `source-and-transformers-child-nodes/source-added`;\n          const {\n            queriesTest\n          } = require(`../plugins/${scenarioName}/scenario`);\n          queriesTest(getQueryResultTestArgs(scenarioName));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Removing source plugin removes parent and child types from schema and they are queryable on first run","suites":["Some plugins changed between gatsby runs","Query results","Source plugins with transformers","Changes to source plugins"],"updatePoint":{"line":365,"column":113,"index":13861},"line":365,"code":"        it(`Removing source plugin removes parent and child types from schema and they are queryable on first run`, () => {\n          const scenarioName = `source-and-transformers-child-nodes/source-removed`;\n          const {\n            queriesTest\n          } = require(`../plugins/${scenarioName}/scenario`);\n          queriesTest(getQueryResultTestArgs(scenarioName));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Changing source plugin adjust schema and query result changes just certain fields","suites":["Some plugins changed between gatsby runs","Query results","Source plugins with transformers","Changes to source plugins"],"updatePoint":{"line":372,"column":93,"index":14227},"line":372,"code":"        it(`Changing source plugin adjust schema and query result changes just certain fields`, () => {\n          const scenarioName = `source-and-transformers-child-nodes/source-changed`;\n          const {\n            queriesTest\n          } = require(`../plugins/${scenarioName}/scenario`);\n          queriesTest(getQueryResultTestArgs(scenarioName));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Adding transformer plugin adds child type to schema and updates query result","suites":["Some plugins changed between gatsby runs","Query results","Source plugins with transformers","Changes to transformer plugins"],"updatePoint":{"line":381,"column":88,"index":14655},"line":381,"code":"        it(`Adding transformer plugin adds child type to schema and updates query result`, () => {\n          const scenarioName = `source-and-transformers-child-nodes/transformer-added`;\n          const {\n            queriesTest\n          } = require(`../plugins/${scenarioName}/scenario`);\n          queriesTest(getQueryResultTestArgs(scenarioName));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Removing transformer plugin removes child type from schema and updates query result","suites":["Some plugins changed between gatsby runs","Query results","Source plugins with transformers","Changes to transformer plugins"],"updatePoint":{"line":388,"column":95,"index":15026},"line":388,"code":"        it(`Removing transformer plugin removes child type from schema and updates query result`, () => {\n          const scenarioName = `source-and-transformers-child-nodes/transformer-removed`;\n          const {\n            queriesTest\n          } = require(`../plugins/${scenarioName}/scenario`);\n          queriesTest(getQueryResultTestArgs(scenarioName));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Changing transformer plugin adjusts schema and query result changes just certain fields","suites":["Some plugins changed between gatsby runs","Query results","Source plugins with transformers","Changes to transformer plugins"],"updatePoint":{"line":395,"column":99,"index":15403},"line":395,"code":"        it(`Changing transformer plugin adjusts schema and query result changes just certain fields`, () => {\n          const scenarioName = `source-and-transformers-child-nodes/transformer-changed`;\n          const {\n            queriesTest\n          } = require(`../plugins/${scenarioName}/scenario`);\n          queriesTest(getQueryResultTestArgs(scenarioName));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Adding source plugin creates node and node field types in schema and they are queryable on second run","suites":["Some plugins changed between gatsby runs","Query results","Source plugins with transformers (node fields)","Changes to source plugins"],"updatePoint":{"line":406,"column":113,"index":15935},"line":406,"code":"        it(`Adding source plugin creates node and node field types in schema and they are queryable on second run`, () => {\n          const scenarioName = `source-and-transformers-node-fields/source-added`;\n          const {\n            queriesTest\n          } = require(`../plugins/${scenarioName}/scenario`);\n          queriesTest(getQueryResultTestArgs(scenarioName));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Changing source plugin adjusts schema and they are queryable on second run","suites":["Some plugins changed between gatsby runs","Query results","Source plugins with transformers (node fields)","Changes to source plugins"],"updatePoint":{"line":413,"column":86,"index":16292},"line":413,"code":"        it(`Changing source plugin adjusts schema and they are queryable on second run`, () => {\n          const scenarioName = `source-and-transformers-node-fields/source-changed`;\n          const {\n            queriesTest\n          } = require(`../plugins/${scenarioName}/scenario`);\n          queriesTest(getQueryResultTestArgs(scenarioName));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Adding transformer plugin adds fields type to schema and updates query result","suites":["Some plugins changed between gatsby runs","Query results","Source plugins with transformers (node fields)","Changes to transformer plugins"],"updatePoint":{"line":422,"column":89,"index":16721},"line":422,"code":"        it(`Adding transformer plugin adds fields type to schema and updates query result`, () => {\n          const scenarioName = `source-and-transformers-node-fields/transformer-added`;\n          const {\n            queriesTest\n          } = require(`../plugins/${scenarioName}/scenario`);\n          queriesTest(getQueryResultTestArgs(scenarioName));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Removing transformer plugin removes fields type from schema and updates query result","suites":["Some plugins changed between gatsby runs","Query results","Source plugins with transformers (node fields)","Changes to transformer plugins"],"updatePoint":{"line":429,"column":96,"index":17093},"line":429,"code":"        it(`Removing transformer plugin removes fields type from schema and updates query result`, () => {\n          const scenarioName = `source-and-transformers-node-fields/transformer-removed`;\n          const {\n            queriesTest\n          } = require(`../plugins/${scenarioName}/scenario`);\n          queriesTest(getQueryResultTestArgs(scenarioName));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"Changing transformer plugin adjusts schema and query result changes just certain fields","suites":["Some plugins changed between gatsby runs","Query results","Source plugins with transformers (node fields)","Changes to transformer plugins"],"updatePoint":{"line":436,"column":99,"index":17470},"line":436,"code":"        it(`Changing transformer plugin adjusts schema and query result changes just certain fields`, () => {\n          const scenarioName = `source-and-transformers-node-fields/transformer-changed`;\n          const {\n            queriesTest\n          } = require(`../plugins/${scenarioName}/scenario`);\n          queriesTest(getQueryResultTestArgs(scenarioName));\n        });","file":"cache.js","skipped":false,"dir":"integration-tests/cache-resilience/__tests__"},{"name":"should log build errors with useful outputs","suites":["gatsby build (errors)"],"updatePoint":{"line":8,"column":49,"index":360},"line":8,"code":"  it(`should log build errors with useful outputs`, () => {\n    const [code, logs] = GatsbyCLI.from(cwd).invoke(`build`);\n\n    // Generic logging header\n    logs.should.contain(`failed Building static HTML for pages`);\n    logs.should.contain(`ERROR #95313`);\n    logs.should.contain(`Building static HTML failed`);\n    logs.should.contain(`See our docs page for more info on this error: https://gatsby.dev/debug-html`);\n\n    // Source map should be printed:\n    logs.should.contain(`  3 | // This should intentionally fail`);\n    logs.should.contain(`  4 | const foo = null`);\n    logs.should.contain(`> 5 | foo.bar()`);\n    logs.should.contain(`    |     ^`);\n    logs.should.contain(`  6 |`);\n    logs.should.contain(`  7 | export default () => <div>Hi</div>`);\n    logs.should.contain(`  8 |`);\n\n    // Stack trace\n    logs.should.contain(`WebpackError: TypeError: Cannot read properties of null (reading 'bar')`);\n    logs.should.contain(`- index.js:5`);\n    logs.should.contain(`  gatsby-starter-default-build-errors/src/pages/index.js:5:5`);\n    expect(code).not.toBe(0);\n  });","file":"build-errors.js","skipped":false,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"should log build errors with useful outputs","suites":["gatsby build (SSR errors)"],"updatePoint":{"line":8,"column":49,"index":368},"line":8,"code":"  it(`should log build errors with useful outputs`, () => {\n    const [code, logs] = GatsbyCLI.from(cwd).invoke(`build`);\n\n    // Generic logging header\n    logs.should.contain(`failed Building static HTML for pages`);\n    logs.should.contain(`ERROR #95312`);\n    logs.should.contain(`\"window\" is not available during server-side rendering.`);\n    logs.should.contain(`See our docs page for more info on this error: https://gatsby.dev/debug-html`);\n\n    // // Source map should be printed:\n    logs.should.contain(`  1 | // This will cause an error during SSR because window is not defined`);\n    logs.should.contain(`  2 | exports.onPreRenderHTML = () => {`);\n    logs.should.contain(`> 3 |   window.location.pathname`);\n    logs.should.contain(`    |   ^`);\n    logs.should.contain(`  4 | }`);\n    logs.should.contain(`  5 |`);\n\n    // // Stack trace\n    logs.should.contain(`WebpackError: ReferenceError: window is not defined`);\n    logs.should.contain(`- gatsby-ssr.js:3`);\n    logs.should.contain(`  gatsby-starter-default-build-ssr-errors/gatsby-ssr.js:3:3`);\n    expect(code).not.toBe(0);\n  });","file":"build-ssr-errors.js","skipped":false,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"creates a built gatsby site","suites":["gatsby build"],"updatePoint":{"line":8,"column":33,"index":328},"line":8,"code":"  it(`creates a built gatsby site`, () => {\n    const [code, logs] = GatsbyCLI.from(cwd).invoke(`build`);\n    logs.should.contain(`success load gatsby config`);\n    logs.should.contain(`success load plugins`);\n    logs.should.contain(`success onPreInit`);\n    logs.should.contain(`success initialize cache`);\n    logs.should.contain(`success copy gatsby files`);\n    logs.should.contain(`success onPreBootstrap`);\n    logs.should.contain(`success createSchemaCustomization`);\n    logs.should.contain(`success source and transform nodes`);\n    logs.should.contain(`success building schema`);\n    logs.should.contain(`success createPages`);\n    logs.should.contain(`success createPagesStatefully`);\n    logs.should.contain(`success onPreExtractQueries`);\n    logs.should.contain(`success extract queries from components`);\n    logs.should.contain(`success write out requires`);\n    logs.should.contain(`success write out redirect data`);\n    logs.should.contain(`success onPostBootstrap`);\n    logs.should.contain(`info bootstrap finished`);\n    logs.should.contain(`success Building production JavaScript and CSS bundles`);\n    logs.should.contain(`run queries in workers`);\n    logs.should.contain(`success Building static HTML for pages`);\n    logs.should.contain(`success onPostBuild`);\n    logs.should.contain(`info Done building`);\n    expect(code).toBe(0);\n  });","file":"build.js","skipped":false,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"starts a gatsby site on port 8000","suites":["gatsby develop"],"updatePoint":{"line":11,"column":39,"index":433},"line":11,"code":"  it(`starts a gatsby site on port 8000`, async () => {\n    // 1. Start the `gatsby develop` command\n    const [childProcess, getLogs] = GatsbyCLI.from(cwd).invokeAsync(`develop`, log => log.includes(`You can now view`));\n\n    // 2. kill the `gatsby develop` command so we can get logs\n    await childProcess;\n\n    // 3. Make sure logs for the user contain expected results\n    const logs = getLogs();\n    logs.should.contain(`success load gatsby config`);\n    logs.should.contain(`success load plugins`);\n    logs.should.contain(`success onPreInit`);\n    logs.should.contain(`success initialize cache`);\n    logs.should.contain(`success copy gatsby files`);\n    logs.should.contain(`success onPreBootstrap`);\n    logs.should.contain(`success createSchemaCustomization`);\n    logs.should.contain(`success source and transform nodes`);\n    logs.should.contain(`success building schema`);\n    logs.should.contain(`success createPages`);\n    logs.should.contain(`success createPagesStatefully`);\n    logs.should.contain(`success onPreExtractQueries`);\n    logs.should.contain(`success extract queries from components`);\n    logs.should.contain(`success write out requires`);\n    logs.should.contain(`success write out redirect data`);\n    logs.should.contain(`success onPostBootstrap`);\n    logs.should.contain(`info bootstrap finished`);\n    // These don't fire in CI. Need to figure out how to make it work. Might not be possible\n    // logs.should.contain(\n    //   `You can now view gatsby-starter-default in the browser.`\n    // )\n    // logs.should.contain(`http://localhost:8000/`)\n    // logs.should.contain(\n    //   `View GraphiQL, an in-browser IDE, to explore your site's data and schema`\n    // )\n    // logs.should.contain(`http://localhost:8000/___graphql`)\n    // logs.should.contain(`Note that the development build is not optimized.`)\n    // logs.should.contain(`To create a production build, use gatsby build`)\n  });","file":"develop.js","skipped":false,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"starts a gatsby site on port 9000 with -p 9000","suites":["gatsby develop"],"line":50,"code":"  it.skip(`starts a gatsby site on port 9000 with -p 9000`, () => {});","file":"develop.js","skipped":true,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"starts a gatsby site at a diffent host with -h","suites":["gatsby develop"],"line":51,"code":"  it.skip(`starts a gatsby site at a diffent host with -h`, () => {});","file":"develop.js","skipped":true,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"starts a gatsby site with ssl using -S","suites":["gatsby develop"],"line":52,"code":"  it.skip(`starts a gatsby site with ssl using -S`, () => {});","file":"develop.js","skipped":true,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"starts a gatsby site with cert file using -c","suites":["gatsby develop"],"line":53,"code":"  it.skip(`starts a gatsby site with cert file using -c`, () => {});","file":"develop.js","skipped":true,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"starts a gatsby site with key file using -k","suites":["gatsby develop"],"line":54,"code":"  it.skip(`starts a gatsby site with key file using -k`, () => {});","file":"develop.js","skipped":true,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"starts a gatsby site with -open-tracing-config-file","suites":["gatsby develop"],"line":55,"code":"  it.skip(`starts a gatsby site with -open-tracing-config-file`, () => {});","file":"develop.js","skipped":true,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"Prints a note to give feedback","suites":["gatsby feedback"],"updatePoint":{"line":8,"column":36,"index":245},"line":8,"code":"  it(`Prints a note to give feedback`, () => {\n    const [status, logs] = GatsbyCLI.from(`gatsby-sites/gatsby-build`).invoke(`feedback`);\n    logs.should.contain(`Hello! Will you help Gatsby improve by taking a four question survey?`);\n    logs.should.contain(`It takes less than five minutes and your ideas and feedback will be very helpful`);\n    logs.should.contain(`Give us your feedback here: https://gatsby.dev/feedback`);\n    expect(status).toBe(0);\n  });","file":"feedback.js","skipped":false,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"creates a gatsby site with the default starter","suites":["gatsby new"],"updatePoint":{"line":23,"column":52,"index":881},"line":23,"code":"  it(`creates a gatsby site with the default starter`, () => {\n    const [code, logs] = GatsbyCLI.from(cwd).invoke([`new`, `gatsby-default`]);\n    logs.should.contain(`info Creating new site from git: https://github.com/gatsbyjs/gatsby-starter-default.git`);\n    logs.should.contain(`success Created starter directory layout`);\n    logs.should.contain(`info Installing packages...`);\n    logs.should.contain(`Your new Gatsby site has been successfully bootstrapped. Start developing it by running:`);\n    logs.should.contain(`  cd gatsby-default`);\n    logs.should.contain(`  gatsby develop`);\n    expect(code).toBe(0);\n  });","file":"new.js","skipped":false,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"creates a gatsby site with the blog starter","suites":["gatsby new"],"updatePoint":{"line":33,"column":49,"index":1504},"line":33,"code":"  it(`creates a gatsby site with the blog starter`, () => {\n    const [code, logs] = GatsbyCLI.from(cwd).invoke([`new`, `gatsby-blog`, `gatsbyjs/gatsby-starter-blog`]);\n    logs.should.contain(`info Creating new site from git: https://github.com/gatsbyjs/gatsby-starter-blog.git`);\n    logs.should.contain(`success Created starter directory layout`);\n    logs.should.contain(`info Installing packages...`);\n    logs.should.contain(`Your new Gatsby site has been successfully bootstrapped. Start developing it by running:`);\n    logs.should.contain(`  cd gatsby-blog`);\n    logs.should.contain(`  gatsby develop`);\n    expect(code).toBe(0);\n  });","file":"new.js","skipped":false,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"fails to create a gatsby site with an invalid starter","suites":["gatsby new"],"updatePoint":{"line":43,"column":59,"index":2160},"line":43,"code":"  it(`fails to create a gatsby site with an invalid starter`, () => {\n    const [code, logs] = GatsbyCLI.from(cwd).invoke([`new`, `gatsby-invalid`, `tHiS-Is-A-fAkE-sTaRtEr`]);\n    logs.should.contain(`Error`);\n    logs.should.contain(`starter tHiS-Is-A-fAkE-sTaRtEr doesn't exist`);\n    expect(code).toBe(1);\n  });","file":"new.js","skipped":false,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"runs create-gatsby when no arguments are provided to gatsby new","suites":["gatsby new"],"updatePoint":{"line":49,"column":69,"index":2485},"line":49,"code":"  it(`runs create-gatsby when no arguments are provided to gatsby new`, () => {\n    const [_, logs] = GatsbyCLI.from(cwd).invoke([`new`]);\n    logs.should.contain(`Welcome to Gatsby!`);\n  });","file":"new.js","skipped":false,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"Prints the options","suites":["gatsby options"],"updatePoint":{"line":5,"column":24,"index":167},"line":5,"code":"  it(`Prints the options`, () => {\n    const [status, logs] = GatsbyCLI.from(`gatsby-sites/gatsby-build`).invoke(`options`);\n    logs.should.contain(`Package Manager`);\n    logs.should.contain(`Telemetry enabled`);\n    expect(status).toBe(0);\n  });","file":"options.js","skipped":false,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"lists plugins","suites":["gatsby plugin"],"updatePoint":{"line":8,"column":19,"index":316},"line":8,"code":"  it(`lists plugins`, async () => {\n    const [code, logs] = GatsbyCLI.from(cwd).invoke([`plugin`, `ls`]);\n    logs.should.contain(`gatsby-source-filesystem`);\n    logs.should.contain(`gatsby-plugin-offline`);\n    expect(logs).toEqual(expect.not.stringContaining(`ignore comments`));\n    expect(code).toBe(0);\n  });","file":"plugin.js","skipped":false,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"starts a gatsby site on port 8000","suites":["gatsby repl"],"updatePoint":{"line":8,"column":39,"index":332},"line":8,"code":"  it(`starts a gatsby site on port 8000`, async () => {\n    // 1. Start the `gatsby develop` command\n    const [childProcess, getLogs] = GatsbyCLI.from(cwd).invokeAsync(`repl`, log => log.includes(\"gatsby >\"));\n\n    // 2. Wait for the build process to finish\n    await childProcess;\n\n    // 3. Make assertions\n    const logs = getLogs();\n    logs.should.contain(`success load gatsby config`);\n    logs.should.contain(`success load plugins`);\n    logs.should.contain(`success onPreInit`);\n    logs.should.contain(`success initialize cache`);\n    logs.should.contain(`success copy gatsby files`);\n    logs.should.contain(`success onPreBootstrap`);\n    logs.should.contain(`success createSchemaCustomization`);\n    logs.should.contain(`success source and transform nodes`);\n    logs.should.contain(`success building schema`);\n    logs.should.contain(`success createPages`);\n    logs.should.contain(`success createPagesStatefully`);\n    logs.should.contain(`success onPreExtractQueries`);\n    logs.should.contain(`success extract queries from components`);\n    logs.should.contain(`success write out redirect data`);\n    logs.should.contain(`success onPostBootstrap`);\n    logs.should.contain(`info bootstrap finished`);\n\n    // This is the actual repl prompt\n    logs.should.contain(`gatsby >`);\n  });","file":"repl.js","skipped":false,"dir":"integration-tests/gatsby-cli/__tests__"},{"name":"should have the correct md5","suites":["fetch-remote-file"],"updatePoint":{"line":24,"column":33,"index":643},"line":24,"code":"  it(\"should have the correct md5\", async () => {\n    expect(await md5File(path.join(__dirname, \"../..\", \"public/images/ce61bf418df0d6677d2701c4aeff1023/photoA.jpg\"))).toEqual(\"37287aaa726d254eabcf3e7ede51a93b\");\n    expect(await md5File(path.join(__dirname, \"../..\", \"public/images/adeb4bc975f3ce4081c6772a0c96ca7b/photoB.jpg\"))).toEqual(\"cef966aac5cfc7972e91e5c5c96829cb\");\n    expect(await md5File(path.join(__dirname, \"../..\", \"public/images/48315d9e12fde935993d8b406f2d6684/photoC.jpg\"))).toEqual(\"c3d2efe723cd58311db404fd1b1f76a7\");\n  });","file":"fetch-remote-file/index.js","skipped":false,"dir":"integration-tests/gatsby-pipeline/__tests__"},{"name":"should process images on demand","suites":["Lazy images"],"updatePoint":{"line":21,"column":37,"index":506},"line":21,"code":"  it(`should process images on demand`, async () => {\n    const {\n      kill\n    } = await createDevServer();\n    const contentDigest = await md5File(path.resolve(\"./src/images/gatsby-astronaut.png\"));\n    const response = await fetch(`http://localhost:8000/static/${contentDigest}/630fb/gatsby-astronaut.png`);\n    await kill();\n    expect(response.status).toBe(200);\n    const images = glob.sync(`${basePath}/public/**/*.png`);\n    // we disable lazy images on CI\n    // https://github.com/gatsbyjs/gatsby/blob/b474dbb25518b51ca8cc1ce75fffb044e7d8609a/packages/gatsby-plugin-sharp/src/index.js#L150-L159\n    expect(images.length).toBe(isCI() ? 6 : 1);\n  });","file":"lazy-image-build/develop.js","skipped":false,"dir":"integration-tests/gatsby-pipeline/__tests__"},{"name":"should process the rest of images on build","suites":["Lazy images"],"updatePoint":{"line":34,"column":48,"index":1177},"line":34,"code":"  it(`should process the rest of images on build`, async () => {\n    await execa(`yarn`, [`build`], {\n      cwd: basePath,\n      env: {\n        NODE_ENV: `production`\n      }\n    });\n    const images = glob.sync(`${basePath}/public/**/*.png`);\n    expect(images.length).toBe(6);\n  });","file":"lazy-image-build/develop.js","skipped":false,"dir":"integration-tests/gatsby-pipeline/__tests__"},{"name":"should process all images from a clean build","suites":["Lazy images"],"updatePoint":{"line":44,"column":50,"index":1464},"line":44,"code":"  it(`should process all images from a clean build`, async () => {\n    await clean();\n    await execa(`yarn`, [`build`], {\n      cwd: basePath,\n      env: {\n        NODE_ENV: `production`\n      }\n    });\n    const images = glob.sync(`${basePath}/public/**/*.png`);\n    expect(images.length).toBe(6);\n  });","file":"lazy-image-build/develop.js","skipped":false,"dir":"integration-tests/gatsby-pipeline/__tests__"},{"name":"generates the correct images for test image","suites":["image generation"],"updatePoint":{"line":181,"column":49},"line":181,"code":"  it(\"generates the correct images for test image\", async () => {\n    return Promise.all(\n      [\n        \"constrained-square\",\n        \"forcePNG\",\n        \"aspectRatio\",\n        \"fullWidth-aspectRatio\",\n        \"fixed-aspectRatio\",\n        \"fixed\",\n        \"fixed-square\",\n        \"constrained\",\n        \"no-jpg\",\n        \"fullwidth\",\n        \"fullwidth-bp\",\n      ].map(async testId => {\n        const images = getImages(testId, div)\n\n        expect(images).toMatchSnapshot(testId)\n\n        const [fallback, ...imgs] = images\n\n        await Promise.all(\n          imgs.map(img => {\n            return (expect(img) as jest.VisualMatch).toVisuallyMatchSrcSet(\n              fallback\n            )\n          })\n        )\n      })\n    )\n  }, 60000)","file":"images.ts","skipped":false,"dir":"integration-tests/images/__tests__"},{"name":"Add character to src/pages/index.js","suites":["long term caching"],"updatePoint":{"line":116,"column":43,"index":3830},"line":116,"code":"  test(`Add character to src/pages/index.js`, async () => {\n    const public0 = resolve(`${basePath}/public-0`);\n    const public1 = resolve(`${basePath}/public-1`);\n    const previousFiles = await getDirFilesWalk(public0);\n    const modifiedFiles = await getDirFilesWalk(public1);\n    expect(previousFiles).not.toEqual(expect.arrayContaining(modifiedFiles));\n  });","file":"long-term-caching.js","skipped":false,"dir":"integration-tests/long-term-caching/__tests__"},{"name":"Add import to src/pages/index.js","suites":["long term caching"],"updatePoint":{"line":123,"column":40,"index":4193},"line":123,"code":"  test(`Add import to src/pages/index.js`, async () => {\n    const public1 = resolve(`${basePath}/public-1`);\n    const public2 = resolve(`${basePath}/public-2`);\n    const previousFiles = await getDirFilesWalk(public1);\n    const modifiedFiles = await getDirFilesWalk(public2);\n    expect(previousFiles).not.toEqual(expect.arrayContaining(modifiedFiles));\n  });","file":"long-term-caching.js","skipped":false,"dir":"integration-tests/long-term-caching/__tests__"},{"name":"Add async import to src/pages/index.js","suites":["long term caching"],"updatePoint":{"line":130,"column":46,"index":4562},"line":130,"code":"  test(`Add async import to src/pages/index.js`, async () => {\n    const public2 = resolve(`${basePath}/public-2`);\n    const public3 = resolve(`${basePath}/public-3`);\n    const previousFiles = await getDirFilesWalk(public2);\n    const modifiedFiles = await getDirFilesWalk(public3);\n    expect(previousFiles).not.toEqual(expect.arrayContaining(modifiedFiles));\n  });","file":"long-term-caching.js","skipped":false,"dir":"integration-tests/long-term-caching/__tests__"},{"name":"Add another async import to src/pages/index.js","suites":["long term caching"],"updatePoint":{"line":137,"column":54,"index":4939},"line":137,"code":"  test(`Add another async import to src/pages/index.js`, async () => {\n    const public3 = resolve(`${basePath}/public-3`);\n    const public4 = resolve(`${basePath}/public-4`);\n    const previousFiles = await getDirFilesWalk(public3);\n    const modifiedFiles = await getDirFilesWalk(public4);\n    expect(previousFiles).not.toEqual(expect.arrayContaining(modifiedFiles));\n  });","file":"long-term-caching.js","skipped":false,"dir":"integration-tests/long-term-caching/__tests__"},{"name":"Add character to src/async-2.js","suites":["long term caching"],"updatePoint":{"line":144,"column":39,"index":5301},"line":144,"code":"  test(`Add character to src/async-2.js`, async () => {\n    const public4 = resolve(`${basePath}/public-4`);\n    const public5 = resolve(`${basePath}/public-5`);\n    const previousFiles = await getDirFilesWalk(public4);\n    const modifiedFiles = await getDirFilesWalk(public5);\n    expect(previousFiles).not.toEqual(expect.arrayContaining(modifiedFiles));\n  });","file":"long-term-caching.js","skipped":false,"dir":"integration-tests/long-term-caching/__tests__"},{"name":"Creates an accurate node manifest when using the ownerNodeId argument in createPage","suites":["Node Manifest API in \"gatsby \""],"updatePoint":{"line":54,"column":89,"index":2175},"line":54,"code":"  it(`Creates an accurate node manifest when using the ownerNodeId argument in createPage`, async () => {\n    const manifestFileContents = await getManifestContents(1);\n    expect(manifestFileContents.node.id).toBe(`1`);\n    expect(manifestFileContents.page.path).toBe(`/one/`);\n    expect(manifestFileContents.foundPageBy).toBe(`ownerNodeId`);\n  });","file":"create-node-manifest.test.js","skipped":false,"dir":"integration-tests/node-manifest/__tests__"},{"name":"Creates an accurate node manifest when ownerNodeId isn't present but there's a matching \"id\" in pageContext","suites":["Node Manifest API in \"gatsby \""],"updatePoint":{"line":60,"column":113,"index":2550},"line":60,"code":"  it(`Creates an accurate node manifest when ownerNodeId isn't present but there's a matching \"id\" in pageContext`, async () => {\n    const manifestFileContents = await getManifestContents(2);\n    expect(manifestFileContents.node.id).toBe(`2`);\n    expect(manifestFileContents.page.path).toBe(`/two/`);\n    expect(manifestFileContents.foundPageBy).toBe(`context.id`);\n  });","file":"create-node-manifest.test.js","skipped":false,"dir":"integration-tests/node-manifest/__tests__"},{"name":"Creates an accurate node manifest when ownerNodeId isn't present but there's a matching \"slug\" in pageContext","suites":["Node Manifest API in \"gatsby \""],"updatePoint":{"line":66,"column":115,"index":2926},"line":66,"code":"  it(`Creates an accurate node manifest when ownerNodeId isn't present but there's a matching \"slug\" in pageContext`, async () => {\n    const manifestFileContents = await getManifestContents(5);\n    expect(manifestFileContents.node.id).toBe(`5`);\n    expect(manifestFileContents.page.path).toBe(`/slug-test-path/`);\n    expect(manifestFileContents.foundPageBy).toBe(`context.slug`);\n  });","file":"create-node-manifest.test.js","skipped":false,"dir":"integration-tests/node-manifest/__tests__"},{"name":"Creates a node manifest from the first tracked page it finds in query tracking","suites":["Node Manifest API in \"gatsby \""],"updatePoint":{"line":75,"column":86,"index":3439},"line":75,"code":"    it(`Creates a node manifest from the first tracked page it finds in query tracking`, async () => {\n      const manifestFileContents = await getManifestContents(3);\n      expect(manifestFileContents.node.id).toBe(`3`);\n      expect([`/three/`, `/three-alternative/`].includes(manifestFileContents.page.path)).toBe(true);\n      expect(manifestFileContents.foundPageBy).toBe(`queryTracking`);\n    });","file":"create-node-manifest.test.js","skipped":false,"dir":"integration-tests/node-manifest/__tests__"},{"name":"Adds the correct manifestId to the pageData.json digest","suites":["Node Manifest API in \"gatsby \""],"updatePoint":{"line":83,"column":63,"index":3908},"line":83,"code":"    it(`Adds the correct manifestId to the pageData.json digest`, async () => {\n      const nodeId = `1`;\n      const path = `one`;\n      const pageData = await pageDataContents(path);\n      expect(pageData.manifestId).toEqual(createManifestId(nodeId));\n    });","file":"create-node-manifest.test.js","skipped":false,"dir":"integration-tests/node-manifest/__tests__"},{"name":"Creates a node manifest with a null page path when createNodeManifest is called but a page is not created for the provided node in the Gatsby site","suites":["Node Manifest API in \"gatsby \""],"updatePoint":{"line":90,"column":152,"index":4263},"line":90,"code":"  it(`Creates a node manifest with a null page path when createNodeManifest is called but a page is not created for the provided node in the Gatsby site`, async () => {\n    const manifestFileContents = await getManifestContents(4);\n    expect(manifestFileContents.node.id).toBe(`4`);\n    expect(manifestFileContents.page.path).toBe(null);\n    expect(manifestFileContents.foundPageBy).toBe(`none`);\n  });","file":"create-node-manifest.test.js","skipped":false,"dir":"integration-tests/node-manifest/__tests__"},{"name":"Creates a Node manifest for filesystem routes","suites":["Node Manifest API in \"gatsby \""],"updatePoint":{"line":96,"column":51,"index":4566},"line":96,"code":"  it(`Creates a Node manifest for filesystem routes`, async () => {\n    const manifestFileContents = await getManifestContents(`filesystem-1`);\n    expect(manifestFileContents.node.id).toBe(`filesystem-1`);\n    expect(manifestFileContents.page.path).toBe(`/filesystem-1/`);\n    expect(manifestFileContents.foundPageBy).toBe(`filesystem-route-api`);\n  });","file":"create-node-manifest.test.js","skipped":false,"dir":"integration-tests/node-manifest/__tests__"},{"name":"Creates a manifest for the node when updatedAt is included and is within  days","suites":["Node Manifest API in \"gatsby \""],"updatePoint":{"line":102,"column":107,"index":4977},"line":102,"code":"  it(`Creates a manifest for the node when updatedAt is included and is within ${DEFAULT_MAX_DAYS_OLD} days`, async () => {\n    const recentlyUpdatedNodeId = `updatedAt-1`;\n    const staleNodeId = `updatedAt-2`;\n    const recentlyUpdatedNodeManifest = await getManifestContents(recentlyUpdatedNodeId);\n    try {\n      await getManifestContents(staleNodeId);\n      throw new Error();\n    } catch (e) {\n      expect(e.message).toContain(`no such file or directory`);\n      expect(e.message).toContain(createManifestId(staleNodeId));\n    }\n    expect(recentlyUpdatedNodeManifest.node.id).toBe(recentlyUpdatedNodeId);\n  });","file":"create-node-manifest.test.js","skipped":false,"dir":"integration-tests/node-manifest/__tests__"},{"name":"Creates a correct node manifest for nodes in connection list queries","suites":["Node Manifest API in \"gatsby \""],"updatePoint":{"line":115,"column":74,"index":5564},"line":115,"code":"  it(`Creates a correct node manifest for nodes in connection list queries`, async () => {\n    const manifestFileContents1 = await getManifestContents(`connection-list-query-node`);\n    expect(manifestFileContents1.node.id).toBe(`connection-list-query-node`);\n    expect(manifestFileContents1.page.path).toBe(`/connection-list-query-page/`);\n    const manifestFileContents2 = await getManifestContents(`connection-list-query-node-2`);\n    expect(manifestFileContents2.node.id).toBe(`connection-list-query-node-2`);\n    expect(manifestFileContents2.page.path).toBe(`/connection-list-query-page/`);\n  });","file":"create-node-manifest.test.js","skipped":false,"dir":"integration-tests/node-manifest/__tests__"},{"name":"Creates a correct node manifest for nodes in connection list queries using staticQuery()","suites":["Node Manifest API in \"gatsby \""],"updatePoint":{"line":123,"column":94,"index":6187},"line":123,"code":"  it(`Creates a correct node manifest for nodes in connection list queries using staticQuery()`, async () => {\n    const manifestFileContents1 = await getManifestContents(`static-query-list-query-node`);\n    expect(manifestFileContents1.node.id).toBe(`static-query-list-query-node`);\n    expect(manifestFileContents1.page.path).toBe(`/static-query-list-query/`);\n    const manifestFileContents2 = await getManifestContents(`static-query-list-query-node-2`);\n    expect(manifestFileContents2.node.id).toBe(`static-query-list-query-node-2`);\n    expect(manifestFileContents2.page.path).toBe(`/static-query-list-query/`);\n  });","file":"create-node-manifest.test.js","skipped":false,"dir":"integration-tests/node-manifest/__tests__"},{"name":"Limits the number of node manifest files written to disk to 500","suites":["Node Manifest API in \"gatsby \""],"updatePoint":{"line":162,"column":69,"index":7689},"line":162,"code":"  it(`Limits the number of node manifest files written to disk to 500`, async () => {\n    const nodeManifestFiles = fs.readdirSync(manifestDir);\n    expect(nodeManifestFiles).toHaveLength(500);\n  });","file":"create-node-manifest.test.js","skipped":false,"dir":"integration-tests/node-manifest/__tests__"},{"name":"is run for a page when it is requested","suites":["SSR"],"updatePoint":{"line":26,"column":46,"index":627},"line":26,"code":"  test(`is run for a page when it is requested`, async () => {\n    const html = await fetch(`http://localhost:8000/`, {\n      headers: {\n        \"x-gatsby-wait-for-dev-ssr\": `1`\n      }\n    }).then(res => res.text());\n    expect(html).toMatchSnapshot();\n  }, 30000);","file":"ssr.js","skipped":false,"dir":"integration-tests/ssr/__tests__"},{"name":"dev & build outputs match","suites":["SSR"],"updatePoint":{"line":34,"column":33,"index":881},"line":34,"code":"  test(`dev & build outputs match`, async () => {\n    const childProcess = await execa(`yarn`, [`test-output`]);\n    expect(childProcess.exitCode).toEqual(0);\n\n    // Additional sanity-check\n    expect(String(childProcess.stdout)).toContain(`testing these paths for differences between dev & prod outputs`);\n  }, 180000);","file":"ssr.js","skipped":false,"dir":"integration-tests/ssr/__tests__"},{"name":"dev & build outputs have matching head elements from Head function export","suites":["SSR"],"updatePoint":{"line":41,"column":81,"index":1251},"line":41,"code":"  test(`dev & build outputs have matching head elements from Head function export`, async () => {\n    const devSsrHtml = await fetch(`http://localhost:8000/head-function-export`, {\n      headers: {\n        \"x-gatsby-wait-for-dev-ssr\": `1`\n      }\n    }).then(res => res.text());\n    const devSsrDom = parse(devSsrHtml);\n    const devSsrHead = devSsrDom.querySelector(`[data-testid=title]`);\n    const ssrHtml = await fs.readFile(`${__dirname}/../public/head-function-export/index.html`, `utf8`);\n    const ssrDom = parse(ssrHtml);\n    const ssrHead = ssrDom.querySelector(`[data-testid=title]`);\n    expect(devSsrHead.textContent).toEqual(ssrHead.textContent);\n    expect(devSsrDom.querySelector(`html`).attributes).toEqual(ssrDom.querySelector(`html`).attributes);\n    expect(devSsrDom.querySelector(`html`).attributes).toMatchInlineSnapshot(`\n      Object {\n        \"data-foo\": \"bar\",\n        \"lang\": \"fr\",\n      }\n    `);\n    expect(devSsrDom.querySelector(`body`).attributes).toEqual(ssrDom.querySelector(`body`).attributes);\n    expect(devSsrDom.querySelector(`body`).attributes).toMatchInlineSnapshot(`\n      Object {\n        \"data-foo\": \"baz\",\n      }\n    `);\n  });","file":"ssr.js","skipped":false,"dir":"integration-tests/ssr/__tests__"},{"name":"should kill the develop process when exit command is given","suites":["IPC Send"],"updatePoint":{"line":24,"column":64,"index":690},"line":24,"code":"  it(`should kill the develop process when exit command is given`, done => {\n    expect.assertions(1);\n    gatsbyProcess.on(\"exit\", () => {\n      expect(true).toBe(true);\n      done();\n    });\n    let hasSentExitCode;\n    gatsbyProcess.on(\"message\", msg => {\n      if (hasSentExitCode) {\n        return;\n      }\n      hasSentExitCode = true;\n      gatsbyProcess.send({\n        type: \"COMMAND\",\n        action: {\n          type: \"EXIT\",\n          payload: \"SIGINT\"\n        }\n      });\n    });\n  });","file":"ipc-send.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emit start, update and end events for a successful activity","suites":["Activities"],"updatePoint":{"line":40,"column":65,"index":1186},"line":40,"code":"  it(`emit start, update and end events for a successful activity`, async () => {\n    const activityEvents = events.filter(event => event.type === `LOG_ACTION` && event.action.payload.id === `Successful activity`);\n\n    // console.log(util.inspect(activityEvents, { depth: null }))\n\n    const activityUuid = activityEvents[0].action.payload.uuid;\n    expect(activityEvents).toEqual([expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `ACTIVITY_START`,\n        payload: expect.objectContaining({\n          id: `Successful activity`,\n          uuid: activityUuid,\n          total: 100\n        })\n      })\n    }), expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `ACTIVITY_UPDATE`,\n        payload: expect.objectContaining({\n          id: `Successful activity`,\n          uuid: activityUuid,\n          current: 50\n        })\n      })\n    }), expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `ACTIVITY_END`,\n        payload: expect.objectContaining({\n          id: `Successful activity`,\n          uuid: activityUuid,\n          status: `SUCCESS`\n        })\n      })\n    })]);\n  });","file":"logs.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emit start, update and end events for a failed activity","suites":["Activities"],"updatePoint":{"line":78,"column":61,"index":2429},"line":78,"code":"  it(`emit start, update and end events for a failed activity`, async () => {\n    const activityEvents = events.filter(event => event.type === `LOG_ACTION` && event.action.payload.id === `Failing activity`);\n\n    // console.log(util.inspect(activityEvents, { depth: null }))\n\n    const activityUuid = activityEvents[0].action.payload.uuid;\n    expect(activityEvents).toEqual([expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `ACTIVITY_START`,\n        payload: expect.objectContaining({\n          id: `Failing activity`,\n          uuid: activityUuid,\n          total: 100\n        })\n      })\n    }), expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `ACTIVITY_UPDATE`,\n        payload: expect.objectContaining({\n          id: `Failing activity`,\n          uuid: activityUuid,\n          current: 75\n        })\n      })\n    }), expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `ACTIVITY_END`,\n        payload: expect.objectContaining({\n          id: `Failing activity`,\n          uuid: activityUuid,\n          status: `FAILED`\n        })\n      })\n    })]);\n  });","file":"logs.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"Fails activity corresponding to API if \"reporter.panicOnBuild\" is called in API callback","suites":["Activities"],"updatePoint":{"line":116,"column":94,"index":3692},"line":116,"code":"  it(`Fails activity corresponding to API if \"reporter.panicOnBuild\" is called in API callback`, () => {\n    const createPagesEndActivityEvent = events.find(event => event.type === `LOG_ACTION` && event.action.type === `ACTIVITY_END` && event.action.payload.id === `createPages`);\n    expect(createPagesEndActivityEvent).toBeDefined();\n    expect(createPagesEndActivityEvent.action.payload.status).toBe(`FAILED`);\n  });","file":"logs.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emits LOG_ACTION for ","suites":["Activities"],"updatePoint":{"line":130,"column":37,"index":4309},"line":130,"code":"    it(`emits LOG_ACTION for ${level}`, async () => {\n      const event = events.find(e => e.type === `LOG_ACTION` && e.action.type === `LOG` && mapActionToLevel[level] === e.action.payload.level && level === e.action.payload.text);\n      expect(event).toBeDefined();\n    });","file":"logs.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emits SET_STATUS FAILURE","suites":["Panic"],"updatePoint":{"line":31,"column":30,"index":877},"line":31,"code":"  it(`emits SET_STATUS FAILURE`, async () => {\n    expect(events).toEqual(expect.arrayContaining([expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `SET_STATUS`,\n        payload: `FAILED`\n      })\n    })]));\n  });","file":"panic.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emits LOG","suites":["Panic"],"updatePoint":{"line":40,"column":15,"index":1132},"line":40,"code":"  it(`emits LOG`, async () => {\n    expect(events).toEqual(expect.arrayContaining([expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `LOG`,\n        payload: expect.objectContaining({\n          level: `ERROR`,\n          text: `Your house is on fire`\n        })\n      })\n    })]));\n  });","file":"panic.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"Sets up errorMap inPreInit and panic with structured error","suites":["Plugin Errors"],"updatePoint":{"line":31,"column":64,"index":920},"line":31,"code":"  it(`Sets up errorMap inPreInit and panic with structured error`, () => {\n    expect(events).toEqual(expect.arrayContaining([expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `SET_STATUS`,\n        payload: `FAILED`\n      })\n    })]));\n    expect(events).toEqual(expect.arrayContaining([expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `LOG`,\n        payload: expect.objectContaining({\n          level: `ERROR`,\n          category: `SYSTEM`,\n          text: `Error text is MORE ERROR!`,\n          code: `structured-plugin-errors_12345`\n        })\n      })\n    })]));\n    expect(events).toEqual(expect.arrayContaining([expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `LOG`,\n        payload: expect.objectContaining({\n          level: `ERROR`,\n          category: `SYSTEM`,\n          text: `Error text is PANIC!`,\n          code: `structured-plugin-errors_1337`\n        })\n      })\n    })]));\n  });","file":"plugin-errors.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emits SUCCESS","suites":["Successful Build"],"updatePoint":{"line":34,"column":19,"index":918},"line":34,"code":"  it(`emits SUCCESS`, async () => {\n    expect(events).toEqual(expect.arrayContaining([expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `SET_STATUS`,\n        payload: `SUCCESS`\n      })\n    })]));\n  });","file":"status.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emits IN_PROGRESS","suites":["Successful Build"],"updatePoint":{"line":43,"column":23,"index":1182},"line":43,"code":"  it(`emits IN_PROGRESS`, async () => {\n    expect(events).toEqual(expect.arrayContaining([expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `SET_STATUS`,\n        payload: `IN_PROGRESS`\n      })\n    })]));\n  });","file":"status.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emits IN_PROGRESS","suites":["Failing Build"],"updatePoint":{"line":103,"column":23,"index":2797},"line":103,"code":"  it(`emits IN_PROGRESS`, async () => {\n    expect(events).toEqual(expect.arrayContaining([expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `SET_STATUS`,\n        payload: `IN_PROGRESS`\n      })\n    })]));\n  });","file":"status.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emits FAILURE","suites":["Failing Build"],"updatePoint":{"line":112,"column":19,"index":3061},"line":112,"code":"  it(`emits FAILURE`, async () => {\n    expect(events).toEqual(expect.arrayContaining([expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `SET_STATUS`,\n        payload: `FAILED`\n      })\n    })]));\n  });","file":"status.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emits actions with a timestamp","suites":[],"updatePoint":{"line":87,"column":36,"index":2594},"line":87,"code":"  it(`emits actions with a timestamp`, () => {\n    events.forEach(event => {\n      expect(event).toHaveProperty(`action.timestamp`, expect.stringMatching(ISO8601));\n    });\n  });","file":"to-do.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"validate shape of all messages types - joi?","suites":[],"updatePoint":{"line":93,"column":49,"index":2860},"line":93,"code":"  it(`validate shape of all messages types - joi?`, () => {\n    const actionSchema = joi.alternatives().try(joi.object({\n      type: joi.string().required().valid(`SET_STATUS`),\n      // TODO: We should change this to always be an Object I think pieh\n      payload: joi.string().required().valid(`SUCCESS`, `IN_PROGRESS`, `FAILED`, `INTERRUPTED`),\n      // Should this be here or one level up?\n      timestamp: joi.string().required()\n    }).required(), joi.object({\n      type: joi.string().required().valid(`ACTIVITY_START`, `ACTIVITY_UPDATE`, `ACTIVITY_END`, `LOG`),\n      payload: joi.object(),\n      // Should this be here or one level up?\n      timestamp: joi.string().required()\n    }).required(), joi.object({\n      type: joi.string().required().valid(`ENGINES_READY`),\n      timestamp: joi.string().required()\n    }), joi.object({\n      type: joi.string().required().valid(`GATSBY_CONFIG_KEYS`),\n      payload: joi.object().required(),\n      timestamp: joi.string().required()\n    }), joi.object({\n      type: joi.string().required().valid(`RENDER_PAGE_TREE`),\n      payload: joi.object(),\n      timestamp: joi.string().required()\n    }));\n    const eventSchema = joi.object({\n      type: joi.string().required().valid(`LOG_ACTION`),\n      action: actionSchema\n    });\n    events.forEach(event => {\n      expect(event).toMatchSchema(eventSchema);\n    });\n  });","file":"to-do.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"asserts all activities that started actually ended","suites":[],"updatePoint":{"line":125,"column":56,"index":4237},"line":125,"code":"  it(`asserts all activities that started actually ended`, () => {\n    const activityStartEventUuids = events.filter(event => event.action.type === `ACTIVITY_START`).map(event => event.action.payload.uuid);\n    const activityEndEventUuids = events.filter(event => event.action.type === `ACTIVITY_END`).map(event => event.action.payload.uuid);\n\n    // const groupedActivities = groupBy(\n    //   events.filter(\n    //     event =>\n    //       event.action.type === `ACTIVITY_START` ||\n    //       event.action.type === `ACTIVITY_END` ||\n    //       event.action.type === `ACTIVITY_UPDATE` ||\n    //       event.action.type === `ACTIVITY_PENDING` ||\n    //       event.action.type === `ACTIVITY_CANCEL`\n    //   ),\n    //   event => event.action.payload.uuid\n    // )\n\n    // const unresolvedActivities = filter(\n    //   groupedActivities,\n    //   (events, activityUuid) =>\n    //     !(\n    //       events.filter(event => event.action.type === `ACTIVITY_START`)\n    //         .length === 1 &&\n    //       events.filter(event => event.action.type === `ACTIVITY_END`)\n    //         .length === 1\n    //     )\n    // )\n\n    // console.log(inspect(unresolvedActivities, true, null))\n\n    // We use a Set here because order of some activities ending might be different\n    expect(new Set(activityStartEventUuids)).toEqual(new Set(activityEndEventUuids));\n  });","file":"to-do.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emit initial SET_STATUS with IN_PROGRESS - very first message","suites":[],"updatePoint":{"line":160,"column":67,"index":5690},"line":160,"code":"  it(`emit initial SET_STATUS with IN_PROGRESS - very first message`, () => {\n    const event = first(events);\n    expect(event).toHaveProperty(`action.type`, `SET_STATUS`);\n    expect(event).toHaveProperty(`action.payload`, `IN_PROGRESS`);\n  });","file":"to-do.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emit final SET_STATUS with SUCCESS - last message","suites":[],"updatePoint":{"line":165,"column":55,"index":5925},"line":165,"code":"  it(`emit final SET_STATUS with SUCCESS - last message`, () => {\n    const event = last(events);\n    expect(event).toHaveProperty(`action.type`, `SET_STATUS`);\n    expect(event).toHaveProperty(`action.payload`, `SUCCESS`);\n  });","file":"to-do.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"it emits just 2 SET_STATUS","suites":[],"line":172,"code":"  it.skip(`it emits just 2 SET_STATUS`, () => {","file":"to-do.js","skipped":true,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emit initial SET_STATUS with IN_PROGRESS - very first message","suites":[],"updatePoint":{"line":185,"column":67,"index":6955},"line":185,"code":"  it(`emit initial SET_STATUS with IN_PROGRESS - very first message`, () => {\n    const event = first(events);\n    expect(event).toHaveProperty(`action.type`, `SET_STATUS`);\n    expect(event).toHaveProperty(`action.payload`, `IN_PROGRESS`);\n  });","file":"to-do.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"it emits just 2 SET_STATUS","suites":[],"line":192,"code":"  it.skip(`it emits just 2 SET_STATUS`, () => {","file":"to-do.js","skipped":true,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emit final SET_STATUS with FAILED - last message","suites":["develop","work finishes with FAILED","called with reporter.panic"],"updatePoint":{"line":220,"column":58,"index":8496},"line":220,"code":"      it(`emit final SET_STATUS with FAILED - last message`, () => {\n        const event = last(events);\n        expect(event).toHaveProperty(`action.type`, `SET_STATUS`);\n        expect(event).toHaveProperty(`action.payload`, `FAILED`);\n      });","file":"to-do.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emit final SET_STATUS with FAILED - last message","suites":["develop","work finishes with FAILED","unhandledRejection"],"updatePoint":{"line":237,"column":58,"index":9151},"line":237,"code":"      it(`emit final SET_STATUS with FAILED - last message`, () => {\n        const event = last(events);\n        expect(event).toHaveProperty(`action.type`, `SET_STATUS`);\n        expect(event).toHaveProperty(`action.payload`, `FAILED`);\n      });","file":"to-do.js","skipped":true,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emit final SET_STATUS with FAILED - last message","suites":["develop","work finishes with FAILED","process.exit"],"updatePoint":{"line":251,"column":58,"index":9654},"line":251,"code":"      it(`emit final SET_STATUS with FAILED - last message`, () => {\n        const event = last(events);\n        expect(event).toHaveProperty(`action.type`, `SET_STATUS`);\n        expect(event).toHaveProperty(`action.payload`, `FAILED`);\n      });","file":"to-do.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emit final SET_STATUS with INTERRUPTED - last message","suites":["develop","work finishes with FAILED","process.kill"],"updatePoint":{"line":274,"column":63,"index":10472},"line":274,"code":"      it(`emit final SET_STATUS with INTERRUPTED - last message`, () => {\n        const event = last(events);\n        expect(event).toHaveProperty(`action.type`, `SET_STATUS`);\n        expect(event).toHaveProperty(`action.payload`, `INTERRUPTED`);\n      });","file":"to-do.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emit final SET_STATUS with FAILED - last message","suites":["build","work finishes with FAILED","called with reporter.panic"],"updatePoint":{"line":469,"column":58,"index":16239},"line":469,"code":"      it(`emit final SET_STATUS with FAILED - last message`, () => {\n        const event = last(events);\n        expect(event).toHaveProperty(`action.type`, `SET_STATUS`);\n        expect(event).toHaveProperty(`action.payload`, `FAILED`);\n      });","file":"to-do.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emit final SET_STATUS with FAILED - last message","suites":["build","work finishes with FAILED","unhandledRejection"],"updatePoint":{"line":498,"column":58,"index":17229},"line":498,"code":"      it(`emit final SET_STATUS with FAILED - last message`, () => {\n        const event = last(events);\n        expect(event).toHaveProperty(`action.type`, `SET_STATUS`);\n        expect(event).toHaveProperty(`action.payload`, `FAILED`);\n      });","file":"to-do.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emit final SET_STATUS with FAILED - last message","suites":["build","work finishes with FAILED","process.exit"],"updatePoint":{"line":527,"column":58,"index":18206},"line":527,"code":"      it(`emit final SET_STATUS with FAILED - last message`, () => {\n        const event = last(events);\n        expect(event).toHaveProperty(`action.type`, `SET_STATUS`);\n        expect(event).toHaveProperty(`action.payload`, `FAILED`);\n      });","file":"to-do.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"emit final SET_STATUS with INTERRUPTED - last message","suites":["build","work finishes with FAILED","process.kill"],"updatePoint":{"line":562,"column":63,"index":19414},"line":562,"code":"      it(`emit final SET_STATUS with INTERRUPTED - last message`, () => {\n        const event = last(events);\n        expect(event).toHaveProperty(`action.type`, `SET_STATUS`);\n        expect(event).toHaveProperty(`action.payload`, `INTERRUPTED`);\n      });","file":"to-do.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"Errors on local plugins","suites":["Validate Plugin Options"],"updatePoint":{"line":31,"column":29,"index":901},"line":31,"code":"  it(`Errors on local plugins`, () => {\n    expect(events).toEqual(expect.arrayContaining([expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `SET_STATUS`,\n        payload: `FAILED`\n      })\n    })]));\n    expect(events).toEqual(expect.arrayContaining([\n    // Local plugin with require.resolve\n    expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `LOG`,\n        payload: expect.objectContaining({\n          level: `ERROR`,\n          category: `USER`,\n          context: expect.objectContaining({\n            pluginName: expect.stringContaining(\"integration-tests/structured-logging/local-plugin-with-path/index.js\"),\n            validationErrors: expect.arrayContaining([{\n              context: {\n                key: \"required\",\n                label: \"required\"\n              },\n              message: '\"required\" is required',\n              path: [\"required\"],\n              type: \"any.required\"\n            }, {\n              context: {\n                key: \"optionalString\",\n                label: \"optionalString\",\n                value: 1234\n              },\n              message: '\"optionalString\" must be a string',\n              path: [\"optionalString\"],\n              type: \"string.base\"\n            }])\n          }),\n          code: `11331`,\n          type: `API.NODE.VALIDATION`\n        })\n      })\n    }),\n    // Local plugin with name in gatsby-config\n    expect.objectContaining({\n      type: `LOG_ACTION`,\n      action: expect.objectContaining({\n        type: `LOG`,\n        payload: expect.objectContaining({\n          level: `ERROR`,\n          category: `USER`,\n          context: expect.objectContaining({\n            pluginName: \"local-plugin\",\n            validationErrors: expect.arrayContaining([{\n              context: {\n                key: \"required\",\n                label: \"required\"\n              },\n              message: '\"required\" is required',\n              path: [\"required\"],\n              type: \"any.required\"\n            }, {\n              context: {\n                key: \"optionalString\",\n                label: \"optionalString\",\n                value: 1234\n              },\n              message: '\"optionalString\" must be a string',\n              path: [\"optionalString\"],\n              type: \"string.base\"\n            }])\n          }),\n          code: `11331`,\n          type: `API.NODE.VALIDATION`\n        })\n      })\n    })]));\n  });","file":"validate-options.js","skipped":false,"dir":"integration-tests/structured-logging/__tests__"},{"name":"should display index page","suites":["Basics"],"updatePoint":{"line":8,"column":31,"index":290},"line":8,"code":"  it('should display index page', () => {\n    cy.get('h1').should('have.text', title);\n    cy.title().should('eq', 'Adapters E2E');\n  });","file":"adapters/cypress/e2e/basics.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should serve assets from \"static\" folder","suites":["Basics"],"updatePoint":{"line":13,"column":46,"index":497},"line":13,"code":"  it('should serve assets from \"static\" folder', () => {\n    cy.wait(\"@static-folder-image\").should(req => {\n      expect(req.response.statusCode).to.be.gte(200).and.lt(400);\n    });\n    cy.get('[alt=\"Gatsby Monogram Logo\"]').should('be.visible');\n  });","file":"adapters/cypress/e2e/basics.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should serve assets imported through webpack","suites":["Basics"],"updatePoint":{"line":19,"column":50,"index":755},"line":19,"code":"  it('should serve assets imported through webpack', () => {\n    cy.wait(\"@img-import\").should(req => {\n      expect(req.response.statusCode).to.be.gte(200).and.lt(400);\n    });\n    cy.get('[alt=\"Gatsby Astronaut\"]').should('be.visible');\n  });","file":"adapters/cypress/e2e/basics.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should show custom 404 page on invalid URL","suites":["Basics"],"updatePoint":{"line":25,"column":48,"index":998},"line":25,"code":"  it(`should show custom 404 page on invalid URL`, () => {\n    cy.visit(`/non-existent-page`, {\n      failOnStatusCode: false\n    });\n    cy.get('h1').should('have.text', 'Page not found');\n  });","file":"adapters/cypress/e2e/basics.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should apply CSS","suites":["Basics"],"updatePoint":{"line":31,"column":22,"index":1168},"line":31,"code":"  it('should apply CSS', () => {\n    cy.get(`h1`).should(`have.css`, `color`, `rgb(21, 21, 22)`);\n  });","file":"adapters/cypress/e2e/basics.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should work correctly","suites":["Deferred Static Generation (DSG)"],"updatePoint":{"line":3,"column":27,"index":122},"line":3,"code":"  it(\"should work correctly\", () => {\n    cy.visit(\"/routes/dsg/static\").waitForRouteChange();\n    cy.get(\"h1\").contains(\"DSG\");\n  });","file":"adapters/cypress/e2e/dsg.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should work with page queries","suites":["Deferred Static Generation (DSG)"],"updatePoint":{"line":7,"column":35,"index":265},"line":7,"code":"  it(\"should work with page queries\", () => {\n    cy.visit(\"/routes/dsg/graphql-query\").waitForRouteChange();\n    cy.get(`[data-testid=\"title\"]`).should(\"have.text\", title);\n  });","file":"adapters/cypress/e2e/dsg.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should redirect from non-existing page to existing","suites":["Redirects"],"updatePoint":{"line":12,"column":56,"index":416},"line":12,"code":"  it(\"should redirect from non-existing page to existing\", () => {\n    cy.visit(applyTrailingSlashOption(`/redirect`, TRAILING_SLASH), {\n      failOnStatusCode: false\n    }).waitForRouteChange().assertRoute(applyTrailingSlashOption(`/routes/redirect/hit`, TRAILING_SLASH));\n    cy.get(`h1`).should(`have.text`, `Hit`);\n  });","file":"adapters/cypress/e2e/redirects.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should respect that pages take precedence over redirects","suites":["Redirects"],"updatePoint":{"line":18,"column":62,"index":747},"line":18,"code":"  it(\"should respect that pages take precedence over redirects\", () => {\n    cy.visit(applyTrailingSlashOption(`/routes/redirect/existing`, TRAILING_SLASH), {\n      failOnStatusCode: false\n    }).waitForRouteChange().assertRoute(applyTrailingSlashOption(`/routes/redirect/existing`, TRAILING_SLASH));\n    cy.get(`h1`).should(`have.text`, `Existing`);\n  });","file":"adapters/cypress/e2e/redirects.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should support hash parameter on direct visit","suites":["Redirects"],"updatePoint":{"line":24,"column":51,"index":1093},"line":24,"code":"  it(\"should support hash parameter on direct visit\", () => {\n    cy.visit(applyTrailingSlashOption(`/redirect`, TRAILING_SLASH) + `#anchor`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, applyTrailingSlashOption(`/routes/redirect/hit`, TRAILING_SLASH));\n    cy.location(`hash`).should(`equal`, `#anchor`);\n    cy.location(`search`).should(`equal`, ``);\n  });","file":"adapters/cypress/e2e/redirects.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should support search parameter on direct visit","suites":["Redirects"],"updatePoint":{"line":32,"column":53,"index":1514},"line":32,"code":"  it(\"should support search parameter on direct visit\", () => {\n    cy.visit(applyTrailingSlashOption(`/redirect`, TRAILING_SLASH) + `?query_param=hello`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, applyTrailingSlashOption(`/routes/redirect/hit`, TRAILING_SLASH));\n    cy.location(`hash`).should(`equal`, ``);\n    cy.location(`search`).should(`equal`, `?query_param=hello`);\n  });","file":"adapters/cypress/e2e/redirects.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should support search & hash parameter on direct visit","suites":["Redirects"],"updatePoint":{"line":40,"column":60,"index":1964},"line":40,"code":"  it(\"should support search & hash parameter on direct visit\", () => {\n    cy.visit(applyTrailingSlashOption(`/redirect`, TRAILING_SLASH) + `?query_param=hello#anchor`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, applyTrailingSlashOption(`/routes/redirect/hit`, TRAILING_SLASH));\n    cy.location(`hash`).should(`equal`, `#anchor`);\n    cy.location(`search`).should(`equal`, `?query_param=hello`);\n  });","file":"adapters/cypress/e2e/redirects.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should work correctly","suites":["Slices"],"updatePoint":{"line":3,"column":27,"index":106},"line":3,"code":"  it(\"should work correctly\", () => {\n    cy.visit('/').waitForRouteChange();\n    cy.get(`footer`).should(\"have.text\", siteDescription);\n  });","file":"adapters/cypress/e2e/slices.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"direct visit no query params ()","suites":["Server Side Rendering (SSR)"],"updatePoint":{"line":4,"column":50,"index":179},"line":4,"code":"  it(`direct visit no query params (${staticPath})`, () => {\n    cy.visit(staticPath).waitForRouteChange();\n    cy.get(`[data-testid=\"query\"]`).contains(`{}`);\n    cy.get(`[data-testid=\"params\"]`).contains(`{}`);\n  });","file":"adapters/cypress/e2e/ssr.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"direct visit with query params ()","suites":["Server Side Rendering (SSR)"],"updatePoint":{"line":9,"column":52,"index":400},"line":9,"code":"  it(`direct visit with query params (${staticPath})`, () => {\n    cy.visit(staticPath + `?foo=bar`).waitForRouteChange();\n    cy.get(`[data-testid=\"query\"]`).contains(`{\"foo\":\"bar\"}`);\n    cy.get(`[data-testid=\"params\"]`).contains(`{}`);\n  });","file":"adapters/cypress/e2e/ssr.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"direct visit no query params ()","suites":["Server Side Rendering (SSR)"],"updatePoint":{"line":14,"column":49,"index":642},"line":14,"code":"  it(`direct visit no query params (${paramPath})`, () => {\n    cy.visit(paramPath + `/foo`).waitForRouteChange();\n    cy.get(`[data-testid=\"query\"]`).contains(`{}`);\n    cy.get(`[data-testid=\"params\"]`).contains(`{\"param\":\"foo\"}`);\n  });","file":"adapters/cypress/e2e/ssr.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"direct visit with query params ()","suites":["Server Side Rendering (SSR)"],"updatePoint":{"line":19,"column":51,"index":883},"line":19,"code":"  it(`direct visit with query params (${paramPath})`, () => {\n    cy.visit(paramPath + `/foo` + `?foo=bar`).waitForRouteChange();\n    cy.get(`[data-testid=\"query\"]`).contains(`{\"foo\":\"bar\"}`);\n    cy.get(`[data-testid=\"params\"]`).contains(`{\"param\":\"foo\"}`);\n  });","file":"adapters/cypress/e2e/ssr.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should display custom 500 page","suites":["Server Side Rendering (SSR)"],"updatePoint":{"line":24,"column":36,"index":1133},"line":24,"code":"  it(`should display custom 500 page`, () => {\n    const errorPath = `/routes/ssr/error-path`;\n    cy.visit(errorPath, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, errorPath).get(`h1`).should(`have.text`, `INTERNAL SERVER ERROR`);\n  });","file":"adapters/cypress/e2e/ssr.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should work when using Gatsby Link (without slash)","suites":["trailingSlash"],"updatePoint":{"line":11,"column":58,"index":435},"line":11,"code":"    it(\"should work when using Gatsby Link (without slash)\", () => {\n      cy.visit('/').waitForRouteChange();\n      cy.get(`[data-testid=\"static-without-slash\"]`).click().waitForRouteChange().assertRoute(applyTrailingSlashOption(`/routes/static`, TRAILING_SLASH));\n    });","file":"adapters/cypress/e2e/trailing-slash.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should work when using Gatsby Link (with slash)","suites":["trailingSlash"],"updatePoint":{"line":15,"column":55,"index":706},"line":15,"code":"    it(\"should work when using Gatsby Link (with slash)\", () => {\n      cy.visit('/').waitForRouteChange();\n      cy.get(`[data-testid=\"static-with-slash\"]`).click().waitForRouteChange().assertRoute(applyTrailingSlashOption(`/routes/static`, TRAILING_SLASH));\n    });","file":"adapters/cypress/e2e/trailing-slash.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should work on direct visit (with other setting)","suites":["trailingSlash"],"updatePoint":{"line":19,"column":56,"index":975},"line":19,"code":"    it(\"should work on direct visit (with other setting)\", () => {\n      const destination = applyTrailingSlashOption(\"/routes/static\", TRAILING_SLASH);\n      const inverse = TRAILING_SLASH === `always` ? \"/routes/static\" : \"/routes/static/\";\n      assertPageVisits([{\n        path: destination,\n        status: 200\n      }, {\n        path: inverse,\n        status: 301,\n        destinationPath: destination\n      }]);\n      cy.visit(inverse).waitForRouteChange().assertRoute(applyTrailingSlashOption(`/routes/static`, TRAILING_SLASH));\n    });","file":"adapters/cypress/e2e/trailing-slash.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"should work on direct visit (with current setting)","suites":["trailingSlash"],"updatePoint":{"line":32,"column":58,"index":1522},"line":32,"code":"    it(\"should work on direct visit (with current setting)\", () => {\n      assertPageVisits([{\n        path: applyTrailingSlashOption(\"/routes/static\", TRAILING_SLASH),\n        status: 200\n      }]);\n      cy.visit(applyTrailingSlashOption(\"/routes/static\", TRAILING_SLASH)).waitForRouteChange().assertRoute(applyTrailingSlashOption(`/routes/static`, TRAILING_SLASH));\n    });","file":"adapters/cypress/e2e/trailing-slash.cy.ts","skipped":false,"dir":"e2e-tests"},{"name":"boolean: No","suites":["boolean"],"updatePoint":{"line":5,"column":17,"index":120},"line":5,"code":"  it(`boolean: No`, () => {\n    cy.get('[data-cy-id=\"default-boolean-no\"] [data-cy-value]').should(\"have.text\", \"false\");\n  });","file":"contentful/cypress/integration/boolean.js","skipped":false,"dir":"e2e-tests"},{"name":"boolean: Null","suites":["boolean"],"updatePoint":{"line":8,"column":19,"index":250},"line":8,"code":"  it(`boolean: Null`, () => {\n    cy.get('[data-cy-id=\"default-boolean-null\"] [data-cy-value]').should(\"have.text\", \"null\");\n  });","file":"contentful/cypress/integration/boolean.js","skipped":false,"dir":"e2e-tests"},{"name":"boolean: Yes","suites":["boolean"],"updatePoint":{"line":11,"column":18,"index":380},"line":11,"code":"  it(`boolean: Yes`, () => {\n    cy.get('[data-cy-id=\"default-boolean-yes\"] [data-cy-value]').should(\"have.text\", \"true\");\n  });","file":"contentful/cypress/integration/boolean.js","skipped":false,"dir":"e2e-tests"},{"name":"boolean localized: English","suites":["boolean localized"],"updatePoint":{"line":19,"column":32,"index":639},"line":19,"code":"  it(`boolean localized: English`, () => {\n    cy.get('[data-cy-id=\"english-boolean-localized\"] [data-cy-value]').should(\"have.text\", \"true\");\n  });","file":"contentful/cypress/integration/boolean.js","skipped":false,"dir":"e2e-tests"},{"name":"boolean localized: German","suites":["boolean localized"],"updatePoint":{"line":22,"column":31,"index":787},"line":22,"code":"  it(`boolean localized: German`, () => {\n    cy.get('[data-cy-id=\"german-boolean-localized\"] [data-cy-value]').should(\"have.text\", \"false\");\n  });","file":"contentful/cypress/integration/boolean.js","skipped":false,"dir":"e2e-tests"},{"name":"content-reference-many-2nd-level-loop","suites":["content-reference"],"updatePoint":{"line":5,"column":43,"index":166},"line":5,"code":"  it(`content-reference-many-2nd-level-loop`, () => {\n    cy.get('[data-cy-id=\"default-content-reference-many-2nd-level-loop\"]').snapshot();\n  });","file":"contentful/cypress/integration/content-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"content-reference-many-loop-a-greater-b","suites":["content-reference"],"updatePoint":{"line":8,"column":45,"index":315},"line":8,"code":"  it(`content-reference-many-loop-a-greater-b`, () => {\n    cy.get('[data-cy-id=\"default-content-reference-many-loop-a-greater-b\"]').snapshot();\n  });","file":"contentful/cypress/integration/content-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"content-reference-many-loop-b-greater-a","suites":["content-reference"],"updatePoint":{"line":11,"column":45,"index":466},"line":11,"code":"  it(`content-reference-many-loop-b-greater-a`, () => {\n    cy.get('[data-cy-id=\"default-content-reference-many-loop-b-greater-a\"]').snapshot();\n  });","file":"contentful/cypress/integration/content-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"content-reference-many-self-reference","suites":["content-reference"],"updatePoint":{"line":14,"column":43,"index":615},"line":14,"code":"  it(`content-reference-many-self-reference`, () => {\n    cy.get('[data-cy-id=\"default-content-reference-many-self-reference\"]').snapshot();\n  });","file":"contentful/cypress/integration/content-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"content-reference-one","suites":["content-reference"],"updatePoint":{"line":17,"column":27,"index":746},"line":17,"code":"  it(`content-reference-one`, () => {\n    cy.get('[data-cy-id=\"default-content-reference-one\"]').snapshot();\n  });","file":"contentful/cypress/integration/content-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"content-reference-one-loop-a-greater-b","suites":["content-reference"],"updatePoint":{"line":20,"column":44,"index":878},"line":20,"code":"  it(`content-reference-one-loop-a-greater-b`, () => {\n    cy.get('[data-cy-id=\"default-content-reference-one-loop-a-greater-b\"]').snapshot();\n  });","file":"contentful/cypress/integration/content-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"content-reference-one-loop-b-greater-a","suites":["content-reference"],"updatePoint":{"line":23,"column":44,"index":1027},"line":23,"code":"  it(`content-reference-one-loop-b-greater-a`, () => {\n    cy.get('[data-cy-id=\"default-content-reference-one-loop-b-greater-a\"]').snapshot();\n  });","file":"contentful/cypress/integration/content-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"content-reference-one-self-reference","suites":["content-reference"],"updatePoint":{"line":26,"column":42,"index":1174},"line":26,"code":"  it(`content-reference-one-self-reference`, () => {\n    cy.get('[data-cy-id=\"default-content-reference-one-self-reference\"]').snapshot();\n  });","file":"contentful/cypress/integration/content-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"english-content-reference-one-localized","suites":["content-reference localized"],"updatePoint":{"line":34,"column":45,"index":1458},"line":34,"code":"  it(`english-content-reference-one-localized`, () => {\n    cy.get('[data-cy-id=\"english-content-reference-one-localized\"]').snapshot();\n  });","file":"contentful/cypress/integration/content-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"english-content-reference-many-localized","suites":["content-reference localized"],"updatePoint":{"line":37,"column":46,"index":1602},"line":37,"code":"  it(`english-content-reference-many-localized`, () => {\n    cy.get('[data-cy-id=\"english-content-reference-many-localized\"]').snapshot();\n  });","file":"contentful/cypress/integration/content-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"german-content-reference-one-localized","suites":["content-reference localized"],"updatePoint":{"line":40,"column":44,"index":1745},"line":40,"code":"  it(`german-content-reference-one-localized`, () => {\n    cy.get('[data-cy-id=\"german-content-reference-one-localized\"]').snapshot();\n  });","file":"contentful/cypress/integration/content-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"german-content-reference-many-localized","suites":["content-reference localized"],"updatePoint":{"line":43,"column":45,"index":1887},"line":43,"code":"  it(`german-content-reference-many-localized`, () => {\n    cy.get('[data-cy-id=\"german-content-reference-many-localized\"]').snapshot();\n  });","file":"contentful/cypress/integration/content-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"date: Date only","suites":["date"],"updatePoint":{"line":5,"column":21,"index":118},"line":5,"code":"  it(`date: Date only`, () => {\n    cy.get('[data-cy-id=\"date-date-only\"]').within(() => {\n      cy.get(`[data-cy-value]`).should(\"have.text\", \"2021-04-20\");\n      cy.get(`[data-cy-value-formatted]`).should(\"have.text\", \"20.4.2021\");\n    });\n  });","file":"contentful/cypress/integration/date.js","skipped":false,"dir":"e2e-tests"},{"name":"date: Date and Time","suites":["date"],"updatePoint":{"line":11,"column":25,"index":370},"line":11,"code":"  it(`date: Date and Time`, () => {\n    cy.get('[data-cy-id=\"date-date-and-time\"]').within(() => {\n      cy.get(`[data-cy-value]`).should(\"have.text\", \"2021-04-20T16:20\");\n      cy.get(`[data-cy-value-formatted]`).should(\"have.text\", \"20.4.2021 - 04:20\");\n    });\n  });","file":"contentful/cypress/integration/date.js","skipped":false,"dir":"e2e-tests"},{"name":"date: Date and Time with Timezone","suites":["date"],"updatePoint":{"line":17,"column":39,"index":654},"line":17,"code":"  it(`date: Date and Time with Timezone`, () => {\n    cy.get('[data-cy-id=\"date-date-and-time-with-timezone\"]').within(() => {\n      cy.get(`[data-cy-value]`).should(\"have.text\", \"2021-04-20T04:20+10:30\");\n      cy.get(`[data-cy-value-formatted]`).should(\"have.text\", \"19.4.2021 - 05:50 (UTC)\");\n    });\n  });","file":"contentful/cypress/integration/date.js","skipped":false,"dir":"e2e-tests"},{"name":"date: Localization","suites":["date"],"updatePoint":{"line":23,"column":24,"index":949},"line":23,"code":"  it(`date: Localization`, () => {\n    cy.get('[data-cy-id=\"date-english\"]').within(() => {\n      cy.get(`[data-cy-value]`).should(\"have.text\", \"2021-05-24T12:45+00:00\");\n      cy.get(`[data-cy-value-formatted]`).should(\"have.text\", \"24.5.2021 - 12:45:00\");\n    });\n    cy.get('[data-cy-id=\"date-german\"]').within(() => {\n      cy.get(`[data-cy-value]`).should(\"have.text\", \"2021-05-23T16:20+02:00\");\n      cy.get(`[data-cy-value-formatted]`).should(\"have.text\", \"23.5.2021 - 14:20:00\");\n    });\n  });","file":"contentful/cypress/integration/date.js","skipped":false,"dir":"e2e-tests"},{"name":"renders dynamic image from static directory","suites":["downloadLocal"],"updatePoint":{"line":5,"column":49,"index":165},"line":5,"code":"  it(`renders dynamic image from static directory`, () => {\n    cy.get(\"#gatsby-plugin-image-download-local\").should(\"be.visible\");\n    cy.get(\"#gatsby-plugin-image-download-local\").should(\"have.attr\", \"srcset\");\n    cy.get(\"#gatsby-plugin-image-download-local\").should(\"have.attr\", \"src\").should(\"match\", /^\\/static/);\n  });","file":"contentful/cypress/integration/download-local.js","skipped":false,"dir":"e2e-tests"},{"name":"should work","suites":["Engines (SSR)"],"updatePoint":{"line":5,"column":17,"index":122},"line":5,"code":"  it(`should work`, () => {\n    cy.get('[data-cy-id=\"getserverdata-result\"]').should(\"have.text\", \"getServerData used in contentful E2E test\");\n  });","file":"contentful/cypress/integration/engines.js","skipped":false,"dir":"e2e-tests"},{"name":"creates a proper gatsby image cdn url","suites":["gatsby-image-cdn urls"],"updatePoint":{"line":11,"column":43,"index":242},"line":11,"code":"  it(`creates a proper gatsby image cdn url`, testConfig, () => {\n    const type = \"gatsby-image-cdn\";\n    cy.get(`[data-cy=\"${type}\"] .gatsby-image-wrapper > picture > img`).then(async $imgs => {\n      let i = 0;\n      for (const $img of $imgs) {\n        cy.wrap($img).should(\"be.visible\");\n        const res = await fetch($img.currentSrc, {\n          method: \"HEAD\"\n        });\n        expect(res.ok).to.be.true;\n        cy.wrap($img).matchImageSnapshot(`${type}-${i++}`);\n      }\n    });\n  });","file":"contentful/cypress/integration/gatsby-image-cdn.js","skipped":false,"dir":"e2e-tests"},{"name":"constrained","suites":["gatsby-plugin-image"],"updatePoint":{"line":53,"column":17,"index":1606},"line":53,"code":"  it(`constrained`, testConfig, () => testGatsbyPluginImage(`constrained`, hasNoPlaceholder));","file":"contentful/cypress/integration/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"full-width","suites":["gatsby-plugin-image"],"updatePoint":{"line":54,"column":16,"index":1700},"line":54,"code":"  it(`full-width`, testConfig, () => testGatsbyPluginImage(`full-width`, hasNoPlaceholder));","file":"contentful/cypress/integration/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"fixed","suites":["gatsby-plugin-image"],"updatePoint":{"line":55,"column":11,"index":1788},"line":55,"code":"  it(`fixed`, testConfig, () => testGatsbyPluginImage(`fixed`, hasNoPlaceholder));","file":"contentful/cypress/integration/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"dominant-color","suites":["gatsby-plugin-image"],"updatePoint":{"line":56,"column":20,"index":1880},"line":56,"code":"  it(`dominant-color`, testConfig, () => testGatsbyPluginImage(`dominant-color`, hasColorPlaceholder));","file":"contentful/cypress/integration/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"traced","suites":["gatsby-plugin-image"],"updatePoint":{"line":57,"column":12,"index":1976},"line":57,"code":"  it(`traced`, testConfig, () => testGatsbyPluginImage(`traced`, hasColorPlaceholder));","file":"contentful/cypress/integration/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"blurred","suites":["gatsby-plugin-image"],"updatePoint":{"line":58,"column":13,"index":2065},"line":58,"code":"  it(`blurred`, testConfig, () => testGatsbyPluginImage(`blurred`, hasBase64Placeholder));","file":"contentful/cypress/integration/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"Custom Image Formats","suites":["gatsby-plugin-image"],"updatePoint":{"line":59,"column":26,"index":2169},"line":59,"code":"  it(`Custom Image Formats`, testConfig, () => {\n    cy.get(`[data-cy=\"customImageFormats\"] picture source[type=\"image/webp\"]`).invoke(`attr`, `srcset`).should(\"contain\", \"fm=webp\");\n    cy.get(`[data-cy=\"customImageFormats\"] picture source[type=\"image/avif\"]`).invoke(`attr`, `srcset`).should(\"contain\", \"fm=avif\");\n    cy.get(`[data-cy=\"customImageFormats\"] picture img`).invoke(`attr`, `srcset`).should(\"not.contain\", \"fm=webp\").should(\"not.contain\", \"fm=avif\");\n  });","file":"contentful/cypress/integration/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"sqip","suites":["gatsby-plugin-image"],"updatePoint":{"line":64,"column":10,"index":2625},"line":64,"code":"  it(`sqip`, testConfig, () => testGatsbyPluginImage(`sqip`, hasSVGPlaceholder));","file":"contentful/cypress/integration/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"english","suites":["gatsby-plugin-image"],"updatePoint":{"line":65,"column":13,"index":2710},"line":65,"code":"  it(`english`, testConfig, () => {\n    testGatsbyPluginImage(`english`, hasNoPlaceholder);\n    cy.get(`[data-cy=\"english\"] p strong`).should(\"have.text\", \"Locale - American English (png)\");\n  });","file":"contentful/cypress/integration/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"german","suites":["gatsby-plugin-image"],"updatePoint":{"line":69,"column":12,"index":2906},"line":69,"code":"  it(`german`, testConfig, () => {\n    testGatsbyPluginImage(`german`, hasNoPlaceholder);\n    cy.get(`[data-cy=\"german\"] p strong`).should(\"have.text\", \"Locale - German (png)\");\n  });","file":"contentful/cypress/integration/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"json: Simple","suites":["json"],"updatePoint":{"line":5,"column":18,"index":115},"line":5,"code":"  it(`json: Simple`, () => {\n    cy.get('[data-cy-id=\"simple\"]').within(() => {\n      cy.get(`[data-cy-value-name]`).should(\"have.text\", \"Name: John\");\n      cy.get(`[data-cy-value-city]`).should(\"have.text\", \"City: New York\");\n      cy.get(`[data-cy-value-age]`).should(\"have.text\", \"Age: 31\");\n    });\n  });","file":"contentful/cypress/integration/json.js","skipped":false,"dir":"e2e-tests"},{"name":"json: Complex","suites":["json"],"updatePoint":{"line":12,"column":19,"index":426},"line":12,"code":"  it(`json: Complex`, () => {\n    cy.get('[data-cy-id=\"complex\"] > div:first-child').snapshot();\n    cy.get('[data-cy-id=\"complex\"] > div:last-child').snapshot();\n  });","file":"contentful/cypress/integration/json.js","skipped":false,"dir":"e2e-tests"},{"name":"json: Localized","suites":["json"],"updatePoint":{"line":16,"column":21,"index":597},"line":16,"code":"  it(`json: Localized`, () => {\n    cy.get('[data-cy-id=\"english\"]').within(() => {\n      cy.get(`[data-cy-value-name]`).should(\"have.text\", \"Name: John\");\n      cy.get(`[data-cy-value-city]`).should(\"have.text\", \"City: New York\");\n      cy.get(`[data-cy-value-age]`).should(\"have.text\", \"Age: 31\");\n    });\n    cy.get('[data-cy-id=\"german\"]').within(() => {\n      cy.get(`[data-cy-value-name]`).should(\"have.text\", \"Name: Max\");\n      cy.get(`[data-cy-value-city]`).should(\"have.text\", \"City: Berlin\");\n      cy.get(`[data-cy-value-age]`).should(\"have.text\", \"Age: 25\");\n    });\n  });","file":"contentful/cypress/integration/json.js","skipped":false,"dir":"e2e-tests"},{"name":"location","suites":["location"],"updatePoint":{"line":5,"column":14,"index":119},"line":5,"code":"  it(`location`, () => {\n    cy.get('[data-cy-id=\"location\"] [data-cy-value-lat]').should(\"have.text\", \"52.51627\");\n    cy.get('[data-cy-id=\"location\"] [data-cy-value-lon]').should(\"have.text\", \"13.3777\");\n  });","file":"contentful/cypress/integration/location.js","skipped":false,"dir":"e2e-tests"},{"name":"location localized","suites":["location"],"updatePoint":{"line":9,"column":24,"index":341},"line":9,"code":"  it(`location localized`, () => {\n    cy.get('[data-cy-id=\"english\"] [data-cy-value-lat]').should(\"have.text\", \"37.79176\");\n    cy.get('[data-cy-id=\"english\"] [data-cy-value-lon]').should(\"have.text\", \"-122.393\");\n    cy.get('[data-cy-id=\"german\"] [data-cy-value-lat]').should(\"have.text\", \"52.53907\");\n    cy.get('[data-cy-id=\"german\"] [data-cy-value-lon]').should(\"have.text\", \"13.38405\");\n  });","file":"contentful/cypress/integration/location.js","skipped":false,"dir":"e2e-tests"},{"name":"media-reference: many","suites":["media-reference"],"updatePoint":{"line":5,"column":27,"index":146},"line":5,"code":"  it(`media-reference: many`, () => {\n    cy.get('[data-cy-id=\"media-reference-many\"]').within(() => {\n      cy.get(\"img\").should(\"have.length\", 2).should(\"have.attr\", \"src\").should(\"match\", /^\\/\\/images\\.ctfassets\\.net/);\n    });\n  });","file":"contentful/cypress/integration/media-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"media-reference: one","suites":["media-reference"],"updatePoint":{"line":10,"column":26,"index":382},"line":10,"code":"  it(`media-reference: one`, () => {\n    cy.get('[data-cy-id=\"media-reference-one\"]').within(() => {\n      cy.get(\"img\").should(\"have.attr\", \"src\").should(\"match\", /^\\/\\/images\\.ctfassets\\.net/);\n    });\n  });","file":"contentful/cypress/integration/media-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"media-reference: many with localized field","suites":["media-reference localized"],"updatePoint":{"line":20,"column":48,"index":725},"line":20,"code":"  it(`media-reference: many with localized field`, () => {\n    cy.get('[data-cy-id=\"english-media-reference-many-localized-field\"]').snapshot();\n    cy.get('[data-cy-id=\"german-media-reference-many-localized-field\"]').snapshot();\n  });","file":"contentful/cypress/integration/media-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"media-reference: many with localized asset","suites":["media-reference localized"],"updatePoint":{"line":24,"column":48,"index":961},"line":24,"code":"  it(`media-reference: many with localized asset`, () => {\n    cy.get('[data-cy-id=\"english-media-reference-many-with-localized-asset\"]').snapshot();\n    cy.get('[data-cy-id=\"german-media-reference-many-with-localized-asset\"]').snapshot();\n  });","file":"contentful/cypress/integration/media-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"media-reference: one with localized asset","suites":["media-reference localized"],"updatePoint":{"line":28,"column":47,"index":1206},"line":28,"code":"  it(`media-reference: one with localized asset`, () => {\n    cy.get('[data-cy-id=\"english-media-reference-one-localized-asset\"]').snapshot();\n    cy.get('[data-cy-id=\"german-media-reference-one-localized-asset\"]').snapshot();\n  });","file":"contentful/cypress/integration/media-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"media-reference: one with localized field","suites":["media-reference localized"],"updatePoint":{"line":32,"column":47,"index":1439},"line":32,"code":"  it(`media-reference: one with localized field`, () => {\n    cy.get('[data-cy-id=\"english-media-reference-one-localized-field\"]').snapshot();\n    cy.get('[data-cy-id=\"german-media-reference-one-localized-field\"]').snapshot();\n  });","file":"contentful/cypress/integration/media-reference.js","skipped":false,"dir":"e2e-tests"},{"name":"number: Decimal","suites":["number"],"updatePoint":{"line":5,"column":21,"index":122},"line":5,"code":"  it(`number: Decimal`, () => {\n    cy.get('[data-cy-id=\"number-decimal\"] [data-cy-value]').should(\"have.text\", \"4.2\");\n  });","file":"contentful/cypress/integration/number.js","skipped":false,"dir":"e2e-tests"},{"name":"number: Integer","suites":["number"],"updatePoint":{"line":8,"column":21,"index":248},"line":8,"code":"  it(`number: Integer`, () => {\n    cy.get('[data-cy-id=\"number-integer\"] [data-cy-value]').should(\"have.text\", \"42\");\n  });","file":"contentful/cypress/integration/number.js","skipped":false,"dir":"e2e-tests"},{"name":"number: Decimal Localized","suites":["number"],"updatePoint":{"line":11,"column":31,"index":383},"line":11,"code":"  it(`number: Decimal Localized`, () => {\n    cy.get('[data-cy-id=\"english-number-decimal-localized\"] [data-cy-value]').should(\"have.text\", \"76.26\");\n    cy.get('[data-cy-id=\"german-number-decimal-localized\"] [data-cy-value]').should(\"have.text\", \"95.31\");\n  });","file":"contentful/cypress/integration/number.js","skipped":false,"dir":"e2e-tests"},{"name":"number: Integer Localized","suites":["number"],"updatePoint":{"line":15,"column":31,"index":646},"line":15,"code":"  it(`number: Integer Localized`, () => {\n    cy.get('[data-cy-id=\"english-number-integer-localized\"] [data-cy-value]').should(\"have.text\", \"8673000\");\n    cy.get('[data-cy-id=\"german-number-integer-localized\"] [data-cy-value]').should(\"have.text\", \"6046000\");\n  });","file":"contentful/cypress/integration/number.js","skipped":false,"dir":"e2e-tests"},{"name":"rich-text: All Features","suites":["rich-text"],"updatePoint":{"line":28,"column":29,"index":1073},"line":28,"code":"  it(`rich-text: All Features`, () => {\n    cy.get(`[data-cy-id=\"rich-text-all-features\"]`).scrollIntoView({\n      duration: 500\n    });\n    cy.wait(1000);\n    testWithGatsbyPluginImage(cy.get(`[data-cy-id=\"rich-text-all-features\"]`));\n  });","file":"contentful/cypress/integration/rich-text.js","skipped":false,"dir":"e2e-tests"},{"name":"rich-text: Basic","suites":["rich-text"],"updatePoint":{"line":35,"column":22,"index":1308},"line":35,"code":"  it(`rich-text: Basic`, () => {\n    cy.get(`[data-cy-id=\"rich-text-basic\"]`).snapshot();\n  });","file":"contentful/cypress/integration/rich-text.js","skipped":false,"dir":"e2e-tests"},{"name":"rich-text: Embedded Entry","suites":["rich-text"],"updatePoint":{"line":38,"column":31,"index":1413},"line":38,"code":"  it(`rich-text: Embedded Entry`, () => {\n    cy.get(`[data-cy-id=\"rich-text-embedded-entry\"]`).snapshot();\n  });","file":"contentful/cypress/integration/rich-text.js","skipped":false,"dir":"e2e-tests"},{"name":"rich-text: Embedded Asset","suites":["rich-text"],"updatePoint":{"line":41,"column":31,"index":1527},"line":41,"code":"  it(`rich-text: Embedded Asset`, () => {\n    cy.get(`[data-cy-id=\"rich-text-embedded-asset\"]`).scrollIntoView({\n      duration: 500\n    });\n    cy.wait(1000);\n    testWithGatsbyPluginImage(cy.get(`[data-cy-id=\"rich-text-embedded-asset\"]`));\n  });","file":"contentful/cypress/integration/rich-text.js","skipped":false,"dir":"e2e-tests"},{"name":"rich-text: Embedded Entry With Deep Reference Loop","suites":["rich-text"],"updatePoint":{"line":48,"column":56,"index":1800},"line":48,"code":"  it(`rich-text: Embedded Entry With Deep Reference Loop`, () => {\n    cy.get(`[data-cy-id=\"rich-text-embedded-entry-with-deep-reference-loop\"]`).snapshot();\n  });","file":"contentful/cypress/integration/rich-text.js","skipped":false,"dir":"e2e-tests"},{"name":"rich-text: Embedded Entry With Reference Loop","suites":["rich-text"],"updatePoint":{"line":51,"column":51,"index":1959},"line":51,"code":"  it(`rich-text: Embedded Entry With Reference Loop`, () => {\n    cy.get(`[data-cy-id=\"rich-text-embedded-entry-with-reference-loop\"]`).snapshot();\n  });","file":"contentful/cypress/integration/rich-text.js","skipped":false,"dir":"e2e-tests"},{"name":"rich-text: Inline Entry","suites":["rich-text"],"updatePoint":{"line":54,"column":29,"index":2091},"line":54,"code":"  it(`rich-text: Inline Entry`, () => {\n    cy.get(`[data-cy-id=\"rich-text-inline-entry\"]`).snapshot();\n  });","file":"contentful/cypress/integration/rich-text.js","skipped":false,"dir":"e2e-tests"},{"name":"rich-text: Inline Entry With Deep Reference Loop","suites":["rich-text"],"updatePoint":{"line":57,"column":54,"index":2226},"line":57,"code":"  it(`rich-text: Inline Entry With Deep Reference Loop`, () => {\n    cy.get(`[data-cy-id=\"rich-text-inline-entry-with-deep-reference-loop\"]`).snapshot();\n  });","file":"contentful/cypress/integration/rich-text.js","skipped":false,"dir":"e2e-tests"},{"name":"rich-text: Inline Entry With Reference Loop","suites":["rich-text"],"updatePoint":{"line":60,"column":49,"index":2381},"line":60,"code":"  it(`rich-text: Inline Entry With Reference Loop`, () => {\n    cy.get(`[data-cy-id=\"rich-text-inline-entry-with-reference-loop\"]`).snapshot();\n  });","file":"contentful/cypress/integration/rich-text.js","skipped":false,"dir":"e2e-tests"},{"name":"rich-text: Localized","suites":["rich-text"],"updatePoint":{"line":63,"column":26,"index":2508},"line":63,"code":"  it(`rich-text: Localized`, () => {\n    cy.get(`[data-cy-id=\"english-rich-text-localized\"]`).snapshot();\n    cy.get(`[data-cy-id=\"german-rich-text-localized\"]`).snapshot();\n  });","file":"contentful/cypress/integration/rich-text.js","skipped":false,"dir":"e2e-tests"},{"name":"rich-text: Tables","suites":["rich-text"],"updatePoint":{"line":67,"column":23,"index":2685},"line":67,"code":"  it(`rich-text: Tables`, () => {\n    cy.get(`[data-cy-id=\"rich-text-tables\"]`).snapshot();\n  });","file":"contentful/cypress/integration/rich-text.js","skipped":false,"dir":"e2e-tests"},{"name":"Tag list","suites":["tags"],"updatePoint":{"line":5,"column":14,"index":111},"line":5,"code":"  it(`Tag list`, () => {\n    cy.get('[data-cy-id=\"tag-numberDecimal\"] [data-cy-name]').should(\"have.text\", \"Number: Decimal\");\n    cy.get('[data-cy-id=\"tag-numberDecimal\"] [data-cy-id]').should(\"have.text\", \"numberDecimal\");\n    cy.get('[data-cy-id=\"tag-numberInteger\"] [data-cy-name]').should(\"have.text\", \"Number: Integer\");\n    cy.get('[data-cy-id=\"tag-numberInteger\"] [data-cy-id]').should(\"have.text\", \"numberInteger\");\n    cy.get('[data-cy-id^=\"tag-\"]').should(\"have.length\", 5);\n  });","file":"contentful/cypress/integration/tags.js","skipped":false,"dir":"e2e-tests"},{"name":"Filtered Entries","suites":["tags"],"updatePoint":{"line":12,"column":22,"index":611},"line":12,"code":"  it(`Filtered Entries`, () => {\n    cy.get('[data-cy-integers] [data-cy-id=\"number-integer\"]').should(\"have.length\", 1);\n    cy.get('[data-cy-integers] [data-cy-id=\"number-integer\"] [data-cy-value]').should(\"have.text\", 42);\n    cy.get('[data-cy-decimals] [data-cy-id=\"number-decimal\"]').should(\"have.length\", 1);\n    cy.get('[data-cy-decimals] [data-cy-id=\"number-decimal\"] [data-cy-value]').should(\"have.text\", 4.2);\n  });","file":"contentful/cypress/integration/tags.js","skipped":false,"dir":"e2e-tests"},{"name":"Assets","suites":["tags"],"updatePoint":{"line":18,"column":12,"index":1027},"line":18,"code":"  it(`Assets`, () => {\n    cy.get('[data-cy-assets] [data-cy-id=\"example-cat\"]').should(\"have.length\", 1);\n    cy.get('[data-cy-assets] [data-cy-id=\"example-cat\"] [data-cy-value]').should(\"contain\", \"Animal\").should(\"contain\", \"Cat\");\n    cy.get('[data-cy-assets] [data-cy-id=\"example-dog\"]').should(\"have.length\", 1);\n    cy.get('[data-cy-assets] [data-cy-id=\"example-dog\"] [data-cy-value]').should(\"contain\", \"Animal\").should(\"contain\", \"Dog\");\n  });","file":"contentful/cypress/integration/tags.js","skipped":false,"dir":"e2e-tests"},{"name":"text: Short","suites":["text"],"updatePoint":{"line":5,"column":17,"index":114},"line":5,"code":"  it(`text: Short`, () => {\n    cy.get(`[data-cy-id=\"short\"] [data-cy-value]`).should(`have.text`, `The quick brown fox jumps over the lazy dog.`);\n  });","file":"contentful/cypress/integration/text.js","skipped":false,"dir":"e2e-tests"},{"name":"text: Long Plain","suites":["text"],"updatePoint":{"line":8,"column":22,"index":273},"line":8,"code":"  it(`text: Long Plain`, () => {\n    cy.get(`[data-cy-id=\"long-plain\"] [data-cy-value]`).invoke(\"text\").then(text => {\n      expect(text.length).to.be.equal(748);\n      expect(text).to.match(/^The European languages are members of the same family. Their/);\n    });\n  });","file":"contentful/cypress/integration/text.js","skipped":false,"dir":"e2e-tests"},{"name":"text: Short List","suites":["text"],"updatePoint":{"line":14,"column":22,"index":544},"line":14,"code":"  it(`text: Short List`, () => {\n    cy.get(`[data-cy-id=\"short-list\"]`).snapshot();\n  });","file":"contentful/cypress/integration/text.js","skipped":false,"dir":"e2e-tests"},{"name":"text: Long Markdown Simple","suites":["text"],"updatePoint":{"line":17,"column":32,"index":645},"line":17,"code":"  it(`text: Long Markdown Simple`, () => {\n    cy.get(`[data-cy-id=\"long-markdown-simple\"]`).snapshot();\n  });","file":"contentful/cypress/integration/text.js","skipped":false,"dir":"e2e-tests"},{"name":"text: Long Markdown Complex","suites":["text"],"updatePoint":{"line":20,"column":33,"index":757},"line":20,"code":"  it(`text: Long Markdown Complex`, () => {\n    cy.get(`[data-cy-id=\"long-markdown-complex\"]`).snapshot();\n  });","file":"contentful/cypress/integration/text.js","skipped":false,"dir":"e2e-tests"},{"name":"text: Short Localized","suites":["text"],"updatePoint":{"line":23,"column":27,"index":864},"line":23,"code":"  it(`text: Short Localized`, () => {\n    cy.get(`[data-cy-id=\"english-short\"]`).should(\"have.text\", \"Short text\");\n    cy.get(`[data-cy-id=\"german-short\"]`).should(\"have.text\", \"Kurzer Text\");\n  });","file":"contentful/cypress/integration/text.js","skipped":false,"dir":"e2e-tests"},{"name":"text: Long Localized","suites":["text"],"updatePoint":{"line":27,"column":26,"index":1063},"line":27,"code":"  it(`text: Long Localized`, () => {\n    cy.get(`[data-cy-id=\"english-long\"]`).snapshot();\n    cy.get(`[data-cy-id=\"german-long\"]`).snapshot();\n  });","file":"contentful/cypress/integration/text.js","skipped":false,"dir":"e2e-tests"},{"name":"should initially not log to console","suites":["limited-exports-page-templates"],"updatePoint":{"line":13,"column":41,"index":575},"line":13,"code":"  it(`should initially not log to console`, () => {\n    cy.get(`@hmrConsoleLog`).should(`not.be.calledWithMatch`, /13:1 {2}warning {2}In page templates only a default export of a valid React component and the named exports of a page query, getServerData, Head or config are allowed./i);\n  });","file":"development-runtime/cypress/integration/eslint-rules/limited-exports-page-templates.js","skipped":false,"dir":"e2e-tests"},{"name":"should log warning to console for invalid export","suites":["limited-exports-page-templates"],"updatePoint":{"line":16,"column":54,"index":881},"line":16,"code":"  it(`should log warning to console for invalid export`, () => {\n    cy.exec(`npm run update -- --file src/pages/eslint-rules/limited-exports-page-templates.js --replacements \"${errorPlaceholder}:${errorReplacement}\" --exact`);\n    cy.reload();\n    cy.get(`@hmrConsoleLog`).should(`be.calledWithMatch`, /13:1 {2}warning {2}In page templates only a default export of a valid React component and the named exports of a page query, getServerData, Head or config are allowed./i);\n    cy.get(`@hmrConsoleLog`).should(`not.be.calledWithMatch`, /15:1 {2}warning {2}In page templates only a default export of a valid React component and the named exports of a page query, getServerData, Head or config are allowed./i);\n  });","file":"development-runtime/cypress/integration/eslint-rules/limited-exports-page-templates.js","skipped":false,"dir":"e2e-tests"},{"name":"should initially not log to console","suites":["no-anonymous-exports-page-templates"],"updatePoint":{"line":16,"column":41,"index":982},"line":16,"code":"  it(`should initially not log to console`, () => {\n    cy.visit(`/eslint-rules/no-anonymous-exports-page-templates`).waitForRouteChange();\n    cy.get(`@hmrConsoleLog`).should(`not.be.calledWithMatch`, /Anonymous arrow functions cause Fast Refresh to not preserve local component state./i);\n    cy.get(`@hmrConsoleLog`).should(`not.be.calledWithMatch`, /Anonymous function declarations cause Fast Refresh to not preserve local component state./i);\n  });","file":"development-runtime/cypress/integration/eslint-rules/no-anonymous-exports-page-templates.js","skipped":false,"dir":"e2e-tests"},{"name":"should log warning to console for arrow functions","suites":["no-anonymous-exports-page-templates"],"updatePoint":{"line":21,"column":55,"index":1450},"line":21,"code":"  it(`should log warning to console for arrow functions`, () => {\n    cy.visit(`/eslint-rules/no-anonymous-exports-page-templates`).waitForRouteChange();\n    cy.exec(`npm run update -- --file src/pages/eslint-rules/no-anonymous-exports-page-templates.js --replacements \"${errorPlaceholderAnonExport01}:${errorReplacementAnonExport01}\" --replacements \"${errorPlaceholderAnonExport02}:${errorReplacementAnonExport02}\" --exact`);\n    cy.reload();\n    cy.get(`@hmrConsoleLog`).should(`be.calledWithMatch`, /Anonymous arrow functions cause Fast Refresh to not preserve local component state./i);\n  });","file":"development-runtime/cypress/integration/eslint-rules/no-anonymous-exports-page-templates.js","skipped":false,"dir":"e2e-tests"},{"name":"should log warning to console for function declarations","suites":["no-anonymous-exports-page-templates"],"updatePoint":{"line":27,"column":61,"index":2053},"line":27,"code":"  it(`should log warning to console for function declarations`, () => {\n    cy.visit(`/eslint-rules/no-anonymous-exports-page-templates-function`).waitForRouteChange();\n    cy.exec(`npm run update -- --file src/pages/eslint-rules/no-anonymous-exports-page-templates-function.js --replacements \"${errorPlaceholderAnonFunction}:${errorReplacementAnonFunction}\" --exact`);\n    cy.reload();\n    cy.get(`@hmrConsoleLog`).should(`be.calledWithMatch`, /Anonymous function declarations cause Fast Refresh to not preserve local component state./i);\n  });","file":"development-runtime/cypress/integration/eslint-rules/no-anonymous-exports-page-templates.js","skipped":false,"dir":"e2e-tests"},{"name":"Focus router wrapper after navigation to regular page (from index)","suites":["focus management"],"updatePoint":{"line":2,"column":72,"index":110},"line":2,"code":"  it(`Focus router wrapper after navigation to regular page (from index)`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.changeFocus();\n    cy.assertRouterWrapperFocus(false);\n    cy.navigateAndWaitForRouteChange(`/page-2/`);\n    cy.assertRouterWrapperFocus(true);\n  });","file":"development-runtime/cypress/integration/functionality/accessibility.js","skipped":false,"dir":"e2e-tests"},{"name":"Focus router wrapper after navigation to regular page (to index)","suites":["focus management"],"updatePoint":{"line":9,"column":70,"index":388},"line":9,"code":"  it(`Focus router wrapper after navigation to regular page (to index)`, () => {\n    cy.visit(`/page-2/`).waitForRouteChange();\n    cy.changeFocus();\n    cy.assertRouterWrapperFocus(false);\n    cy.navigateAndWaitForRouteChange(`/`);\n    cy.assertRouterWrapperFocus(true);\n  });","file":"development-runtime/cypress/integration/functionality/accessibility.js","skipped":false,"dir":"e2e-tests"},{"name":"Focus router wrapper after navigation to 404","suites":["focus management"],"line":22,"code":"  it.skip(`Focus router wrapper after navigation to 404`, () => {","file":"development-runtime/cypress/integration/functionality/accessibility.js","skipped":true,"dir":"e2e-tests"},{"name":"Focus router wrapper after navigation from 404","suites":["focus management"],"line":29,"code":"  it.skip(`Focus router wrapper after navigation from 404`, () => {","file":"development-runtime/cypress/integration/functionality/accessibility.js","skipped":true,"dir":"e2e-tests"},{"name":"Focus router wrapper after navigation from one 404 path to another 404 path","suites":["focus management"],"updatePoint":{"line":38,"column":81,"index":1539},"line":38,"code":"  it(`Focus router wrapper after navigation from one 404 path to another 404 path`, () => {\n    cy.visit(`/broken-path`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n\n    // navigating to different not existing page should also trigger\n    // router wrapper focus as this is different page\n    cy.changeFocus();\n    cy.assertRouterWrapperFocus(false);\n    cy.navigateAndWaitForRouteChange(`/another-broken-path/`);\n    cy.assertRouterWrapperFocus(true);\n  });","file":"development-runtime/cypress/integration/functionality/accessibility.js","skipped":false,"dir":"e2e-tests"},{"name":"Focus router wrapper after navigation to client-only page","suites":["focus management"],"updatePoint":{"line":50,"column":63,"index":1997},"line":50,"code":"  it(`Focus router wrapper after navigation to client-only page`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.changeFocus();\n    cy.assertRouterWrapperFocus(false);\n    cy.navigateAndWaitForRouteChange(`/client-only-paths/`);\n    cy.assertRouterWrapperFocus(true);\n  });","file":"development-runtime/cypress/integration/functionality/accessibility.js","skipped":false,"dir":"e2e-tests"},{"name":"Focus router wrapper after navigation from client-only page","suites":["focus management"],"updatePoint":{"line":57,"column":65,"index":2281},"line":57,"code":"  it(`Focus router wrapper after navigation from client-only page`, () => {\n    cy.visit(`/client-only-paths/`).waitForRouteChange();\n    cy.changeFocus();\n    cy.assertRouterWrapperFocus(false);\n    cy.navigateAndWaitForRouteChange(`/`);\n    cy.assertRouterWrapperFocus(true);\n  });","file":"development-runtime/cypress/integration/functionality/accessibility.js","skipped":false,"dir":"e2e-tests"},{"name":"Focus subrouter inside client-only page","suites":["focus management"],"line":68,"code":"  it.skip(`Focus subrouter inside client-only page`, () => {","file":"development-runtime/cypress/integration/functionality/accessibility.js","skipped":true,"dir":"e2e-tests"},{"name":"Applies .babelrc","suites":["babelrc"],"updatePoint":{"line":9,"column":22,"index":181},"line":9,"code":"  it(`Applies .babelrc`, () => {\n    cy.visit(`/babelrc/base/`).waitForRouteChange();\n    cy.getTestElement(TEST_ELEMENT).invoke(`text`).should(`eq`, `babel-rc-is-used`);\n  });","file":"development-runtime/cypress/integration/functionality/babelrc.js","skipped":false,"dir":"e2e-tests"},{"name":"editing .babelrc","suites":["babelrc","hot reload"],"updatePoint":{"line":14,"column":24,"index":393},"line":14,"code":"    it(`editing .babelrc`, () => {\n      cy.visit(`/babelrc/edit/`).waitForRouteChange();\n      cy.getTestElement(TEST_ELEMENT).invoke(`text`).should(`eq`, `babel-rc-initial`);\n      cy.exec(`npm run update -- --file src/pages/babelrc/edit/.babelrc --replacements \"babel-rc-initial:babel-rc-edited\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(TEST_ELEMENT).invoke(`text`).should(`eq`, `babel-rc-edited`);\n    });","file":"development-runtime/cypress/integration/functionality/babelrc.js","skipped":false,"dir":"e2e-tests"},{"name":"adding .babelrc","suites":["babelrc","hot reload"],"updatePoint":{"line":21,"column":23,"index":819},"line":21,"code":"    it(`adding .babelrc`, () => {\n      cy.visit(`/babelrc/add/`).waitForRouteChange();\n      cy.getTestElement(TEST_ELEMENT).invoke(`text`).should(`eq`, `babel-rc-test`);\n      cy.exec(`npm run update -- --file src/pages/babelrc/add/.babelrc --file-source src/pages/babelrc/add/.babelrc-fixture`);\n\n      // babel-loader doesn't actually hot reloads itself when new .babelrc file is added\n      // this is because it registers dependency only if file already exists\n      // ( https://github.com/babel/babel-loader/blob/1669ac07ee1eed28a8e6fcacbf1c07ceb06fe053/src/index.js#L214-L216 )\n      // so to test hot-reloading here we actually have to invalidate js file, which would recompile it and discover\n      // new babelrc file\n      cy.exec(`npm run update -- --file src/pages/babelrc/add/index.js --replacements \"foo-bar:foo-bar\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(TEST_ELEMENT).invoke(`text`).should(`eq`, `babel-rc-added`);\n    });","file":"development-runtime/cypress/integration/functionality/babelrc.js","skipped":false,"dir":"e2e-tests"},{"name":"removing .babelrc","suites":["babelrc","hot reload"],"updatePoint":{"line":35,"column":25,"index":1782},"line":35,"code":"    it(`removing .babelrc`, () => {\n      cy.visit(`/babelrc/remove/`).waitForRouteChange();\n      cy.getTestElement(TEST_ELEMENT).invoke(`text`).should(`eq`, `babel-rc-will-be-deleted`);\n      cy.exec(`npm run update -- --file src/pages/babelrc/remove/.babelrc --delete`);\n\n      // babel-loader doesn't actually hot reloads itself when .babelrc file is deleted\n      // so to test hot-reloading here we actually have to invalidate js file, which would recompile it and discover\n      // new babelrc file\n      cy.exec(`npm run update -- --file src/pages/babelrc/remove/index.js --replacements \"foo-bar:foo-bar\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(TEST_ELEMENT).invoke(`text`).should(`eq`, `babel-rc-test`);\n    });","file":"development-runtime/cypress/integration/functionality/babelrc.js","skipped":false,"dir":"e2e-tests"},{"name":"re-runs GraphQL queries with new file contents","suites":["on new file"],"updatePoint":{"line":21,"column":52,"index":370},"line":21,"code":"  it(`re-runs GraphQL queries with new file contents`, () => {\n    const content = JSON.stringify(FILE_CONTENT);\n    cy.exec(`npm run update -- --file content/new-file.md --file-content \\\\\"${content}\\\\\"`);\n    cy.get(`ul`).find(`li:nth-child(2)`).should(`exist`, 1);\n  });","file":"development-runtime/cypress/integration/functionality/data-update.js","skipped":false,"dir":"e2e-tests"},{"name":"rebuilds GraphQL schema","suites":["on schema change"],"updatePoint":{"line":31,"column":29,"index":728},"line":31,"code":"  it(`rebuilds GraphQL schema`, () => {\n    const content = JSON.stringify(FILE_CONTENT);\n    cy.exec(`npm run update -- --file content/new-file.md --exact --replacements \"# foo:foo\" --file-content \\\\\"${content}\\\\\"`);\n    cy.exec(`npm run update -- --file src/pages/schema-rebuild.js --exact --replacements \"# foo:foo\"`);\n    cy.visit(`/schema-rebuild/`).waitForRouteChange();\n    cy.get(`p`).contains(`\"foo\":\"freshField\"`);\n    cy.exec(`npm run update -- --file src/pages/schema-rebuild.js --exact --replacements \"foo: # foo\"`);\n  });","file":"development-runtime/cypress/integration/functionality/data-update.js","skipped":false,"dir":"e2e-tests"},{"name":"works","suites":["gatsby-browser.tsx"],"updatePoint":{"line":2,"column":11,"index":51},"line":2,"code":"  it(`works`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.get(`.gatsby-browser-tsx`).should(`have.attr`, `data-content`, `TSX with gatsby-browser works`);\n  });","file":"development-runtime/cypress/integration/functionality/gatsby-browser-tsx.js","skipped":false,"dir":"e2e-tests"},{"name":"Should appear on ","suites":["The GraphQL endpoint"],"updatePoint":{"line":11,"column":36,"index":289},"line":11,"code":"    it(`Should appear on ${endpoint}`, () => {\n      cy.visit(endpoint);\n      cy.get(`.graphiql-container`).should(`be.visible`);\n      cy.title().should(`eq`, `Gatsby - GraphiQL`);\n    });","file":"development-runtime/cypress/integration/functionality/graphql-endpoint.js","skipped":false,"dir":"e2e-tests"},{"name":"Should execute queries from query string on ","suites":["The GraphQL endpoint"],"updatePoint":{"line":16,"column":63,"index":507},"line":16,"code":"    it(`Should execute queries from query string on ${endpoint}`, () => {\n      // prefill query from query string\n      cy.visit(endpoint + testQueryString);\n      cy.get(`.graphiql-container`).should(`be.visible`);\n      cy.get(`.graphiql-execute-button`).click();\n      cy.get(`.result-window .CodeMirror-code`).contains(`Gatsby Default Starter`);\n    });","file":"development-runtime/cypress/integration/functionality/graphql-endpoint.js","skipped":false,"dir":"e2e-tests"},{"name":"Should execute queries created with explorer on ","suites":["The GraphQL endpoint"],"updatePoint":{"line":23,"column":67,"index":870},"line":23,"code":"    it(`Should execute queries created with explorer on ${endpoint}`, () => {\n      // hack to show (almost) empty editor instead of\n      cy.visit(endpoint + `?query=%20`);\n      cy.get(`.graphiql-container`).should(`be.visible`);\n      cy.get(`[aria-label=\"Show GraphiQL Explorer\"]`).click();\n      cy.get(`[data-field-name=\"site\"]`).click();\n      cy.get(`[data-field-name=\"port\"]`).click();\n      cy.get(`.graphiql-execute-button`).click();\n      cy.get(`.result-window .CodeMirror-code`).contains(`8000`);\n    });","file":"development-runtime/cypress/integration/functionality/graphql-endpoint.js","skipped":false,"dir":"e2e-tests"},{"name":"displays initial state","suites":["hooks"],"updatePoint":{"line":6,"column":28,"index":153},"line":6,"code":"  it(`displays initial state`, () => {\n    cy.getTestElement(COUNT_ID).invoke(`text`).should(`eq`, `0`);\n  });","file":"development-runtime/cypress/integration/functionality/hooks.js","skipped":false,"dir":"e2e-tests"},{"name":"can update local state","suites":["hooks"],"updatePoint":{"line":9,"column":28,"index":264},"line":9,"code":"  it(`can update local state`, () => {\n    cy.getTestElement(`increment`).click();\n    cy.getTestElement(COUNT_ID).invoke(`text`).should(`eq`, `1`);\n    cy.getTestElement(`decrement`).click();\n    cy.getTestElement(COUNT_ID).invoke(`text`).should(`eq`, `0`);\n  });","file":"development-runtime/cypress/integration/functionality/hooks.js","skipped":false,"dir":"e2e-tests"},{"name":"Should execute operations with implicit fragments","suites":["The GraphQL endpoint"],"updatePoint":{"line":7,"column":55,"index":196},"line":7,"code":"  it(`Should execute operations with implicit fragments`, () => {\n    // prefill query from query string\n    cy.visit(`/___graphql` + testQueryString);\n    cy.get(`.graphiql-container`).should(`be.visible`);\n    cy.get(`.graphiql-execute-button`).click();\n    cy.get(`.result-window .CodeMirror-code`).contains(`@gatsbyjs`);\n  });","file":"development-runtime/cypress/integration/functionality/implicit-fragments.js","skipped":false,"dir":"e2e-tests"},{"name":"should have exports named config removed","suites":["modifed exports","page templates"],"updatePoint":{"line":17,"column":48,"index":688},"line":17,"code":"    it(`should have exports named config removed`, () => {\n      cy.getTestElement(`modified-exports-page-template-config`).invoke(`text`).should(`contain`, `undefined`);\n    });","file":"development-runtime/cypress/integration/functionality/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should have exports named getServerData removed","suites":["modifed exports","page templates"],"updatePoint":{"line":20,"column":55,"index":874},"line":20,"code":"    it(`should have exports named getServerData removed`, () => {\n      cy.getTestElement(`modified-exports-page-template-get-server-data`).invoke(`text`).should(`contain`, `undefined`);\n    });","file":"development-runtime/cypress/integration/functionality/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should have imported exports named config left alone","suites":["modifed exports","page templates"],"updatePoint":{"line":23,"column":60,"index":1074},"line":23,"code":"    it(`should have imported exports named config left alone`, () => {\n      cy.getTestElement(`unmodified-exports-page-template-config`).invoke(`text`).should(`contain`, config);\n    });","file":"development-runtime/cypress/integration/functionality/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should have imported exports named getServerData left alone","suites":["modifed exports","page templates"],"updatePoint":{"line":26,"column":67,"index":1269},"line":26,"code":"    it(`should have imported exports named getServerData left alone`, () => {\n      cy.getTestElement(`unmodified-exports-page-template-get-server-data`).invoke(`text`).should(`contain`, getServerData);\n    });","file":"development-runtime/cypress/integration/functionality/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should have other imported exports left alone","suites":["modifed exports","page templates"],"updatePoint":{"line":29,"column":53,"index":1466},"line":29,"code":"    it(`should have other imported exports left alone`, () => {\n      cy.getTestElement(`unmodified-exports-page-template-hello-world`).invoke(`text`).should(`contain`, helloWorld);\n    });","file":"development-runtime/cypress/integration/functionality/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should have exports named config left alone","suites":["modifed exports","other JS files"],"updatePoint":{"line":34,"column":51,"index":1697},"line":34,"code":"    it(`should have exports named config left alone`, () => {\n      cy.getTestElement(`unmodified-exports-config`).invoke(`text`).should(`contain`, config);\n    });","file":"development-runtime/cypress/integration/functionality/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should have exports named getServerData left alone","suites":["modifed exports","other JS files"],"updatePoint":{"line":37,"column":58,"index":1869},"line":37,"code":"    it(`should have exports named getServerData left alone`, () => {\n      cy.getTestElement(`unmodified-exports-get-server-data`).invoke(`text`).should(`contain`, getServerData);\n    });","file":"development-runtime/cypress/integration/functionality/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should have other named exports left alone","suites":["modifed exports","other JS files"],"updatePoint":{"line":40,"column":50,"index":2049},"line":40,"code":"    it(`should have other named exports left alone`, () => {\n      cy.getTestElement(`unmodified-exports-hello-world`).invoke(`text`).should(`contain`, helloWorld);\n    });","file":"development-runtime/cypress/integration/functionality/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"displays arrow function component correctly","suites":["anonymous arrow function pages"],"updatePoint":{"line":5,"column":49,"index":183},"line":5,"code":"  it(`displays arrow function component correctly`, () => {\n    cy.getTestElement(`title`).invoke(`text`).should(`contain`, `Anonymous Arrow Function`);\n  });","file":"development-runtime/cypress/integration/functionality/page-arrow-functions.js","skipped":false,"dir":"e2e-tests"},{"name":"updates page on navigation","suites":["anonymous arrow function pages"],"updatePoint":{"line":8,"column":32,"index":325},"line":8,"code":"  it(`updates page on navigation`, () => {\n    cy.getTestElement(`link`).click().waitForRouteChange();\n    cy.getTestElement(`title`).invoke(`text`).should(`contain`, `Two`);\n  });","file":"development-runtime/cypress/integration/functionality/page-arrow-functions.js","skipped":false,"dir":"e2e-tests"},{"name":"Should extract and run query from gatsby component","suites":["queries in packages"],"updatePoint":{"line":5,"column":56,"index":183},"line":5,"code":"  it(`Should extract and run query from gatsby component`, () => {\n    cy.title().should(`eq`, `Testing queries in packages | Gatsby Default Starter`);\n  });","file":"development-runtime/cypress/integration/functionality/queries-in-packages.js","skipped":false,"dir":"e2e-tests"},{"name":"page query (page has trailing slash)","suites":["Keeping caches up-to-date when updating data","Navigate from static page A to page B, invalidate some data resources for static page A, navigate back to static page A","Navigating back with gatsby-link"],"updatePoint":{"line":125,"column":46,"index":5800},"line":125,"code":"      it(`page query (page has trailing slash)`, () => {\n        const config = {\n          slug: `page-query-with-trailing-slash-A-to-B-to-A-link`,\n          queryType: `page`,\n          navigateBack: `link`,\n          initialPage: `A`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"page query (page doesn't have trailing slash)","suites":["Keeping caches up-to-date when updating data","Navigate from static page A to page B, invalidate some data resources for static page A, navigate back to static page A","Navigating back with gatsby-link"],"updatePoint":{"line":134,"column":55,"index":6093},"line":134,"code":"      it(`page query (page doesn't have trailing slash)`, () => {\n        const config = {\n          slug: `page-query-no-trailing-slash-A-to-B-to-A-link`,\n          trailingSlash: false,\n          queryType: `page`,\n          navigateBack: `link`,\n          initialPage: `A`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"static query (page has trailing slash)","suites":["Keeping caches up-to-date when updating data","Navigate from static page A to page B, invalidate some data resources for static page A, navigate back to static page A","Navigating back with gatsby-link"],"updatePoint":{"line":144,"column":48,"index":6409},"line":144,"code":"      it(`static query (page has trailing slash)`, () => {\n        const config = {\n          slug: `static-query-with-trailing-slash-A-to-B-to-A-link`,\n          queryType: `static`,\n          navigateBack: `link`,\n          initialPage: `A`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"static query (page doesn't have trailing slash)","suites":["Keeping caches up-to-date when updating data","Navigate from static page A to page B, invalidate some data resources for static page A, navigate back to static page A","Navigating back with gatsby-link"],"updatePoint":{"line":153,"column":57,"index":6708},"line":153,"code":"      it(`static query (page doesn't have trailing slash)`, () => {\n        const config = {\n          slug: `static-query-no-trailing-slash-A-to-B-to-A-link`,\n          trailingSlash: false,\n          queryType: `static`,\n          navigateBack: `link`,\n          initialPage: `A`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"page query (page has trailing slash)","suites":["Keeping caches up-to-date when updating data","Navigate from static page A to page B, invalidate some data resources for static page A, navigate back to static page A","Navigating back with history.back()"],"updatePoint":{"line":165,"column":46,"index":7094},"line":165,"code":"      it(`page query (page has trailing slash)`, () => {\n        const config = {\n          slug: `page-query-with-trailing-slash-A-to-B-to-A-history`,\n          queryType: `page`,\n          navigateBack: `history`,\n          initialPage: `A`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"page query (page doesn't have trailing slash)","suites":["Keeping caches up-to-date when updating data","Navigate from static page A to page B, invalidate some data resources for static page A, navigate back to static page A","Navigating back with history.back()"],"updatePoint":{"line":174,"column":55,"index":7393},"line":174,"code":"      it(`page query (page doesn't have trailing slash)`, () => {\n        const config = {\n          slug: `page-query-no-trailing-slash-A-to-B-to-A-history`,\n          trailingSlash: false,\n          queryType: `page`,\n          navigateBack: `history`,\n          initialPage: `A`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"static query (page has trailing slash)","suites":["Keeping caches up-to-date when updating data","Navigate from static page A to page B, invalidate some data resources for static page A, navigate back to static page A","Navigating back with history.back()"],"updatePoint":{"line":184,"column":48,"index":7715},"line":184,"code":"      it(`static query (page has trailing slash)`, () => {\n        const config = {\n          slug: `static-query-with-trailing-slash-A-to-B-to-A-history`,\n          queryType: `static`,\n          navigateBack: `history`,\n          initialPage: `A`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"static query (page doesn't have trailing slash)","suites":["Keeping caches up-to-date when updating data","Navigate from static page A to page B, invalidate some data resources for static page A, navigate back to static page A","Navigating back with history.back()"],"updatePoint":{"line":193,"column":57,"index":8020},"line":193,"code":"      it(`static query (page doesn't have trailing slash)`, () => {\n        const config = {\n          slug: `static-query-no-trailing-slash-A-to-B-to-A-history`,\n          trailingSlash: false,\n          queryType: `static`,\n          navigateBack: `history`,\n          initialPage: `A`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"page query","suites":["Keeping caches up-to-date when updating data","Navigate from client-only page A to page B, invalidate some data resources for client-only page A, navigate back to client-only page A","Navigating back with gatsby-link"],"updatePoint":{"line":207,"column":20,"index":8546},"line":207,"code":"      it(`page query`, () => {\n        const config = {\n          slug: `page-query-CO-to-B-to-CO-link`,\n          queryType: `page`,\n          navigateBack: `link`,\n          initialPage: `client-only`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"static query","suites":["Keeping caches up-to-date when updating data","Navigate from client-only page A to page B, invalidate some data resources for client-only page A, navigate back to client-only page A","Navigating back with gatsby-link"],"updatePoint":{"line":216,"column":22,"index":8798},"line":216,"code":"      it(`static query`, () => {\n        const config = {\n          slug: `static-query-CO-to-B-to-CO-link`,\n          queryType: `static`,\n          navigateBack: `link`,\n          initialPage: `client-only`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"page query","suites":["Keeping caches up-to-date when updating data","Navigate from client-only page A to page B, invalidate some data resources for client-only page A, navigate back to client-only page A","Navigating back with history.back()"],"updatePoint":{"line":227,"column":20,"index":9120},"line":227,"code":"      it(`page query`, () => {\n        const config = {\n          slug: `page-query-CO-to-B-to-CO-history`,\n          queryType: `page`,\n          navigateBack: `history`,\n          initialPage: `client-only`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"static query","suites":["Keeping caches up-to-date when updating data","Navigate from client-only page A to page B, invalidate some data resources for client-only page A, navigate back to client-only page A","Navigating back with history.back()"],"updatePoint":{"line":236,"column":22,"index":9378},"line":236,"code":"      it(`static query`, () => {\n        const config = {\n          slug: `static-query-CO-to-B-to-CO-history`,\n          queryType: `static`,\n          navigateBack: `history`,\n          initialPage: `client-only`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"page query","suites":["Keeping caches up-to-date when updating data","Navigate from 404 page A to page B, invalidate some data resources for 404 page A, navigate back to 404 page A","Navigating back with gatsby-link"],"updatePoint":{"line":249,"column":20,"index":9842},"line":249,"code":"      it(`page query`, () => {\n        const config = {\n          slug: `page-query-404-to-B-to-404-link`,\n          queryType: `page`,\n          navigateBack: `link`,\n          initialPage: `404`,\n          prefix: `page-link-`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"static query","suites":["Keeping caches up-to-date when updating data","Navigate from 404 page A to page B, invalidate some data resources for 404 page A, navigate back to 404 page A","Navigating back with gatsby-link"],"updatePoint":{"line":259,"column":22,"index":10120},"line":259,"code":"      it(`static query`, () => {\n        const config = {\n          slug: `static-query-404-to-B-to-404-link`,\n          queryType: `static`,\n          navigateBack: `link`,\n          initialPage: `404`,\n          prefix: `static-link-`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"page query","suites":["Keeping caches up-to-date when updating data","Navigate from 404 page A to page B, invalidate some data resources for 404 page A, navigate back to 404 page A","Navigating back with history.back()"],"updatePoint":{"line":271,"column":20,"index":10470},"line":271,"code":"      it(`page query`, () => {\n        const config = {\n          slug: `page-query-404-to-B-to-404-history`,\n          queryType: `page`,\n          navigateBack: `history`,\n          initialPage: `404`,\n          prefix: `page-history-`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"static query","suites":["Keeping caches up-to-date when updating data","Navigate from 404 page A to page B, invalidate some data resources for 404 page A, navigate back to 404 page A","Navigating back with history.back()"],"updatePoint":{"line":281,"column":22,"index":10757},"line":281,"code":"      it(`static query`, () => {\n        const config = {\n          slug: `static-query-404-to-B-to-404-history`,\n          queryType: `static`,\n          navigateBack: `history`,\n          initialPage: `404`,\n          prefix: `static-history-`\n        };\n        runTests(config);\n      });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"Navigate from page A to page B, add static query to page A, navigate back to page A","suites":["Keeping caches up to date when modifying list of static query hashes assigned to a template","using gatsby-link"],"updatePoint":{"line":296,"column":91,"index":11289},"line":296,"code":"    it(`Navigate from page A to page B, add static query to page A, navigate back to page A`, () => {\n      const config = {\n        slug: `adding-static-query-A-to-B-to-A-link`,\n        queryType: `static`,\n        navigateBack: `link`,\n        initialPage: `A`\n      };\n      cy.visit(`/query-data-caches/${config.slug}/page-A/`).waitForRouteChange();\n      setupForAssertingNotReloading();\n\n      // baseline assertions\n      pageTitleAndDataAssertion({\n        ...config,\n        page: config.initialPage,\n        data: `from-hardcoded-data`\n      });\n      cy.getTestElement(`page-b-link`).click().waitForRouteChange();\n\n      // assert we navigated\n      pageTitleAndDataAssertion({\n        ...config,\n        page: `B`,\n        data: `from-static-query-results`\n      });\n      cy.exec(`npm run update -- --file src/pages/query-data-caches/${config.slug}/page-A.js --replacements \"adding-static-query-blank:adding-static-query-with-data\" --exact`);\n\n      // TODO: get rid of this wait\n      // We currently have timing issue when emitting both webpack's HMR and page-data.\n      // Problem is we need to potentially wait for webpack recompilation before we emit page-data (due to dependency graph traversal).\n      // Even if we could delay emitting data on the \"server\" side - this doesn't guarantee that messages are received\n      // and handled in correct order (ideally they are applied at the exact same time actually, because ordering might still cause issues if we change query text and component render function)\n      cy.wait(10000);\n      if (config.navigateBack === `link`) {\n        cy.getTestElement(`page-a-link`).click().waitForRouteChange();\n      } else if (config.navigateBack === `history`) {\n        // this is just making sure page components don't have link to navigate back (asserting correct setup)\n        cy.getTestElement(`page-a-link`).should(`not.exist`);\n        cy.go(`back`).waitForRouteChange();\n      }\n\n      // assert data on page we previously visited is updated\n      pageTitleAndDataAssertion({\n        ...config,\n        page: config.initialPage,\n        data: `from-static-query-results`\n      });\n      assertNotReloading();\n    });","file":"development-runtime/cypress/integration/functionality/query-data-caches.js","skipped":false,"dir":"e2e-tests"},{"name":"prompts to restart when changed","suites":["gatsby-config.js"],"updatePoint":{"line":9,"column":37,"index":354},"line":9,"code":"  it(`prompts to restart when changed`, () => {\n    cy.on(`window:confirm`, str => {\n      expect(str).to.contain(`gatsby-config.js`);\n\n      // Press \"Restart\"\n      return true;\n    });\n    cy.task(`changeGatsbyConfig`);\n    cy.get(`[data-cy=\"restarting-screen\"]`, {\n      timeout: 10000\n    }).should(`be.visible`);\n    // Restarting gatsby develop can take a while\n    cy.get(`[data-testid=\"page-component\"]`, {\n      timeout: 30000\n    }).should(`be.visible`);\n  });","file":"development-runtime/cypress/integration/functionality/restarting-prompt.js","skipped":true,"dir":"e2e-tests"},{"name":"registers one route update on initial route","suites":["hooks"],"updatePoint":{"line":5,"column":49,"index":143},"line":5,"code":"  it(`registers one route update on initial route`, () => {\n    cy.lifecycleCallCount(`onRouteUpdate`).should(`eq`, 1);\n  });","file":"development-runtime/cypress/integration/functionality/route-update.js","skipped":false,"dir":"e2e-tests"},{"name":"registers new route update on page navigation","suites":["hooks"],"updatePoint":{"line":8,"column":51,"index":271},"line":8,"code":"  it(`registers new route update on page navigation`, () => {\n    cy.getTestElement(`page-two`).click().waitForRouteChange();\n    cy.lifecycleCallCount(`onRouteUpdate`).should(`eq`, 2);\n  });","file":"development-runtime/cypress/integration/functionality/route-update.js","skipped":false,"dir":"e2e-tests"},{"name":"works with inline query","suites":["StaticQuery behavior"],"updatePoint":{"line":5,"column":29,"index":145},"line":5,"code":"  it(`works with inline query`, () => {\n    cy.getTestElement(`inline`).invoke(`text`).should(`not.contain`, `Loading`);\n  });","file":"development-runtime/cypress/integration/functionality/static-queries.js","skipped":false,"dir":"e2e-tests"},{"name":"works with variable query","suites":["StaticQuery behavior"],"updatePoint":{"line":8,"column":31,"index":274},"line":8,"code":"  it(`works with variable query`, () => {\n    cy.getTestElement(`variable`).invoke(`text`).should(`not.contain`, `Loading`);\n  });","file":"development-runtime/cypress/integration/functionality/static-queries.js","skipped":false,"dir":"e2e-tests"},{"name":"works with exported variable query","suites":["StaticQuery behavior"],"updatePoint":{"line":11,"column":40,"index":414},"line":11,"code":"  it(`works with exported variable query`, () => {\n    cy.getTestElement(`exported`).invoke(`text`).should(`not.contain`, `Loading`);\n  });","file":"development-runtime/cypress/integration/functionality/static-queries.js","skipped":false,"dir":"e2e-tests"},{"name":"works when used in wrapRootElement API","suites":["StaticQuery behavior"],"updatePoint":{"line":14,"column":44,"index":558},"line":14,"code":"  it(`works when used in wrapRootElement API`, () => {\n    cy.getTestElement(`wrap-root-element-result`).invoke(`text`).should(`not.contain`, `Loading`).should(`contain`, `Gatsby Default Starter`);\n  });","file":"development-runtime/cypress/integration/functionality/static-queries.js","skipped":false,"dir":"e2e-tests"},{"name":"works with inline query","suites":["StaticQuery behavior","useStaticQuery"],"updatePoint":{"line":18,"column":31,"index":786},"line":18,"code":"    it(`works with inline query`, () => {\n      cy.getTestElement(`use-static-query-inline`).invoke(`text`).should(`not.contain`, `Error`);\n    });","file":"development-runtime/cypress/integration/functionality/static-queries.js","skipped":false,"dir":"e2e-tests"},{"name":"works with variable query","suites":["StaticQuery behavior","useStaticQuery"],"updatePoint":{"line":21,"column":33,"index":936},"line":21,"code":"    it(`works with variable query`, () => {\n      cy.getTestElement(`use-static-query-variable`).invoke(`text`).should(`not.contain`, `Error`);\n    });","file":"development-runtime/cypress/integration/functionality/static-queries.js","skipped":false,"dir":"e2e-tests"},{"name":"works with exported variable query","suites":["StaticQuery behavior","useStaticQuery"],"updatePoint":{"line":24,"column":42,"index":1097},"line":24,"code":"    it(`works with exported variable query`, () => {\n      cy.getTestElement(`use-static-query-exported`).invoke(`text`).should(`not.contain`, `Error`);\n    });","file":"development-runtime/cypress/integration/functionality/static-queries.js","skipped":false,"dir":"e2e-tests"},{"name":"works with destructuring","suites":["StaticQuery behavior","useStaticQuery"],"updatePoint":{"line":27,"column":32,"index":1248},"line":27,"code":"    it(`works with destructuring`, () => {\n      cy.getTestElement(`use-static-query-destructuring`).find(`li`).should(`have.length.gte`, 1);\n    });","file":"development-runtime/cypress/integration/functionality/static-queries.js","skipped":false,"dir":"e2e-tests"},{"name":"has access to custom sub-plugin cache","suites":["sub-plugin caching"],"updatePoint":{"line":10,"column":43,"index":334},"line":10,"code":"  it(`has access to custom sub-plugin cache`, () => {\n    cy.getTestElement(`gatsby-remark-subcache-value`).invoke(`text`).should(`eq`, `Hello World`);\n  });","file":"development-runtime/cypress/integration/functionality/sub-plugin-caching.js","skipped":false,"dir":"e2e-tests"},{"name":"outputs the YAML file as JSON","suites":["webpack-loader: yaml"],"updatePoint":{"line":5,"column":35,"index":164},"line":5,"code":"  it(`outputs the YAML file as JSON`, () => {\n    cy.getTestElement(`webpack-loader-yaml`).invoke(`text`).should(`eq`, `[{\"name\":\"Paul\"},{\"name\":\"Leto II\"},{\"name\":\"Ghanima\"},{\"name\":\"Alia\"}]`);\n  });","file":"development-runtime/cypress/integration/functionality/yaml.js","skipped":false,"dir":"e2e-tests"},{"name":"has data, by default","suites":["Gatsby Preview, base functionality"],"updatePoint":{"line":6,"column":26,"index":186},"line":6,"code":"  it(`has data, by default`, () => {\n    cy.get(`ul#fake-data`).its(`length`).should(`equal`, 1);\n  });","file":"development-runtime/cypress/integration/gatsby-preview/base-functionality.js","skipped":false,"dir":"e2e-tests"},{"name":"displays correct data/id","suites":["Gatsby Preview, base functionality"],"updatePoint":{"line":9,"column":30,"index":294},"line":9,"code":"  it(`displays correct data/id`, () => {\n    cy.get(`#fake-data li`).should(`have.text`, `Hello World (1)`);\n  });","file":"development-runtime/cypress/integration/gatsby-preview/base-functionality.js","skipped":false,"dir":"e2e-tests"},{"name":"displays initial data","suites":["Gatsby Preview (Refreshing)"],"updatePoint":{"line":8,"column":27,"index":256},"line":8,"code":"  it(`displays initial data`, () => {\n    cy.get(`#pinc-data li`).should(`have.length`, 1);\n    cy.get(`#fake-data li`).should(`have.length`, 1);\n  });","file":"development-runtime/cypress/integration/gatsby-preview/refreshing.js","skipped":false,"dir":"e2e-tests"},{"name":"updates no data for an unknown plugin","suites":["Gatsby Preview (Refreshing)"],"updatePoint":{"line":12,"column":43,"index":424},"line":12,"code":"  it(`updates no data for an unknown plugin`, () => {\n    cy.exec(`npm run update:cms-webhook gatsby-source-unknown`);\n    cy.get(`#pinc-data li`).should(`have.length`, 1);\n    cy.get(`#fake-data li`).should(`have.length`, 1);\n  });","file":"development-runtime/cypress/integration/gatsby-preview/refreshing.js","skipped":false,"dir":"e2e-tests"},{"name":"updates the data from the matching plugin","suites":["Gatsby Preview (Refreshing)"],"updatePoint":{"line":17,"column":47,"index":661},"line":17,"code":"  it(`updates the data from the matching plugin`, () => {\n    cy.exec(`npm run update:cms-webhook gatsby-source-pinc-data`);\n    cy.get(`#pinc-data li`).should(`have.length`, 2);\n    cy.get(`#fake-data li`).should(`have.length`, 1);\n    cy.exec(`npm run update:cms-webhook gatsby-source-fake-data`);\n    cy.get(`#pinc-data li`).should(`have.length`, 2);\n    cy.get(`#fake-data li`).should(`have.length`, 2);\n  });","file":"development-runtime/cypress/integration/gatsby-preview/refreshing.js","skipped":false,"dir":"e2e-tests"},{"name":"displays initial data","suites":["Gatsby Preview (Updating)"],"updatePoint":{"line":9,"column":27,"index":381},"line":9,"code":"  it(`displays initial data`, () => {\n    cy.get(`#fake-data li:eq(0) a`).click().waitForRouteChange();\n    cy.findByText(`Hello World (1)`).should(`exist`);\n    cy.findByText(`0`).should(`exist`);\n  });","file":"development-runtime/cypress/integration/gatsby-preview/updating.js","skipped":false,"dir":"e2e-tests"},{"name":"updates and hot-reloads changes to content","suites":["Gatsby Preview (Updating)"],"updatePoint":{"line":14,"column":48,"index":606},"line":14,"code":"  it(`updates and hot-reloads changes to content`, () => {\n    cy.get(`#fake-data li:eq(0) a`).click().waitForRouteChange();\n    update();\n    cy.findByText(`1`).should(`exist`);\n  });","file":"development-runtime/cypress/integration/gatsby-preview/updating.js","skipped":false,"dir":"e2e-tests"},{"name":"updates and hot-reloads new content","suites":["Gatsby Preview (Updating)"],"updatePoint":{"line":19,"column":41,"index":784},"line":19,"code":"  it(`updates and hot-reloads new content`, () => {\n    const count = 5;\n    update(count);\n    cy.get(`#fake-data li`).should(`have.length`, count + 1);\n  });","file":"development-runtime/cypress/integration/gatsby-preview/updating.js","skipped":false,"dir":"e2e-tests"},{"name":"updates when content is deleted","suites":["Gatsby Preview (Updating)"],"updatePoint":{"line":24,"column":37,"index":940},"line":24,"code":"  it(`updates when content is deleted`, () => {\n    update(5);\n    reset();\n    cy.get(`#fake-data li`).should(`have.length`, 1);\n  });","file":"development-runtime/cypress/integration/gatsby-preview/updating.js","skipped":false,"dir":"e2e-tests"},{"name":"can be triggered with webhook data","suites":["Gatsby Preview (Updating)"],"updatePoint":{"line":29,"column":40,"index":1079},"line":29,"code":"  it(`can be triggered with webhook data`, () => {\n    cy.exec(`npm run update:webhook`);\n    cy.get(`#fake-data`).findByText(`Hello World from a Webhook (999)`).should(`exist`);\n  });","file":"development-runtime/cypress/integration/gatsby-preview/updating.js","skipped":false,"dir":"e2e-tests"},{"name":"should execute the onLoad callback","suites":["both onLoad and onError callbacks are declared"],"updatePoint":{"line":5,"column":40,"index":204},"line":5,"code":"  it(`should execute the onLoad callback`, () => {\n    cy.get(`[data-on-load-result=both-callbacks]`).should(`have.length`, 1);\n  });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-both-callbacks.js","skipped":false,"dir":"e2e-tests"},{"name":"should execute the onError callback","suites":["both onLoad and onError callbacks are declared"],"updatePoint":{"line":8,"column":41,"index":339},"line":8,"code":"  it(`should execute the onError callback`, () => {\n    cy.get(`[data-on-error-result=both-callbacks]`).should(`have.length`, 1);\n  });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-both-callbacks.js","skipped":false,"dir":"e2e-tests"},{"name":"should execute load callbacks of duplicate scripts","suites":["duplicate scripts"],"updatePoint":{"line":5,"column":56,"index":194},"line":5,"code":"  it(`should execute load callbacks of duplicate scripts`, () => {\n    cy.get(`[data-on-load-result=duplicate-1]`).should(`have.length`, 1);\n    cy.get(`[data-on-load-result=duplicate-2]`).should(`have.length`, 1);\n    cy.get(`[data-on-load-result=duplicate-3]`).should(`have.length`, 1);\n  });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-duplicate-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should execute error callbacks of duplicate scripts","suites":["duplicate scripts"],"updatePoint":{"line":10,"column":57,"index":490},"line":10,"code":"  it(`should execute error callbacks of duplicate scripts`, () => {\n    cy.get(`[data-on-error-result=duplicate-1]`).should(`have.length`, 1);\n    cy.get(`[data-on-error-result=duplicate-2]`).should(`have.length`, 1);\n    cy.get(`[data-on-error-result=duplicate-3]`).should(`have.length`, 1);\n  });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-duplicate-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should execute load callbacks even if the first script has no declared load callback","suites":["duplicate scripts"],"updatePoint":{"line":15,"column":90,"index":822},"line":15,"code":"  it(`should execute load callbacks even if the first script has no declared load callback`, () => {\n    cy.get(`[data-on-load-result=duplicate-first-script-no-callback]`).should(`have.length`, 1);\n    cy.get(`[data-on-load-result=duplicate-first-script-no-callback-2]`).should(`have.length`, 1);\n  });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-duplicate-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should execute error callbacks even if the first script has no declared error callback","suites":["duplicate scripts"],"updatePoint":{"line":19,"column":92,"index":1127},"line":19,"code":"  it(`should execute error callbacks even if the first script has no declared error callback`, () => {\n    cy.get(`[data-on-error-result=duplicate-first-script-no-callback]`).should(`have.length`, 1);\n    cy.get(`[data-on-error-result=duplicate-first-script-no-callback-2]`).should(`have.length`, 1);\n  });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-duplicate-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should execute successfully","suites":["inline scripts set via ","using the post-hydrate strategy"],"updatePoint":{"line":26,"column":37,"index":861},"line":26,"code":"      it(`should execute successfully`, () => {\n        cy.visit(page.target).waitForRouteChange();\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, `success`, true).should(`equal`, `true`);\n      });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load after the framework bundle has loaded","suites":["inline scripts set via ","using the post-hydrate strategy"],"updatePoint":{"line":30,"column":59,"index":1092},"line":30,"code":"      it(`should load after the framework bundle has loaded`, () => {\n        cy.visit(page.target).waitForRouteChange();\n\n        // Assert framework is loaded before inline script is executed\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, markRecord.executeStart).then(dangerouslySetExecuteStart => {\n          cy.getRecord(`framework`, resourceRecord.responseEnd).should(`be.lessThan`, dangerouslySetExecuteStart);\n        });\n      });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should execute successfully","suites":["inline scripts set via ","using the idle strategy"],"updatePoint":{"line":40,"column":37,"index":1576},"line":40,"code":"      it(`should execute successfully`, () => {\n        cy.visit(page.target).waitForRouteChange();\n        cy.getRecord(`idle-${inlineScriptType}`, `success`, true).should(`equal`, `true`);\n      });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load after other strategies","suites":["inline scripts set via ","using the idle strategy"],"updatePoint":{"line":44,"column":44,"index":1784},"line":44,"code":"      it(`should load after other strategies`, () => {\n        cy.visit(page.target).waitForRouteChange();\n        cy.getRecord(`idle-${inlineScriptType}`, markRecord.executeStart).then(dangerouslySetExecuteStart => {\n          cy.getRecord(`post-hydrate-${inlineScriptType}`, markRecord.executeStart).should(`be.lessThan`, dangerouslySetExecuteStart);\n        });\n      });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once on initial page load","suites":["inline scripts set via ","when navigation occurs"],"updatePoint":{"line":52,"column":52,"index":2222},"line":52,"code":"      it(`should load only once on initial page load`, () => {\n        cy.visit(page.target).waitForRouteChange();\n        cy.get(`table[id=script-mark-records] tbody`).children().should(`have.length`, 4);\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, `strategy`, true).should(`equal`, `post-hydrate`);\n        cy.getRecord(`idle-${inlineScriptType}`, `strategy`, true).should(`equal`, `idle`);\n      });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once after the page is refreshed","suites":["inline scripts set via ","when navigation occurs"],"updatePoint":{"line":58,"column":59,"index":2645},"line":58,"code":"      it(`should load only once after the page is refreshed`, () => {\n        cy.visit(page.target).waitForRouteChange();\n        cy.reload().url().should(`contain`, page.target);\n        cy.get(`table[id=script-mark-records] tbody`).children().should(`have.length`, 4);\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, `strategy`, true).should(`equal`, `post-hydrate`);\n        cy.getRecord(`idle-${inlineScriptType}`, `strategy`, true).should(`equal`, `idle`);\n      });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once after anchor link navigation","suites":["inline scripts set via ","when navigation occurs"],"updatePoint":{"line":65,"column":60,"index":3127},"line":65,"code":"      it(`should load only once after anchor link navigation`, () => {\n        cy.visit(page.target).waitForRouteChange();\n        cy.get(`a[id=anchor-link-back-to-index]`).click();\n        cy.url().should(`contain`, page.navigation);\n        cy.get(`a[href=\"${page.target}\"][id=anchor-link]`).click();\n        cy.get(`table[id=script-mark-records] tbody`).children().should(`have.length`, 4);\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, `strategy`, true).should(`equal`, `post-hydrate`);\n        cy.getRecord(`idle-${inlineScriptType}`, `strategy`, true).should(`equal`, `idle`);\n      });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once if the page is revisited via browser back/forward buttons after anchor link navigation","suites":["inline scripts set via ","when navigation occurs"],"updatePoint":{"line":74,"column":118,"index":3789},"line":74,"code":"      it(`should load only once if the page is revisited via browser back/forward buttons after anchor link navigation`, () => {\n        cy.visit(page.navigation).waitForRouteChange();\n        cy.get(`a[href=\"${page.target}\"][id=anchor-link]`).click();\n        cy.get(`table[id=script-mark-records] tbody`); // Make sure history has time to change\n        cy.go(`back`).waitForRouteChange();\n        cy.go(`forward`).waitForRouteChange();\n        cy.get(`table[id=script-mark-records] tbody`).children().should(`have.length`, 4);\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, `strategy`, true).should(`equal`, `post-hydrate`);\n        cy.getRecord(`idle-${inlineScriptType}`, `strategy`, true).should(`equal`, `idle`);\n      });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once after Gatsby link navigation","suites":["inline scripts set via ","when navigation occurs"],"updatePoint":{"line":84,"column":60,"index":4471},"line":84,"code":"      it(`should load only once after Gatsby link navigation`, () => {\n        cy.visit(page.target).waitForRouteChange();\n        cy.get(`a[id=gatsby-link-back-to-index]`).click();\n        cy.get(`a[href=\"${page.target}\"][id=gatsby-link]`).click();\n        cy.get(`table[id=script-mark-records] tbody`).children().should(`have.length`, 4);\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, `strategy`, true).should(`equal`, `post-hydrate`);\n        cy.getRecord(`idle-${inlineScriptType}`, `strategy`, true).should(`equal`, `idle`);\n      });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once if the page is revisited via browser back/forward buttons after Gatsby link navigation","suites":["inline scripts set via ","when navigation occurs"],"updatePoint":{"line":92,"column":118,"index":5080},"line":92,"code":"      it(`should load only once if the page is revisited via browser back/forward buttons after Gatsby link navigation`, () => {\n        cy.visit(page.navigation).waitForRouteChange();\n        cy.get(`a[href=\"${page.target}\"][id=gatsby-link]`).click();\n        cy.go(`back`).waitForRouteChange();\n        cy.go(`forward`).waitForRouteChange();\n        cy.get(`table[id=script-mark-records] tbody`).children().should(`have.length`, 4);\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, `strategy`, true).should(`equal`, `post-hydrate`);\n        cy.getRecord(`idle-${inlineScriptType}`, `strategy`, true).should(`equal`, `idle`);\n      });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load successfully","suites":["scripts with sources","using the post-hydrate strategy"],"updatePoint":{"line":9,"column":32,"index":361},"line":9,"code":"    it(`should load successfully`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.getRecord(script.three, `success`, true).should(`equal`, `true`);\n    });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load after the framework bundle has loaded","suites":["scripts with sources","using the post-hydrate strategy"],"updatePoint":{"line":13,"column":57,"index":562},"line":13,"code":"    it(`should load after the framework bundle has loaded`, () => {\n      cy.visit(page.target).waitForRouteChange();\n\n      // Assert framework is loaded before three starts loading\n      cy.getRecord(script.three, resourceRecord.fetchStart).then(threeFetchStart => {\n        cy.getRecord(`framework`, resourceRecord.responseEnd).should(`be.lessThan`, threeFetchStart);\n      });\n    });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should call an on load callback once the script has loaded","suites":["scripts with sources","using the post-hydrate strategy"],"updatePoint":{"line":21,"column":66,"index":960},"line":21,"code":"    it(`should call an on load callback once the script has loaded`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.getRecord(script.three, resourceRecord.responseEnd).then(() => {\n        cy.get(`[data-on-load-result=post-hydrate]`);\n      });\n    });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should call an on error callback if an error occurred","suites":["scripts with sources","using the post-hydrate strategy"],"updatePoint":{"line":27,"column":61,"index":1228},"line":27,"code":"    it(`should call an on error callback if an error occurred`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.get(`[data-on-error-result=post-hydrate]`);\n    });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load successfully","suites":["scripts with sources","using the idle strategy"],"updatePoint":{"line":33,"column":32,"index":1434},"line":33,"code":"    it(`should load successfully`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.getRecord(script.marked, `success`, true).should(`equal`, `true`);\n    });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load after other strategies","suites":["scripts with sources","using the idle strategy"],"updatePoint":{"line":37,"column":42,"index":1621},"line":37,"code":"    it(`should load after other strategies`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.getRecord(script.marked, resourceRecord.fetchStart).then(markedFetchStart => {\n        cy.getRecord(script.three, resourceRecord.fetchStart).should(`be.lessThan`, markedFetchStart);\n      });\n    });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should call an on load callback once the script has loaded","suites":["scripts with sources","using the idle strategy"],"updatePoint":{"line":43,"column":66,"index":1957},"line":43,"code":"    it(`should call an on load callback once the script has loaded`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.getRecord(script.marked, resourceRecord.responseEnd).then(() => {\n        cy.get(`[data-on-load-result=idle]`);\n      });\n    });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should call an on error callback if an error occurred","suites":["scripts with sources","using the idle strategy"],"updatePoint":{"line":49,"column":61,"index":2218},"line":49,"code":"    it(`should call an on error callback if an error occurred`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.get(`[data-on-error-result=idle]`);\n    });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once on initial page load","suites":["scripts with sources","when navigation occurs"],"updatePoint":{"line":55,"column":50,"index":2433},"line":55,"code":"    it(`should load only once on initial page load`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.get(`table[id=script-resource-records] tbody`).children().should(`have.length`, 5);\n      cy.getRecord(script.three, `strategy`, true).should(`equal`, `post-hydrate`);\n      cy.getRecord(script.marked, `strategy`, true).should(`equal`, `idle`);\n    });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once after the page is refreshed","suites":["scripts with sources","when navigation occurs"],"updatePoint":{"line":61,"column":57,"index":2813},"line":61,"code":"    it(`should load only once after the page is refreshed`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.reload();\n      cy.get(`table[id=script-resource-records] tbody`).children().should(`have.length`, 5);\n      cy.getRecord(script.three, `strategy`, true).should(`equal`, `post-hydrate`);\n      cy.getRecord(script.marked, `strategy`, true).should(`equal`, `idle`);\n    });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once after anchor link navigation","suites":["scripts with sources","when navigation occurs"],"updatePoint":{"line":68,"column":58,"index":3213},"line":68,"code":"    it(`should load only once after anchor link navigation`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.get(`a[id=anchor-link-back-to-index]`).click();\n      cy.url().should(`contain`, page.navigation);\n      cy.get(`a[href=\"${page.target}\"][id=anchor-link]`).click();\n      cy.get(`table[id=script-resource-records] tbody`).children().should(`have.length`, 5);\n      cy.getRecord(script.three, `strategy`, true).should(`equal`, `post-hydrate`);\n      cy.getRecord(script.marked, `strategy`, true).should(`equal`, `idle`);\n    });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once if the page is revisited via browser back/forward buttons after anchor link navigation","suites":["scripts with sources","when navigation occurs"],"updatePoint":{"line":77,"column":116,"index":3826},"line":77,"code":"    it(`should load only once if the page is revisited via browser back/forward buttons after anchor link navigation`, () => {\n      cy.visit(page.navigation).waitForRouteChange();\n      cy.get(`a[href=\"${page.target}\"][id=anchor-link]`).click();\n      cy.go(`back`).waitForRouteChange();\n      cy.go(`forward`).waitForRouteChange();\n      cy.get(`table[id=script-resource-records] tbody`).children().should(`have.length`, 5);\n      cy.getRecord(script.three, `strategy`, true).should(`equal`, `post-hydrate`);\n      cy.getRecord(script.marked, `strategy`, true).should(`equal`, `idle`);\n    });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once after Gatsby link navigation","suites":["scripts with sources","when navigation occurs"],"updatePoint":{"line":86,"column":58,"index":4364},"line":86,"code":"    it(`should load only once after Gatsby link navigation`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.get(`a[id=gatsby-link-back-to-index]`).click();\n      cy.get(`a[href=\"${page.target}\"][id=gatsby-link]`).click();\n      cy.get(`table[id=script-resource-records] tbody`).children().should(`have.length`, 5);\n      cy.getRecord(script.three, `strategy`, true).should(`equal`, `post-hydrate`);\n      cy.getRecord(script.marked, `strategy`, true).should(`equal`, `idle`);\n    });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once if the page is revisited via browser back/forward buttons after Gatsby link navigation","suites":["scripts with sources","when navigation occurs"],"updatePoint":{"line":94,"column":116,"index":4926},"line":94,"code":"    it(`should load only once if the page is revisited via browser back/forward buttons after Gatsby link navigation`, () => {\n      cy.visit(page.navigation).waitForRouteChange();\n      cy.get(`a[href=\"${page.target}\"][id=gatsby-link]`).click();\n      cy.go(`back`).waitForRouteChange();\n      cy.go(`forward`).waitForRouteChange();\n      cy.get(`table[id=script-resource-records] tbody`).children().should(`have.length`, 5);\n      cy.getRecord(script.three, `strategy`, true).should(`equal`, `post-hydrate`);\n      cy.getRecord(script.marked, `strategy`, true).should(`equal`, `idle`);\n    });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load successfully","suites":["using the idle strategy with shimmed requestIdleCallback"],"updatePoint":{"line":16,"column":30,"index":653},"line":16,"code":"  it(`should load successfully`, () => {\n    cy.visit(page).waitForRouteChange();\n    cy.getRecord(script.marked, `success`, true).should(`equal`, `true`);\n    cy.get(`@requestIdleCallback`).should(`not.be.called`);\n  });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-shimmed-req-idle-callback.js","skipped":false,"dir":"e2e-tests"},{"name":"should load after other strategies","suites":["using the idle strategy with shimmed requestIdleCallback"],"updatePoint":{"line":21,"column":40,"index":885},"line":21,"code":"  it(`should load after other strategies`, () => {\n    cy.visit(page).waitForRouteChange();\n    cy.getRecord(script.marked, resourceRecord.fetchStart).then(markedFetchStart => {\n      cy.getRecord(script.three, resourceRecord.fetchStart).should(`be.lessThan`, markedFetchStart);\n    });\n    cy.get(`@requestIdleCallback`).should(`not.be.called`);\n  });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-shimmed-req-idle-callback.js","skipped":false,"dir":"e2e-tests"},{"name":"should call an on load callback once the script has loaded","suites":["using the idle strategy with shimmed requestIdleCallback"],"updatePoint":{"line":28,"column":64,"index":1262},"line":28,"code":"  it(`should call an on load callback once the script has loaded`, () => {\n    cy.visit(page).waitForRouteChange();\n    cy.getRecord(script.marked, resourceRecord.responseEnd).then(() => {\n      cy.get(`[data-on-load-result=idle]`);\n    });\n    cy.get(`@requestIdleCallback`).should(`not.be.called`);\n  });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-shimmed-req-idle-callback.js","skipped":false,"dir":"e2e-tests"},{"name":"should call an on error callback if an error occurred","suites":["using the idle strategy with shimmed requestIdleCallback"],"updatePoint":{"line":35,"column":59,"index":1564},"line":35,"code":"  it(`should call an on error callback if an error occurred`, () => {\n    cy.visit(page).waitForRouteChange();\n    cy.get(`[data-on-error-result=idle]`);\n    cy.get(`@requestIdleCallback`).should(`not.be.called`);\n  });","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-shimmed-req-idle-callback.js","skipped":false,"dir":"e2e-tests"},{"name":"scripts load successfully when used via wrapPageElement","suites":[],"updatePoint":{"line":3,"column":59,"index":166},"line":3,"code":"it(`scripts load successfully when used via wrapPageElement`, () => {\n  cy.visit(page).waitForRouteChange();\n  cy.getRecord(script.three, `success`, true).should(`equal`, `true`);\n  cy.getRecord(script.marked, `success`, true).should(`equal`, `true`);\n});","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-ssr-browser-apis.js","skipped":false,"dir":"e2e-tests"},{"name":"scripts load successfully when used via wrapRootElement","suites":[],"updatePoint":{"line":8,"column":59,"index":422},"line":8,"code":"it(`scripts load successfully when used via wrapRootElement`, () => {\n  cy.visit(page).waitForRouteChange();\n  cy.getRecord(script.jQuery, `success`, true).should(`equal`, `true`);\n  cy.getRecord(script.popper, `success`, true).should(`equal`, `true`);\n});","file":"development-runtime/cypress/integration/gatsby-script/gatsby-script-ssr-browser-apis.js","skipped":false,"dir":"e2e-tests"},{"name":"passes without an error","suites":["typecheck"],"updatePoint":{"line":16,"column":29,"index":449},"line":16,"code":"  it(`passes without an error`, () => {\n    cy.exec(`npm run typecheck`);\n  });","file":"development-runtime/cypress/integration/graphql-typegen/files-existence.js","skipped":false,"dir":"e2e-tests"},{"name":"exists in .cache folder","suites":["fragments.graphql"],"updatePoint":{"line":21,"column":29,"index":571},"line":21,"code":"  it('exists in .cache folder', () => {\n    cy.readFile('.cache/typegen/fragments.graphql');\n  });","file":"development-runtime/cypress/integration/graphql-typegen/files-existence.js","skipped":false,"dir":"e2e-tests"},{"name":"contains test fragment","suites":["fragments.graphql"],"updatePoint":{"line":24,"column":28,"index":669},"line":24,"code":"  it('contains test fragment', () => {\n    cy.readFile('.cache/typegen/fragments.graphql').then(file => {\n      expect(file).to.include(FRAGMENT);\n    });\n  });","file":"development-runtime/cypress/integration/graphql-typegen/files-existence.js","skipped":false,"dir":"e2e-tests"},{"name":"exists in .cache folder with correct data","suites":["graphql-config"],"updatePoint":{"line":31,"column":47,"index":888},"line":31,"code":"  it('exists in .cache folder with correct data', () => {\n    cy.readFile('.cache/typegen/graphql.config.json', 'utf-8').then(json => {\n      expect(json).to.deep.equal({\n        \"schema\": \".cache/typegen/schema.graphql\",\n        \"documents\": [\"src/**/**.{ts,js,tsx,jsx}\", \".cache/typegen/fragments.graphql\"],\n        \"extensions\": {\n          \"endpoints\": {\n            \"default\": {\n              \"url\": \"http://localhost:8000/___graphql\"\n            }\n          }\n        }\n      });\n    });\n  });","file":"development-runtime/cypress/integration/graphql-typegen/files-existence.js","skipped":false,"dir":"e2e-tests"},{"name":"exists in .cache folder","suites":["schema.graphql"],"updatePoint":{"line":48,"column":29,"index":1409},"line":48,"code":"  it('exists in .cache folder', () => {\n    cy.readFile('.cache/typegen/schema.graphql');\n  });","file":"development-runtime/cypress/integration/graphql-typegen/files-existence.js","skipped":false,"dir":"e2e-tests"},{"name":"contains test type","suites":["schema.graphql"],"updatePoint":{"line":51,"column":24,"index":1500},"line":51,"code":"  it('contains test type', () => {\n    cy.readFile('.cache/typegen/schema.graphql').then(file => {\n      expect(file).to.include(GRAPHQL_TYPE);\n    });\n  });","file":"development-runtime/cypress/integration/graphql-typegen/files-existence.js","skipped":false,"dir":"e2e-tests"},{"name":"exists in src folder","suites":["gatsby-types.d.ts"],"updatePoint":{"line":58,"column":26,"index":1702},"line":58,"code":"  it('exists in src folder', () => {\n    cy.readFile('src/gatsby-types.d.ts');\n  });","file":"development-runtime/cypress/integration/graphql-typegen/files-existence.js","skipped":false,"dir":"e2e-tests"},{"name":"contains test type","suites":["gatsby-types.d.ts"],"updatePoint":{"line":61,"column":24,"index":1785},"line":61,"code":"  it('contains test type', () => {\n    cy.readFile('src/gatsby-types.d.ts').then(file => {\n      expect(file).to.include(TS_TYPE);\n    });\n  });","file":"development-runtime/cypress/integration/graphql-typegen/files-existence.js","skipped":false,"dir":"e2e-tests"},{"name":"contains initial contents in files","suites":["hot-reloading changes on GraphQL Typegen files"],"updatePoint":{"line":17,"column":40,"index":721},"line":17,"code":"  it(`contains initial contents in files`, () => {\n    cy.readFile('src/gatsby-types.d.ts').then(file => {\n      expect(file).to.include(QUERY_BEFORE);\n    });\n    cy.readFile('.cache/typegen/fragments.graphql').then(file => {\n      expect(file).to.include(FRAGMENT_BEFORE);\n    });\n  });","file":"development-runtime/cypress/integration/graphql-typegen/updates.js","skipped":false,"dir":"e2e-tests"},{"name":"can edit a page query","suites":["hot-reloading changes on GraphQL Typegen files"],"updatePoint":{"line":25,"column":27,"index":997},"line":25,"code":"  it(`can edit a page query`, () => {\n    cy.exec(`npm run update -- --file src/pages/graphql-typegen.tsx --replacements \"# %AUTHOR%:author\" --exact`);\n    cy.waitForHmr();\n    cy.readFile('src/gatsby-types.d.ts').then(file => {\n      expect(file).to.include(QUERY_AFTER);\n    });\n  });","file":"development-runtime/cypress/integration/graphql-typegen/updates.js","skipped":false,"dir":"e2e-tests"},{"name":"can edit a fragment","suites":["hot-reloading changes on GraphQL Typegen files"],"updatePoint":{"line":32,"column":25,"index":1282},"line":32,"code":"  it(`can edit a fragment`, () => {\n    cy.exec(`npm run update -- --file src/pages/graphql-typegen.tsx --replacements \"# %TRAILING_SLASH%:trailingSlash\" --exact`);\n    cy.waitForHmr();\n    cy.readFile('.cache/typegen/fragments.graphql').then(file => {\n      expect(file).to.include(FRAGMENT_AFTER);\n    });\n  });","file":"development-runtime/cypress/integration/graphql-typegen/updates.js","skipped":false,"dir":"e2e-tests"},{"name":"successfully runs typecheck","suites":["hot-reloading changes on GraphQL Typegen files"],"updatePoint":{"line":39,"column":33,"index":1604},"line":39,"code":"  it(`successfully runs typecheck`, () => {\n    cy.exec(`npm run typecheck`);\n  });","file":"development-runtime/cypress/integration/graphql-typegen/updates.js","skipped":false,"dir":"e2e-tests"},{"name":"Head function export receive correct props","suites":[],"updatePoint":{"line":2,"column":46,"index":136},"line":2,"code":"it(`Head function export receive correct props`, () => {\n  cy.visit(headFunctionExportSharedData.page.correctProps).waitForRouteChange();\n  const data = {\n    site: {\n      siteMetadata: {\n        headFunctionExport: {\n          ...headFunctionExportSharedData.data.queried\n        }\n      }\n    }\n  };\n  const location = {\n    pathname: headFunctionExportSharedData.page.correctProps\n  };\n  const pageContext = headFunctionExportSharedData.data.pageContext;\n  cy.getTestElement(`pageContext`).invoke(`attr`, `content`).should(`equal`, JSON.stringify(pageContext, null, 2));\n  cy.getTestElement(`location`).invoke(`attr`, `content`).should(`equal`, JSON.stringify(location, null, 2));\n  cy.getTestElement(`data`).invoke(`attr`, `content`).should(`equal`, JSON.stringify(data, null, 2));\n});","file":"development-runtime/cypress/integration/head-function-export/correct-props.js","skipped":false,"dir":"e2e-tests"},{"name":"Deduplicates multiple tags with same id","suites":[],"updatePoint":{"line":2,"column":43,"index":133},"line":2,"code":"it(`Deduplicates multiple tags with same id`, () => {\n  cy.visit(headFunctionExportSharedData.page.deduplication).waitForRouteChange();\n\n  // deduplication link has id and should be deduplicated\n  cy.get(`link[rel=deduplication]`).should(\"have.length\", 1);\n  // last deduplication link should win\n  cy.get(`link[rel=deduplication]`).should(\"have.attr\", \"href\", \"/bar\");\n  // we should preserve id\n  cy.get(`link[rel=deduplication]`).should(\"have.attr\", \"id\", \"deduplication-test\");\n\n  // alternate links are not using id, so should have multiple instances\n  cy.get(`link[rel=alternate]`).should(\"have.length\", 2);\n});","file":"development-runtime/cypress/integration/head-function-export/deduplication.js","skipped":false,"dir":"e2e-tests"},{"name":"Head function export with FS Route API should work","suites":[],"updatePoint":{"line":2,"column":54,"index":130},"line":2,"code":"it(`Head function export with FS Route API should work`, () => {\n  cy.visit(page.fsRouteApi).waitForRouteChange();\n  cy.getTestElement(`title`).should(`have.text`, data.fsRouteApi.slug);\n});","file":"development-runtime/cypress/integration/head-function-export/fs-route-api.js","skipped":false,"dir":"e2e-tests"},{"name":"can pickup deeply nested valid head elements","suites":["Head with wrapRootElement"],"updatePoint":{"line":4,"column":50,"index":246},"line":4,"code":"  it(`can pickup deeply nested valid head elements`, () => {\n    cy.visit(headFunctionExportSharedData.page.headWithWrapRooElement).waitForRouteChange();\n    const {\n      data\n    } = headFunctionExportSharedData;\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.static.base);\n    cy.getTestElement(`title`).should(`have.text`, contextValue.posts[0].title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, contextValue.posts[1].title);\n    cy.getTestElement(`noscript`).should(`have.text`, data.static.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.static.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.static.link);\n    cy.getTestElement(`jsonLD`).should(`have.text`, data.static.jsonLD);\n  });","file":"development-runtime/cypress/integration/head-function-export/head-with-wrap-root-element.js","skipped":false,"dir":"e2e-tests"},{"name":"can use context values provided in wrapRootElement","suites":["Head with wrapRootElement"],"updatePoint":{"line":17,"column":56,"index":1051},"line":17,"code":"  it(`can use context values provided in wrapRootElement`, () => {\n    cy.visit(headFunctionExportSharedData.page.headWithWrapRooElement).waitForRouteChange();\n    cy.getTestElement(`title`).should(`have.text`, contextValue.posts[0].title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, contextValue.posts[1].title);\n  });","file":"development-runtime/cypress/integration/head-function-export/head-with-wrap-root-element.js","skipped":false,"dir":"e2e-tests"},{"name":"Page has body and html attributes on direct visit","suites":["Html and body attributes"],"updatePoint":{"line":3,"column":55,"index":190},"line":3,"code":"  it(`Page has body and html attributes on direct visit`, () => {\n    cy.visit(headFunctionExportSharedData.page.htmlAndBodyAttributes).waitForRouteChange();\n    cy.get(`body`).should(`have.attr`, `data-foo`, `baz`);\n    cy.get(`body`).should(`have.attr`, `class`, `foo`);\n    cy.get(`html`).should(`have.attr`, `data-foo`, `bar`);\n    cy.get(`html`).should(`have.attr`, `lang`, `fr`);\n  });","file":"development-runtime/cypress/integration/head-function-export/html-and-body-attributes.js","skipped":false,"dir":"e2e-tests"},{"name":"Page has body and html attributes on client-side navigation","suites":["Html and body attributes"],"updatePoint":{"line":10,"column":65,"index":592},"line":10,"code":"  it(`Page has body and html attributes on client-side navigation`, () => {\n    cy.visit(headFunctionExportSharedData.page.basic).waitForRouteChange();\n    cy.get(`body`).should(`not.have.attr`, `data-foo`, `baz`);\n    cy.get(`body`).should(`not.have.attr`, `class`, `foo`);\n    cy.get(`html`).should(`not.have.attr`, `data-foo`, `bar`);\n    cy.get(`html`).should(`not.have.attr`, `lang`, `fr`);\n    cy.visit(headFunctionExportSharedData.page.htmlAndBodyAttributes).waitForRouteChange();\n    cy.get(`body`).should(`have.attr`, `data-foo`, `baz`);\n    cy.get(`body`).should(`have.attr`, `class`, `foo`);\n    cy.get(`html`).should(`have.attr`, `data-foo`, `bar`);\n    cy.get(`html`).should(`have.attr`, `lang`, `fr`);\n  });","file":"development-runtime/cypress/integration/head-function-export/html-and-body-attributes.js","skipped":false,"dir":"e2e-tests"},{"name":"Body and html attributes are removed on client-side navigation when new page doesn't set them","suites":["Html and body attributes"],"updatePoint":{"line":22,"column":99,"index":1348},"line":22,"code":"  it(`Body and html attributes are removed on client-side navigation when new page doesn't set them`, () => {\n    cy.visit(headFunctionExportSharedData.page.htmlAndBodyAttributes).waitForRouteChange();\n    cy.get(`body`).should(`have.attr`, `data-foo`, `baz`);\n    cy.get(`body`).should(`have.attr`, `class`, `foo`);\n    cy.get(`html`).should(`have.attr`, `data-foo`, `bar`);\n    cy.get(`html`).should(`have.attr`, `lang`, `fr`);\n    cy.visit(headFunctionExportSharedData.page.basic).waitForRouteChange();\n    cy.get(`body`).should(`not.have.attr`, `data-foo`, `baz`);\n    cy.get(`body`).should(`not.have.attr`, `class`, `foo`);\n    cy.get(`html`).should(`not.have.attr`, `data-foo`, `bar`);\n    cy.get(`html`).should(`not.have.attr`, `lang`, `fr`);\n  });","file":"development-runtime/cypress/integration/head-function-export/html-and-body-attributes.js","skipped":false,"dir":"e2e-tests"},{"name":"should work with static data","suites":["Head function export html insertion"],"updatePoint":{"line":3,"column":34,"index":166},"line":3,"code":"  it(`should work with static data`, () => {\n    cy.visit(page.basic).waitForRouteChange();\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.static.base);\n    cy.getTestElement(`title`).should(`have.text`, data.static.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.static.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.static.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.static.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.static.link);\n    cy.getTestElement(`jsonLD`).should(`have.text`, data.static.jsonLD);\n  });","file":"development-runtime/cypress/integration/head-function-export/html-insertion.js","skipped":false,"dir":"e2e-tests"},{"name":"should work with data from a page query","suites":["Head function export html insertion"],"updatePoint":{"line":13,"column":45,"index":832},"line":13,"code":"  it(`should work with data from a page query`, () => {\n    cy.visit(page.pageQuery).waitForRouteChange();\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.queried.base);\n    cy.getTestElement(`title`).should(`have.text`, data.queried.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.queried.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.queried.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.queried.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.queried.link);\n  });","file":"development-runtime/cypress/integration/head-function-export/html-insertion.js","skipped":false,"dir":"e2e-tests"},{"name":"should work when a head function with static data is re-exported from the page","suites":["Head function export html insertion"],"updatePoint":{"line":22,"column":84,"index":1474},"line":22,"code":"  it(`should work when a head function with static data is re-exported from the page`, () => {\n    cy.visit(page.reExport).waitForRouteChange();\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.static.base);\n    cy.getTestElement(`title`).should(`have.text`, data.static.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.static.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.static.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.static.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.static.link);\n    cy.getTestElement(`jsonLD`).should(`have.text`, data.static.jsonLD);\n  });","file":"development-runtime/cypress/integration/head-function-export/html-insertion.js","skipped":false,"dir":"e2e-tests"},{"name":"should work when an imported Head component with queried data is used","suites":["Head function export html insertion"],"updatePoint":{"line":32,"column":75,"index":2173},"line":32,"code":"  it(`should work when an imported Head component with queried data is used`, () => {\n    cy.visit(page.staticQuery).waitForRouteChange();\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.queried.base);\n    cy.getTestElement(`title`).should(`have.text`, data.queried.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.queried.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.queried.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.queried.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.queried.link);\n  });","file":"development-runtime/cypress/integration/head-function-export/html-insertion.js","skipped":false,"dir":"e2e-tests"},{"name":"should work in a DSG page (exporting function named config)","suites":["Head function export html insertion"],"updatePoint":{"line":41,"column":65,"index":2798},"line":41,"code":"  it(`should work in a DSG page (exporting function named config)`, () => {\n    cy.visit(page.dsg).waitForRouteChange();\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.dsg.base);\n    cy.getTestElement(`title`).should(`have.text`, data.dsg.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.dsg.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.dsg.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.dsg.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.dsg.link);\n  });","file":"development-runtime/cypress/integration/head-function-export/html-insertion.js","skipped":false,"dir":"e2e-tests"},{"name":"should work in an SSR page (exporting function named getServerData)","suites":["Head function export html insertion"],"updatePoint":{"line":50,"column":73,"index":3399},"line":50,"code":"  it(`should work in an SSR page (exporting function named getServerData)`, () => {\n    cy.visit(page.ssr).waitForRouteChange();\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.ssr.base);\n    cy.getTestElement(`title`).should(`have.text`, data.ssr.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.ssr.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.ssr.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.ssr.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.ssr.link);\n    cy.getTestElement(`server-data`).invoke(`attr`, `content`).should(`equal`, JSON.stringify(data.ssr.serverData));\n  });","file":"development-runtime/cypress/integration/head-function-export/html-insertion.js","skipped":false,"dir":"e2e-tests"},{"name":"Head function export should not include invalid elements","suites":[],"updatePoint":{"line":2,"column":60,"index":136},"line":2,"code":"it(`Head function export should not include invalid elements`, () => {\n  cy.visit(page.invalidElements).waitForRouteChange();\n  cy.get(`head > h1`).should(`not.exist`);\n  cy.get(`head > div`).should(`not.exist`);\n  cy.get(`head > audio`).should(`not.exist`);\n  cy.get(`head > video`).should(`not.exist`);\n  cy.get(`head > title`).should(`exist`).and(`have.text`, data.invalidElements.title);\n});","file":"development-runtime/cypress/integration/head-function-export/invalid-elements.js","skipped":false,"dir":"e2e-tests"},{"name":"should remove tags not on next page","suites":["Head function export behavior during CSR navigation (Gatsby Link)"],"updatePoint":{"line":6,"column":41,"index":314},"line":6,"code":"  it(`should remove tags not on next page`, () => {\n    cy.visit(page.basic).waitForRouteChange();\n    cy.getTestElement(`extra-meta`).invoke(`attr`, `content`).should(`equal`, data.static.extraMeta);\n    cy.getTestElement(`gatsby-link`).click().waitForRouteChange();\n    cy.get(`[data-testid=\"extra-meta\"]`).should(`not.exist`);\n  });","file":"development-runtime/cypress/integration/head-function-export/navigation.js","skipped":false,"dir":"e2e-tests"},{"name":"should add tags not on next page","suites":["Head function export behavior during CSR navigation (Gatsby Link)"],"updatePoint":{"line":12,"column":38,"index":647},"line":12,"code":"  it(`should add tags not on next page`, () => {\n    cy.visit(page.basic).waitForRouteChange();\n    cy.get(`[data-testid=\"extra-meta-2\"]`).should(`not.exist`);\n    cy.getTestElement(`gatsby-link`).click().waitForRouteChange();\n    cy.getTestElement(`extra-meta-2`).invoke(`attr`, `content`).should(`equal`, data.queried.extraMeta2);\n  });","file":"development-runtime/cypress/integration/head-function-export/navigation.js","skipped":false,"dir":"e2e-tests"},{"name":"should not contain tags from old tags when we navigate to page without Head export","suites":["Head function export behavior during CSR navigation (Gatsby Link)"],"updatePoint":{"line":18,"column":88,"index":1036},"line":18,"code":"  it(`should not contain tags from old tags when we navigate to page without Head export`, () => {\n    cy.visit(page.basic).waitForRouteChange();\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.static.base);\n    cy.getTestElement(`title`).should(`have.text`, data.static.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.static.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.static.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.static.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.static.link);\n    cy.getTestElement(`jsonLD`).should(`have.text`, data.static.jsonLD);\n    cy.getTestElement(`navigate-to-page-without-head-export`).click().waitForRouteChange();\n    cy.getTestElement(`base`).should(`not.exist`);\n    cy.getTestElement(`title`).should(`not.exist`);\n    cy.getTestElement(`meta`).should(`not.exist`);\n    cy.getTestElement(`noscript`).should(`not.exist`);\n    cy.getTestElement(`style`).should(`not.exist`);\n    cy.getTestElement(`link`).should(`not.exist`);\n    cy.getTestElement(`jsonLD`).should(`not.exist`);\n  });","file":"development-runtime/cypress/integration/head-function-export/navigation.js","skipped":false,"dir":"e2e-tests"},{"name":"should change meta tag values","suites":["Head function export behavior during CSR navigation (Gatsby Link)"],"updatePoint":{"line":41,"column":35,"index":2410},"line":41,"code":"  it(`should change meta tag values`, () => {\n    // Initial load\n    cy.visit(page.basic).waitForRouteChange();\n\n    // Validate data from initial load\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.static.base);\n    cy.getTestElement(`title`).should(`have.text`, data.static.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.static.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.static.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.static.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.static.link);\n\n    // Navigate to a different page via Gatsby Link\n    cy.getTestElement(`gatsby-link`).click();\n\n    // Validate data on navigated-to page\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.queried.base);\n    cy.getTestElement(`title`).should(`have.text`, data.queried.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.queried.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.queried.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.queried.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.queried.link);\n\n    // Navigate back to original page via Gatsby Link\n    cy.getTestElement(`gatsby-link`).click().waitForRouteChange();\n\n    // Validate data is same as initial load\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.static.base);\n    cy.getTestElement(`title`).should(`have.text`, data.static.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.static.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.static.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.static.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.static.link);\n  });","file":"development-runtime/cypress/integration/head-function-export/navigation.js","skipped":false,"dir":"e2e-tests"},{"name":"Inline script work and get called only once","suites":["Scripts"],"updatePoint":{"line":9,"column":49,"index":365},"line":9,"code":"  it(`Inline script work and get called only once`, () => {\n    // Head export seem to be appending the tags after waitForRouteChange()\n    // We need to find a way to make waitForRouteChange() catch Head export too\n    cy.wait(3000);\n    cy.window().then(win => {\n      expect(win.__SOME_GLOBAL_TO_CHECK_CALL_COUNT__).to.equal(1);\n    });\n  });","file":"development-runtime/cypress/integration/head-function-export/scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"Works with Head export","suites":["Tsx Pages"],"updatePoint":{"line":2,"column":28,"index":59},"line":2,"code":"  it(`Works with Head export`, () => {\n    cy.visit(`/head-function-export/tsx-page`);\n    cy.getTestElement(`title`).should(`contain`, `TypeScript`);\n    cy.getTestElement(`name`).invoke(`attr`, `content`).should(`equal`, `TypeScript`);\n  });","file":"development-runtime/cypress/integration/head-function-export/typescript.js","skipped":false,"dir":"e2e-tests"},{"name":"for elements that belong in the body","suites":["Head function export should warn"],"updatePoint":{"line":11,"column":42,"index":409},"line":11,"code":"  it(`for elements that belong in the body`, () => {\n    cy.get(`@consoleWarn`).should(`be.calledWith`, `<h1> is not a valid head element. Please use one of the following: ${VALID_NODE_NAMES.join(`, `)}.\\n\\nAlso make sure that wrapRootElement in gatsby-ssr/gatsby-browser doesn't contain UI elements: https://gatsby.dev/invalid-head-elements`);\n  });","file":"development-runtime/cypress/integration/head-function-export/warnings.js","skipped":false,"dir":"e2e-tests"},{"name":"displays placeholders on launch","suites":["hot-reloading anonymous arrow functions"],"updatePoint":{"line":9,"column":37,"index":230},"line":9,"code":"  it(`displays placeholders on launch`, () => {\n    cy.getTestElement(IDS.title).should(`have.text`, `%TITLE%`);\n    cy.getTestElement(IDS.subTitle).should(`have.text`, `%SUB_TITLE%`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/arrow-functions.js","skipped":false,"dir":"e2e-tests"},{"name":"updates on change","suites":["hot-reloading anonymous arrow functions"],"updatePoint":{"line":13,"column":23,"index":407},"line":13,"code":"  it(`updates on change`, () => {\n    const text = `The title`;\n    cy.exec(`npm run update -- --file src/components/title.tsx --replacements \"TITLE:${text}\"`);\n    cy.waitForHmr();\n    cy.getTestElement(IDS.title).should(`have.text`, text);\n  });","file":"development-runtime/cypress/integration/hot-reloading/arrow-functions.js","skipped":false,"dir":"e2e-tests"},{"name":"displays placeholder on launch","suites":["reloading class component"],"updatePoint":{"line":6,"column":36,"index":185},"line":6,"code":"  it(`displays placeholder on launch`, () => {\n    cy.getTestElement(TEST_ID).should(`contain.text`, `%CLASS_COMPONENT%`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/class-component.js","skipped":false,"dir":"e2e-tests"},{"name":"updates placeholder and hot reloads","suites":["reloading class component"],"updatePoint":{"line":9,"column":41,"index":319},"line":9,"code":"  it(`updates placeholder and hot reloads`, () => {\n    const text = `class component`;\n    cy.exec(`npm run update -- --file src/components/class-component.js --replacements \"CLASS_COMPONENT:${text}\"`);\n    cy.getTestElement(TEST_ID).should(`contain.text`, text);\n  });","file":"development-runtime/cypress/integration/hot-reloading/class-component.js","skipped":false,"dir":"e2e-tests"},{"name":"updates state and hot reloads","suites":["reloading class component"],"updatePoint":{"line":14,"column":35,"index":584},"line":14,"code":"  it(`updates state and hot reloads`, () => {\n    const value = `custom`;\n    cy.exec(`npm run update -- --file src/components/class-component.js --replacements \"CUSTOM_STATE:${value}\"`);\n    cy.waitForHmr();\n    cy.getTestElement(`stateful-${TEST_ID}`).should(`have.text`, `Custom Message`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/class-component.js","skipped":false,"dir":"e2e-tests"},{"name":"displays content initially (no errors yet)","suites":["testing error overlay and ability to automatically recover from webpack compile errors"],"updatePoint":{"line":13,"column":48,"index":548},"line":13,"code":"  it(`displays content initially (no errors yet)`, () => {\n    cy.findByTestId(`hot`).should(`contain.text`, `Working`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/compile-error.js","skipped":false,"dir":"e2e-tests"},{"name":"displays error with overlay on compilation errors","suites":["testing error overlay and ability to automatically recover from webpack compile errors"],"updatePoint":{"line":16,"column":55,"index":682},"line":16,"code":"  it(`displays error with overlay on compilation errors`, () => {\n    cy.exec(`npm run update -- --file src/pages/error-handling/compile-error.js --replacements \"${errorPlaceholder}:${errorReplacement}\" --exact`);\n    cy.getFastRefreshOverlay().find(`#gatsby-overlay-labelledby`).should(`contain.text`, `Failed to compile`);\n    cy.getFastRefreshOverlay().find(`#gatsby-overlay-describedby`).should(`contain.text`, `This error occurred during the build process and can only be dismissed by fixing the error.`);\n    cy.getFastRefreshOverlay().find(`[data-gatsby-overlay=\"header__cause-file\"] span`).should(`contain.text`, `./src/pages/error-handling/compile-error.js`);\n    cy.getFastRefreshOverlay().find(`[data-gatsby-overlay=\"body\"] h2`).should(`contain.text`, `Source`);\n    cy.getFastRefreshOverlay().find(`[data-gatsby-overlay=\"body\"] pre`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/compile-error.js","skipped":false,"dir":"e2e-tests"},{"name":"can recover without need to refresh manually","suites":["testing error overlay and ability to automatically recover from webpack compile errors"],"updatePoint":{"line":24,"column":50,"index":1530},"line":24,"code":"  it(`can recover without need to refresh manually`, () => {\n    cy.exec(`npm run update -- --file src/pages/error-handling/compile-error.js --replacements \"Working:Updated\" --replacements \"${errorReplacement}:${errorPlaceholder}\" --exact`);\n    cy.findByTestId(`hot`).should(`contain.text`, `Updated`);\n    cy.assertNoFastRefreshOverlay();\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/compile-error.js","skipped":false,"dir":"e2e-tests"},{"name":"__file-code-frame","suites":["overlay handlers don't serve unrelated files"],"updatePoint":{"line":3,"column":23,"index":132},"line":3,"code":"  it(`__file-code-frame`, () => {\n    cy.request(`__file-code-frame?filePath=${cwd}/SHOULD_NOT_SERVE&lineNumber=0`).should(response => {\n      expect(response.body.codeFrame).not.to.match(/CYPRESS-MARKER/);\n    });\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/overlay-endpoints.js","skipped":false,"dir":"e2e-tests"},{"name":"__original-stack-frame","suites":["overlay handlers don't serve unrelated files"],"updatePoint":{"line":8,"column":28,"index":358},"line":8,"code":"  it(`__original-stack-frame`, () => {\n    cy.request(`__original-stack-frame?moduleId=${cwd}/SHOULD_NOT_SERVE&lineNumber=0&skipSourceMap=1`).should(response => {\n      expect(response.body.codeFrame).not.to.match(/CYPRESS-MARKER/);\n      expect(response.body.sourceContent).not.to.match(/CYPRESS-MARKER/);\n    });\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/overlay-endpoints.js","skipped":false,"dir":"e2e-tests"},{"name":"displays content initially (no errors yet)","suites":["testing error overlay and ability to automatically recover runtime errors cause by content changes (page queries variant)"],"updatePoint":{"line":27,"column":48,"index":1195},"line":27,"code":"  it(`displays content initially (no errors yet)`, () => {\n    cy.findByTestId(`hot`).should(`contain.text`, `Working`);\n    cy.findByTestId(`results`).should(`contain.text`, `\"hasError\": false`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/page-query-result-runtime-error.js","skipped":false,"dir":"e2e-tests"},{"name":"displays error with overlay on runtime errors","suites":["testing error overlay and ability to automatically recover runtime errors cause by content changes (page queries variant)"],"updatePoint":{"line":31,"column":51,"index":1401},"line":31,"code":"  it(`displays error with overlay on runtime errors`, () => {\n    cy.exec(`npm run update -- --file content/error-recovery/page-query.json  --replacements \"${errorPlaceholder}:${errorReplacement}\" --exact`);\n    cy.getFastRefreshOverlay().find(`#gatsby-overlay-labelledby`).should(`contain.text`, `Unhandled Runtime Error`);\n    cy.getFastRefreshOverlay().find(`#gatsby-overlay-describedby`).should(`contain.text`, `One unhandled runtime error found in your files. See the list below to fix it:`);\n    cy.getFastRefreshOverlay().find(`[data-gatsby-overlay=\"accordion\"] [data-gatsby-overlay=\"accordion__item__title\"]`).should(`contain.text`, `Error in function PageQueryRuntimeError in ./src/pages/error-handling/page-query-result-runtime-error.js:7`);\n    cy.getFastRefreshOverlay().find(`[data-gatsby-overlay=\"accordion\"] [data-gatsby-overlay=\"body__error-message\"]`).should(`contain.text`, `Page query results caused runtime error`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/page-query-result-runtime-error.js","skipped":false,"dir":"e2e-tests"},{"name":"can recover without need to refresh manually","suites":["testing error overlay and ability to automatically recover runtime errors cause by content changes (page queries variant)"],"updatePoint":{"line":38,"column":50,"index":2342},"line":38,"code":"  it(`can recover without need to refresh manually`, () => {\n    cy.exec(`npm run update -- --file content/error-recovery/page-query.json  --replacements \"${errorReplacement}:${errorPlaceholder}\" --exact`);\n    cy.exec(`npm run update -- --file src/pages/error-handling/page-query-result-runtime-error.js --replacements \"Working:Updated\" --exact`);\n    cy.findByTestId(`hot`).should(`contain.text`, `Updated`);\n    cy.findByTestId(`results`).should(`contain.text`, `\"hasError\": false`);\n    cy.assertNoFastRefreshOverlay();\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/page-query-result-runtime-error.js","skipped":false,"dir":"e2e-tests"},{"name":"displays content initially (no errors yet)","suites":["testing error overlay and ability to automatically recover from query extraction validation errors"],"updatePoint":{"line":15,"column":48,"index":650},"line":15,"code":"  it(`displays content initially (no errors yet)`, () => {\n    cy.findByTestId(`hot`).should(`contain.text`, `Working`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/query-validation-error.js","skipped":false,"dir":"e2e-tests"},{"name":"displays error with overlay on compilation errors","suites":["testing error overlay and ability to automatically recover from query extraction validation errors"],"updatePoint":{"line":18,"column":55,"index":784},"line":18,"code":"  it(`displays error with overlay on compilation errors`, () => {\n    cy.exec(`npm run update -- --file src/pages/error-handling/query-validation-error.js --replacements \"${errorPlaceholder}:${errorReplacement}\" --exact`);\n    cy.getFastRefreshOverlay().find(`#gatsby-overlay-labelledby`).should(`contain.text`, `Unhandled GraphQL Error`);\n    cy.getFastRefreshOverlay().find(`#gatsby-overlay-describedby`).should(`contain.text`, `One unhandled GraphQL error found in your files. See the list below to fix it:`);\n    cy.getFastRefreshOverlay().find(`[data-gatsby-overlay=\"accordion\"] [data-gatsby-overlay=\"accordion__item__title\"]`).should(`contain.text`, `Cannot query field \"fieldThatDoesNotExistOnSiteMapType\" on type \"SiteSiteMetadata\".`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/query-validation-error.js","skipped":false,"dir":"e2e-tests"},{"name":"can recover without need to refresh manually","suites":["testing error overlay and ability to automatically recover from query extraction validation errors"],"updatePoint":{"line":24,"column":50,"index":1529},"line":24,"code":"  it(`can recover without need to refresh manually`, () => {\n    cy.exec(`npm run update -- --file src/pages/error-handling/query-validation-error.js --replacements \"Working:Updated\" --replacements \"${errorReplacement}:${errorPlaceholder}\" --exact`);\n    cy.findByTestId(`hot`).should(`contain.text`, `Updated`);\n    cy.assertNoFastRefreshOverlay();\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/query-validation-error.js","skipped":false,"dir":"e2e-tests"},{"name":"displays content initially (no errors yet)","suites":["testing error overlay and ability to automatically recover from runtime errors"],"updatePoint":{"line":25,"column":48,"index":951},"line":25,"code":"  it(`displays content initially (no errors yet)`, () => {\n    cy.findByTestId(`hot`).should(`contain.text`, `Working`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/runtime-error.js","skipped":false,"dir":"e2e-tests"},{"name":"displays error with overlay on runtime errors","suites":["testing error overlay and ability to automatically recover from runtime errors"],"updatePoint":{"line":28,"column":51,"index":1081},"line":28,"code":"  it(`displays error with overlay on runtime errors`, () => {\n    cy.exec(`npm run update -- --file src/pages/error-handling/runtime-error.js --replacements \"${errorPlaceholder}:${errorReplacement}\" --exact`);\n    cy.getFastRefreshOverlay().find(`#gatsby-overlay-labelledby`).should(`contain.text`, `Unhandled Runtime Error`);\n    cy.getFastRefreshOverlay().find(`#gatsby-overlay-describedby`).should(`contain.text`, `One unhandled runtime error found in your files. See the list below to fix it:`);\n    cy.getFastRefreshOverlay().find(`[data-gatsby-overlay=\"accordion\"] [data-gatsby-overlay=\"accordion__item__title\"]`).should(`contain.text`, `Error in function RuntimeError in ./src/pages/error-handling/runtime-error.js:4`);\n    cy.getFastRefreshOverlay().find(`[data-gatsby-overlay=\"accordion\"] [data-gatsby-overlay=\"body__error-message\"]`).should(`contain.text`, `Cannot read properties of undefined (reading 'b')`);\n    cy.getFastRefreshOverlay().find(`[data-gatsby-overlay=\"body\"] pre`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/runtime-error.js","skipped":false,"dir":"e2e-tests"},{"name":"can recover without need to refresh manually","suites":["testing error overlay and ability to automatically recover from runtime errors"],"updatePoint":{"line":36,"column":50,"index":2080},"line":36,"code":"  it(`can recover without need to refresh manually`, () => {\n    cy.exec(`npm run update -- --file src/pages/error-handling/runtime-error.js --replacements \"Working:Updated\" --replacements \"${errorReplacement}:${errorPlaceholder}\" --exact`);\n    cy.findByTestId(`hot`).should(`contain.text`, `Updated`);\n    cy.assertNoFastRefreshOverlay();\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/runtime-error.js","skipped":false,"dir":"e2e-tests"},{"name":"displays content initially (no errors yet)","suites":["testing error overlay and ability to automatically recover from runtime errors (static queries variant)"],"updatePoint":{"line":27,"column":48,"index":1187},"line":27,"code":"  it(`displays content initially (no errors yet)`, () => {\n    cy.findByTestId(`hot`).should(`contain.text`, `Working`);\n    cy.findByTestId(`results`).should(`contain.text`, `\"hasError\": false`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/static-query-result-runtime-error.js","skipped":false,"dir":"e2e-tests"},{"name":"displays error with overlay on runtime errors","suites":["testing error overlay and ability to automatically recover from runtime errors (static queries variant)"],"updatePoint":{"line":31,"column":51,"index":1393},"line":31,"code":"  it(`displays error with overlay on runtime errors`, () => {\n    cy.exec(`npm run update -- --file content/error-recovery/static-query.json  --replacements \"${errorPlaceholder}:${errorReplacement}\" --exact`);\n    cy.getFastRefreshOverlay().find(`#gatsby-overlay-labelledby`).should(`contain.text`, `Unhandled Runtime Error`);\n    cy.getFastRefreshOverlay().find(`#gatsby-overlay-describedby`).should(`contain.text`, `One unhandled runtime error found in your files. See the list below to fix it:`);\n    cy.getFastRefreshOverlay().find(`[data-gatsby-overlay=\"accordion\"] [data-gatsby-overlay=\"accordion__item__title\"]`).should(`contain.text`, `Error in function StaticQueryRuntimeError in ./src/pages/error-handling/static-query-result-runtime-error.js:14`);\n    cy.getFastRefreshOverlay().find(`[data-gatsby-overlay=\"accordion\"] [data-gatsby-overlay=\"body__error-message\"]`).should(`contain.text`, `Static query results caused runtime error`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/static-query-result-runtime-error.js","skipped":false,"dir":"e2e-tests"},{"name":"can recover without need to refresh manually","suites":["testing error overlay and ability to automatically recover from runtime errors (static queries variant)"],"updatePoint":{"line":38,"column":50,"index":2343},"line":38,"code":"  it(`can recover without need to refresh manually`, () => {\n    cy.exec(`npm run update -- --file content/error-recovery/static-query.json  --replacements \"${errorReplacement}:${errorPlaceholder}\" --exact`);\n    cy.exec(`npm run update -- --file src/pages/error-handling/static-query-result-runtime-error.js --replacements \"Working:Updated\" --exact`);\n    cy.findByTestId(`hot`).should(`contain.text`, `Updated`);\n    cy.findByTestId(`results`).should(`contain.text`, `\"hasError\": false`);\n    cy.assertNoFastRefreshOverlay();\n  });","file":"development-runtime/cypress/integration/hot-reloading/error-handling/static-query-result-runtime-error.js","skipped":false,"dir":"e2e-tests"},{"name":"displays placeholder content on launch","suites":["hot reloading above page template (gatsby-browser)"],"updatePoint":{"line":6,"column":44,"index":221},"line":6,"code":"  it(`displays placeholder content on launch`, () => {\n    cy.getTestElement(TEST_ID).should(`contain.text`, `%TEST_HMR_IN_GATSBY_BROWSER%`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/gatsby-browser.js","skipped":false,"dir":"e2e-tests"},{"name":"hot reloads with new content","suites":["hot reloading above page template (gatsby-browser)"],"updatePoint":{"line":9,"column":34,"index":359},"line":9,"code":"  it(`hot reloads with new content`, () => {\n    const text = `HMR_IN_GATSBY_BROWSER_WORKS`;\n    cy.exec(`npm run update -- --file src/wrap-root-element.js --replacements \"TEST_HMR_IN_GATSBY_BROWSER:${text}\"`);\n    cy.waitForHmr();\n    cy.getTestElement(TEST_ID).should(`contain.text`, text);\n  });","file":"development-runtime/cypress/integration/hot-reloading/gatsby-browser.js","skipped":false,"dir":"e2e-tests"},{"name":"displays placeholder content on launch","suites":["hot reloading Head export"],"updatePoint":{"line":9,"column":44,"index":305},"line":9,"code":"  it(`displays placeholder content on launch`, () => {\n    cy.getTestElement(TEST_ID).invoke(`attr`, `content`).should(`contain.equal`, \"%SOME_EXTRA_META%\");\n  });","file":"development-runtime/cypress/integration/hot-reloading/head-export.js","skipped":false,"dir":"e2e-tests"},{"name":"hot reloads with new content","suites":["hot reloading Head export"],"updatePoint":{"line":12,"column":34,"index":459},"line":12,"code":"  it(`hot reloads with new content`, () => {\n    const text = `New Title by HMR`;\n    cy.exec(`npm run update -- --file src/pages/head-function-export/basic.js --replacements \"SOME_EXTRA_META:${text}\"`);\n    cy.waitForHmr();\n    cy.getTestElement(TEST_ID).invoke(`attr`, `content`).should(`contain.equal`, text);\n  });","file":"development-runtime/cypress/integration/hot-reloading/head-export.js","skipped":false,"dir":"e2e-tests"},{"name":"can update component","suites":["hot-reloading hooks"],"updatePoint":{"line":9,"column":26,"index":317},"line":9,"code":"  it(`can update component`, () => {\n    cy.exec(`npm run update -- --file src/pages/hooks.js --replacements \"count + 1:count + ${amount}\" --exact`);\n    cy.waitForHmr();\n    cy.getTestElement(`increment`).click();\n    cy.getTestElement(COUNT_ID).invoke(`text`).should(`eq`, `${amount}`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/hooks.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to newly created page using link","suites":["client-side navigation to the new page"],"updatePoint":{"line":7,"column":51,"index":256},"line":7,"code":"  it(`can navigate to newly created page using link`, () => {\n    cy.findByTestId(`hot-reloading-new-file`).click({\n      force: true\n    }).waitForRouteChange();\n    cy.getTestElement(`message`).invoke(`text`).should(`contain`, `Hello`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/new-file.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to new page","suites":["hot reloading new page component"],"updatePoint":{"line":25,"column":30,"index":872},"line":25,"code":"  it(`can navigate to new page`, () => {\n    cy.visit(`/sample`).waitForRouteChange();\n    cy.getTestElement(`message`).invoke(`text`).should(`contain`, `Hello`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/new-file.js","skipped":false,"dir":"e2e-tests"},{"name":"can hot reload a new page file","suites":["hot reloading new page component"],"updatePoint":{"line":29,"column":36,"index":1047},"line":29,"code":"  it(`can hot reload a new page file`, () => {\n    cy.visit(`/sample`).waitForRouteChange();\n    const text = `World`;\n    cy.exec(`npm run update -- --file src/pages/sample.js --replacements \"REPLACEMENT:${text}\"`);\n    cy.waitForHmr();\n    cy.getTestElement(`message`).invoke(`text`).should(`eq`, `Hello ${text}`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/new-file.js","skipped":false,"dir":"e2e-tests"},{"name":"displays placeholder content on launch","suites":["hot reloading non-js file","markdown"],"updatePoint":{"line":12,"column":46,"index":487},"line":12,"code":"    it(`displays placeholder content on launch`, () => {\n      cy.getTestElement(TEST_ID).invoke(`text`).should(`contain`, TEMPLATE);\n    });","file":"development-runtime/cypress/integration/hot-reloading/non-js-file.js","skipped":false,"dir":"e2e-tests"},{"name":"hot reloads with new content","suites":["hot reloading non-js file","markdown"],"updatePoint":{"line":15,"column":36,"index":619},"line":15,"code":"    it(`hot reloads with new content`, () => {\n      cy.getTestElement(TEST_ID).invoke(`text`).should(`contain`, TEMPLATE);\n      cy.exec(`npm run update -- --file content/2018-12-14-hello-world.md --replacements \"${TEMPLATE}:${message}\"`);\n\n      // wait for socket.io to update\n      cy.wait(5000);\n      cy.getTestElement(TEST_ID).invoke(`text`).should(`eq`, message);\n    });","file":"development-runtime/cypress/integration/hot-reloading/non-js-file.js","skipped":false,"dir":"e2e-tests"},{"name":"displays original content on launch","suites":["hot reloading non-js file","image"],"updatePoint":{"line":36,"column":43,"index":1464},"line":36,"code":"    it(`displays original content on launch`, () => {\n      runImageSnapshot(`non-js-file--image-original`);\n    });","file":"development-runtime/cypress/integration/hot-reloading/non-js-file.js","skipped":false,"dir":"e2e-tests"},{"name":"hot reloads with new content","suites":["hot reloading non-js file","image"],"updatePoint":{"line":39,"column":36,"index":1574},"line":39,"code":"    it(`hot reloads with new content`, () => {\n      cy.exec(`npm run update -- --file src/images/image.png --copy \"src/images/new.png\"`);\n\n      // wait for socket.io to update\n      cy.wait(5000);\n      runImageSnapshot(`non-js-file--image-new`);\n    });","file":"development-runtime/cypress/integration/hot-reloading/non-js-file.js","skipped":false,"dir":"e2e-tests"},{"name":"displays placeholder content on launch","suites":["hot reloading page component"],"updatePoint":{"line":5,"column":44,"index":161},"line":5,"code":"  it(`displays placeholder content on launch`, () => {\n    cy.getTestElement(`page-component`).should(`contain.text`, `%GATSBY_SITE%`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/page-component.js","skipped":false,"dir":"e2e-tests"},{"name":"hot reloads with new content","suites":["hot reloading page component"],"updatePoint":{"line":8,"column":34,"index":293},"line":8,"code":"  it(`hot reloads with new content`, () => {\n    const text = `Gatsby site`;\n    cy.exec(`npm run update -- --file src/pages/index.js --replacements \"GATSBY_SITE:${text}\"`);\n    cy.waitForHmr();\n    cy.getTestElement(`page-component`).should(`contain.text`, text);\n  });","file":"development-runtime/cypress/integration/hot-reloading/page-component.js","skipped":false,"dir":"e2e-tests"},{"name":"displays placeholder content on launch","suites":["hot reloading page component with Head export"],"updatePoint":{"line":19,"column":44,"index":737},"line":19,"code":"  it(`displays placeholder content on launch`, () => {\n    cy.getTestElement(`page-component-with-head-export`).should(`contain.text`, `%GATSBY_SITE%`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/page-component.js","skipped":false,"dir":"e2e-tests"},{"name":"hot reloads with new content","suites":["hot reloading page component with Head export"],"updatePoint":{"line":22,"column":34,"index":886},"line":22,"code":"  it(`hot reloads with new content`, () => {\n    const text = `Gatsby site`;\n    cy.exec(`npm run update -- --file src/pages/head-function-export/basic.js --replacements \"GATSBY_SITE:${text}\"`);\n    cy.waitForHmr();\n    cy.getTestElement(`page-component-with-head-export`).should(`contain.text`, text);\n  });","file":"development-runtime/cypress/integration/hot-reloading/page-component.js","skipped":false,"dir":"e2e-tests"},{"name":"displays placeholder content on launch","suites":["hot-reloading page queries"],"updatePoint":{"line":9,"column":44,"index":238},"line":9,"code":"  it(`displays placeholder content on launch`, () => {\n    cy.getTestElement(`hot`).invoke(`text`).should(`not.contain`, author);\n  });","file":"development-runtime/cypress/integration/hot-reloading/page-queries.js","skipped":false,"dir":"e2e-tests"},{"name":"can edit a page query","suites":["hot-reloading page queries"],"updatePoint":{"line":12,"column":27,"index":357},"line":12,"code":"  it(`can edit a page query`, () => {\n    cy.exec(`npm run update -- --file src/pages/page-query.js --replacements \"# %AUTHOR%:author\" --exact`);\n    cy.waitForHmr();\n    cy.getTestElement(`hot`).invoke(`text`).should(`contain`, author);\n  });","file":"development-runtime/cypress/integration/hot-reloading/page-queries.js","skipped":false,"dir":"e2e-tests"},{"name":"displays placeholder content on launch","suites":["hot-reloading static queries"],"updatePoint":{"line":6,"column":44,"index":196},"line":6,"code":"  it(`displays placeholder content on launch`, () => {\n    cy.getTestElement(`hot`).invoke(`text`).should(`not.contain`, author);\n  });","file":"development-runtime/cypress/integration/hot-reloading/static-queries.js","skipped":false,"dir":"e2e-tests"},{"name":"can update a StaticQuery element","suites":["hot-reloading static queries"],"updatePoint":{"line":9,"column":38,"index":326},"line":9,"code":"  it(`can update a StaticQuery element`, () => {\n    cy.exec(`npm run update -- --file src/components/static-query/hot.js --replacements \"# %AUTHOR%:author\" --exact`);\n    cy.getTestElement(`hot`).invoke(`text`).should(`contain`, author);\n  });","file":"development-runtime/cypress/integration/hot-reloading/static-queries.js","skipped":false,"dir":"e2e-tests"},{"name":"displays placeholder content on launch","suites":["hot-reloading static queries","useStaticQuery"],"updatePoint":{"line":14,"column":46,"index":616},"line":14,"code":"    it(`displays placeholder content on launch`, () => {\n      cy.getTestElement(`use-static-query-hot`).invoke(`text`).should(`not.contain`, author);\n    });","file":"development-runtime/cypress/integration/hot-reloading/static-queries.js","skipped":false,"dir":"e2e-tests"},{"name":"can update a useStaticQuery element","suites":["hot-reloading static queries","useStaticQuery"],"updatePoint":{"line":17,"column":43,"index":772},"line":17,"code":"    it(`can update a useStaticQuery element`, () => {\n      cy.exec(`npm run update -- --file src/components/static-query/use-static-query/hot.js --replacements \"# %AUTHOR%:author\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`use-static-query-hot`).invoke(`text`).should(`contain`, author);\n    });","file":"development-runtime/cypress/integration/hot-reloading/static-queries.js","skipped":false,"dir":"e2e-tests"},{"name":"displays placeholder content on launch","suites":["hot reloading template component"],"updatePoint":{"line":7,"column":44,"index":243},"line":7,"code":"  it(`displays placeholder content on launch`, () => {\n    cy.getTestElement(TEST_ID).invoke(`text`).should(`contain`, TEMPLATE);\n  });","file":"development-runtime/cypress/integration/hot-reloading/template-component.js","skipped":false,"dir":"e2e-tests"},{"name":"hot reloads with new content","suites":["hot reloading template component"],"updatePoint":{"line":10,"column":34,"index":369},"line":10,"code":"  it(`hot reloads with new content`, () => {\n    const message = `World`;\n    cy.exec(`npm run update -- --file src/templates/blog-post.js --replacements \"${TEMPLATE}:${message}\"`);\n    cy.waitForHmr();\n    cy.getTestElement(TEST_ID).should(`have.text`, `Hello ${message}`);\n  });","file":"development-runtime/cypress/integration/hot-reloading/template-component.js","skipped":false,"dir":"e2e-tests"},{"name":"displays content from other pages","suites":["navigation"],"updatePoint":{"line":5,"column":39,"index":138},"line":5,"code":"  it(`displays content from other pages`, () => {\n    cy.visit(`/page-2`).waitForRouteChange();\n    cy.getTestElement(`page-2-message`).invoke(`text`).should(`equal`, `Hi from the second page`);\n  });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"re-routes on link click","suites":["navigation"],"updatePoint":{"line":9,"column":29,"index":329},"line":9,"code":"  it(`re-routes on link click`, () => {\n    cy.getTestElement(`page-two`).click();\n    cy.location(`pathname`).should(`equal`, `/page-2/`);\n  });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to and from pages","suites":["navigation"],"updatePoint":{"line":13,"column":36,"index":482},"line":13,"code":"  it(`can navigate to and from pages`, () => {\n    cy.getTestElement(`page-two`).click();\n    cy.getTestElement(`back-button`).click();\n    cy.location(`pathname`).should(`equal`, `/`);\n  });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate back using history","suites":["navigation"],"updatePoint":{"line":18,"column":37,"index":675},"line":18,"code":"  it(`can navigate back using history`, () => {\n    cy.getTestElement(`page-two`).click().waitForRouteChange();\n    cy.go(`back`).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/`);\n  });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate using numbers","suites":["navigation"],"updatePoint":{"line":23,"column":32,"index":878},"line":23,"code":"  it(`can navigate using numbers`, () => {\n    cy.getTestElement(`page-two`).click().waitForRouteChange();\n    cy.getTestElement(`back-by-number`).click();\n    cy.location(`pathname`).should(`equal`, `/`);\n  });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to a subdirectory","suites":["navigation","relative links"],"updatePoint":{"line":29,"column":38,"index":1133},"line":29,"code":"    it(`can navigate to a subdirectory`, () => {\n      cy.getTestElement(`subdir-link`).click().location(`pathname`).should(`eq`, `/subdirectory/page-1/`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to a sibling page","suites":["navigation","relative links"],"updatePoint":{"line":32,"column":38,"index":1297},"line":32,"code":"    it(`can navigate to a sibling page`, () => {\n      cy.visit(`/subdirectory/page-1`).waitForRouteChange().getTestElement(`page-2-link`).click().location(`pathname`).should(`eq`, `/subdirectory/page-2/`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to a parent page","suites":["navigation","relative links"],"updatePoint":{"line":35,"column":37,"index":1511},"line":35,"code":"    it(`can navigate to a parent page`, () => {\n      cy.visit(`/subdirectory/page-1`).waitForRouteChange().getTestElement(`page-parent-link`).click().location(`pathname`).should(`eq`, `/subdirectory/`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to a sibling page programatically","suites":["navigation","relative links"],"updatePoint":{"line":38,"column":54,"index":1740},"line":38,"code":"    it(`can navigate to a sibling page programatically`, () => {\n      cy.visit(`/subdirectory/page-1`).waitForRouteChange().getTestElement(`page-2-button-link`).click().location(`pathname`).should(`eq`, `/subdirectory/page-2/`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"displays 404 page on broken link","suites":["navigation","non-existent route"],"updatePoint":{"line":46,"column":40,"index":2111},"line":46,"code":"    it(`displays 404 page on broken link`, () => {\n      cy.get(`h1`).invoke(`text`).should(`eq`, `Gatsby.js development 404 page`);\n\n      /*\n       * Two route updates:\n       * - initial render of /\n       * - (default) development 404 page\n       */\n      cy.lifecycleCallCount(`onRouteUpdate`).should(`eq`, 2);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"can display a custom 404 page","suites":["navigation","non-existent route"],"updatePoint":{"line":56,"column":37,"index":2432},"line":56,"code":"    it(`can display a custom 404 page`, () => {\n      cy.get(`button`).click();\n      cy.getTestElement(`page-title`).invoke(`text`).should(`eq`, `NOT FOUND`);\n\n      /*\n       * Two route updates:\n       * - initial render\n       * - 404 page\n       * a re-render does not occur because the route remains the same\n       */\n      cy.lifecycleCallCount(`onRouteUpdate`).should(`eq`, 2);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"Can navigate directly","suites":["navigation","Supports unicode characters in urls"],"updatePoint":{"line":70,"column":29,"index":2883},"line":70,"code":"    it(`Can navigate directly`, () => {\n      cy.visit(encodeURI(`/`)).waitForRouteChange();\n      cy.getTestElement(`page-2-message`).invoke(`text`).should(`equal`, `Hi from the second page`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"Can navigate on client","suites":["navigation","Supports unicode characters in urls"],"updatePoint":{"line":74,"column":30,"index":3088},"line":74,"code":"    it(`Can navigate on client`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.getTestElement(`page-with-unicode-path`).click().waitForRouteChange();\n      cy.getTestElement(`page-2-message`).invoke(`text`).should(`equal`, `Hi from the second page`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"should show 404 page when url with unicode characters point to a non-existent page route when navigating directly","suites":["navigation","Supports unicode characters in urls"],"updatePoint":{"line":79,"column":121,"index":3451},"line":79,"code":"    it(`should show 404 page when url with unicode characters point to a non-existent page route when navigating directly`, () => {\n      cy.visit(encodeURI(`/404/`), {\n        failOnStatusCode: false\n      }).waitForRouteChange();\n      cy.get(`h1`).invoke(`text`).should(`eq`, `Gatsby.js development 404 page`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"should show 404 page when url with unicode characters point to a non-existent page route when navigating on client","suites":["navigation","Supports unicode characters in urls"],"updatePoint":{"line":85,"column":122,"index":3776},"line":85,"code":"    it(`should show 404 page when url with unicode characters point to a non-existent page route when navigating on client`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.window().then(win => win.___navigate(`/404/`)).waitForRouteChange();\n      cy.get(`h1`).invoke(`text`).should(`eq`, `Gatsby.js development 404 page`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"Can navigate directly","suites":["navigation","Supports encodable characters in urls"],"updatePoint":{"line":92,"column":29,"index":4094},"line":92,"code":"    it(`Can navigate directly`, () => {\n      cy.visit(`/foo/@something/bar`).waitForRouteChange();\n      cy.getTestElement(`page-2-message`).invoke(`text`).should(`equal`, `Hi from the second page`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"Can navigate on client","suites":["navigation","Supports encodable characters in urls"],"updatePoint":{"line":96,"column":30,"index":4304},"line":96,"code":"    it(`Can navigate on client`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.getTestElement(`page-with-encodable-path`).click().waitForRouteChange();\n      cy.getTestElement(`page-2-message`).invoke(`text`).should(`equal`, `Hi from the second page`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"should show 404 page when url with unicode characters point to a non-existent page route when navigating directly","suites":["navigation","Supports encodable characters in urls"],"updatePoint":{"line":101,"column":121,"index":4669},"line":101,"code":"    it(`should show 404 page when url with unicode characters point to a non-existent page route when navigating directly`, () => {\n      cy.visit(`/foo/@something/bar404/`, {\n        failOnStatusCode: false\n      }).waitForRouteChange();\n      cy.get(`h1`).invoke(`text`).should(`eq`, `Gatsby.js development 404 page`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"should show 404 page when url with unicode characters point to a non-existent page route when navigating on client","suites":["navigation","Supports encodable characters in urls"],"updatePoint":{"line":107,"column":122,"index":4999},"line":107,"code":"    it(`should show 404 page when url with unicode characters point to a non-existent page route when navigating on client`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.window().then(win => win.___navigate(`/foo/@something/bar404/`)).waitForRouteChange();\n      cy.get(`h1`).invoke(`text`).should(`eq`, `Gatsby.js development 404 page`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"should trigger an effect after a search param has changed","suites":["navigation","All location changes should trigger an effect (fast-refresh)"],"updatePoint":{"line":119,"column":65,"index":5533},"line":119,"code":"    it(`should trigger an effect after a search param has changed`, () => {\n      cy.findByTestId(`effect-message`).should(`have.text`, ``);\n      cy.findByTestId(`send-search-message`).click().waitForRouteChange();\n      cy.findByTestId(`effect-message`).should(`have.text`, `?message=searchParam`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"should trigger an effect after the hash has changed","suites":["navigation","All location changes should trigger an effect (fast-refresh)"],"updatePoint":{"line":124,"column":59,"index":5836},"line":124,"code":"    it(`should trigger an effect after the hash has changed`, () => {\n      cy.findByTestId(`effect-message`).should(`have.text`, ``);\n      cy.findByTestId(`send-hash-message`).click().waitForRouteChange();\n      cy.findByTestId(`effect-message`).should(`have.text`, `#message-hash`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"should trigger an effect after the state has changed","suites":["navigation","All location changes should trigger an effect (fast-refresh)"],"updatePoint":{"line":129,"column":60,"index":6131},"line":129,"code":"    it(`should trigger an effect after the state has changed`, () => {\n      cy.findByTestId(`effect-message`).should(`have.text`, ``);\n      cy.findByTestId(`send-state-message`).click().waitForRouteChange();\n      cy.findByTestId(`effect-message`).should(`have.text`, `this is a message using the state`);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"calls onPreRouteUpdate, render and onRouteUpdate the correct amount of times on route change","suites":["navigation","Route lifecycle update order"],"updatePoint":{"line":136,"column":100,"index":6544},"line":136,"code":"    it(`calls onPreRouteUpdate, render and onRouteUpdate the correct amount of times on route change`, () => {\n      cy.lifecycleCallCount(`onPreRouteUpdate`).should(`eq`, 1);\n      cy.lifecycleCallCount(`render`).should(`eq`, 1);\n      cy.lifecycleCallCount(`onRouteUpdate`).should(`eq`, 1);\n      cy.getTestElement(`page-two`).click().waitForRouteChange();\n      cy.getTestElement(`page-2-message`).should(`exist`);\n      cy.lifecycleCallCount(`onPreRouteUpdate`).should(`eq`, 2);\n      cy.lifecycleCallCount(`render`).should(`eq`, 2);\n      cy.lifecycleCallCount(`onRouteUpdate`).should(`eq`, 2);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"renders the component after onPreRouteUpdate on route change","suites":["navigation","Route lifecycle update order"],"updatePoint":{"line":146,"column":68,"index":7120},"line":146,"code":"    it(`renders the component after onPreRouteUpdate on route change`, () => {\n      cy.getTestElement(`page-component`).should(`exist`);\n      cy.lifecycleCallCount(`onPreRouteUpdate`).should(`eq`, 1);\n      cy.lifecycleCallCount(`render`).should(`eq`, 1);\n      cy.lifecycleCallCount(`onRouteUpdate`).should(`eq`, 1);\n      cy.lifecycleCallOrder([`onPreRouteUpdate`, `render`, `onRouteUpdate`]).should(`eq`, true);\n      cy.getTestElement(`page-two`).click().waitForRouteChange();\n      cy.getTestElement(`page-2-message`).should(`exist`);\n      cy.lifecycleCallOrder([`onPreRouteUpdate`, `render`, `onRouteUpdate`, `onPreRouteUpdate`, `render`, `onRouteUpdate`]).should(`eq`, true);\n      cy.lifecycleCallCount(`onPreRouteUpdate`).should(`eq`, 2);\n      cy.lifecycleCallCount(`render`).should(`eq`, 2);\n      cy.lifecycleCallCount(`onRouteUpdate`).should(`eq`, 2);\n    });","file":"development-runtime/cypress/integration/navigation/linking.js","skipped":false,"dir":"e2e-tests"},{"name":"Initial first render","suites":["Loading indicator","Defaults in cypress env (doesn't show indicator)","Page with light/quick query doesn't show indicator"],"updatePoint":{"line":91,"column":30,"index":2889},"line":91,"code":"      it(`Initial first render`, () => {\n        runTests({\n          ...config,\n          data: `quick-first-render-with-disabled-indicator`,\n          mode: `first-render`\n        });\n      });","file":"development-runtime/cypress/integration/navigation/loading-indicator.js","skipped":false,"dir":"e2e-tests"},{"name":"On navigation","suites":["Loading indicator","Defaults in cypress env (doesn't show indicator)","Page with light/quick query doesn't show indicator"],"updatePoint":{"line":98,"column":23,"index":3078},"line":98,"code":"      it(`On navigation`, () => {\n        runTests({\n          ...config,\n          data: `quick-client-navigation-with-disabled-indicator`,\n          mode: `client-navigation`\n        });\n      });","file":"development-runtime/cypress/integration/navigation/loading-indicator.js","skipped":false,"dir":"e2e-tests"},{"name":"Initial first render","suites":["Loading indicator","Defaults in cypress env (doesn't show indicator)","Page with heavy/long running query doesn't show indicator (indicator is disabled)"],"updatePoint":{"line":112,"column":30,"index":3579},"line":112,"code":"      it(`Initial first render`, () => {\n        runTests({\n          ...config,\n          data: `slow-first-render-with-disabled-indicator`,\n          mode: `first-render`\n        });\n      });","file":"development-runtime/cypress/integration/navigation/loading-indicator.js","skipped":false,"dir":"e2e-tests"},{"name":"On navigation","suites":["Loading indicator","Defaults in cypress env (doesn't show indicator)","Page with heavy/long running query doesn't show indicator (indicator is disabled)"],"updatePoint":{"line":119,"column":23,"index":3767},"line":119,"code":"      it(`On navigation`, () => {\n        runTests({\n          ...config,\n          data: `slow-client-navigation-with-disabled-indicator`,\n          mode: `client-navigation`\n        });\n      });","file":"development-runtime/cypress/integration/navigation/loading-indicator.js","skipped":false,"dir":"e2e-tests"},{"name":"Initial first render","suites":["Loading indicator","With enabled loading indicator","Page with light/quick query doesn't show indicator"],"updatePoint":{"line":138,"column":30,"index":4313},"line":138,"code":"      it(`Initial first render`, () => {\n        runTests({\n          ...config,\n          data: `quick-first-render-with-enabled-indicator`,\n          mode: `first-render`\n        });\n      });","file":"development-runtime/cypress/integration/navigation/loading-indicator.js","skipped":false,"dir":"e2e-tests"},{"name":"On navigation","suites":["Loading indicator","With enabled loading indicator","Page with light/quick query doesn't show indicator"],"updatePoint":{"line":145,"column":23,"index":4501},"line":145,"code":"      it(`On navigation`, () => {\n        runTests({\n          ...config,\n          data: `quick-client-navigation-with-enabled-indicator`,\n          mode: `client-navigation`\n        });\n      });","file":"development-runtime/cypress/integration/navigation/loading-indicator.js","skipped":false,"dir":"e2e-tests"},{"name":"Initial first render","suites":["Loading indicator","With enabled loading indicator","Page with heavy/long running query shows indicator"],"updatePoint":{"line":159,"column":30,"index":4917},"line":159,"code":"      it(`Initial first render`, () => {\n        runTests({\n          ...config,\n          data: `slow-first-render-with-enabled-indicator`,\n          mode: `first-render`\n        });\n      });","file":"development-runtime/cypress/integration/navigation/loading-indicator.js","skipped":false,"dir":"e2e-tests"},{"name":"On navigation","suites":["Loading indicator","With enabled loading indicator","Page with heavy/long running query shows indicator"],"updatePoint":{"line":166,"column":23,"index":5104},"line":166,"code":"      it(`On navigation`, () => {\n        runTests({\n          ...config,\n          data: `slow-client-navigation-with-enabled-indicator`,\n          mode: `client-navigation`\n        });\n      });","file":"development-runtime/cypress/integration/navigation/loading-indicator.js","skipped":false,"dir":"e2e-tests"},{"name":"renders page when percent encoded query string value is used on client navigation","suites":["query-string","Supports percent encoded query string values"],"updatePoint":{"line":9,"column":89,"index":362},"line":9,"code":"    it(`renders page when percent encoded query string value is used on client navigation`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.window().then(win => win.___navigate(`/query-params?message=%25`)).waitForRouteChange();\n      cy.getTestElement(`location.search`).invoke(`text`).should(`equal`, `?message=%25`);\n    });","file":"development-runtime/cypress/integration/navigation/query-string.js","skipped":false,"dir":"e2e-tests"},{"name":"renders page when percent encoded query string value is used on direct visit ","suites":["query-string","Supports percent encoded query string values"],"updatePoint":{"line":14,"column":85,"index":697},"line":14,"code":"    it(`renders page when percent encoded query string value is used on direct visit `, () => {\n      cy.visit(`/query-params?message=%25`).waitForRouteChange();\n      cy.getTestElement(`location.search`).invoke(`text`).should(`equal`, `?message=%25`);\n    });","file":"development-runtime/cypress/integration/navigation/query-string.js","skipped":false,"dir":"e2e-tests"},{"name":"should not throw error when percent encoded query string value is used","suites":["query-string","Supports percent encoded query string values"],"updatePoint":{"line":18,"column":78,"index":951},"line":18,"code":"    it(`should not throw error when percent encoded query string value is used`, () => {\n      cy.get(`@consoleError`).should(`not.be.called`);\n    });","file":"development-runtime/cypress/integration/navigation/query-string.js","skipped":false,"dir":"e2e-tests"},{"name":"should redirect page to index page when there is no such page","suites":[],"updatePoint":{"line":2,"column":67,"index":93},"line":2,"code":"  it(`should redirect page to index page when there is no such page`, () => {\n    cy.visit(`/redirect-without-page/`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/`);\n  });","file":"development-runtime/cypress/integration/navigation/redirect.js","skipped":false,"dir":"e2e-tests"},{"name":"should redirect page to index page even there is a such page","suites":[],"updatePoint":{"line":8,"column":66,"index":327},"line":8,"code":"  it(`should redirect page to index page even there is a such page`, () => {\n    cy.visit(`/redirect/`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/`);\n  });","file":"development-runtime/cypress/integration/navigation/redirect.js","skipped":false,"dir":"e2e-tests"},{"name":"should redirect to a dynamically-created replacement page","suites":[],"updatePoint":{"line":14,"column":63,"index":545},"line":14,"code":"  it(`should redirect to a dynamically-created replacement page`, () => {\n    cy.visit(`/redirect-me/`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/pt/redirect-me/`);\n  });","file":"development-runtime/cypress/integration/navigation/redirect.js","skipped":false,"dir":"e2e-tests"},{"name":"should support hash parameter with Link component","suites":[],"updatePoint":{"line":20,"column":55,"index":773},"line":20,"code":"  it(`should support hash parameter with Link component`, () => {\n    cy.visit(`/`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.getTestElement(`redirect-two-anchor`).click().waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/redirect-search-hash/`);\n    cy.location(`hash`).should(`equal`, `#anchor`);\n    cy.location(`search`).should(`equal`, ``);\n  });","file":"development-runtime/cypress/integration/navigation/redirect.js","skipped":false,"dir":"e2e-tests"},{"name":"should support hash parameter on direct visit","suites":[],"updatePoint":{"line":29,"column":51,"index":1165},"line":29,"code":"  it(`should support hash parameter on direct visit`, () => {\n    cy.visit(`/redirect-two/#anchor`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/redirect-search-hash/`);\n    cy.location(`hash`).should(`equal`, `#anchor`);\n    cy.location(`search`).should(`equal`, ``);\n  });","file":"development-runtime/cypress/integration/navigation/redirect.js","skipped":false,"dir":"e2e-tests"},{"name":"should support search parameter with Link component","suites":[],"updatePoint":{"line":37,"column":57,"index":1508},"line":37,"code":"  it(`should support search parameter with Link component`, () => {\n    cy.visit(`/`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.getTestElement(`redirect-two-search`).click().waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/redirect-search-hash/`);\n    cy.location(`hash`).should(`equal`, ``);\n    cy.location(`search`).should(`equal`, `?query_param=hello`);\n  });","file":"development-runtime/cypress/integration/navigation/redirect.js","skipped":false,"dir":"e2e-tests"},{"name":"should support search parameter on direct visit","suites":[],"updatePoint":{"line":46,"column":53,"index":1913},"line":46,"code":"  it(`should support search parameter on direct visit`, () => {\n    cy.visit(`/redirect-two/?query_param=hello`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/redirect-search-hash/`);\n    cy.location(`hash`).should(`equal`, ``);\n    cy.location(`search`).should(`equal`, `?query_param=hello`);\n  });","file":"development-runtime/cypress/integration/navigation/redirect.js","skipped":false,"dir":"e2e-tests"},{"name":"should support search & hash parameter with Link component","suites":[],"updatePoint":{"line":54,"column":64,"index":2285},"line":54,"code":"  it(`should support search & hash parameter with Link component`, () => {\n    cy.visit(`/`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.getTestElement(`redirect-two-search-anchor`).click().waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/redirect-search-hash/`);\n    cy.location(`hash`).should(`equal`, `#anchor`);\n    cy.location(`search`).should(`equal`, `?query_param=hello`);\n  });","file":"development-runtime/cypress/integration/navigation/redirect.js","skipped":false,"dir":"e2e-tests"},{"name":"should support search & hash parameter on direct visit","suites":[],"updatePoint":{"line":63,"column":60,"index":2711},"line":63,"code":"  it(`should support search & hash parameter on direct visit`, () => {\n    cy.visit(`/redirect-two/?query_param=hello#anchor`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/redirect-search-hash/`);\n    cy.location(`hash`).should(`equal`, `#anchor`);\n    cy.location(`search`).should(`equal`, `?query_param=hello`);\n  });","file":"development-runtime/cypress/integration/navigation/redirect.js","skipped":false,"dir":"e2e-tests"},{"name":"make sure 404 is present","suites":["redirect","404 is present"],"updatePoint":{"line":81,"column":32,"index":3273},"line":81,"code":"    it(`make sure 404 is present`, () => {\n      cy.visit(`/______not_existing_page`, {\n        failOnStatusCode: false\n      }).waitForRouteChange();\n      cy.findByText(`Preview custom 404 page`).click();\n      cy.findByText(`A custom 404 page wasn't detected`, {\n        exact: false\n      }).should(`not.exist`);\n      cy.findByText(`You just hit a route that does not exist... the sadness.`).should(`exist`);\n    });","file":"development-runtime/cypress/integration/navigation/redirect.js","skipped":true,"dir":"e2e-tests"},{"name":"make sure 404 is NOT present","suites":["redirect","no 404"],"updatePoint":{"line":111,"column":36,"index":4179},"line":111,"code":"    it(`make sure 404 is NOT present`, () => {\n      cy.visit(`/______not_existing_page`, {\n        failOnStatusCode: false\n      }).waitForRouteChange();\n      cy.findByText(`Preview custom 404 page`).click();\n      cy.findByText(`A custom 404 page wasn't detected`, {\n        exact: false\n      }).should(`exist`);\n      cy.findByText(`You just hit a route that does not exist... the sadness.`, {\n        exact: false\n      }).should(`not.exist`);\n    });","file":"development-runtime/cypress/integration/navigation/redirect.js","skipped":true,"dir":"e2e-tests"},{"name":"should display message ","suites":["page not found"],"updatePoint":{"line":7,"column":29,"index":157},"line":7,"code":"  it(`should display message `, () => {\n    cy.get(`h1`).invoke(`text`).should(`eq`, `Gatsby.js development 404 page`);\n  });","file":"development-runtime/cypress/integration/page-not-found/404.js","skipped":false,"dir":"e2e-tests"},{"name":"can preview 404 page","suites":["page not found"],"updatePoint":{"line":10,"column":26,"index":280},"line":10,"code":"  it(`can preview 404 page`, () => {\n    cy.get(`button`).click();\n    cy.getTestElement(`page-title`).invoke(`text`).should(`eq`, `NOT FOUND`);\n  });","file":"development-runtime/cypress/integration/page-not-found/404.js","skipped":false,"dir":"e2e-tests"},{"name":"shows page listing","suites":["page not found"],"updatePoint":{"line":14,"column":24,"index":429},"line":14,"code":"  it(`shows page listing`, () => {\n    cy.get(`ul`).find(`li`).its(`length`).should(`be.gte`, 4);\n  });","file":"development-runtime/cypress/integration/page-not-found/404.js","skipped":false,"dir":"e2e-tests"},{"name":"should render correct dimensions","suites":["remote-file"],"updatePoint":{"line":30,"column":38,"index":889},"line":30,"code":"  it(`should render correct dimensions`, () => {\n    cy.get('[data-testid=\"public\"]').then(async $urls => {\n      const urls = Array.from($urls.map((_, $url) => $url.getAttribute(\"href\")));\n      for (const url of urls) {\n        const res = await fetch(url, {\n          method: \"HEAD\"\n        });\n        expect(res.ok).to.be.true;\n      }\n    });\n    cy.get(\".resize\").then(async $imgs => {\n      await testImages(Array.from($imgs), [{\n        width: 100,\n        height: 133\n      }, {\n        width: 100,\n        height: 160\n      }, {\n        width: 100,\n        height: 67\n      }]);\n    });\n    cy.get(\".fixed\").then(async $imgs => {\n      await testImages(Array.from($imgs), [{\n        width: 100,\n        height: 133\n      }, {\n        width: 100,\n        height: 160\n      }, {\n        width: 100,\n        height: 67\n      }]);\n    });\n    cy.get(\".constrained\").then(async $imgs => {\n      await testImages(Array.from($imgs), [{\n        width: 300,\n        height: 400\n      }, {\n        width: 300,\n        height: 481\n      }, {\n        width: 300,\n        height: 200\n      }]);\n    });\n    cy.get(\".full\").then(async $imgs => {\n      await testImages(Array.from($imgs), [{\n        height: 1229\n      }, {\n        height: 1478\n      }, {\n        height: 614\n      }]);\n    });\n  });","file":"development-runtime/cypress/integration/remote-file/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"should render a placeholder","suites":["remote-file"],"updatePoint":{"line":86,"column":33,"index":2181},"line":86,"code":"  it(`should render a placeholder`, () => {\n    cy.get(\".fixed [data-placeholder-image]\").first().should(\"have.css\", \"background-color\", \"rgb(232, 184, 8)\");\n    cy.get(\".constrained [data-placeholder-image]\").first().should($el => {\n      expect($el.prop(\"tagName\")).to.be.equal(\"IMG\");\n      expect($el.prop(\"src\")).to.contain(\"data:image/jpg;base64\");\n    });\n    cy.get(\".constrained_traced [data-placeholder-image]\").first().should($el => {\n      // traced falls back to DOMINANT_COLOR\n      expect($el.prop(\"tagName\")).to.be.equal(\"DIV\");\n      expect($el).to.be.empty;\n    });\n    cy.get(\".full [data-placeholder-image]\").first().should($el => {\n      expect($el.prop(\"tagName\")).to.be.equal(\"DIV\");\n      expect($el).to.be.empty;\n    });\n  });","file":"development-runtime/cypress/integration/remote-file/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"Pages created with slices mapping have correct content","suites":["Slice passed via createPage"],"updatePoint":{"line":8,"column":60,"index":278},"line":8,"code":"  it(\"Pages created with slices mapping have correct content\", () => {\n    allRecipes.forEach(recipe => {\n      cy.visit(`recipe/${recipe.id}`).waitForRouteChange();\n      cy.getTestElement(`recipe-name`).invoke(`text`).should(`contain`, recipe.name);\n      cy.getTestElement(`recipe-description`).invoke(`text`).should(`contain`, recipe.description);\n      cy.getTestElement(`recipe-author-name`).invoke(`text`).should(`contain`, allRecipeAuthors.find(author => recipe.authorId === author.id).name);\n    });\n  });","file":"development-runtime/cypress/integration/slices/slice-via-create-page.js","skipped":false,"dir":"e2e-tests"},{"name":"404 pages with slices mapping have correct content","suites":["Slice passed via createPage"],"updatePoint":{"line":16,"column":56,"index":789},"line":16,"code":"  it(`404 pages with slices mapping have correct content`, () => {\n    cy.visit(`/doesnt-exist`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.get(`button`).click();\n    cy.getTestElement(`mapped-slice`).should(\"have.text\", \"My mapped Slice\");\n  });","file":"development-runtime/cypress/integration/slices/slice-via-create-page.js","skipped":false,"dir":"e2e-tests"},{"name":"Slice content show on screen","suites":["Slices"],"updatePoint":{"line":9,"column":34,"index":199},"line":9,"code":"  it(`Slice content show on screen`, () => {\n    cy.getTestElement(`footer-static-text`).invoke(`text`).should(`contain`, `Built with`);\n  });","file":"development-runtime/cypress/integration/slices/slices.js","skipped":false,"dir":"e2e-tests"},{"name":"Slice recieves context passed via createSlice","suites":["Slices"],"updatePoint":{"line":12,"column":51,"index":359},"line":12,"code":"  it(`Slice recieves context passed via createSlice`, () => {\n    cy.getTestElement(`footer-slice-context-value`).invoke(`text`).should(`contain`, `Gatsby`);\n  });","file":"development-runtime/cypress/integration/slices/slices.js","skipped":false,"dir":"e2e-tests"},{"name":"Slice can take in props","suites":["Slices"],"updatePoint":{"line":15,"column":29,"index":501},"line":15,"code":"  it(`Slice can take in props`, () => {\n    cy.getTestElement(`footer-props`).invoke(`text`).should(`contains`, `Gatsbyjs`);\n  });","file":"development-runtime/cypress/integration/slices/slices.js","skipped":false,"dir":"e2e-tests"},{"name":"Slice can consume a context wrapped in WrapRootElement","suites":["Slices"],"updatePoint":{"line":18,"column":60,"index":663},"line":18,"code":"  it(`Slice can consume a context wrapped in WrapRootElement`, () => {\n    cy.getTestElement(`footer-context-derieved-value`).invoke(`text`).should(`contain`, `2`);\n  });","file":"development-runtime/cypress/integration/slices/slices.js","skipped":false,"dir":"e2e-tests"},{"name":"Direct visit no query params","suites":["Static path ('')"],"updatePoint":{"line":5,"column":34,"index":207},"line":5,"code":"  it(`Direct visit no query params`, () => {\n    cy.visit(staticPath).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{}`);\n  });","file":"development-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Direct visit with query params","suites":["Static path ('')"],"updatePoint":{"line":10,"column":36,"index":402},"line":10,"code":"  it(`Direct visit with query params`, () => {\n    cy.visit(staticPath + `?foo=bar`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{}`);\n  });","file":"development-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Client navigation to same path with different query params","suites":["Static path ('')"],"updatePoint":{"line":15,"column":64,"index":649},"line":15,"code":"  it(`Client navigation to same path with different query params`, () => {\n    cy.visit(staticPath).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{}`);\n    cy.window().then(win => win.___navigate(staticPath + `?foo=bar`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{}`);\n    cy.window().then(win => win.___navigate(staticPath + `?foo=baz`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"baz\"}`);\n    cy.getTestElement(`params`).contains(`{}`);\n    cy.window().then(win => win.___navigate(staticPath)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{}`);\n  });","file":"development-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Preserves window.location.search as querystring passed","suites":["Static path ('')"],"updatePoint":{"line":29,"column":60,"index":1438},"line":29,"code":"  it(`Preserves window.location.search as querystring passed`, () => {\n    const queryString = `?a=b%23&x=y%25&j=`;\n    cy.visit(staticPath + queryString).waitForRouteChange();\n    cy.window().then(win => {\n      expect(win.location.search).to.equal(queryString);\n    });\n  });","file":"development-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Direct visit no query params","suites":["Param path (':param')"],"updatePoint":{"line":38,"column":34,"index":1748},"line":38,"code":"  it(`Direct visit no query params`, () => {\n    cy.visit(paramPath + `foo/`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"param\":\"foo\"}`);\n  });","file":"development-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Direct visit with query params","suites":["Param path (':param')"],"updatePoint":{"line":43,"column":36,"index":1964},"line":43,"code":"  it(`Direct visit with query params`, () => {\n    cy.visit(paramPath + `foo/` + `?foo=bar`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{\"param\":\"foo\"}`);\n  });","file":"development-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Client navigation to same param path with different query params and url params","suites":["Param path (':param')"],"updatePoint":{"line":48,"column":85,"index":2253},"line":48,"code":"  it(`Client navigation to same param path with different query params and url params`, () => {\n    cy.visit(paramPath + `foo/`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"param\":\"foo\"}`);\n    cy.window().then(win => win.___navigate(paramPath + `foo/` + `?foo=bar`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{\"param\":\"foo\"}`);\n    cy.window().then(win => win.___navigate(paramPath + `baz/` + `?foo=bar`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{\"param\":\"baz\"}`);\n    cy.window().then(win => win.___navigate(paramPath + `baz/`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"param\":\"baz\"}`);\n  });","file":"development-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Direct visit no query params","suites":["Wildcard path ('*')"],"updatePoint":{"line":64,"column":34,"index":3159},"line":64,"code":"  it(`Direct visit no query params`, () => {\n    cy.visit(wildcardPath + `foo/nested/`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"wildcard\":\"foo/nested\"}`);\n  });","file":"development-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Direct visit with query params","suites":["Wildcard path ('*')"],"updatePoint":{"line":69,"column":36,"index":3395},"line":69,"code":"  it(`Direct visit with query params`, () => {\n    cy.visit(wildcardPath + `foo/nested/` + `?foo=bar`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{\"wildcard\":\"foo/nested\"}`);\n  });","file":"development-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Client navigation to same param path with different query params and url params","suites":["Wildcard path ('*')"],"updatePoint":{"line":74,"column":85,"index":3704},"line":74,"code":"  it(`Client navigation to same param path with different query params and url params`, () => {\n    cy.visit(wildcardPath + `foo/`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"wildcard\":\"foo\"}`);\n    cy.window().then(win => win.___navigate(wildcardPath + `foo/` + `?foo=bar`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{\"wildcard\":\"foo\"}`);\n    cy.window().then(win => win.___navigate(wildcardPath + `baz/` + `?foo=bar`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{\"wildcard\":\"baz\"}`);\n    cy.window().then(win => win.___navigate(wildcardPath + `baz/`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"wildcard\":\"baz\"}`);\n  });","file":"development-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"renders a spacer svg","suites":["constrained"],"updatePoint":{"line":5,"column":26,"index":150},"line":5,"code":"  it(`renders a spacer svg`, () => {\n    cy.getTestElement(`image-constrained`).find(`img[role=presentation]`).should(`have.attr`, `src`).and(`match`, /svg\\+xml/);\n  });","file":"development-runtime/cypress/integration/static-image/constrained.js","skipped":false,"dir":"e2e-tests"},{"name":"includes sizes attribute with default width","suites":["constrained"],"updatePoint":{"line":8,"column":49,"index":343},"line":8,"code":"  it(`includes sizes attribute with default width`, () => {\n    cy.getTestElement(`image-constrained`).find(`[data-main-image]`).should(`have.attr`, `sizes`).and(`equal`, `(min-width: 4015px) 4015px, 100vw`);\n  });","file":"development-runtime/cypress/integration/static-image/constrained.js","skipped":false,"dir":"e2e-tests"},{"name":"includes sizes attribute with specified width","suites":["constrained"],"updatePoint":{"line":11,"column":51,"index":560},"line":11,"code":"  it(`includes sizes attribute with specified width`, () => {\n    cy.getTestElement(`image-constrained-limit`).find(`[data-main-image]`).should(`have.attr`, `sizes`).and(`equal`, `(min-width: 500px) 500px, 100vw`);\n  });","file":"development-runtime/cypress/integration/static-image/constrained.js","skipped":false,"dir":"e2e-tests"},{"name":"overrides sizes","suites":["constrained"],"updatePoint":{"line":14,"column":21,"index":751},"line":14,"code":"  it(`overrides sizes`, () => {\n    cy.getTestElement(`image-constrained-override`).find(`[data-main-image]`).should(`have.attr`, `sizes`).and(`equal`, `100vw`);\n  });","file":"development-runtime/cypress/integration/static-image/constrained.js","skipped":false,"dir":"e2e-tests"},{"name":"applies height and width to wrapper","suites":["fixed"],"updatePoint":{"line":6,"column":41,"index":188},"line":6,"code":"  it(`applies height and width to wrapper`, () => {\n    cy.getTestElement(fixedTestId).find(`.gatsby-image-wrapper`).should(`have.attr`, `style`).and(style => {\n      ;\n      [`height:`, `width:`].forEach(part => {\n        expect(style).contains(part);\n      });\n    });\n  });","file":"development-runtime/cypress/integration/static-image/fixed.js","skipped":false,"dir":"e2e-tests"},{"name":"works on png files","suites":["fixed"],"updatePoint":{"line":14,"column":24,"index":448},"line":14,"code":"  it(`works on png files`, () => {\n    cy.getTestElement(`image-fixed-png`).find(`.gatsby-image-wrapper`).should(`exist`);\n  });","file":"development-runtime/cypress/integration/static-image/fixed.js","skipped":false,"dir":"e2e-tests"},{"name":"works on relative paths outside of src","suites":["fixed"],"updatePoint":{"line":17,"column":44,"index":597},"line":17,"code":"  it(`works on relative paths outside of src`, () => {\n    cy.getTestElement(`image-fixed-relative`).find(`.gatsby-image-wrapper`).should(`exist`);\n  });","file":"development-runtime/cypress/integration/static-image/fixed.js","skipped":false,"dir":"e2e-tests"},{"name":"includes sizes attribute","suites":["fixed"],"updatePoint":{"line":20,"column":30,"index":737},"line":20,"code":"  it(`includes sizes attribute`, () => {\n    cy.getTestElement(fixedTestId).find(`[data-main-image]`).should(`have.attr`, `sizes`).should(`equal`, `500px`);\n  });","file":"development-runtime/cypress/integration/static-image/fixed.js","skipped":false,"dir":"e2e-tests"},{"name":"works on png files","suites":["full-width"],"updatePoint":{"line":6,"column":24,"index":181},"line":6,"code":"  it(`works on png files`, () => {\n    cy.getTestElement(`image-fluid-png`).find(`.gatsby-image-wrapper`).should(`exist`);\n  });","file":"development-runtime/cypress/integration/static-image/full-width.js","skipped":false,"dir":"e2e-tests"},{"name":"works on relative paths outside of src","suites":["full-width"],"updatePoint":{"line":9,"column":44,"index":330},"line":9,"code":"  it(`works on relative paths outside of src`, () => {\n    cy.getTestElement(`image-fluid-relative`).find(`.gatsby-image-wrapper`).should(`exist`);\n  });","file":"development-runtime/cypress/integration/static-image/full-width.js","skipped":false,"dir":"e2e-tests"},{"name":"renders a spacer div","suites":["full-width"],"updatePoint":{"line":12,"column":26,"index":466},"line":12,"code":"  it(`renders a spacer div`, () => {\n    cy.getTestElement(fluidTestId).find(`.gatsby-image-wrapper > div`).should(`have.attr`, `style`).and(`match`, /padding/);\n  });","file":"development-runtime/cypress/integration/static-image/full-width.js","skipped":false,"dir":"e2e-tests"},{"name":"includes sizes attribute","suites":["full-width"],"updatePoint":{"line":15,"column":30,"index":638},"line":15,"code":"  it(`includes sizes attribute`, () => {\n    cy.getTestElement(fluidTestId).find(`[data-main-image]`).should(`have.attr`, `sizes`).should(`equal`, `100vw`);\n  });","file":"development-runtime/cypress/integration/static-image/full-width.js","skipped":false,"dir":"e2e-tests"},{"name":"exists","suites":["Production gatsby-image","wrapping elements","outer div"],"updatePoint":{"line":8,"column":16,"index":260},"line":8,"code":"      it(`exists`, () => {\n        cy.getTestElement(fluidTestId).find(`.gatsby-image-wrapper`).its(`length`).should(`eq`, 1);\n      });","file":"development-runtime/cypress/integration/static-image/image.js","skipped":false,"dir":"e2e-tests"},{"name":"will not appear","suites":["Production gatsby-image","invalid image"],"updatePoint":{"line":14,"column":23,"index":454},"line":14,"code":"    it(`will not appear`, () => {\n      cy.getTestElement(`invalid-image`).find(`.gatsby-image-wrapper`).should(`not.exist`);\n    });","file":"development-runtime/cypress/integration/static-image/image.js","skipped":false,"dir":"e2e-tests"},{"name":"should not error","suites":["immediately unmounted"],"updatePoint":{"line":5,"column":22,"index":145},"line":5,"code":"  it(`should not error`, () => {\n    cy.assertNoFastRefreshOverlay();\n  });","file":"development-runtime/cypress/integration/static-image/immediately-unmounted.js","skipped":false,"dir":"e2e-tests"},{"name":"lazy loads an image when scrolling","suites":["gatsby-plugin-image / intersection observer"],"updatePoint":{"line":9,"column":40,"index":322},"line":9,"code":"  it(`lazy loads an image when scrolling`, () => {\n    cy.window().then(win => {\n      expect(`loading` in win.HTMLImageElement.prototype).to.equal(false);\n    });\n\n    // We need to wait for a decent amount of time so that the image\n    // can resolve. This is necessary because the assertion\n    // is done outside the Cypress scheduler and so, Cypress is not able\n    // to ping for the specific assertion to be truthy.\n    cy.wait(500);\n    cy.get(`[data-cy=already-loaded]`).should(`be.visible`).then($img => {\n      expect($img[0].complete).to.equal(true);\n    });\n    cy.get(`[data-cy=lazy-loaded]`).should(`exist`).then($img => {\n      expect($img[0].naturalHeight).to.equal(0);\n    });\n    cy.scrollTo(`bottom`);\n    cy.wait(500);\n    cy.get(`[data-cy=lazy-loaded]`).should(`exist`).then($img => {\n      expect($img[0].naturalHeight).to.be.greaterThan(0);\n    });\n  });","file":"development-runtime/cypress/integration/static-image/intesection-observer.js","skipped":false,"dir":"e2e-tests"},{"name":"lazy loads an image when scrolling","suites":["gatsby-plugin-image / native lazy loading"],"updatePoint":{"line":5,"column":40,"index":174},"line":5,"code":"  it(`lazy loads an image when scrolling`, () => {\n    // We need to wait for a decent amount of time so that the image\n    // can resolve. This is necessary because the assertion\n    // is done outside the Cypress scheduler and so, Cypress is not able\n    // to ping for the specific assertion to be truthy.\n    cy.wait(500);\n    cy.get(`[data-cy=already-loaded]`).should(`be.visible`).then($img => {\n      expect($img[0].complete).to.equal(true);\n    });\n    cy.get(`[data-cy=lazy-loaded]`).should(`exist`).then($img => {\n      expect($img[0].complete).to.equal(false);\n    });\n    cy.scrollTo(`bottom`);\n    cy.wait(500);\n    cy.get(`[data-cy=lazy-loaded]`).should(`exist`).then($img => {\n      expect($img[0].complete).to.equal(true);\n    });\n  });","file":"development-runtime/cypress/integration/static-image/native-lazy-loading.js","skipped":false,"dir":"e2e-tests"},{"name":"traced svg (falls back to DOMINANT_COLOR)","suites":["fixed"],"updatePoint":{"line":6,"column":47,"index":197},"line":6,"code":"  it(`traced svg (falls back to DOMINANT_COLOR)`, () => {\n    cy.getTestElement(tracedTestId).find(`.gatsby-image-wrapper > [data-placeholder-image]`).first().should($el => {\n      // traced falls\n      expect($el.prop(\"tagName\")).to.be.equal(\"DIV\");\n      expect($el).to.be.empty;\n    });\n  });","file":"development-runtime/cypress/integration/static-image/traced.js","skipped":false,"dir":"e2e-tests"},{"name":"works on png files","suites":["fixed"],"updatePoint":{"line":13,"column":24,"index":470},"line":13,"code":"  it(`works on png files`, () => {\n    cy.getTestElement(`image-traced-png`).find(`.gatsby-image-wrapper`).should(`exist`);\n  });","file":"development-runtime/cypress/integration/static-image/traced.js","skipped":false,"dir":"e2e-tests"},{"name":"works on relative paths outside of src","suites":["fixed"],"updatePoint":{"line":16,"column":44,"index":620},"line":16,"code":"  it(`works on relative paths outside of src`, () => {\n    cy.getTestElement(`image-traced-relative`).find(`.gatsby-image-wrapper`).should(`exist`);\n  });","file":"development-runtime/cypress/integration/static-image/traced.js","skipped":false,"dir":"e2e-tests"},{"name":"initial styling is correct","suites":["styling: css modules"],"updatePoint":{"line":11,"column":32,"index":253},"line":11,"code":"  it(`initial styling is correct`, () => {\n    cy.getTestElement(`styled-element`).should(`have.css`, `color`, `rgb(0, 128, 0)`);\n  });","file":"development-runtime/cypress/integration/styling/css-modules.js","skipped":false,"dir":"e2e-tests"},{"name":"updates on change","suites":["styling: css modules"],"updatePoint":{"line":14,"column":23,"index":380},"line":14,"code":"  it(`updates on change`, () => {\n    cy.exec(`npm run update -- --file src/pages/styling/css-modules.module.css --replacements \"green:blue\" --exact`);\n    cy.waitForHmr();\n    cy.getTestElement(`styled-element`).should(`have.css`, `color`, `rgb(0, 0, 255)`);\n  });","file":"development-runtime/cypress/integration/styling/css-modules.js","skipped":false,"dir":"e2e-tests"},{"name":"initial styling is correct","suites":["styling: less"],"updatePoint":{"line":8,"column":32,"index":160},"line":8,"code":"  it(`initial styling is correct`, () => {\n    cy.visit(`/styling/less`).waitForRouteChange();\n    cy.getTestElement(`less-styled-element`).should(`have.css`, `color`, `rgb(255, 0, 0)`);\n    cy.getTestElement(`less-module-styled-element`).should(`have.css`, `color`, `rgb(0, 128, 0)`);\n  });","file":"development-runtime/cypress/integration/styling/less.js","skipped":false,"dir":"e2e-tests"},{"name":"plain less","suites":["styling: less","hot reloading"],"updatePoint":{"line":17,"column":18,"index":559},"line":17,"code":"    it(`plain less`, () => {\n      cy.exec(`npm run update -- --file src/pages/styling/less-plain.less --replacements \"red:blue\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`less-styled-element`).should(`have.css`, `color`, `rgb(0, 0, 255)`);\n    });","file":"development-runtime/cypress/integration/styling/less.js","skipped":false,"dir":"e2e-tests"},{"name":"less module","suites":["styling: less","hot reloading"],"updatePoint":{"line":22,"column":19,"index":825},"line":22,"code":"    it(`less module`, () => {\n      cy.exec(`npm run update -- --file src/pages/styling/less.module.less --replacements \"green:blue\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`less-module-styled-element`).should(`have.css`, `color`, `rgb(0, 0, 255)`);\n    });","file":"development-runtime/cypress/integration/styling/less.js","skipped":false,"dir":"e2e-tests"},{"name":"initial styling is correct","suites":["styling: plain css"],"updatePoint":{"line":8,"column":32,"index":165},"line":8,"code":"  it(`initial styling is correct`, () => {\n    cy.visit(`/styling/plain-css`).waitForRouteChange();\n    cy.getTestElement(`styled-element`).should(`have.css`, `color`, `rgb(255, 0, 0)`);\n    cy.getTestElement(`styled-element-that-is-not-styled-initially`).should(`have.css`, `color`, `rgb(0, 0, 0)`);\n    cy.getTestElement(`styled-element-by-not-visited-template`).should(`have.css`, `color`, `rgb(255, 0, 0)`);\n    cy.getTestElement(`styled-element-that-is-not-styled-initially-by-not-visited-template`).should(`have.css`, `color`, `rgb(0, 0, 0)`);\n  });","file":"development-runtime/cypress/integration/styling/plain-css.js","skipped":false,"dir":"e2e-tests"},{"name":"updates on already imported css file change","suites":["styling: plain css","changing styles/imports imported by visited template"],"updatePoint":{"line":19,"column":51,"index":905},"line":19,"code":"    it(`updates on already imported css file change`, () => {\n      cy.exec(`npm run update -- --file src/pages/styling/plain-css.css --replacements \"red:blue\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`styled-element`).should(`have.css`, `color`, `rgb(0, 0, 255)`);\n    });","file":"development-runtime/cypress/integration/styling/plain-css.js","skipped":false,"dir":"e2e-tests"},{"name":"importing new css file result in styles being applied","suites":["styling: plain css","changing styles/imports imported by visited template"],"updatePoint":{"line":24,"column":61,"index":1206},"line":24,"code":"    it(`importing new css file result in styles being applied`, () => {\n      cy.exec(`npm run update -- --file src/pages/styling/plain-css.js --replacements \"// UNCOMMENT-IN-TEST:/* IMPORT-TO-COMMENT-OUT-AGAIN */\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`styled-element-that-is-not-styled-initially`).should(`have.css`, `color`, `rgb(255, 0, 0)`);\n    });","file":"development-runtime/cypress/integration/styling/plain-css.js","skipped":false,"dir":"e2e-tests"},{"name":"updating newly imported css file result in styles being applied","suites":["styling: plain css","changing styles/imports imported by visited template"],"updatePoint":{"line":29,"column":71,"index":1591},"line":29,"code":"    it(`updating newly imported css file result in styles being applied`, () => {\n      cy.exec(`npm run update -- --file src/pages/styling/plain-css-not-imported-initially.css --replacements \"red:green\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`styled-element-that-is-not-styled-initially`).should(`have.css`, `color`, `rgb(0, 128, 0)`);\n    });","file":"development-runtime/cypress/integration/styling/plain-css.js","skipped":false,"dir":"e2e-tests"},{"name":"removing css import results in styles being removed","suites":["styling: plain css","changing styles/imports imported by visited template"],"updatePoint":{"line":34,"column":59,"index":1943},"line":34,"code":"    it(`removing css import results in styles being removed`, () => {\n      cy.exec(`npm run update -- --file src/pages/styling/plain-css.js --replacements \"/* IMPORT-TO-COMMENT-OUT-AGAIN */:// COMMENTED-AGAIN\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`styled-element-that-is-not-styled-initially`).should(`have.css`, `color`, `rgb(0, 0, 0)`);\n    });","file":"development-runtime/cypress/integration/styling/plain-css.js","skipped":false,"dir":"e2e-tests"},{"name":"updates on already imported css file change by not visited template","suites":["styling: plain css","changing styles/imports imported by NOT visited template"],"updatePoint":{"line":44,"column":75,"index":2503},"line":44,"code":"    it(`updates on already imported css file change by not visited template`, () => {\n      cy.exec(`npm run update -- --file src/pages/styling/not-visited-plain-css.css --replacements \"red:blue\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`styled-element-by-not-visited-template`).should(`have.css`, `color`, `rgb(0, 0, 255)`);\n    });","file":"development-runtime/cypress/integration/styling/plain-css.js","skipped":false,"dir":"e2e-tests"},{"name":"importing new css file result in styles being applied","suites":["styling: plain css","changing styles/imports imported by NOT visited template"],"updatePoint":{"line":49,"column":61,"index":2840},"line":49,"code":"    it(`importing new css file result in styles being applied`, () => {\n      cy.exec(`npm run update -- --file src/pages/styling/not-visited-plain-css.js --replacements \"// UNCOMMENT-IN-TEST:/* IMPORT-TO-COMMENT-OUT-AGAIN */\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`styled-element-that-is-not-styled-initially-by-not-visited-template`).should(`have.css`, `color`, `rgb(255, 0, 0)`);\n    });","file":"development-runtime/cypress/integration/styling/plain-css.js","skipped":false,"dir":"e2e-tests"},{"name":"updating newly imported css file result in styles being applied","suites":["styling: plain css","changing styles/imports imported by NOT visited template"],"updatePoint":{"line":54,"column":71,"index":3261},"line":54,"code":"    it(`updating newly imported css file result in styles being applied`, () => {\n      cy.exec(`npm run update -- --file src/pages/styling/not-visited-plain-css-not-imported-initially.css --replacements \"red:green\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`styled-element-that-is-not-styled-initially-by-not-visited-template`).should(`have.css`, `color`, `rgb(0, 128, 0)`);\n    });","file":"development-runtime/cypress/integration/styling/plain-css.js","skipped":false,"dir":"e2e-tests"},{"name":"removing css import results in styles being removed","suites":["styling: plain css","changing styles/imports imported by NOT visited template"],"updatePoint":{"line":59,"column":59,"index":3649},"line":59,"code":"    it(`removing css import results in styles being removed`, () => {\n      cy.exec(`npm run update -- --file src/pages/styling/not-visited-plain-css.js --replacements \"/* IMPORT-TO-COMMENT-OUT-AGAIN */:// COMMENTED-AGAIN\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`styled-element-that-is-not-styled-initially-by-not-visited-template`).should(`have.css`, `color`, `rgb(0, 0, 0)`);\n    });","file":"development-runtime/cypress/integration/styling/plain-css.js","skipped":false,"dir":"e2e-tests"},{"name":"initial styling is correct","suites":["styling: sass"],"updatePoint":{"line":8,"column":32,"index":160},"line":8,"code":"  it(`initial styling is correct`, () => {\n    cy.visit(`/styling/sass`).waitForRouteChange();\n    cy.getTestElement(`sass-styled-element`).should(`have.css`, `color`, `rgb(255, 0, 0)`);\n    cy.getTestElement(`sass-module-styled-element`).should(`have.css`, `color`, `rgb(0, 128, 0)`);\n  });","file":"development-runtime/cypress/integration/styling/sass.js","skipped":false,"dir":"e2e-tests"},{"name":"plain sass","suites":["styling: sass","hot reloading"],"updatePoint":{"line":17,"column":18,"index":559},"line":17,"code":"    it(`plain sass`, () => {\n      cy.exec(`npm run update -- --file src/pages/styling/sass-plain.scss --replacements \"red:blue\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`sass-styled-element`).should(`have.css`, `color`, `rgb(0, 0, 255)`);\n    });","file":"development-runtime/cypress/integration/styling/sass.js","skipped":false,"dir":"e2e-tests"},{"name":"sass module","suites":["styling: sass","hot reloading"],"updatePoint":{"line":22,"column":19,"index":825},"line":22,"code":"    it(`sass module`, () => {\n      cy.exec(`npm run update -- --file src/pages/styling/sass.module.scss --replacements \"green:blue\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`sass-module-styled-element`).should(`have.css`, `color`, `rgb(0, 0, 255)`);\n    });","file":"development-runtime/cypress/integration/styling/sass.js","skipped":false,"dir":"e2e-tests"},{"name":"initial styling is correct","suites":["styling: stylus"],"updatePoint":{"line":8,"column":32,"index":162},"line":8,"code":"  it(`initial styling is correct`, () => {\n    cy.visit(`/styling/stylus`).waitForRouteChange();\n    cy.getTestElement(`stylus-styled-element`).should(`have.css`, `color`, `rgb(255, 0, 0)`);\n    cy.getTestElement(`stylus-module-styled-element`).should(`have.css`, `color`, `rgb(0, 128, 0)`);\n  });","file":"development-runtime/cypress/integration/styling/stylus.js","skipped":false,"dir":"e2e-tests"},{"name":"plain stylus","suites":["styling: stylus","hot reloading"],"updatePoint":{"line":17,"column":20,"index":571},"line":17,"code":"    it(`plain stylus`, () => {\n      cy.exec(`npm run update -- --file src/pages/styling/stylus-plain.styl --replacements \"red:blue\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`stylus-styled-element`).should(`have.css`, `color`, `rgb(0, 0, 255)`);\n    });","file":"development-runtime/cypress/integration/styling/stylus.js","skipped":false,"dir":"e2e-tests"},{"name":"stylus module","suites":["styling: stylus","hot reloading"],"updatePoint":{"line":22,"column":21,"index":843},"line":22,"code":"    it(`stylus module`, () => {\n      cy.exec(`npm run update -- --file src/pages/styling/stylus.module.styl --replacements \"green:blue\" --exact`);\n      cy.waitForHmr();\n      cy.getTestElement(`stylus-module-styled-element`).should(`have.css`, `color`, `rgb(0, 0, 255)`);\n    });","file":"development-runtime/cypress/integration/styling/stylus.js","skipped":false,"dir":"e2e-tests"},{"name":"includes the title","suites":["the site data object"],"updatePoint":{"line":5,"column":24,"index":121},"line":5,"code":"  it(`includes the title`, () => {\n    cy.getTestElement(`title`).invoke(`text`).should(`equal`, `Gatsby Default Starter`);\n  });","file":"development-runtime/cypress/integration/types/site-data.js","skipped":false,"dir":"e2e-tests"},{"name":"includes site host","suites":["the site data object"],"updatePoint":{"line":8,"column":24,"index":251},"line":8,"code":"  it(`includes site host`, () => {\n    cy.getTestElement(`host`).invoke(`text`).should(`equal`, `localhost`);\n  });","file":"development-runtime/cypress/integration/types/site-data.js","skipped":false,"dir":"e2e-tests"},{"name":"default description is null","suites":["the site data object"],"updatePoint":{"line":11,"column":33,"index":376},"line":11,"code":"  it(`default description is null`, () => {\n    cy.getTestElement(`description`).invoke(`text`).should(`equal`, `description is null`);\n  });","file":"development-runtime/cypress/integration/types/site-data.js","skipped":false,"dir":"e2e-tests"},{"name":"includes nested metadata","suites":["the site data object"],"updatePoint":{"line":14,"column":30,"index":515},"line":14,"code":"  it(`includes nested metadata`, () => {\n    cy.getTestElement(`twitter`).invoke(`text`).should(`equal`, `kylemathews`);\n  });","file":"development-runtime/cypress/integration/types/site-data.js","skipped":false,"dir":"e2e-tests"},{"name":"can recognise valid date strings","suites":["the site data object"],"updatePoint":{"line":17,"column":38,"index":650},"line":17,"code":"  it(`can recognise valid date strings`, () => {\n    cy.getTestElement(`validdate`).invoke(`text`).should(`equal`, `Invalid dates can be detected`);\n  });","file":"development-runtime/cypress/integration/types/site-data.js","skipped":false,"dir":"e2e-tests"},{"name":"includes valid build time","suites":["the site data object"],"updatePoint":{"line":20,"column":31,"index":798},"line":20,"code":"  it(`includes valid build time`, () => {\n    cy.getTestElement(`buildtime`).invoke(`text`).should(`equal`, `buildTime is valid`);\n  });","file":"development-runtime/cypress/integration/types/site-data.js","skipped":false,"dir":"e2e-tests"},{"name":"supports dynamic url segments","suites":["client-side-routing"],"updatePoint":{"line":2,"column":35,"index":76},"line":2,"code":"  it(`supports dynamic url segments`, () => {\n    cy.visit(`/client-dynamic-route/foo`).waitForRouteChange();\n    cy.findByTestId(`params`);\n    cy.should(`have.text`, `foo`);\n  });","file":"development-runtime/cypress/integration/unified-routing/client-side-routes.js","skipped":false,"dir":"e2e-tests"},{"name":"supports nested dynamic url segments","suites":["client-side-routing"],"updatePoint":{"line":7,"column":42,"index":265},"line":7,"code":"  it(`supports nested dynamic url segments`, () => {\n    cy.visit(`/client-dynamic-route/products/incite/holo-lens`).waitForRouteChange();\n    cy.findByTestId(`params-brand`);\n    cy.should(`have.text`, `incite`);\n    cy.findByTestId(`params-product`);\n    cy.should(`have.text`, `holo-lens`);\n  });","file":"development-runtime/cypress/integration/unified-routing/client-side-routes.js","skipped":false,"dir":"e2e-tests"},{"name":"supports splats","suites":["client-side-routing"],"updatePoint":{"line":14,"column":21,"index":544},"line":14,"code":"  it(`supports splats`, () => {\n    cy.visit(`/client-dynamic-route/splat/blah/blah/blah`).waitForRouteChange();\n    cy.findByTestId(`splat`);\n    cy.should(`have.text`, `blah/blah/blah`);\n  });","file":"development-runtime/cypress/integration/unified-routing/client-side-routes.js","skipped":false,"dir":"e2e-tests"},{"name":"supports named splats","suites":["client-side-routing"],"updatePoint":{"line":19,"column":27,"index":745},"line":19,"code":"  it(`supports named splats`, () => {\n    cy.visit(`/client-dynamic-route/named-splat/dolores`).waitForRouteChange();\n    cy.findByTestId(`splat`);\n    cy.should(`have.text`, `dolores`);\n    cy.findByTestId(`title`);\n    cy.should(`have.text`, `Named SPLAT`);\n  });","file":"development-runtime/cypress/integration/unified-routing/client-side-routes.js","skipped":false,"dir":"e2e-tests"},{"name":"can create simplest collection route that also has a number as an identifier","suites":["collection-routing"],"updatePoint":{"line":33,"column":82,"index":993},"line":33,"code":"  it(`can create simplest collection route that also has a number as an identifier`, () => {\n    cy.visit(`/collection-routing/1/`).waitForRouteChange();\n    cy.findByTestId(`slug`).should(`have.text`, `/preview/1`);\n    cy.findByTestId(`pagecontext`).should(`have.text`, `1`);\n  });","file":"development-runtime/cypress/integration/unified-routing/collection-routing.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to a collection route and see its content rendered","suites":["collection-routing"],"updatePoint":{"line":38,"column":69,"index":1264},"line":38,"code":"  it(`can navigate to a collection route and see its content rendered`, () => {\n    cy.visit(`/collection-routing`).waitForRouteChange();\n    // this test depends on the alphabetical sorting of markdown files\n    cy.findByTestId(`collection-routing-blog-0`).should(`have.attr`, `data-testslug`, `/2018-12-14-hello-world/`).click();\n    cy.waitForRouteChange().assertRoute(`/collection-routing/2018-12-14-hello-world/`);\n    cy.findByTestId(`slug`);\n    cy.should(`have.text`, `/2018-12-14-hello-world/`);\n    cy.findByTestId(`pagecontext`);\n    cy.should(`have.text`, `/2018-12-14-hello-world/`);\n  });","file":"development-runtime/cypress/integration/unified-routing/collection-routing.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to a collection route that uses unions and see its content rendered","suites":["collection-routing"],"updatePoint":{"line":48,"column":86,"index":1884},"line":48,"code":"  it(`can navigate to a collection route that uses unions and see its content rendered`, () => {\n    cy.visit(`/collection-routing`).waitForRouteChange();\n    // this test depends on the alphabetical sorting of image files\n    cy.findByTestId(`collection-routing-image-0`).should(`have.attr`, `data-testimagename`, `citrus-fruits`).click();\n    cy.waitForRouteChange().assertRoute(`/collection-routing/citrus-fruits/`);\n    cy.findByTestId(`name`);\n    cy.should(`have.text`, `citrus-fruits`);\n    cy.findByTestId(`pagecontext`);\n    cy.should(`have.text`, `citrus-fruits`);\n  });","file":"development-runtime/cypress/integration/unified-routing/collection-routing.js","skipped":false,"dir":"e2e-tests"},{"name":"should allow normal folder","suites":["collection-routing"],"updatePoint":{"line":58,"column":32,"index":2411},"line":58,"code":"  it(`should allow normal folder`, () => {\n    cy.visit(`/collection-routing/hogwarts/1/`).waitForRouteChange();\n    cy.findByTestId(`custom-text`).should(`have.text`, `static-folder`);\n    cy.findByTestId(`pagecontext`).should(`have.text`, `1`);\n  });","file":"development-runtime/cypress/integration/unified-routing/collection-routing.js","skipped":false,"dir":"e2e-tests"},{"name":"should allow static template","suites":["collection-routing"],"updatePoint":{"line":63,"column":34,"index":2666},"line":63,"code":"  it(`should allow static template`, () => {\n    cy.visit(`/collection-routing/westworld/1/template`).waitForRouteChange();\n    cy.findByTestId(`custom-text`).should(`have.text`, `Static Template`);\n    cy.findByTestId(`pagecontext`).should(`have.text`, `1`);\n  });","file":"development-runtime/cypress/integration/unified-routing/collection-routing.js","skipped":false,"dir":"e2e-tests"},{"name":"should allow nested collections","suites":["collection-routing"],"updatePoint":{"line":68,"column":37,"index":2935},"line":68,"code":"  it(`should allow nested collections`, () => {\n    cy.visit(`/collection-routing/hello-world-1/1`).waitForRouteChange();\n    cy.findByTestId(`slug`).should(`have.text`, `/preview/1 + test`);\n    cy.findByTestId(`pagecontext`).should(`have.text`, `1`);\n  });","file":"development-runtime/cypress/integration/unified-routing/collection-routing.js","skipped":false,"dir":"e2e-tests"},{"name":"supports nested collection + client-only route","suites":["collection-routing"],"updatePoint":{"line":73,"column":52,"index":3209},"line":73,"code":"  it(`supports nested collection + client-only route`, () => {\n    cy.visit(`/collection-routing/hello-world-1/dolores`).waitForRouteChange();\n    cy.findByTestId(`splat`);\n    cy.should(`have.text`, `dolores`);\n    cy.findByTestId(`title`);\n    cy.should(`have.text`, `Named SPLAT Nested with Collection Route!`);\n  });","file":"development-runtime/cypress/integration/unified-routing/collection-routing.js","skipped":false,"dir":"e2e-tests"},{"name":"creates a page when new node is created","suites":["collection-routing","data updates"],"updatePoint":{"line":87,"column":47,"index":3661},"line":87,"code":"    it(`creates a page when new node is created`, () => {\n      assert404(`new-node`);\n      assert404(`updated-node`);\n      refresh(`create`);\n      assertPageExist(`new-node`, `This is node that was just created`);\n      assert404(`updated-node`);\n    });","file":"development-runtime/cypress/integration/unified-routing/collection-routing.js","skipped":false,"dir":"e2e-tests"},{"name":"remove previous page and add a new one when slug changes","suites":["collection-routing","data updates"],"updatePoint":{"line":94,"column":64,"index":3937},"line":94,"code":"    it(`remove previous page and add a new one when slug changes`, () => {\n      assertPageExist(`new-node`, `This is node that was just created`);\n      assert404(`updated-node`);\n      refresh(`update`);\n      assertPageExist(`updated-node`, `This is node that had slug and content updated`);\n      assert404(`new-node`);\n    });","file":"development-runtime/cypress/integration/unified-routing/collection-routing.js","skipped":false,"dir":"e2e-tests"},{"name":"remove a page when node is deleted","suites":["collection-routing","data updates"],"updatePoint":{"line":101,"column":42,"index":4247},"line":101,"code":"    it(`remove a page when node is deleted`, () => {\n      assertPageExist(`updated-node`, `This is node that had slug and content updated`);\n      assert404(`new-node`);\n      refresh(`delete`);\n      assert404(`new-node`);\n      assert404(`updated-node`);\n    });","file":"development-runtime/cypress/integration/unified-routing/collection-routing.js","skipped":false,"dir":"e2e-tests"},{"name":"gatsbyPath should support materialized field values","suites":["collection-routing","data updates"],"updatePoint":{"line":109,"column":57,"index":4534},"line":109,"code":"  it(`gatsbyPath should support materialized field values`, () => {\n    cy.visit(`/collection-routing/gatsby-path-materialized-linked-name/gatsby-path-materialized-parent-name`).waitForRouteChange();\n    cy.findByTestId(`gatsby-path-materialized`);\n    cy.should(`have.text`, `/collection-routing/gatsby-path-materialized-linked-name/gatsby-path-materialized-parent-name/`);\n  });","file":"development-runtime/cypress/integration/unified-routing/collection-routing.js","skipped":false,"dir":"e2e-tests"},{"name":"should load successfully when the page is visited directly","suites":[],"updatePoint":{"line":11,"column":66,"index":447},"line":11,"code":"  test(`should load successfully when the page is visited directly`, async ({\n    page\n  }) => {\n    await page.goto(`/gatsby-script-off-main-thread/`);\n    const partytownSnippet = page.locator(`[data-partytown]`);\n    const scriptWithSrc = page.locator(`[id=${id.three}]`);\n    const templateLiteral = page.locator(`[id=${id.templateLiteral}]`);\n    const dangerouslySet = page.locator(`[id=${id.dangerouslySet}]`);\n\n    // Unsure why this locator appears to behave differently, get text content to compare directly\n    const partytownSnippetText = await partytownSnippet.textContent();\n    expect(partytownSnippetText).toMatch(/THREE/); // Forwards configured\n\n    await expect(templateLiteral).toHaveText(`${id.templateLiteral}: success`); // Template literal inline scripts loaded\n    await expect(dangerouslySet).toHaveText(`${id.dangerouslySet}: success`); // Dangerously set inline scripts loaded\n    await expect(scriptWithSrc).toHaveAttribute(`type`, `text/partytown-x`); // Scripts with sources loaded\n  });","file":"development-runtime/playwright/gatsby-script-off-main-thread.spec.ts","skipped":false,"dir":"e2e-tests"},{"name":"should load successfully when navigating via Gatsby Link to a page with off-main-thread scripts","suites":[],"line":30,"code":"  test.skip(`should load successfully when navigating via Gatsby Link to a page with off-main-thread scripts`, async ({","file":"development-runtime/playwright/gatsby-script-off-main-thread.spec.ts","skipped":true,"dir":"e2e-tests"},{"name":"should load successfully when navigating via Gatsby Link between pages with off-main-thread scripts","suites":[],"line":50,"code":"  test.skip(`should load successfully when navigating via Gatsby Link between pages with off-main-thread scripts`, async ({","file":"development-runtime/playwright/gatsby-script-off-main-thread.spec.ts","skipped":true,"dir":"e2e-tests"},{"name":"should parse","suites":["webpack loader","---yaml frontmatter"],"updatePoint":{"line":25,"column":20,"index":672},"line":25,"code":"    it(`should parse`, () => {\n      cy.get(selector).invoke(`text`).should(`eq`, titles.parsed);\n    });","file":"mdx/cypress/integration/frontmatter.js","skipped":false,"dir":"e2e-tests"},{"name":"should not leak into the page","suites":["webpack loader","---yaml frontmatter"],"updatePoint":{"line":28,"column":37,"index":795},"line":28,"code":"    it(`should not leak into the page`, () => {\n      cy.contains(otherKey).should(`not.exist`);\n    });","file":"mdx/cypress/integration/frontmatter.js","skipped":false,"dir":"e2e-tests"},{"name":"should parse","suites":["webpack loader","---json frontmatter"],"updatePoint":{"line":36,"column":20,"index":1010},"line":36,"code":"    it(`should parse`, () => {\n      cy.get(selector).invoke(`text`).should(`eq`, `disabled`);\n    });","file":"mdx/cypress/integration/frontmatter.js","skipped":false,"dir":"e2e-tests"},{"name":"should not leak into the page","suites":["webpack loader","---json frontmatter"],"updatePoint":{"line":39,"column":37,"index":1130},"line":39,"code":"    it(`should not leak into the page`, () => {\n      cy.contains(otherKey).should(`not.exist`);\n    });","file":"mdx/cypress/integration/frontmatter.js","skipped":false,"dir":"e2e-tests"},{"name":"should parse","suites":["webpack loader","---js frontmatter"],"updatePoint":{"line":47,"column":20,"index":1341},"line":47,"code":"    it(`should parse`, () => {\n      cy.get(selector).invoke(`text`).should(`eq`, `disabled`);\n    });","file":"mdx/cypress/integration/frontmatter.js","skipped":false,"dir":"e2e-tests"},{"name":"should not leak into the page","suites":["webpack loader","---js frontmatter"],"updatePoint":{"line":50,"column":37,"index":1461},"line":50,"code":"    it(`should not leak into the page`, () => {\n      cy.contains(otherKey).should(`not.exist`);\n    });","file":"mdx/cypress/integration/frontmatter.js","skipped":false,"dir":"e2e-tests"},{"name":"should parse","suites":["webpack loader","---javascript frontmatter"],"updatePoint":{"line":58,"column":20,"index":1688},"line":58,"code":"    it(`should parse`, () => {\n      cy.get(selector).invoke(`text`).should(`eq`, `disabled`);\n    });","file":"mdx/cypress/integration/frontmatter.js","skipped":false,"dir":"e2e-tests"},{"name":"should not leak into the page","suites":["webpack loader","---javascript frontmatter"],"updatePoint":{"line":61,"column":37,"index":1808},"line":61,"code":"    it(`should not leak into the page`, () => {\n      cy.contains(otherKey).should(`not.exist`);\n    });","file":"mdx/cypress/integration/frontmatter.js","skipped":false,"dir":"e2e-tests"},{"name":"---js or ---javascript frontmatter should not parse by default","suites":["data layer"],"updatePoint":{"line":67,"column":68,"index":1985},"line":67,"code":"  it(`---js or ---javascript frontmatter should not parse by default`, () => {\n    cy.visit(page.graphqlQuery).waitForRouteChange();\n    cy.contains(titles.notParsed).should(`not.exist`);\n  });","file":"mdx/cypress/integration/frontmatter.js","skipped":false,"dir":"e2e-tests"},{"name":"---js and ---javascript frontmatter should not allow remote code execution","suites":["data layer"],"updatePoint":{"line":72,"column":78,"index":2193},"line":72,"code":"it(`---js and ---javascript frontmatter should not allow remote code execution`, () => {\n  cy.readFile(`cypress/fixtures/file-to-attempt-rce-on.txt`).should(`eq`, `Nothing here, do not remove`);\n});","file":"mdx/cypress/integration/frontmatter.js","skipped":false,"dir":"e2e-tests"},{"name":"index","suites":["creates pages using the file system routing API"],"updatePoint":{"line":7,"column":11,"index":303},"line":7,"code":"  it(`index`, () => {\n    cy.visit(\"/fs-api/\").waitForRouteChange();\n    cy.contains(`src/pages/index.mdx`);\n    cy.get(`h2`).invoke(`text`).should(`eq`, `Do you work`);\n    cy.contains(`\"slug\": \"/\"`);\n  });","file":"mdx/cypress/integration/fs-api.js","skipped":false,"dir":"e2e-tests"},{"name":"another","suites":["creates pages using the file system routing API"],"updatePoint":{"line":13,"column":13,"index":513},"line":13,"code":"  it(`another`, () => {\n    cy.visit(\"/fs-api/another\").waitForRouteChange();\n    cy.contains(`src/pages/another.mdx`);\n    cy.contains(`This is to add another source page for slugification.`);\n    cy.contains(`\"slug\": \"/another\"`);\n  });","file":"mdx/cypress/integration/fs-api.js","skipped":false,"dir":"e2e-tests"},{"name":"post in deep directory","suites":["creates pages using the file system routing API"],"updatePoint":{"line":19,"column":28,"index":767},"line":19,"code":"  it(`post in deep directory`, () => {\n    cy.visit(\"/fs-api/about/embedded\").waitForRouteChange();\n    cy.contains(`src/posts/about/embedded.mdx`);\n    cy.contains(`This is a page that should include a slash slug`);\n    cy.contains(`\"slug\": \"/about/embedded\"`);\n  });","file":"mdx/cypress/integration/fs-api.js","skipped":false,"dir":"e2e-tests"},{"name":"works when template and content file paths contain spaces","suites":["creates pages using the file system routing API"],"updatePoint":{"line":25,"column":63,"index":1071},"line":25,"code":"  it(`works when template and content file paths contain spaces`, () => {\n    cy.visit(`/fs-api/space%20and%20static%20query/file-with-space/`).waitForRouteChange();\n    cy.get(`[data-cy=\"static-query-result\"]`).invoke(`text`).should(`eq`, `Gatsby MDX e2e`);\n  });","file":"mdx/cypress/integration/fs-api.js","skipped":false,"dir":"e2e-tests"},{"name":"works when template and content file paths contain plusses","suites":["creates pages using the file system routing API"],"updatePoint":{"line":29,"column":64,"index":1337},"line":29,"code":"  it(`works when template and content file paths contain plusses`, () => {\n    cy.visit(`/fs-api/plus+and+static+query/file-with-plus/`).waitForRouteChange();\n    cy.get(`[data-cy=\"static-query-result\"]`).invoke(`text`).should(`eq`, `Gatsby MDX e2e`);\n  });","file":"mdx/cypress/integration/fs-api.js","skipped":false,"dir":"e2e-tests"},{"name":"Can hot-reload markdown content","suites":[],"updatePoint":{"line":8,"column":37,"index":194},"line":8,"code":"  it(`Can hot-reload markdown content`, () => {\n    cy.visit(`/hmr`, {\n      onBeforeLoad: win => {\n        cy.spy(win.console, \"log\").as(`hmrConsoleLog`);\n      }\n    }).waitForRouteChange();\n    cy.get(`h2`).invoke(`text`).should(`eq`, `Lorem`);\n    cy.exec(`npm run update -- --file src/pages/hmr.mdx --exact --replacements \"Lorem:Ipsum\"`);\n    cy.get(`@hmrConsoleLog`).should(`be.calledWithMatch`, `App is up to date`);\n    cy.wait(1000);\n    cy.get(`h2`).invoke(`text`).should(`eq`, `Ipsum`);\n  });","file":"mdx/cypress/integration/hmr.js","skipped":false,"dir":"e2e-tests"},{"name":"Can hot-reload react content (i.e. change prop in mdx content)","suites":[],"updatePoint":{"line":20,"column":68,"index":729},"line":20,"code":"  it(`Can hot-reload react content (i.e. change prop in mdx content)`, () => {\n    cy.visit(`/hmr`, {\n      onBeforeLoad: win => {\n        cy.spy(win.console, \"log\").as(`hmrConsoleLog`);\n      }\n    }).waitForRouteChange();\n    cy.get(`[data-testid=\"test-prop-edit\"]`).invoke(`text`).should(`eq`, `prop-before`);\n    cy.exec(`npm run update -- --file src/pages/hmr.mdx --exact --replacements \"prop-before:prop-after\"`);\n    cy.get(`@hmrConsoleLog`).should(`be.calledWithMatch`, `App is up to date`);\n    cy.wait(1000);\n    cy.get(`[data-testid=\"test-prop-edit\"]`).invoke(`text`).should(`eq`, `prop-after`);\n  });","file":"mdx/cypress/integration/hmr.js","skipped":false,"dir":"e2e-tests"},{"name":"Can hot-reload imported js components","suites":[],"updatePoint":{"line":32,"column":43,"index":1317},"line":32,"code":"  it(`Can hot-reload imported js components`, () => {\n    cy.visit(`/hmr`, {\n      onBeforeLoad: win => {\n        cy.spy(win.console, \"log\").as(`hmrConsoleLog`);\n      }\n    }).waitForRouteChange();\n    cy.get(`[data-testid=\"test-imported-edit\"]`).invoke(`text`).should(`eq`, `component-before`);\n    cy.exec(`npm run update -- --file src/components/hmr-component-edit.js --exact --replacements \"component-before:component-after\"`);\n    cy.get(`@hmrConsoleLog`).should(`be.calledWithMatch`, `App is up to date`);\n    cy.wait(1000);\n    cy.get(`[data-testid=\"test-imported-edit\"]`).invoke(`text`).should(`eq`, `component-after`);\n  });","file":"mdx/cypress/integration/hmr.js","skipped":false,"dir":"e2e-tests"},{"name":"can be created with MDX","suites":["Pages"],"updatePoint":{"line":9,"column":29,"index":306},"line":9,"code":"  it(`can be created with MDX`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.get(`h2`).invoke(`text`).should(`eq`, `Do you work`);\n  });","file":"mdx/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"runs gatsby-remark-autolink-headers and attaches link","suites":["Pages"],"updatePoint":{"line":13,"column":59,"index":483},"line":13,"code":"  it(`runs gatsby-remark-autolink-headers and attaches link`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.get(`h2`).invoke(`text`).should(`eq`, `Do you work`);\n    cy.get(`h2#do-you-work`).should('exist');\n    cy.get(`h2#do-you-work a svg`).should('exist');\n  });","file":"mdx/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"runs gatsby-remark-images and renders image","suites":["Pages"],"updatePoint":{"line":19,"column":49,"index":748},"line":19,"code":"  it(`runs gatsby-remark-images and renders image`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.get(`span.gatsby-resp-image-wrapper`).should('exist');\n    cy.get(`span.gatsby-resp-image-wrapper img`).should('exist');\n  });","file":"mdx/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"can include shortcode component","suites":["Pages"],"updatePoint":{"line":24,"column":37,"index":970},"line":24,"code":"  it(`can include shortcode component`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.getTestElement(`shortcode`).contains(`I am an example of a component in MDX.`);\n  });","file":"mdx/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"can include external import","suites":["Pages"],"updatePoint":{"line":28,"column":33,"index":1147},"line":28,"code":"  it(`can include external import`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.getTestElement(`external`).contains(`Now an external import`);\n  });","file":"mdx/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"generates slug for mdx in pages dir","suites":["Pages"],"updatePoint":{"line":32,"column":41,"index":1315},"line":32,"code":"  it(`generates slug for mdx in pages dir`, () => {\n    cy.visit(`/list`).waitForRouteChange();\n    cy.getTestElement(`mdx-slug`).contains(`another`);\n  });","file":"mdx/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"generates complex slug with md extension","suites":["Pages"],"updatePoint":{"line":36,"column":46,"index":1477},"line":36,"code":"  it(`generates complex slug with md extension`, () => {\n    cy.visit(`/list`).waitForRouteChange();\n    cy.getTestElement(`md-slug`).contains(`my-blog`);\n  });","file":"mdx/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"generates a slug with an index file","suites":["Pages"],"updatePoint":{"line":40,"column":41,"index":1633},"line":40,"code":"  it(`generates a slug with an index file`, () => {\n    cy.visit(`/list`).waitForRouteChange();\n    cy.getTestElement(`complex-slug`).contains(`about`);\n  });","file":"mdx/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"generates a slug with a slash","suites":["Pages"],"updatePoint":{"line":44,"column":35,"index":1786},"line":44,"code":"  it(`generates a slug with a slash`, () => {\n    cy.visit(`/list`).waitForRouteChange();\n    cy.getTestElement(`embed-slug`).contains(`about/embedded`);\n  });","file":"mdx/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"transforms to github-like checkbox list","suites":["ESM only Rehype & Remark plugins","Remark Plugin"],"updatePoint":{"line":3,"column":47,"index":137},"line":3,"code":"    it(`transforms to github-like checkbox list`, () => {\n      cy.visit(`/using-esm-only-rehype-remark-plugins/`).waitForRouteChange();\n      cy.get(`.task-list-item`).should(\"have.length\", 2);\n    });","file":"mdx/cypress/integration/using-esm-only-remark-rehype-plugins.js","skipped":false,"dir":"e2e-tests"},{"name":"use heading text as id ","suites":["ESM only Rehype & Remark plugins","Rehype Plugin"],"updatePoint":{"line":9,"column":31,"index":366},"line":9,"code":"    it(`use heading text as id `, () => {\n      cy.visit(`/using-esm-only-rehype-remark-plugins/`).waitForRouteChange();\n      cy.get(`#heading-two`).invoke(`text`).should(`eq`, `Heading two`);\n    });","file":"mdx/cypress/integration/using-esm-only-remark-rehype-plugins.js","skipped":false,"dir":"e2e-tests"},{"name":"div","suites":[],"updatePoint":{"line":4,"column":43,"index":110},"line":null,"code":"","file":"mdx/src/components/hmr-prop-edit.js","skipped":false,"dir":"e2e-tests"},{"name":"page-data is prefixed with asset prefix","suites":["assetPrefix"],"updatePoint":{"line":14,"column":45,"index":503},"line":14,"code":"  it(`page-data is prefixed with asset prefix`, () => {\n    cy.wait(\"@page-data\");\n    cy.get(\"@page-data\").then((...intercepts) => {\n      expect(intercepts).to.have.length(1);\n      for (const intercept of intercepts) {\n        expect(intercept.request.url).to.match(assetPrefixExpression);\n      }\n    });\n  });","file":"path-prefix/cypress/integration/asset-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"slice-data is prefixed with asset prefix","suites":["assetPrefix"],"updatePoint":{"line":23,"column":46,"index":819},"line":23,"code":"  it(`slice-data is prefixed with asset prefix`, () => {\n    cy.wait(\"@slice-data\");\n    cy.get(\"@slice-data\").then((...intercepts) => {\n      expect(intercepts).to.have.length(1);\n      for (const intercept of intercepts) {\n        expect(intercept.request.url).to.match(assetPrefixExpression);\n      }\n    });\n  });","file":"path-prefix/cypress/integration/asset-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"prefixes styles","suites":["assetPrefix","runtime"],"updatePoint":{"line":33,"column":23,"index":1144},"line":33,"code":"    it(`prefixes styles`, () => {\n      assetPrefixMatcher(cy.get(`head style[data-href]`), `data-href`);\n    });","file":"path-prefix/cypress/integration/asset-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"prefixes scripts","suites":["assetPrefix","runtime"],"updatePoint":{"line":36,"column":24,"index":1259},"line":36,"code":"    it(`prefixes scripts`, () => {\n      assetPrefixMatcher(cy.get(`body script[src]`), `src`);\n    });","file":"path-prefix/cypress/integration/asset-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"doesnt prefix manifest","suites":["assetPrefix","gatsby-plugin-manifest"],"updatePoint":{"line":41,"column":31,"index":1421},"line":41,"code":"    it(`doesnt prefix manifest`, () => {\n      cy.get(`head link[rel=\"manifest\"]`).should(`have.attr`, `href`).and(`not.matches`, assetPrefixExpression);\n    });","file":"path-prefix/cypress/integration/asset-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"prefixes icon","suites":["assetPrefix","gatsby-plugin-manifest"],"updatePoint":{"line":44,"column":21,"index":1574},"line":44,"code":"    it(`prefixes icon`, () => {\n      assetPrefixMatcher(cy.get(`head link[rel=\"icon\"]`));\n    });","file":"path-prefix/cypress/integration/asset-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"prefixes manifest icons","suites":["assetPrefix","gatsby-plugin-manifest"],"updatePoint":{"line":47,"column":31,"index":1683},"line":47,"code":"    it(`prefixes manifest icons`, () => {\n      assetPrefixMatcher(cy.get(`head link[rel=\"apple-touch-icon\"]`));\n    });","file":"path-prefix/cypress/integration/asset-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"prefixes sitemap","suites":["assetPrefix","gatsby-plugin-sitemap"],"updatePoint":{"line":52,"column":24,"index":1847},"line":52,"code":"    it(`prefixes sitemap`, () => {\n      assetPrefixMatcher(cy.get(`head link[rel=\"sitemap\"]`));\n    });","file":"path-prefix/cypress/integration/asset-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"prefixes RSS feed","suites":["assetPrefix","gatsby-plugin-feed"],"updatePoint":{"line":57,"column":25,"index":2000},"line":57,"code":"    it(`prefixes RSS feed`, () => {\n      assetPrefixMatcher(cy.get(`head link[type=\"application/rss+xml\"]`));\n    });","file":"path-prefix/cypress/integration/asset-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"prefixes an asset","suites":["assetPrefix with assets handled by file-loader"],"updatePoint":{"line":66,"column":23,"index":2273},"line":66,"code":"  it(`prefixes an asset`, () => {\n    assetPrefixMatcher(cy.getTestElement(`file-loader-image`), `src`);\n  });","file":"path-prefix/cypress/integration/asset-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"uses pathPrefix","suites":["navigate"],"updatePoint":{"line":10,"column":21,"index":235},"line":10,"code":"  it(`uses pathPrefix`, () => {\n    cy.getTestElement(`page-2-button-link`).click().location(`pathname`).should(`eq`, withTrailingSlash(`${pathPrefix}/page-2`));\n  });","file":"path-prefix/cypress/integration/navigate.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate back after using","suites":["navigate"],"updatePoint":{"line":13,"column":35,"index":417},"line":13,"code":"  it(`can navigate back after using`, () => {\n    cy.getTestElement(`page-2-button-link`).click().getTestElement(`index-link`).click().location(`pathname`).should(`eq`, withTrailingSlash(pathPrefix));\n  });","file":"path-prefix/cypress/integration/navigate.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to a subdirectory","suites":["navigate","relative links"],"updatePoint":{"line":17,"column":38,"index":664},"line":17,"code":"    it(`can navigate to a subdirectory`, () => {\n      cy.getTestElement(`subdir-link`).click().location(`pathname`).should(`eq`, withTrailingSlash(`${pathPrefix}/subdirectory/page-1`));\n    });","file":"path-prefix/cypress/integration/navigate.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to a sibling page","suites":["navigate","relative links"],"updatePoint":{"line":20,"column":38,"index":859},"line":20,"code":"    it(`can navigate to a sibling page`, () => {\n      cy.visit(`/subdirectory/page-1`).waitForRouteChange().getTestElement(`page-2-link`).click().location(`pathname`).should(`eq`, withTrailingSlash(`${pathPrefix}/subdirectory/page-2`));\n    });","file":"path-prefix/cypress/integration/navigate.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to a parent page","suites":["navigate","relative links"],"updatePoint":{"line":23,"column":37,"index":1104},"line":23,"code":"    it(`can navigate to a parent page`, () => {\n      cy.visit(`/subdirectory/page-1`).waitForRouteChange().getTestElement(`page-parent-link`).click().location(`pathname`).should(`eq`, withTrailingSlash(`${pathPrefix}/subdirectory`));\n    });","file":"path-prefix/cypress/integration/navigate.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to a sibling page programatically","suites":["navigate","relative links"],"updatePoint":{"line":26,"column":54,"index":1364},"line":26,"code":"    it(`can navigate to a sibling page programatically`, () => {\n      cy.visit(`/subdirectory/page-1`).waitForRouteChange().getTestElement(`page-2-button-link`).click().location(`pathname`).should(`eq`, withTrailingSlash(`${pathPrefix}/subdirectory/page-2`));\n    });","file":"path-prefix/cypress/integration/navigate.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to SSR page","suites":["navigate","relative links"],"updatePoint":{"line":29,"column":32,"index":1611},"line":29,"code":"    it(`can navigate to SSR page`, () => {\n      cy.getTestElement(`page-ssr-button-link`).click().waitForRouteChange().location(`pathname`).should(`eq`, withTrailingSlash(`${pathPrefix}/ssr`));\n      cy.getTestElement(`server-data`).contains(`foo`);\n    });","file":"path-prefix/cypress/integration/navigate.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to 404","suites":["navigate","relative links"],"updatePoint":{"line":34,"column":25,"index":1869},"line":34,"code":"  it(`can navigate to 404`, () => {\n    cy.getTestElement(`404-link`).click().waitForRouteChange();\n    cy.get(`h1`).contains(`NOT FOUND`);\n  });","file":"path-prefix/cypress/integration/navigate.js","skipped":false,"dir":"e2e-tests"},{"name":"can load 404 directly","suites":["navigate","relative links"],"updatePoint":{"line":38,"column":27,"index":2017},"line":38,"code":"  it(`can load 404 directly`, () => {\n    cy.visit(`${pathPrefix}/not-existing-page`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.get(`h1`).contains(`NOT FOUND`);\n  });","file":"path-prefix/cypress/integration/navigate.js","skipped":false,"dir":"e2e-tests"},{"name":"returns 200 on base route","suites":["Production pathPrefix","navigation"],"updatePoint":{"line":10,"column":33,"index":283},"line":10,"code":"    it(`returns 200 on base route`, () => {\n      cy.location(`pathname`).should(`eq`, withTrailingSlash(pathPrefix));\n    });","file":"path-prefix/cypress/integration/path-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"renders static image","suites":["Production pathPrefix","navigation"],"updatePoint":{"line":13,"column":28,"index":405},"line":13,"code":"    it(`renders static image`, () => {\n      cy.getTestElement(`static-image`).should(`have.attr`, `srcset`).and(srcset => {\n        srcset.split(/\\s*,\\s*/).forEach(part => {\n          expect(part).to.contain(`/blog`);\n        });\n      });\n    });","file":"path-prefix/cypress/integration/path-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"renders dynamic image","suites":["Production pathPrefix","navigation"],"updatePoint":{"line":20,"column":29,"index":655},"line":20,"code":"    it(`renders dynamic image`, () => {\n      cy.getTestElement(`gatsby-image`).should(`have.attr`, `srcset`).and(srcset => {\n        srcset.split(/\\s*,\\s*/).forEach(part => {\n          expect(part).to.contain(`/blog`);\n        });\n      });\n    });","file":"path-prefix/cypress/integration/path-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"prefixes link with /blog","suites":["Production pathPrefix","navigation"],"updatePoint":{"line":27,"column":32,"index":908},"line":27,"code":"    it(`prefixes link with /blog`, () => {\n      cy.getTestElement(`page-2-link`).should(`have.attr`, `href`).and(`include`, `/blog`);\n      cy.getTestElement(`page-ssr-link`).should(`have.attr`, `href`).and(`include`, `/blog`);\n    });","file":"path-prefix/cypress/integration/path-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to secondary page","suites":["Production pathPrefix","navigation"],"updatePoint":{"line":31,"column":38,"index":1151},"line":31,"code":"    it(`can navigate to secondary page`, () => {\n      cy.getTestElement(`page-2-link`).click();\n      cy.location(`pathname`).should(`eq`, withTrailingSlash(`${pathPrefix}/page-2`));\n    });","file":"path-prefix/cypress/integration/path-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate back from secondary page","suites":["Production pathPrefix","navigation"],"updatePoint":{"line":35,"column":45,"index":1350},"line":35,"code":"    it(`can navigate back from secondary page`, () => {\n      cy.getTestElement(`page-2-link`).click();\n      cy.getTestElement(`index-link`).click();\n      cy.location(`pathname`).should(`eq`, withTrailingSlash(pathPrefix));\n    });","file":"path-prefix/cypress/integration/path-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"can go back","suites":["Production pathPrefix","navigation"],"updatePoint":{"line":40,"column":19,"index":1558},"line":40,"code":"    it(`can go back`, () => {\n      cy.getTestElement(`page-2-link`).click().waitForRouteChange().go(`back`).waitForRouteChange();\n      cy.location(`pathname`).should(`eq`, withTrailingSlash(pathPrefix));\n    });","file":"path-prefix/cypress/integration/path-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to the blogtest page that contains the blog prefix","suites":["Production pathPrefix","navigation"],"updatePoint":{"line":44,"column":71,"index":1824},"line":44,"code":"    it(`can navigate to the blogtest page that contains the blog prefix`, () => {\n      cy.getTestElement(`page-blogtest-link`).click();\n      cy.location(`pathname`).should(`eq`, withTrailingSlash(`${pathPrefix}/blogtest`));\n    });","file":"path-prefix/cypress/integration/path-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to ssr page","suites":["Production pathPrefix","navigation"],"updatePoint":{"line":48,"column":32,"index":2019},"line":48,"code":"    it(`can navigate to ssr page`, () => {\n      cy.getTestElement(`page-ssr-link`).click();\n      cy.location(`pathname`).should(`eq`, withTrailingSlash(`${pathPrefix}/ssr`));\n      cy.getTestElement(`server-data`).contains(`foo`);\n    });","file":"path-prefix/cypress/integration/path-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"can visit ssr page","suites":["Production pathPrefix","navigation"],"updatePoint":{"line":54,"column":24,"index":2258},"line":54,"code":"  it(`can visit ssr page`, () => {\n    cy.visit(`/ssr/`).waitForRouteChange();\n    cy.location(`pathname`).should(`eq`, withTrailingSlash(`${pathPrefix}/ssr`));\n    cy.getTestElement(`server-data`).contains(`foo`);\n  });","file":"path-prefix/cypress/integration/path-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"prefixes an asset","suites":["pathPrefix with assets handled by file-loader"],"updatePoint":{"line":64,"column":23,"index":2627},"line":64,"code":"  it(`prefixes an asset`, () => {\n    cy.getTestElement(`file-loader-image`).invoke(`attr`, `src`).should(`include`, withTrailingSlash(pathPrefix));\n  });","file":"path-prefix/cypress/integration/path-prefix.js","skipped":false,"dir":"e2e-tests"},{"name":"should render properly","suites":["Production build tests"],"updatePoint":{"line":18,"column":28,"index":747},"line":18,"code":"  it(`should render properly`, () => {\n    cy.visit(`/`).waitForRouteChange();\n  });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"should activate the service worker","suites":["Production build tests"],"updatePoint":{"line":22,"column":42,"index":890},"line":22,"code":"    it(`should activate the service worker`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.waitForAPI(`onServiceWorkerActive`);\n    });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"should navigate back after a reload","suites":["Production build tests"],"updatePoint":{"line":27,"column":41,"index":1042},"line":27,"code":"  it(`should navigate back after a reload`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.getTestElement(`page2`).click();\n    cy.waitForRouteChange().location(`pathname`).should(`equal`, `/page-2/`);\n    cy.reload().waitForRouteChange().go(`back`);\n    cy.waitForRouteChange().getTestElement(`page2`).should(`exist`).location(`pathname`).should(`equal`, `/`);\n  });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"should work when visiting a page with direct URL entry or an external link","suites":["Production build tests"],"updatePoint":{"line":34,"column":80,"index":1457},"line":34,"code":"  it(`should work when visiting a page with direct URL entry or an external link`, () => {\n    cy.visit(`/page-2/`).waitForRouteChange().getTestElement(`index-link`).should(`exist`).location(`pathname`).should(`equal`, `/page-2/`);\n  });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"should navigate to a subdirectory","suites":["Production build tests","relative links"],"updatePoint":{"line":38,"column":41,"index":1693},"line":38,"code":"    it(`should navigate to a subdirectory`, () => {\n      cy.visit(`/`).waitForRouteChange().getTestElement(`subdir-link`).click().location(`pathname`).should(`eq`, `/subdirectory/page-1/`);\n    });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to a sibling page","suites":["Production build tests","relative links"],"updatePoint":{"line":41,"column":38,"index":1889},"line":41,"code":"    it(`can navigate to a sibling page`, () => {\n      cy.visit(`/subdirectory/page-1`).waitForRouteChange().getTestElement(`page-2-link`).click().location(`pathname`).should(`eq`, `/subdirectory/page-2/`);\n    });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to a parent page","suites":["Production build tests","relative links"],"updatePoint":{"line":44,"column":37,"index":2103},"line":44,"code":"    it(`can navigate to a parent page`, () => {\n      cy.visit(`/subdirectory/page-1`).waitForRouteChange().getTestElement(`page-parent-link`).click().location(`pathname`).should(`eq`, `/subdirectory/`);\n    });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to a sibling page programatically","suites":["Production build tests","relative links"],"updatePoint":{"line":47,"column":54,"index":2332},"line":47,"code":"    it(`can navigate to a sibling page programatically`, () => {\n      cy.visit(`/subdirectory/page-1`).waitForRouteChange().getTestElement(`page-2-button-link`).click().location(`pathname`).should(`eq`, `/subdirectory/page-2/`);\n    });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"should show 404 page when clicking a link to a non-existent page route","suites":["Production build tests","relative links"],"updatePoint":{"line":51,"column":76,"index":2598},"line":51,"code":"  it(`should show 404 page when clicking a link to a non-existent page route`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.getTestElement(`404`).click();\n    cy.waitForRouteChange().location(`pathname`).should(`equal`, `/page-3/`).getTestElement(`404`).should(`exist`);\n  });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"should show 404 page when directly entering an invalid URL","suites":["Production build tests","relative links"],"updatePoint":{"line":56,"column":64,"index":2873},"line":56,"code":"  it(`should show 404 page when directly entering an invalid URL`, () => {\n    cy.visit(`/non-existent-page/`, {\n      failOnStatusCode: false\n    });\n    cy.waitForRouteChange().getTestElement(`404`).should(`exist`);\n  });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"should navigate back after a 404 from a direct link entry","suites":["Production build tests","relative links"],"updatePoint":{"line":62,"column":63,"index":3096},"line":62,"code":"  it(`should navigate back after a 404 from a direct link entry`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.visit(`/non-existent-page/`, {\n      failOnStatusCode: false\n    });\n    cy.waitForRouteChange().go(`back`).waitForRouteChange().getTestElement(`index-link`).should(`exist`);\n  });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"Uses env vars","suites":["Production build tests","relative links"],"updatePoint":{"line":69,"column":19,"index":3354},"line":69,"code":"  it(`Uses env vars`, () => {\n    cy.visit(`/env-vars`).waitForRouteChange();\n    cy.getTestElement(`process.env`).contains(`{}`);\n    cy.getTestElement(`process.env.EXISTING_VAR`).contains(`\"foo bar\"`);\n    cy.getTestElement(`process.env.NOT_EXISTING_VAR`).should(`be.empty`);\n  });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"should be able to create a page from component located in .cache directory","suites":["Production build tests","relative links"],"updatePoint":{"line":75,"column":80,"index":3699},"line":75,"code":"  it(`should be able to create a page from component located in .cache directory`, () => {\n    cy.visit(`/page-from-cache/`).waitForRouteChange();\n\n    // `bar` is set in gatsby-node createPages\n    cy.getTestElement(`dom-marker`).contains(`[static-page-from-cache]`);\n  });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"Can navigate directly","suites":["Production build tests","Supports unicode characters in urls","DSG pages"],"updatePoint":{"line":83,"column":31,"index":4017},"line":83,"code":"      it(`Can navigate directly`, () => {\n        cy.visit(encodeURI(`/-URL`)).waitForRouteChange();\n        cy.getTestElement(`dom-marker`).contains(\"page-2\");\n      });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"Can navigate on client","suites":["Production build tests","Supports unicode characters in urls","DSG pages"],"updatePoint":{"line":87,"column":32,"index":4191},"line":87,"code":"      it(`Can navigate on client`, () => {\n        cy.visit(`/`).waitForRouteChange();\n        cy.getTestElement(`dsg-page-with-unicode-path`).click().waitForRouteChange();\n        cy.getTestElement(`dom-marker`).contains(\"page-2\");\n      });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"Can navigate directly","suites":["Production build tests","Supports unicode characters in urls","DSG pages"],"updatePoint":{"line":93,"column":29,"index":4439},"line":93,"code":"    it(`Can navigate directly`, () => {\n      cy.visit(encodeURI(`//`), {\n        // Cypress seems to think it's 404\n        // even if it's not. 404 page doesn't have\n        // `page-2-message` element so the test will fail on\n        // assertion. Using failOnStatusCode here\n        // only to workaround cypress weirdness\n        failOnStatusCode: false\n      }).waitForRouteChange();\n      cy.getTestElement(`page-2-message`).invoke(`text`).should(`equal`, `Hi from the second page`);\n    });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"Can navigate on client","suites":["Production build tests","Supports unicode characters in urls","DSG pages"],"updatePoint":{"line":104,"column":30,"index":4941},"line":104,"code":"    it(`Can navigate on client`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.getTestElement(`page-with-unicode-path`).click().waitForRouteChange();\n      cy.getTestElement(`page-2-message`).invoke(`text`).should(`equal`, `Hi from the second page`);\n    });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"should show 404 page when url with unicode characters point to a non-existent page route when navigating directly","suites":["Production build tests","Supports unicode characters in urls","DSG pages"],"updatePoint":{"line":109,"column":121,"index":5304},"line":109,"code":"    it(`should show 404 page when url with unicode characters point to a non-existent page route when navigating directly`, () => {\n      cy.visit(encodeURI(`/404/`), {\n        failOnStatusCode: false\n      }).waitForRouteChange();\n      cy.getTestElement(`404`).should(`exist`);\n    });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"should show 404 page when url with unicode characters point to a non-existent page route when navigating on client","suites":["Production build tests","Supports unicode characters in urls","DSG pages"],"updatePoint":{"line":115,"column":122,"index":5595},"line":115,"code":"    it(`should show 404 page when url with unicode characters point to a non-existent page route when navigating on client`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.window().then(win => win.___navigate(`/404/`)).waitForRouteChange();\n      cy.getTestElement(`404`).should(`exist`);\n    });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"Can navigate directly","suites":["Production build tests","Supports encodable characters in urls"],"updatePoint":{"line":122,"column":29,"index":5879},"line":122,"code":"    it(`Can navigate directly`, () => {\n      cy.visit(`/foo/@something/bar`).waitForRouteChange();\n      cy.getTestElement(`page-2-message`).invoke(`text`).should(`equal`, `Hi from the second page`);\n    });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"Can navigate on client","suites":["Production build tests","Supports encodable characters in urls"],"updatePoint":{"line":126,"column":30,"index":6089},"line":126,"code":"    it(`Can navigate on client`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.getTestElement(`page-with-encodable-path`).click().waitForRouteChange();\n      cy.getTestElement(`page-2-message`).invoke(`text`).should(`equal`, `Hi from the second page`);\n    });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"should show 404 page when url with unicode characters point to a non-existent page route when navigating directly","suites":["Production build tests","Supports encodable characters in urls"],"updatePoint":{"line":131,"column":121,"index":6454},"line":131,"code":"    it(`should show 404 page when url with unicode characters point to a non-existent page route when navigating directly`, () => {\n      cy.visit(`/foo/@something/bar404/`, {\n        failOnStatusCode: false\n      }).waitForRouteChange();\n      cy.getTestElement(`404`).should(`exist`);\n    });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"should show 404 page when url with unicode characters point to a non-existent page route when navigating on client","suites":["Production build tests","Supports encodable characters in urls"],"updatePoint":{"line":137,"column":122,"index":6750},"line":137,"code":"    it(`should show 404 page when url with unicode characters point to a non-existent page route when navigating on client`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.window().then(win => win.___navigate(`/foo/@something/bar404/`)).waitForRouteChange();\n      cy.getTestElement(`404`).should(`exist`);\n    });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"/slashes/no-trailing?param=value","suites":["Production build tests","Keeps search query","Converts no trailing slash canonical path to trailing (/slashes/no-trailing)"],"updatePoint":{"line":145,"column":42,"index":7145},"line":145,"code":"      it(`/slashes/no-trailing?param=value`, () => {\n        cy.visit(`/slashes/no-trailing?param=value`).waitForRouteChange();\n        cy.getTestElement(`search-marker`).invoke(`text`).should(`equal`, `?param=value`);\n        cy.location(`pathname`).should(`equal`, `/slashes/no-trailing/`);\n        cy.location(`search`).should(`equal`, `?param=value`);\n      });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"/slashes/no-trailing/?param=value","suites":["Production build tests","Keeps search query","Converts no trailing slash canonical path to trailing (/slashes/no-trailing)"],"updatePoint":{"line":151,"column":43,"index":7512},"line":151,"code":"      it(`/slashes/no-trailing/?param=value`, () => {\n        cy.visit(`/slashes/no-trailing/?param=value`).waitForRouteChange();\n        cy.getTestElement(`search-marker`).invoke(`text`).should(`equal`, `?param=value`);\n        cy.location(`pathname`).should(`equal`, `/slashes/no-trailing/`);\n        cy.location(`search`).should(`equal`, `?param=value`);\n      });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"/slashes/with-trailing?param=value","suites":["Production build tests","Keeps search query","With trailing slash canonical path (/slashes/with-trailing/)"],"updatePoint":{"line":159,"column":44,"index":7974},"line":159,"code":"      it(`/slashes/with-trailing?param=value`, () => {\n        cy.visit(`/slashes/with-trailing?param=value`).waitForRouteChange();\n        cy.getTestElement(`search-marker`).invoke(`text`).should(`equal`, `?param=value`);\n        cy.location(`pathname`).should(`equal`, `/slashes/with-trailing/`);\n        cy.location(`search`).should(`equal`, `?param=value`);\n      });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"/slashes/with-trailing/?param=value","suites":["Production build tests","Keeps search query","With trailing slash canonical path (/slashes/with-trailing/)"],"updatePoint":{"line":165,"column":45,"index":8347},"line":165,"code":"      it(`/slashes/with-trailing/?param=value`, () => {\n        cy.visit(`/slashes/with-trailing/?param=value`).waitForRouteChange();\n        cy.getTestElement(`search-marker`).invoke(`text`).should(`equal`, `?param=value`);\n        cy.location(`pathname`).should(`equal`, `/slashes/with-trailing/`);\n        cy.location(`search`).should(`equal`, `?param=value`);\n      });","file":"production-runtime/cypress/integration/1-production.js","skipped":false,"dir":"e2e-tests"},{"name":"Focus router wrapper after navigation to regular page (from index)","suites":["focus management"],"updatePoint":{"line":7,"column":72,"index":383},"line":7,"code":"  it(`Focus router wrapper after navigation to regular page (from index)`, () => {\n    cy.visit(`/`).waitForAPIorTimeout(`onRouteUpdate`, {\n      timeout: 10000\n    });\n    cy.changeFocus();\n    cy.assertRouterWrapperFocus(false);\n    cy.navigateAndWaitForRouteChange(`/page-2/`);\n    cy.assertRouterWrapperFocus(true);\n  });","file":"production-runtime/cypress/integration/accessibility.js","skipped":false,"dir":"e2e-tests"},{"name":"Focus router wrapper after navigation to regular page (to index)","suites":["focus management"],"updatePoint":{"line":16,"column":70,"index":707},"line":16,"code":"  it(`Focus router wrapper after navigation to regular page (to index)`, () => {\n    cy.visit(`/page-2/`).waitForRouteChange();\n    cy.changeFocus();\n    cy.assertRouterWrapperFocus(false);\n    cy.navigateAndWaitForRouteChange(`/`);\n    cy.assertRouterWrapperFocus(true);\n  });","file":"production-runtime/cypress/integration/accessibility.js","skipped":false,"dir":"e2e-tests"},{"name":"Focus router wrapper after navigation to 404","suites":["focus management"],"updatePoint":{"line":23,"column":50,"index":965},"line":23,"code":"  it(`Focus router wrapper after navigation to 404`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.changeFocus();\n    cy.assertRouterWrapperFocus(false);\n    cy.navigateAndWaitForRouteChange(`/broken-path/`);\n    cy.assertRouterWrapperFocus(true);\n  });","file":"production-runtime/cypress/integration/accessibility.js","skipped":false,"dir":"e2e-tests"},{"name":"Focus router wrapper after navigation from 404","suites":["focus management"],"updatePoint":{"line":30,"column":52,"index":1230},"line":30,"code":"  it(`Focus router wrapper after navigation from 404`, () => {\n    cy.visit(`/broken-path`, {\n      failOnStatusCode: false\n    }).waitForAPIorTimeout(`onRouteUpdate`, {\n      timeout: 5000\n    });\n    cy.changeFocus();\n    cy.assertRouterWrapperFocus(false);\n    cy.navigateAndWaitForRouteChange(`/`);\n    cy.assertRouterWrapperFocus(true);\n  });","file":"production-runtime/cypress/integration/accessibility.js","skipped":false,"dir":"e2e-tests"},{"name":"Focus router wrapper after navigation from one 404 path to another 404 path","suites":["focus management"],"updatePoint":{"line":41,"column":81,"index":1607},"line":41,"code":"  it(`Focus router wrapper after navigation from one 404 path to another 404 path`, () => {\n    cy.visit(`/broken-path`, {\n      failOnStatusCode: false\n    }).waitForAPIorTimeout(`onRouteUpdate`, {\n      timeout: 5000\n    });\n\n    // navigating to different not existing page should also trigger\n    // router wrapper focus as this is different page\n    cy.changeFocus();\n    cy.assertRouterWrapperFocus(false);\n    cy.navigateAndWaitForRouteChange(`/another-broken-path/`);\n    cy.assertRouterWrapperFocus(true);\n  });","file":"production-runtime/cypress/integration/accessibility.js","skipped":false,"dir":"e2e-tests"},{"name":"Focus router wrapper after navigation to client-only page","suites":["focus management"],"updatePoint":{"line":55,"column":63,"index":2110},"line":55,"code":"  it(`Focus router wrapper after navigation to client-only page`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.changeFocus();\n    cy.assertRouterWrapperFocus(false);\n    cy.navigateAndWaitForRouteChange(`/client-only-paths/`);\n    cy.assertRouterWrapperFocus(true);\n  });","file":"production-runtime/cypress/integration/accessibility.js","skipped":false,"dir":"e2e-tests"},{"name":"Focus router wrapper after navigation from client-only page","suites":["focus management"],"updatePoint":{"line":62,"column":65,"index":2394},"line":62,"code":"  it(`Focus router wrapper after navigation from client-only page`, () => {\n    cy.visit(`/client-only-paths/`).waitForRouteChange();\n    cy.changeFocus();\n    cy.assertRouterWrapperFocus(false);\n    cy.navigateAndWaitForRouteChange(`/`);\n    cy.assertRouterWrapperFocus(true);\n  });","file":"production-runtime/cypress/integration/accessibility.js","skipped":false,"dir":"e2e-tests"},{"name":"Focus subrouter inside client-only page","suites":["focus management"],"line":71,"code":"  it.skip(`Focus subrouter inside client-only page`, () => {","file":"production-runtime/cypress/integration/accessibility.js","skipped":true,"dir":"e2e-tests"},{"name":"should only create one font file (no duplicates with different hashes)","suites":["webpack assets"],"updatePoint":{"line":13,"column":78,"index":666},"line":13,"code":"    it(`should only create one font file (no duplicates with different hashes)`, () => {\n      cy.wait(\"@font-regular\").should(req => {\n        expect(req.response.url).to.match(/merriweather-latin-300-/i);\n      });\n      cy.wait(\"@font-italic\").should(req => {\n        expect(req.response.url).to.match(/merriweather-latin-300italic-/i);\n      });\n    });","file":"production-runtime/cypress/integration/assets.js","skipped":false,"dir":"e2e-tests"},{"name":"should load image import","suites":["webpack assets"],"updatePoint":{"line":21,"column":32,"index":978},"line":21,"code":"    it(`should load image import`, () => {\n      cy.wait(\"@img-import\").should(req => {\n        expect(req.response.statusCode).to.be.gte(200).and.lt(400);\n      });\n    });","file":"production-runtime/cypress/integration/assets.js","skipped":false,"dir":"e2e-tests"},{"name":"should load file import","suites":["webpack assets"],"updatePoint":{"line":26,"column":31,"index":1151},"line":26,"code":"    it(`should load file import`, () => {\n      cy.getTestElement('assets-pdf-import').should('have.attr', 'href').and('match', /\\/static\\/pdf-example-.*\\.pdf/i);\n    });","file":"production-runtime/cypress/integration/assets.js","skipped":false,"dir":"e2e-tests"},{"name":"should load static folder asset","suites":["webpack assets"],"updatePoint":{"line":30,"column":37,"index":1332},"line":30,"code":"  it(`should load static folder asset`, () => {\n    cy.wait(\"@static-folder-image\").should(req => {\n      expect(req.response.statusCode).to.be.gte(200).and.lt(400);\n    });\n  });","file":"production-runtime/cypress/integration/assets.js","skipped":false,"dir":"e2e-tests"},{"name":"Applies .babelrc","suites":["babelrc"],"updatePoint":{"line":3,"column":22,"index":88},"line":3,"code":"  it(`Applies .babelrc`, () => {\n    cy.visit(`/babelrc/base/`).waitForRouteChange();\n    cy.getTestElement(TEST_ELEMENT).invoke(`text`).should(`eq`, `babel-rc-is-used`);\n  });","file":"production-runtime/cypress/integration/babelrc.js","skipped":false,"dir":"e2e-tests"},{"name":"should render properly","suites":["Webpack Compilation Hash tests"],"updatePoint":{"line":29,"column":28,"index":716},"line":29,"code":"  it(`should render properly`, () => {\n    cy.visit(`/`).waitForRouteChange();\n  });","file":"production-runtime/cypress/integration/compilation-hash.js","skipped":false,"dir":"e2e-tests"},{"name":"should reload page on navigation if build occurs in background","suites":["Webpack Compilation Hash tests"],"updatePoint":{"line":48,"column":70,"index":1703},"line":48,"code":"    it(`should reload page on navigation if build occurs in background`, () => {\n      const mockHash = createMockCompilationHash();\n      cy.intercept(\"/deep-link-page/\").as(\"deepLinkPage\");\n      cy.visit(`/`).waitForRouteChange();\n      let didMock = false;\n      cy.intercept(\"/page-data/app-data.json\", req => {\n        if (!didMock) {\n          req.reply({\n            webpackCompilationHash: mockHash\n          });\n          didMock = true;\n        }\n      }).as(`appDataFetch`);\n      cy.waitForAPI(\"onInitialClientRender\");\n\n      // just setting some property on the window\n      // we will later assert that property to know wether\n      // browser reload happened or not\n      cy.window().then(w => w.beforeReload = true);\n      cy.window().should('have.prop', 'beforeReload', true);\n      cy.window().then(w => w.___navigate(`/deep-link-page/`));\n\n      // wait for refresh\n      cy.wait(\"@deepLinkPage\");\n      cy.waitForRouteChange();\n\n      // we expect reload to happen so our window property shouldn't be set anymore\n      cy.window().should('not.have.prop', 'beforeReload');\n\n      // let's make sure we actually see the content\n      cy.contains(`StaticQuery in wrapRootElement test (should show site title):Gatsby Default Starter`);\n    });","file":"production-runtime/cypress/integration/compilation-hash.js","skipped":false,"dir":"e2e-tests"},{"name":"should force reload page if on initial load the html is not matching newest app/page-data","suites":["Webpack Compilation Hash tests"],"updatePoint":{"line":85,"column":97,"index":3305},"line":85,"code":"    it(`should force reload page if on initial load the html is not matching newest app/page-data`, {\n      retries: {\n        // give this test a few more chances... this one is rough\n        runMode: 4\n      }\n    }, () => {\n      const mockHash = createMockCompilationHash();\n\n      // trying to intercept just `/` seems to intercept all routes\n      // so intercepting same thing just with regex\n      cy.intercept(/^\\/$/).as(`indexFetch`);\n\n      // We will mock `app-data` and `page-data` json responses one time (for initial load)\n      let shouldMockAppDataRequests = true;\n      let shouldMockPageDataRequests = true;\n      cy.intercept(\"/page-data/app-data.json\", req => {\n        if (shouldMockAppDataRequests) {\n          req.reply({\n            webpackCompilationHash: mockHash\n          });\n          shouldMockAppDataRequests = false;\n        }\n      }).as(`appDataFetch`);\n      cy.readFile(`public/page-data/compilation-hash/page-data.json`).then(originalPageData => {\n        cy.intercept(\"/page-data/index/page-data.json\", req => {\n          if (shouldMockPageDataRequests) {\n            req.reply({\n              ...originalPageData,\n              // setting this to empty array should break runtime with\n              // either placeholder \"Loading (StaticQuery)\" (for <StaticQuery> component)\n              // or thrown error \"The result of this StaticQuery could not be fetched.\" (for `useStaticQuery` hook)\n              staticQueryHashes: []\n            });\n            shouldMockPageDataRequests = false;\n          }\n        }).as(`pageDataFetch`);\n      });\n      cy.visit(`/`);\n      cy.wait(1500);\n\n      // <StaticQuery> component case\n      cy.contains(\"Loading (StaticQuery)\").should(\"not.exist\");\n\n      // useStaticQuery hook case\n      cy.get(`@errorMessage`).should(`not.called`);\n\n      // let's make sure we actually see the content\n      cy.contains(`StaticQuery in wrapRootElement test (should show site title):Gatsby Default Starter`);\n      cy.get(\"@indexFetch.all\").should(\"have.length\", 2);\n      cy.get(\"@appDataFetch.all\").should(\"have.length\", 2);\n      cy.get(\"@pageDataFetch.all\").should(\"have.length\", 2);\n    });","file":"production-runtime/cypress/integration/compilation-hash.js","skipped":false,"dir":"e2e-tests"},{"name":"should not force reload indefinitely","suites":["Webpack Compilation Hash tests"],"updatePoint":{"line":137,"column":44,"index":5416},"line":137,"code":"    it(`should not force reload indefinitely`, () => {\n      const mockHash = createMockCompilationHash();\n\n      // trying to intercept just `/` seems to intercept all routes\n      // so intercepting same thing just with regex\n      cy.intercept(/^\\/$/).as(`indexFetch`);\n\n      // We will mock `app-data` and `page-data` json responses permanently\n      cy.intercept(\"/page-data/app-data.json\", req => {\n        req.reply({\n          webpackCompilationHash: mockHash\n        });\n      }).as(`appDataFetch`);\n      cy.readFile(`public/page-data/index/page-data.json`).then(originalPageData => {\n        cy.intercept(\"/page-data/index/page-data.json\", req => {\n          req.reply({\n            ...originalPageData,\n            // setting this to empty array should break runtime with\n            // either placeholder \"Loading (StaticQuery)\" (for <StaticQuery> component)\n            // or thrown error \"The result of this StaticQuery could not be fetched.\" (for `useStaticQuery` hook)\n            staticQueryHashes: []\n          });\n        }).as(`pageDataFetch`);\n      });\n      cy.visit(`/`);\n      cy.wait(1500);\n      cy.get(\"@indexFetch.all\").should(\"have.length\", 2);\n      cy.get(\"@appDataFetch.all\").should(\"have.length\", 2);\n      cy.get(\"@pageDataFetch.all\").should(\"have.length\", 2);\n    });","file":"production-runtime/cypress/integration/compilation-hash.js","skipped":false,"dir":"e2e-tests"},{"name":"SSG page gets right env vars","suites":["Uses env vars correctly"],"updatePoint":{"line":7,"column":34,"index":271},"line":7,"code":"  it(`SSG page gets right env vars`, () => {\n    cy.visit(`/env-vars`).waitForRouteChange();\n    cy.getTestElement(`process.env`).contains(`{}`);\n    cy.getTestElement(`process.env.EXISTING_VAR`).contains(`\"foo bar\"`);\n    cy.getTestElement(`process.env.NOT_EXISTING_VAR`).should(`be.empty`);\n  });","file":"production-runtime/cypress/integration/env-vars.js","skipped":false,"dir":"e2e-tests"},{"name":"SSR page gets right env vars","suites":["Uses env vars correctly"],"updatePoint":{"line":13,"column":34,"index":570},"line":13,"code":"  it(`SSR page gets right env vars`, () => {\n    cy.visit(`/ssr/static-path`).waitForRouteChange();\n    cy.getTestElement(`process.env`).contains(`{}`);\n\n    // EXISTING_VAR is provided by `.env.production`\n    // so despite not being prefixed with `GATSBY_` it is\n    // available to use in react template as well as in getServerData\n    cy.getTestElement(`process.env.EXISTING_VAR`).contains(`\"foo bar\"`);\n    cy.getTestElement(`serverData.envVars.EXISTING_VAR`).contains(`\"foo bar\"`);\n\n    // VERY_SECRET_VAR is not used by browser bundle, but it's used by getServerData\n    // we want to verify that it's available to getServerData and at the same time check\n    // if it doesn't leak to browser bundle (we do so by running `test-env-vars` script)\n    // We do use alias \"VERY_SECRET_ALIAS_VAR\" so that \"VERY_SECRET_VAR\" doesn't end up\n    // in public dir and mess with our test scanning public directory\n    cy.getTestElement(`serverData.envVars.VERY_SECRET_ALIAS_VAR`).contains(`\"it's a secret\"`);\n\n    // NOT_EXISTING_VAR is not defined at all so we expect it to be blank\n    // both in react template and in getServerData\n    cy.getTestElement(`process.env.NOT_EXISTING_VAR`).should(`be.empty`);\n    cy.getTestElement(`serverData.envVars.NOT_EXISTING_VAR`).should(`be.empty`);\n\n    // FROM_COMMAND_LINE is just in `process.env.`, but it's not prefixed with\n    // `GATSBY_` so it's not available for react template (process.env.FROM_COMMAND_LINE)\n    // but it is available to getServerData\n    cy.getTestElement(`process.env.FROM_COMMAND_LINE`).should(`be.empty`);\n    cy.getTestElement(`serverData.envVars.FROM_COMMAND_LINE`).contains(`\"YES\"`);\n\n    //prefix env should be available in `process.env` and getServerData\n    cy.getTestElement(`process.env.GATSBY_PREFIXED_FROM_COMMAND_LINE`).contains(`\"YES\"`);\n    cy.getTestElement(`serverData.envVars.GATSBY_PREFIXED_FROM_COMMAND_LINE`).contains(`\"YES\"`);\n  });","file":"production-runtime/cypress/integration/env-vars.js","skipped":false,"dir":"e2e-tests"},{"name":"doesn't recycle image nodes when not necessary","suites":["gatsby-plugin-image"],"updatePoint":{"line":28,"column":52,"index":865},"line":28,"code":"  it(`doesn't recycle image nodes when not necessary`, () => {\n    const mutationStub = cy.stub();\n    let cleanup;\n    cy.visit(`/gatsby-plugin-image-page-1/`);\n\n    // wait for the image to load\n    cy.get(\"[data-main-image]\").should(\"be.visible\");\n\n    // start watching mutations in the image-wrapper\n    cy.get(\"body\").then($element => {\n      cleanup = observeDOM($element[0], {}, mutations => {\n        const normalizedMutations = [];\n        mutations.forEach(mutation => {\n          if (mutation.type === \"childList\" && mutation.target.classList.contains(\"gatsby-image-wrapper\")) {\n            normalizedMutations.push({\n              type: mutation.type,\n              addedNodes: !!mutation.addedNodes.length,\n              removedNodes: !!mutation.removedNodes.length\n            });\n          }\n        });\n        if (normalizedMutations.length) {\n          mutationStub(normalizedMutations);\n        }\n      });\n    });\n    cy.window().then(win => win.___navigate(`/gatsby-plugin-image-page-2/`)).waitForRouteChange();\n\n    // wait for the image to load\n    cy.get(\"[data-main-image]\").should(\"be.visible\");\n    cy.wait(500);\n    cy.then(() => {\n      cleanup();\n      expect(mutationStub).to.be.calledWith([{\n        type: \"childList\",\n        addedNodes: true,\n        removedNodes: false\n      }]);\n    });\n  });","file":"production-runtime/cypress/integration/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"rerenders when image src changed","suites":["gatsby-plugin-image"],"updatePoint":{"line":68,"column":38,"index":2182},"line":68,"code":"  it(`rerenders when image src changed`, () => {\n    const mutationStub = cy.stub();\n    let cleanup;\n    cy.visit(`/gatsby-plugin-image-page-1/`);\n\n    // wait for the image to load\n    cy.get(\"[data-main-image]\").should(\"be.visible\");\n\n    // start watching mutations in the image-wrapper\n    cy.get(\"#image-wrapper\").then($element => {\n      cleanup = observeDOM($element[0], {}, mutations => {\n        const normalizedMutations = [];\n        mutationStub(mutations.map(mutation => {\n          normalizedMutations.push({\n            addedNodes: mutation.addedNodes,\n            removedNodes: mutation.removedNodes\n          });\n          return {\n            type: mutation.type,\n            addedNodes: !!mutation.addedNodes.length,\n            removedNodes: !!mutation.removedNodes.length\n          };\n        }));\n        Cypress.log({\n          name: \"MutationObserver\",\n          message: `${normalizedMutations.length} mutations`,\n          consoleProps: () => {\n            return {\n              mutations: normalizedMutations\n            };\n          }\n        });\n      });\n    });\n    cy.get(\"#click\").click();\n    cy.wait(500);\n    cy.get(\"[data-main-image]\", {\n      timeout: 5000\n    }).should(\"be.visible\");\n    cy.then(() => {\n      cleanup();\n      expect(mutationStub).to.be.calledOnce;\n      expect(mutationStub).to.be.calledWith([{\n        type: \"childList\",\n        addedNodes: true,\n        removedNodes: true\n      }]);\n    });\n  });","file":"production-runtime/cypress/integration/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"rerenders when background color changes","suites":["gatsby-plugin-image"],"updatePoint":{"line":117,"column":45,"index":3649},"line":117,"code":"  it(`rerenders when background color changes`, () => {\n    const mutationStub = cy.stub();\n    let cleanup;\n    cy.visit(`/gatsby-plugin-image-page-2/`);\n\n    // wait for the image to load\n    cy.get(\"[data-main-image]\").should(\"be.visible\");\n\n    // start watching mutations in the image-wrapper\n    cy.get(\"#image-wrapper\").then($element => {\n      cleanup = observeDOM($element[0], {\n        attributes: true,\n        attributeFilter: [\"style\"]\n      }, mutations => {\n        mutationStub(mutations.map(mutation => ({\n          type: mutation.type,\n          attributeName: mutation.attributeName\n        })));\n      });\n    });\n    cy.get(\"[data-gatsby-image-wrapper]\").should(\"have.css\", \"background-color\", \"rgb(102, 51, 153)\");\n    cy.get(\"#click\").click();\n    cy.wait(500);\n\n    // wait for the image to load\n    cy.get(\"[data-main-image]\").should(\"be.visible\");\n    cy.get(\"[data-gatsby-image-wrapper]\").should(\"have.css\", \"background-color\", \"rgb(255, 0, 0)\");\n    cy.then(() => {\n      cleanup();\n      expect(mutationStub).to.be.calledOnce;\n      expect(mutationStub).to.be.calledWith([{\n        type: \"attributes\",\n        attributeName: \"style\"\n      }]);\n    });\n  });","file":"production-runtime/cypress/integration/gatsby-plugin-image.js","skipped":false,"dir":"e2e-tests"},{"name":"should execute the onLoad callback","suites":["both onLoad and onError callbacks are declared"],"updatePoint":{"line":10,"column":40,"index":477},"line":10,"code":"  it(`should execute the onLoad callback`, () => {\n    cy.get(`[data-on-load-result=both-callbacks]`).should(`have.length`, 1);\n  });","file":"production-runtime/cypress/integration/gatsby-script-both-callbacks.js","skipped":false,"dir":"e2e-tests"},{"name":"should execute the onError callback","suites":["both onLoad and onError callbacks are declared"],"updatePoint":{"line":13,"column":41,"index":612},"line":13,"code":"  it(`should execute the onError callback`, () => {\n    cy.get(`[data-on-error-result=both-callbacks]`).should(`have.length`, 1);\n  });","file":"production-runtime/cypress/integration/gatsby-script-both-callbacks.js","skipped":false,"dir":"e2e-tests"},{"name":"should execute load callbacks of duplicate scripts","suites":["duplicate scripts"],"updatePoint":{"line":12,"column":56,"index":558},"line":12,"code":"  it(`should execute load callbacks of duplicate scripts`, () => {\n    cy.get(`[data-on-load-result=duplicate-1]`).should(`have.length`, 1);\n    cy.get(`[data-on-load-result=duplicate-2]`).should(`have.length`, 1);\n    cy.get(`[data-on-load-result=duplicate-3]`).should(`have.length`, 1);\n  });","file":"production-runtime/cypress/integration/gatsby-script-duplicate-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should execute error callbacks of duplicate scripts","suites":["duplicate scripts"],"updatePoint":{"line":17,"column":57,"index":854},"line":17,"code":"  it(`should execute error callbacks of duplicate scripts`, () => {\n    cy.get(`[data-on-error-result=duplicate-1]`).should(`have.length`, 1);\n    cy.get(`[data-on-error-result=duplicate-2]`).should(`have.length`, 1);\n    cy.get(`[data-on-error-result=duplicate-3]`).should(`have.length`, 1);\n  });","file":"production-runtime/cypress/integration/gatsby-script-duplicate-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should execute successfully","suites":["inline scripts set via ","using the post-hydrate strategy"],"updatePoint":{"line":31,"column":37,"index":1128},"line":31,"code":"      it(`should execute successfully`, () => {\n        cy.visit(page.target).waitForRouteChange();\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, `success`, true).should(`equal`, `true`);\n      });","file":"production-runtime/cypress/integration/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load after the framework bundle has loaded","suites":["inline scripts set via ","using the post-hydrate strategy"],"updatePoint":{"line":35,"column":59,"index":1359},"line":35,"code":"      it(`should load after the framework bundle has loaded`, () => {\n        cy.visit(page.target).waitForRouteChange();\n\n        // Assert framework is loaded before inline script is executed\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, markRecord.executeStart).then(dangerouslySetExecuteStart => {\n          cy.getRecord(`framework`, resourceRecord.responseEnd).should(`be.lessThan`, dangerouslySetExecuteStart);\n        });\n      });","file":"production-runtime/cypress/integration/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should execute successfully","suites":["inline scripts set via ","using the idle strategy"],"updatePoint":{"line":45,"column":37,"index":1843},"line":45,"code":"      it(`should execute successfully`, () => {\n        cy.visit(page.target).waitForRouteChange();\n        cy.getRecord(`idle-${inlineScriptType}`, `success`, true).should(`equal`, `true`);\n      });","file":"production-runtime/cypress/integration/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load after other strategies","suites":["inline scripts set via ","using the idle strategy"],"updatePoint":{"line":49,"column":44,"index":2051},"line":49,"code":"      it(`should load after other strategies`, () => {\n        cy.visit(page.target).waitForRouteChange();\n        cy.getRecord(`idle-${inlineScriptType}`, markRecord.executeStart).then(dangerouslySetExecuteStart => {\n          cy.getRecord(`post-hydrate-${inlineScriptType}`, markRecord.executeStart).should(`be.lessThan`, dangerouslySetExecuteStart);\n        });\n      });","file":"production-runtime/cypress/integration/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once on initial page load","suites":["inline scripts set via ","when navigation occurs"],"updatePoint":{"line":57,"column":52,"index":2489},"line":57,"code":"      it(`should load only once on initial page load`, () => {\n        cy.visit(page.target).waitForRouteChange();\n        cy.get(`table[id=script-mark-records] tbody`).children().should(`have.length`, 4);\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, `strategy`, true).should(`equal`, `post-hydrate`);\n        cy.getRecord(`idle-${inlineScriptType}`, `strategy`, true).should(`equal`, `idle`);\n      });","file":"production-runtime/cypress/integration/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once after the page is refreshed","suites":["inline scripts set via ","when navigation occurs"],"updatePoint":{"line":63,"column":59,"index":2912},"line":63,"code":"      it(`should load only once after the page is refreshed`, () => {\n        cy.visit(page.target).waitForRouteChange();\n        cy.reload().url().should(`contain`, page.target);\n        cy.get(`table[id=script-mark-records] tbody`).children().should(`have.length`, 4);\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, `strategy`, true).should(`equal`, `post-hydrate`);\n        cy.getRecord(`idle-${inlineScriptType}`, `strategy`, true).should(`equal`, `idle`);\n      });","file":"production-runtime/cypress/integration/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once after anchor link navigation","suites":["inline scripts set via ","when navigation occurs"],"updatePoint":{"line":70,"column":60,"index":3394},"line":70,"code":"      it(`should load only once after anchor link navigation`, () => {\n        cy.visit(page.target).waitForRouteChange();\n        cy.get(`a[id=anchor-link-back-to-index]`).click();\n        cy.url().should(`contain`, page.navigation);\n        cy.get(`a[href=\"${page.target}\"][id=anchor-link]`).click();\n        cy.get(`table[id=script-mark-records] tbody`).children().should(`have.length`, 4);\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, `strategy`, true).should(`equal`, `post-hydrate`);\n        cy.getRecord(`idle-${inlineScriptType}`, `strategy`, true).should(`equal`, `idle`);\n      });","file":"production-runtime/cypress/integration/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once if the page is revisited via browser back/forward buttons after anchor link navigation","suites":["inline scripts set via ","when navigation occurs"],"updatePoint":{"line":79,"column":118,"index":4056},"line":79,"code":"      it(`should load only once if the page is revisited via browser back/forward buttons after anchor link navigation`, () => {\n        cy.visit(page.navigation).waitForRouteChange();\n        cy.get(`a[href=\"${page.target}\"][id=anchor-link]`).click();\n        cy.get(`table[id=script-mark-records] tbody`); // Make sure history has time to change\n        cy.go(`back`).waitForRouteChange();\n        cy.go(`forward`).waitForRouteChange();\n        cy.get(`table[id=script-mark-records] tbody`).children().should(`have.length`, 4);\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, `strategy`, true).should(`equal`, `post-hydrate`);\n        cy.getRecord(`idle-${inlineScriptType}`, `strategy`, true).should(`equal`, `idle`);\n      });","file":"production-runtime/cypress/integration/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once after Gatsby link navigation","suites":["inline scripts set via ","when navigation occurs"],"updatePoint":{"line":89,"column":60,"index":4738},"line":89,"code":"      it(`should load only once after Gatsby link navigation`, () => {\n        cy.visit(page.target).waitForRouteChange();\n        cy.get(`a[id=gatsby-link-back-to-index]`).click();\n        cy.get(`a[href=\"${page.target}\"][id=gatsby-link]`).click();\n        cy.get(`table[id=script-mark-records] tbody`).children().should(`have.length`, 4);\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, `strategy`, true).should(`equal`, `post-hydrate`);\n        cy.getRecord(`idle-${inlineScriptType}`, `strategy`, true).should(`equal`, `idle`);\n      });","file":"production-runtime/cypress/integration/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once if the page is revisited via browser back/forward buttons after Gatsby link navigation","suites":["inline scripts set via ","when navigation occurs"],"updatePoint":{"line":97,"column":118,"index":5347},"line":97,"code":"      it(`should load only once if the page is revisited via browser back/forward buttons after Gatsby link navigation`, () => {\n        cy.visit(page.navigation).waitForRouteChange();\n        cy.get(`a[href=\"${page.target}\"][id=gatsby-link]`).click();\n        cy.go(`back`).waitForRouteChange();\n        cy.go(`forward`).waitForRouteChange();\n        cy.get(`table[id=script-mark-records] tbody`).children().should(`have.length`, 4);\n        cy.getRecord(`post-hydrate-${inlineScriptType}`, `strategy`, true).should(`equal`, `post-hydrate`);\n        cy.getRecord(`idle-${inlineScriptType}`, `strategy`, true).should(`equal`, `idle`);\n      });","file":"production-runtime/cypress/integration/gatsby-script-inline-scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should load successfully","suites":["scripts with sources","using the post-hydrate strategy"],"updatePoint":{"line":16,"column":32,"index":719},"line":16,"code":"    it(`should load successfully`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.getRecord(script.three, `success`, true).should(`equal`, `true`);\n    });","file":"production-runtime/cypress/integration/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load after the framework bundle has loaded","suites":["scripts with sources","using the post-hydrate strategy"],"updatePoint":{"line":20,"column":57,"index":920},"line":20,"code":"    it(`should load after the framework bundle has loaded`, () => {\n      cy.visit(page.target).waitForRouteChange();\n\n      // Assert framework is loaded before three starts loading\n      cy.getRecord(script.three, resourceRecord.fetchStart).then(threeFetchStart => {\n        cy.getRecord(`framework`, resourceRecord.responseEnd).should(`be.lessThan`, threeFetchStart);\n      });\n    });","file":"production-runtime/cypress/integration/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should call an on load callback once the script has loaded","suites":["scripts with sources","using the post-hydrate strategy"],"updatePoint":{"line":28,"column":66,"index":1318},"line":28,"code":"    it(`should call an on load callback once the script has loaded`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.getRecord(script.three, resourceRecord.responseEnd).then(() => {\n        cy.get(`[data-on-load-result=post-hydrate]`);\n      });\n    });","file":"production-runtime/cypress/integration/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should call an on error callback if an error occurred","suites":["scripts with sources","using the post-hydrate strategy"],"updatePoint":{"line":34,"column":61,"index":1586},"line":34,"code":"    it(`should call an on error callback if an error occurred`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.get(`[data-on-error-result=post-hydrate]`);\n    });","file":"production-runtime/cypress/integration/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load successfully","suites":["scripts with sources","using the idle strategy"],"updatePoint":{"line":40,"column":32,"index":1792},"line":40,"code":"    it(`should load successfully`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.getRecord(script.marked, `success`, true).should(`equal`, `true`);\n    });","file":"production-runtime/cypress/integration/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load after other strategies","suites":["scripts with sources","using the idle strategy"],"updatePoint":{"line":44,"column":42,"index":1979},"line":44,"code":"    it(`should load after other strategies`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.getRecord(script.marked, resourceRecord.fetchStart).then(markedFetchStart => {\n        cy.getRecord(script.three, resourceRecord.fetchStart).should(`be.lessThan`, markedFetchStart);\n      });\n    });","file":"production-runtime/cypress/integration/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should call an on load callback once the script has loaded","suites":["scripts with sources","using the idle strategy"],"updatePoint":{"line":50,"column":66,"index":2315},"line":50,"code":"    it(`should call an on load callback once the script has loaded`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.getRecord(script.marked, resourceRecord.responseEnd).then(() => {\n        cy.get(`[data-on-load-result=idle]`);\n      });\n    });","file":"production-runtime/cypress/integration/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should call an on error callback if an error occurred","suites":["scripts with sources","using the idle strategy"],"updatePoint":{"line":56,"column":61,"index":2576},"line":56,"code":"    it(`should call an on error callback if an error occurred`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.get(`[data-on-error-result=idle]`);\n    });","file":"production-runtime/cypress/integration/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once on initial page load","suites":["scripts with sources","when navigation occurs"],"updatePoint":{"line":62,"column":50,"index":2791},"line":62,"code":"    it(`should load only once on initial page load`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.get(`table[id=script-resource-records] tbody`).children().should(`have.length`, 5);\n      cy.getRecord(script.three, `strategy`, true).should(`equal`, `post-hydrate`);\n      cy.getRecord(script.marked, `strategy`, true).should(`equal`, `idle`);\n    });","file":"production-runtime/cypress/integration/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once after the page is refreshed","suites":["scripts with sources","when navigation occurs"],"updatePoint":{"line":68,"column":57,"index":3171},"line":68,"code":"    it(`should load only once after the page is refreshed`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.reload();\n      cy.get(`table[id=script-resource-records] tbody`).children().should(`have.length`, 5);\n      cy.getRecord(script.three, `strategy`, true).should(`equal`, `post-hydrate`);\n      cy.getRecord(script.marked, `strategy`, true).should(`equal`, `idle`);\n    });","file":"production-runtime/cypress/integration/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once after anchor link navigation","suites":["scripts with sources","when navigation occurs"],"updatePoint":{"line":75,"column":58,"index":3571},"line":75,"code":"    it(`should load only once after anchor link navigation`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.get(`table[id=script-resource-records] tbody`).children().should(`have.length`, 5);\n      cy.get(`a[id=anchor-link-back-to-index]`).click();\n      cy.url().should(`contain`, page.navigation);\n      cy.get(`a[href=\"${page.target}\"][id=anchor-link]`).click();\n      cy.get(`table[id=script-resource-records] tbody`).children().should(`have.length`, 5);\n      cy.getRecord(script.three, `strategy`, true).should(`equal`, `post-hydrate`);\n      cy.getRecord(script.marked, `strategy`, true).should(`equal`, `idle`);\n    });","file":"production-runtime/cypress/integration/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once if the page is revisited via browser back/forward buttons after anchor link navigation","suites":["scripts with sources","when navigation occurs"],"updatePoint":{"line":85,"column":116,"index":4277},"line":85,"code":"    it(`should load only once if the page is revisited via browser back/forward buttons after anchor link navigation`, () => {\n      cy.visit(page.navigation).waitForRouteChange();\n      cy.get(`a[href=\"${page.target}\"][id=anchor-link]`).click();\n      cy.go(`back`).waitForRouteChange();\n      cy.go(`forward`).waitForRouteChange();\n      cy.get(`table[id=script-resource-records] tbody`).children().should(`have.length`, 5);\n      cy.getRecord(script.three, `strategy`, true).should(`equal`, `post-hydrate`);\n      cy.getRecord(script.marked, `strategy`, true).should(`equal`, `idle`);\n    });","file":"production-runtime/cypress/integration/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once after Gatsby link navigation","suites":["scripts with sources","when navigation occurs"],"updatePoint":{"line":94,"column":58,"index":4815},"line":94,"code":"    it(`should load only once after Gatsby link navigation`, () => {\n      cy.visit(page.target).waitForRouteChange();\n      cy.get(`a[id=gatsby-link-back-to-index]`).click();\n      cy.get(`a[href=\"${page.target}\"][id=gatsby-link]`).click();\n      cy.get(`table[id=script-resource-records] tbody`).children().should(`have.length`, 5);\n      cy.getRecord(script.three, `strategy`, true).should(`equal`, `post-hydrate`);\n      cy.getRecord(script.marked, `strategy`, true).should(`equal`, `idle`);\n    });","file":"production-runtime/cypress/integration/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load only once if the page is revisited via browser back/forward buttons after Gatsby link navigation","suites":["scripts with sources","when navigation occurs"],"updatePoint":{"line":102,"column":116,"index":5377},"line":102,"code":"    it(`should load only once if the page is revisited via browser back/forward buttons after Gatsby link navigation`, () => {\n      cy.visit(page.navigation).waitForRouteChange();\n      cy.get(`a[href=\"${page.target}\"][id=gatsby-link]`).click();\n      cy.go(`back`).waitForRouteChange();\n      cy.go(`forward`).waitForRouteChange();\n      cy.get(`table[id=script-resource-records] tbody`).children().should(`have.length`, 5);\n      cy.getRecord(script.three, `strategy`, true).should(`equal`, `post-hydrate`);\n      cy.getRecord(script.marked, `strategy`, true).should(`equal`, `idle`);\n    });","file":"production-runtime/cypress/integration/gatsby-script-scripts-with-sources.js","skipped":false,"dir":"e2e-tests"},{"name":"should load successfully","suites":["using the idle strategy with shimmed requestIdleCallback"],"updatePoint":{"line":21,"column":30,"index":963},"line":21,"code":"  it(`should load successfully`, () => {\n    cy.visit(page).waitForRouteChange();\n    cy.getRecord(script.marked, `success`, true).should(`equal`, `true`);\n    cy.get(`@requestIdleCallback`).should(`not.be.called`);\n  });","file":"production-runtime/cypress/integration/gatsby-script-shimmed-req-idle-callback.js","skipped":false,"dir":"e2e-tests"},{"name":"should load after other strategies","suites":["using the idle strategy with shimmed requestIdleCallback"],"updatePoint":{"line":26,"column":40,"index":1195},"line":26,"code":"  it(`should load after other strategies`, () => {\n    cy.visit(page).waitForRouteChange();\n    cy.getRecord(script.marked, resourceRecord.fetchStart).then(markedFetchStart => {\n      cy.getRecord(script.three, resourceRecord.fetchStart).should(`be.lessThan`, markedFetchStart);\n    });\n    cy.get(`@requestIdleCallback`).should(`not.be.called`);\n  });","file":"production-runtime/cypress/integration/gatsby-script-shimmed-req-idle-callback.js","skipped":false,"dir":"e2e-tests"},{"name":"should call an on load callback once the script has loaded","suites":["using the idle strategy with shimmed requestIdleCallback"],"updatePoint":{"line":33,"column":64,"index":1572},"line":33,"code":"  it(`should call an on load callback once the script has loaded`, () => {\n    cy.visit(page).waitForRouteChange();\n    cy.getRecord(script.marked, resourceRecord.responseEnd).then(() => {\n      cy.get(`[data-on-load-result=idle]`);\n    });\n    cy.get(`@requestIdleCallback`).should(`not.be.called`);\n  });","file":"production-runtime/cypress/integration/gatsby-script-shimmed-req-idle-callback.js","skipped":false,"dir":"e2e-tests"},{"name":"should call an on error callback if an error occurred","suites":["using the idle strategy with shimmed requestIdleCallback"],"updatePoint":{"line":40,"column":59,"index":1874},"line":40,"code":"  it(`should call an on error callback if an error occurred`, () => {\n    cy.visit(page).waitForRouteChange();\n    cy.get(`[data-on-error-result=idle]`);\n    cy.get(`@requestIdleCallback`).should(`not.be.called`);\n  });","file":"production-runtime/cypress/integration/gatsby-script-shimmed-req-idle-callback.js","skipped":false,"dir":"e2e-tests"},{"name":"scripts load successfully when used via wrapPageElement","suites":[],"updatePoint":{"line":8,"column":59,"index":436},"line":8,"code":"it(`scripts load successfully when used via wrapPageElement`, () => {\n  cy.visit(page).waitForRouteChange();\n  cy.getRecord(script.three, `success`, true).should(`equal`, `true`);\n  cy.getRecord(script.marked, `success`, true).should(`equal`, `true`);\n});","file":"production-runtime/cypress/integration/gatsby-script-ssr-browser-apis.js","skipped":false,"dir":"e2e-tests"},{"name":"scripts load successfully when used via wrapRootElement","suites":[],"updatePoint":{"line":13,"column":59,"index":692},"line":13,"code":"it(`scripts load successfully when used via wrapRootElement`, () => {\n  cy.visit(page).waitForRouteChange();\n  cy.getRecord(script.jQuery, `success`, true).should(`equal`, `true`);\n  cy.getRecord(script.popper, `success`, true).should(`equal`, `true`);\n});","file":"production-runtime/cypress/integration/gatsby-script-ssr-browser-apis.js","skipped":false,"dir":"e2e-tests"},{"name":"works","suites":["gatsby-ssr.tsx"],"updatePoint":{"line":7,"column":11,"index":320},"line":7,"code":"  it(`works`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.get(`.gatsby-ssr-tsx`).should(`have.attr`, `data-content`, `TSX with gatsby-ssr works`);\n  });","file":"production-runtime/cypress/integration/gatsby-ssr-tsx.js","skipped":false,"dir":"e2e-tests"},{"name":"should apply any styles in root gatsby-browser.js","suites":["Global style from gatsby-browser.js"],"updatePoint":{"line":15,"column":55,"index":772},"line":15,"code":"  it(`should apply any styles in root gatsby-browser.js`, () => {\n    cy.getTestElement(`global-style`).should(`have.css`, `zIndex`, zIndex);\n  });","file":"production-runtime/cypress/integration/global-styles.js","skipped":false,"dir":"e2e-tests"},{"name":"should apply any styles in plugin(s) gatsby-browser.js","suites":["Global style from gatsby-browser.js"],"updatePoint":{"line":18,"column":60,"index":925},"line":18,"code":"  it(`should apply any styles in plugin(s) gatsby-browser.js`, () => {\n    cy.getTestElement(`global-plugin-style`).should(`have.css`, `zIndex`, zIndex);\n  });","file":"production-runtime/cypress/integration/global-styles.js","skipped":false,"dir":"e2e-tests"},{"name":"url without host","suites":["Global style from gatsby-browser.js","should resolve absolute path in url()"],"updatePoint":{"line":22,"column":24,"index":1109},"line":22,"code":"    it(`url without host`, () => {\n      cy.wait(\"@thumbnail\").should(req => {\n        expect(req.response.statusCode).to.be.gte(200).and.lt(400);\n      });\n      cy.getTestElement(`global-style-background`).should(`have.css`, `background-image`, `url(\"http://localhost:9000/dog-thumbnail.jpg\")`);\n    });","file":"production-runtime/cypress/integration/global-styles.js","skipped":false,"dir":"e2e-tests"},{"name":"url with host and without protocol","suites":["Global style from gatsby-browser.js","should resolve absolute path in url()"],"updatePoint":{"line":28,"column":42,"index":1433},"line":28,"code":"    it(`url with host and without protocol`, () => {\n      cy.wait(\"@absolute-url-without-protocol\").should(req => {\n        expect(req.response.statusCode).to.be.gte(200).and.lt(400);\n      });\n      cy.getTestElement(`global-style-urlwithoutprotocol`).should(`have.css`, `background-image`, `url(\"http://localhost:9000/dog-thumbnail-flip.jpg\")`);\n    });","file":"production-runtime/cypress/integration/global-styles.js","skipped":false,"dir":"e2e-tests"},{"name":"url with host and with protocol","suites":["Global style from gatsby-browser.js","should resolve absolute path in url()"],"updatePoint":{"line":34,"column":39,"index":1787},"line":34,"code":"    it(`url with host and with protocol`, () => {\n      cy.wait(\"@absolute-url-with-protocol\").should(req => {\n        expect(req.response.statusCode).to.be.gte(200).and.lt(400);\n      });\n      cy.getTestElement(`global-style-fullurl`).should(`have.css`, `background-image`, `url(\"http://localhost:9000/dog-thumbnail-dither.jpg\")`);\n    });","file":"production-runtime/cypress/integration/global-styles.js","skipped":false,"dir":"e2e-tests"},{"name":"should resolve relative path in url()","suites":["Global style from gatsby-browser.js","should resolve absolute path in url()"],"updatePoint":{"line":44,"column":45,"index":2267},"line":44,"code":"    it(`should resolve relative path in url()`, () => {\n      cy.wait(\"@font\").should(req => {\n        expect(req.response.statusCode).to.be.gte(200).and.lt(400);\n      });\n    });","file":"production-runtime/cypress/integration/global-styles.js","skipped":false,"dir":"e2e-tests"},{"name":"Deduplicates multiple tags with same id","suites":[],"updatePoint":{"line":2,"column":43,"index":133},"line":2,"code":"it(`Deduplicates multiple tags with same id`, () => {\n  cy.visit(headFunctionExportSharedData.page.deduplication).waitForRouteChange();\n\n  // deduplication link has id and should be deduplicated\n  cy.get(`link[rel=deduplication]`).should(\"have.length\", 1);\n  // last deduplication link should win\n  cy.get(`link[rel=deduplication]`).should(\"have.attr\", \"href\", \"/bar\");\n  // we should preserve id\n  cy.get(`link[rel=deduplication]`).should(\"have.attr\", \"id\", \"deduplication-test\");\n\n  // alternate links are not using id, so should have multiple instances\n  cy.get(`link[rel=alternate]`).should(\"have.length\", 2);\n});","file":"production-runtime/cypress/integration/head-function-export/deduplication.js","skipped":false,"dir":"e2e-tests"},{"name":"Head function export with FS Route API should work","suites":[],"updatePoint":{"line":2,"column":54,"index":130},"line":2,"code":"it(`Head function export with FS Route API should work`, () => {\n  cy.visit(page.fsRouteApi).waitForRouteChange();\n  cy.getTestElement(`title`).should(`have.text`, data.fsRouteApi.slug);\n});","file":"production-runtime/cypress/integration/head-function-export/fs-route-api.js","skipped":false,"dir":"e2e-tests"},{"name":"can pickup deeply nested valid head elements","suites":["Head with wrapRootElement"],"updatePoint":{"line":9,"column":50,"index":519},"line":9,"code":"  it(`can pickup deeply nested valid head elements`, () => {\n    cy.visit(headFunctionExportSharedData.page.headWithWrapRooElement).waitForRouteChange();\n    console.log({\n      headFunctionExportSharedData\n    });\n    const {\n      data\n    } = headFunctionExportSharedData;\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.static.base);\n    cy.getTestElement(`title`).should(`have.text`, contextValue.posts[0].title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, contextValue.posts[1].title);\n    cy.getTestElement(`noscript`).should(`have.text`, data.static.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.static.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.static.link);\n    cy.getTestElement(`jsonLD`).should(`have.text`, data.static.jsonLD);\n  });","file":"production-runtime/cypress/integration/head-function-export/head-with-wrap-root-element.js","skipped":false,"dir":"e2e-tests"},{"name":"can use context values provided in wrapRootElement","suites":["Head with wrapRootElement"],"updatePoint":{"line":25,"column":56,"index":1385},"line":25,"code":"  it(`can use context values provided in wrapRootElement`, () => {\n    cy.visit(headFunctionExportSharedData.page.headWithWrapRooElement).waitForRouteChange();\n    cy.getTestElement(`title`).should(`have.text`, contextValue.posts[0].title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, contextValue.posts[1].title);\n  });","file":"production-runtime/cypress/integration/head-function-export/head-with-wrap-root-element.js","skipped":false,"dir":"e2e-tests"},{"name":"Page has body and html attributes on direct visit","suites":["Html and body attributes"],"updatePoint":{"line":8,"column":55,"index":463},"line":8,"code":"  it(`Page has body and html attributes on direct visit`, () => {\n    cy.visit(headFunctionExportSharedData.page.htmlAndBodyAttributes).waitForRouteChange();\n    cy.get(`body`).should(`have.attr`, `data-foo`, `baz`);\n    cy.get(`body`).should(`have.attr`, `class`, `foo`);\n    cy.get(`body`).should(`have.css`, `accentColor`, `rgb(102, 51, 153)`);\n    cy.get(`body`).should(`have.css`, `caretColor`, `rgb(102, 51, 153)`);\n    cy.get(`html`).should(`have.attr`, `data-foo`, `bar`);\n    cy.get(`html`).should(`have.attr`, `lang`, `fr`);\n    cy.get(`html`).should(`have.css`, `accentColor`, `rgb(102, 51, 153)`);\n    cy.get(`html`).should(`have.css`, `caretColor`, `rgb(102, 51, 153)`);\n  });","file":"production-runtime/cypress/integration/head-function-export/html-and-body-attributes.js","skipped":false,"dir":"e2e-tests"},{"name":"Page has body and html attributes on client-side navigation","suites":["Html and body attributes"],"updatePoint":{"line":19,"column":65,"index":1163},"line":19,"code":"  it(`Page has body and html attributes on client-side navigation`, () => {\n    cy.visit(headFunctionExportSharedData.page.basic).waitForRouteChange();\n    cy.get(`body`).should(`not.have.attr`, `data-foo`, `baz`);\n    cy.get(`body`).should(`not.have.attr`, `class`, `foo`);\n    cy.get(`html`).should(`not.have.attr`, `data-foo`, `bar`);\n    cy.get(`html`).should(`not.have.attr`, `lang`, `fr`);\n    cy.visit(headFunctionExportSharedData.page.htmlAndBodyAttributes).waitForRouteChange();\n    cy.get(`body`).should(`have.attr`, `data-foo`, `baz`);\n    cy.get(`body`).should(`have.attr`, `class`, `foo`);\n    cy.get(`body`).should(`have.css`, `accentColor`, `rgb(102, 51, 153)`);\n    cy.get(`body`).should(`have.css`, `caretColor`, `rgb(102, 51, 153)`);\n    cy.get(`html`).should(`have.attr`, `data-foo`, `bar`);\n    cy.get(`html`).should(`have.attr`, `lang`, `fr`);\n    cy.get(`html`).should(`have.css`, `accentColor`, `rgb(102, 51, 153)`);\n    cy.get(`html`).should(`have.css`, `caretColor`, `rgb(102, 51, 153)`);\n  });","file":"production-runtime/cypress/integration/head-function-export/html-and-body-attributes.js","skipped":false,"dir":"e2e-tests"},{"name":"Body and html attributes are removed on client-side navigation when new page doesn't set them","suites":["Html and body attributes"],"updatePoint":{"line":35,"column":99,"index":2217},"line":35,"code":"  it(`Body and html attributes are removed on client-side navigation when new page doesn't set them`, () => {\n    cy.visit(headFunctionExportSharedData.page.htmlAndBodyAttributes).waitForRouteChange();\n    cy.get(`body`).should(`have.attr`, `data-foo`, `baz`);\n    cy.get(`body`).should(`have.attr`, `class`, `foo`);\n    cy.get(`body`).should(`have.css`, `accentColor`, `rgb(102, 51, 153)`);\n    cy.get(`body`).should(`have.css`, `caretColor`, `rgb(102, 51, 153)`);\n    cy.get(`html`).should(`have.attr`, `data-foo`, `bar`);\n    cy.get(`html`).should(`have.attr`, `lang`, `fr`);\n    cy.get(`html`).should(`have.css`, `accentColor`, `rgb(102, 51, 153)`);\n    cy.get(`html`).should(`have.css`, `caretColor`, `rgb(102, 51, 153)`);\n    cy.visit(headFunctionExportSharedData.page.basic).waitForRouteChange();\n    cy.get(`body`).should(`not.have.attr`, `data-foo`, `baz`);\n    cy.get(`body`).should(`not.have.attr`, `class`, `foo`);\n    cy.get(`body`).should(`not.have.css`, `accentColor`, `rgb(102, 51, 153)`);\n    cy.get(`body`).should(`not.have.css`, `caretColor`, `rgb(102, 51, 153)`);\n    cy.get(`html`).should(`not.have.attr`, `data-foo`, `bar`);\n    cy.get(`html`).should(`not.have.attr`, `lang`, `fr`);\n    cy.get(`html`).should(`not.have.css`, `accentColor`, `rgb(102, 51, 153)`);\n    cy.get(`html`).should(`not.have.css`, `caretColor`, `rgb(102, 51, 153)`);\n  });","file":"production-runtime/cypress/integration/head-function-export/html-and-body-attributes.js","skipped":false,"dir":"e2e-tests"},{"name":"should work with static data","suites":["Head function export html insertion"],"updatePoint":{"line":8,"column":34,"index":439},"line":8,"code":"  it(`should work with static data`, () => {\n    cy.visit(page.basic).waitForRouteChange();\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.static.base);\n    cy.getTestElement(`title`).should(`have.text`, data.static.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.static.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.static.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.static.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.static.link);\n    cy.getTestElement(`jsonLD`).should(`have.text`, data.static.jsonLD);\n  });","file":"production-runtime/cypress/integration/head-function-export/html-insertion.js","skipped":false,"dir":"e2e-tests"},{"name":"should work with data from a page query","suites":["Head function export html insertion"],"updatePoint":{"line":18,"column":45,"index":1105},"line":18,"code":"  it(`should work with data from a page query`, () => {\n    cy.visit(page.pageQuery).waitForRouteChange();\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.queried.base);\n    cy.getTestElement(`title`).should(`have.text`, data.queried.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.queried.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.queried.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.queried.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.queried.link);\n  });","file":"production-runtime/cypress/integration/head-function-export/html-insertion.js","skipped":false,"dir":"e2e-tests"},{"name":"should work when a Head function with static data is re-exported from the page","suites":["Head function export html insertion"],"updatePoint":{"line":27,"column":84,"index":1747},"line":27,"code":"  it(`should work when a Head function with static data is re-exported from the page`, () => {\n    cy.visit(page.reExport).waitForRouteChange();\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.static.base);\n    cy.getTestElement(`title`).should(`have.text`, data.static.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.static.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.static.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.static.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.static.link);\n    cy.getTestElement(`jsonLD`).should(`have.text`, data.static.jsonLD);\n  });","file":"production-runtime/cypress/integration/head-function-export/html-insertion.js","skipped":false,"dir":"e2e-tests"},{"name":"should work when an imported Head component with queried data is used","suites":["Head function export html insertion"],"updatePoint":{"line":37,"column":75,"index":2446},"line":37,"code":"  it(`should work when an imported Head component with queried data is used`, () => {\n    cy.visit(page.staticQuery).waitForRouteChange();\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.queried.base);\n    cy.getTestElement(`title`).should(`have.text`, data.queried.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.queried.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.queried.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.queried.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.queried.link);\n  });","file":"production-runtime/cypress/integration/head-function-export/html-insertion.js","skipped":false,"dir":"e2e-tests"},{"name":"should work in a DSG page (exporting function named config)","suites":["Head function export html insertion"],"updatePoint":{"line":46,"column":65,"index":3071},"line":46,"code":"  it(`should work in a DSG page (exporting function named config)`, () => {\n    cy.visit(page.dsg).waitForRouteChange();\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.dsg.base);\n    cy.getTestElement(`title`).should(`have.text`, data.dsg.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.dsg.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.dsg.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.dsg.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.dsg.link);\n  });","file":"production-runtime/cypress/integration/head-function-export/html-insertion.js","skipped":false,"dir":"e2e-tests"},{"name":"should work in an SSR page (exporting function named getServerData)","suites":["Head function export html insertion"],"updatePoint":{"line":55,"column":73,"index":3672},"line":55,"code":"  it(`should work in an SSR page (exporting function named getServerData)`, () => {\n    cy.visit(page.ssr).waitForRouteChange();\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.ssr.base);\n    cy.getTestElement(`title`).should(`have.text`, data.ssr.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.ssr.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.ssr.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.ssr.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.ssr.link);\n    cy.getTestElement(`server-data`).invoke(`attr`, `content`).should(`equal`, JSON.stringify(data.ssr.serverData));\n  });","file":"production-runtime/cypress/integration/head-function-export/html-insertion.js","skipped":false,"dir":"e2e-tests"},{"name":"Head function export should not include invalid elements","suites":[],"updatePoint":{"line":2,"column":60,"index":136},"line":2,"code":"it(`Head function export should not include invalid elements`, () => {\n  cy.visit(page.invalidElements).waitForRouteChange();\n  cy.get(`head > h1`).should(`not.exist`);\n  cy.get(`head > div`).should(`not.exist`);\n  cy.get(`head > audio`).should(`not.exist`);\n  cy.get(`head > video`).should(`not.exist`);\n  cy.get(`head > title`).should(`exist`).and(`have.text`, data.invalidElements.title);\n});","file":"production-runtime/cypress/integration/head-function-export/invalid-elements.js","skipped":false,"dir":"e2e-tests"},{"name":"should remove tags not on next page","suites":["Head function export behavior during CSR navigation (Gatsby Link)"],"updatePoint":{"line":11,"column":41,"index":587},"line":11,"code":"  it(`should remove tags not on next page`, () => {\n    cy.visit(page.basic).waitForRouteChange();\n    cy.getTestElement(`extra-meta`).invoke(`attr`, `content`).should(`equal`, data.static.extraMeta);\n    cy.getTestElement(`gatsby-link`).click().waitForRouteChange();\n    cy.get(`[data-testid=\"extra-meta\"]`).should(`not.exist`);\n  });","file":"production-runtime/cypress/integration/head-function-export/navigation.js","skipped":false,"dir":"e2e-tests"},{"name":"should add tags not on next page","suites":["Head function export behavior during CSR navigation (Gatsby Link)"],"updatePoint":{"line":17,"column":38,"index":920},"line":17,"code":"  it(`should add tags not on next page`, () => {\n    cy.visit(page.basic).waitForRouteChange();\n    cy.get(`[data-testid=\"extra-meta-2\"]`).should(`not.exist`);\n    cy.getTestElement(`gatsby-link`).click();\n    cy.getTestElement(`extra-meta-2`).invoke(`attr`, `content`).should(`equal`, data.queried.extraMeta2);\n  });","file":"production-runtime/cypress/integration/head-function-export/navigation.js","skipped":false,"dir":"e2e-tests"},{"name":"should not contain tags from old tags when we navigate to page without Head export","suites":["Head function export behavior during CSR navigation (Gatsby Link)"],"updatePoint":{"line":23,"column":88,"index":1288},"line":23,"code":"  it(`should not contain tags from old tags when we navigate to page without Head export`, () => {\n    cy.visit(page.basic).waitForRouteChange();\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.static.base);\n    cy.getTestElement(`title`).should(`have.text`, data.static.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.static.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.static.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.static.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.static.link);\n    cy.getTestElement(`jsonLD`).should(`have.text`, data.static.jsonLD);\n    cy.getTestElement(`navigate-to-page-without-head-export`).click().waitForRouteChange();\n    cy.getTestElement(`base`).should(`not.exist`);\n    cy.getTestElement(`title`).should(`not.exist`);\n    cy.getTestElement(`meta`).should(`not.exist`);\n    cy.getTestElement(`noscript`).should(`not.exist`);\n    cy.getTestElement(`style`).should(`not.exist`);\n    cy.getTestElement(`link`).should(`not.exist`);\n    cy.getTestElement(`jsonLD`).should(`not.exist`);\n  });","file":"production-runtime/cypress/integration/head-function-export/navigation.js","skipped":false,"dir":"e2e-tests"},{"name":"should change meta tag values","suites":["Head function export behavior during CSR navigation (Gatsby Link)"],"updatePoint":{"line":46,"column":35,"index":2662},"line":46,"code":"  it(`should change meta tag values`, () => {\n    // Initial load\n    cy.visit(page.basic).waitForRouteChange();\n\n    // Validate data from initial load\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.static.base);\n    cy.getTestElement(`title`).should(`have.text`, data.static.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.static.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.static.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.static.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.static.link);\n\n    // Navigate to a different page via Gatsby Link\n    cy.getTestElement(`gatsby-link`).click().waitForRouteChange();\n\n    // Validate data on navigated-to page\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.queried.base);\n    cy.getTestElement(`title`).should(`have.text`, data.queried.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.queried.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.queried.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.queried.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.queried.link);\n\n    // Navigate back to original page via Gatsby Link\n    cy.getTestElement(`gatsby-link`).click().waitForRouteChange();\n\n    // Validate data is same as initial load\n    cy.getTestElement(`base`).invoke(`attr`, `href`).should(`equal`, data.static.base);\n    cy.getTestElement(`title`).should(`have.text`, data.static.title);\n    cy.getTestElement(`meta`).invoke(`attr`, `content`).should(`equal`, data.static.meta);\n    cy.getTestElement(`noscript`).should(`have.text`, data.static.noscript);\n    cy.getTestElement(`style`).should(`contain`, data.static.style);\n    cy.getTestElement(`link`).invoke(`attr`, `href`).should(`equal`, data.static.link);\n  });","file":"production-runtime/cypress/integration/head-function-export/navigation.js","skipped":false,"dir":"e2e-tests"},{"name":"Inline script work and get called only once","suites":["Scripts"],"updatePoint":{"line":14,"column":49,"index":638},"line":14,"code":"  it(`Inline script work and get called only once`, () => {\n    // Head export seem to be appending the tags after waitForRouteChange()\n    // We need to find a way to make waitForRouteChange() catch Head export too\n    cy.wait(3000);\n    cy.window().then(win => {\n      expect(win.__SOME_GLOBAL_TO_CHECK_CALL_COUNT__).to.equal(1);\n    });\n  });","file":"production-runtime/cypress/integration/head-function-export/scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"Works with Head export","suites":["Tsx Pages"],"updatePoint":{"line":2,"column":28,"index":59},"line":2,"code":"  it(`Works with Head export`, () => {\n    cy.visit(`/head-function-export/tsx-page`);\n    cy.getTestElement(`title`).should(`contain`, `TypeScript`);\n    cy.getTestElement(`name`).invoke(`attr`, `content`).should(`equal`, `TypeScript`);\n  });","file":"production-runtime/cypress/integration/head-function-export/typescript.js","skipped":false,"dir":"e2e-tests"},{"name":"Page with Head Export that uses useLocation works","suites":[],"updatePoint":{"line":2,"column":53,"index":143},"line":2,"code":"it(`Page with Head Export that uses useLocation works`, () => {\n  cy.visit(headFunctionExportSharedData.page.pageWithUseLocation).waitForRouteChange();\n  cy.getTestElement(`location-pathname-in-template`).invoke(`text`).then(text => {\n    cy.getTestElement(`location-pathname-in-head`).invoke(`attr`, `content`).should('equal', text);\n  });\n});","file":"production-runtime/cypress/integration/head-function-export/use-location.js","skipped":false,"dir":"e2e-tests"},{"name":"should remount when navigating to different template","suites":["Production build tests"],"updatePoint":{"line":7,"column":58,"index":375},"line":7,"code":"  it(`should remount when navigating to different template`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.getTestElement(`page2`).click().waitForRouteChange();\n\n    // add buffer time so that componentDidMount has time to be called after route change\n    cy.wait(1000);\n\n    // we expect 2 `componentDidMount` calls - 1 for initial page and 1 for second page\n    cy.lifecycleCallCount(`componentDidMount`).should(`equal`, 2);\n    cy.lifecycleCallCount(`render`).should(`equal`, 2);\n  });","file":"production-runtime/cypress/integration/lifecycle-methods.js","skipped":false,"dir":"e2e-tests"},{"name":"should remount when navigating to different page using same template","suites":["Production build tests"],"updatePoint":{"line":18,"column":74,"index":889},"line":18,"code":"  it(`should remount when navigating to different page using same template`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.getTestElement(`duplicated`).click().waitForRouteChange();\n\n    // add buffer time so that componentDidMount has time to be called after route change\n    cy.wait(1000);\n\n    // we expect 2 `componentDidMount` calls - 1 for initial page and 1 for duplicated page\n    cy.lifecycleCallCount(`componentDidMount`).should(`equal`, 2);\n    cy.lifecycleCallCount(`render`).should(`equal`, 2);\n  });","file":"production-runtime/cypress/integration/lifecycle-methods.js","skipped":false,"dir":"e2e-tests"},{"name":"should NOT remount when navigating within client only paths","suites":["Production build tests"],"updatePoint":{"line":29,"column":65,"index":1403},"line":29,"code":"  it(`should NOT remount when navigating within client only paths`, () => {\n    cy.visit(`/client-only-paths`).waitForRouteChange();\n    cy.getTestElement(`/page/profile`).click().waitForRouteChange();\n    cy.getTestElement(`/nested/foo`).click().waitForRouteChange();\n\n    // add buffer time so that componentDidMount has time to be called after route change\n    cy.wait(1000);\n\n    // we expect just 1 `componentDidMount` call, when navigating inside matchPath\n    cy.lifecycleCallCount(`componentDidMount`).should(`equal`, 1);\n    cy.lifecycleCallCount(`render`).should(`equal`, 3);\n  });","file":"production-runtime/cypress/integration/lifecycle-methods.js","skipped":false,"dir":"e2e-tests"},{"name":"should have exports named config removed","suites":["modifed exports","page templates"],"updatePoint":{"line":22,"column":48,"index":914},"line":22,"code":"    it(`should have exports named config removed`, () => {\n      cy.getTestElement(`modified-exports-page-template-config`).invoke(`text`).should(`contain`, `undefined`);\n    });","file":"production-runtime/cypress/integration/modified-exports-ts.js","skipped":false,"dir":"e2e-tests"},{"name":"should have exports named getServerData removed","suites":["modifed exports","page templates"],"updatePoint":{"line":25,"column":55,"index":1100},"line":25,"code":"    it(`should have exports named getServerData removed`, () => {\n      cy.getTestElement(`modified-exports-page-template-get-server-data`).invoke(`text`).should(`contain`, `undefined`);\n    });","file":"production-runtime/cypress/integration/modified-exports-ts.js","skipped":false,"dir":"e2e-tests"},{"name":"should have imported exports named config left alone","suites":["modifed exports","page templates"],"updatePoint":{"line":28,"column":60,"index":1300},"line":28,"code":"    it(`should have imported exports named config left alone`, () => {\n      cy.getTestElement(`unmodified-exports-page-template-config`).invoke(`text`).should(`contain`, config);\n    });","file":"production-runtime/cypress/integration/modified-exports-ts.js","skipped":false,"dir":"e2e-tests"},{"name":"should have imported exports named getServerData left alone","suites":["modifed exports","page templates"],"updatePoint":{"line":31,"column":67,"index":1495},"line":31,"code":"    it(`should have imported exports named getServerData left alone`, () => {\n      cy.getTestElement(`unmodified-exports-page-template-get-server-data`).invoke(`text`).should(`contain`, getServerData);\n    });","file":"production-runtime/cypress/integration/modified-exports-ts.js","skipped":false,"dir":"e2e-tests"},{"name":"should have other imported exports left alone","suites":["modifed exports","page templates"],"updatePoint":{"line":34,"column":53,"index":1692},"line":34,"code":"    it(`should have other imported exports left alone`, () => {\n      cy.getTestElement(`unmodified-exports-page-template-hello-world`).invoke(`text`).should(`contain`, helloWorld);\n    });","file":"production-runtime/cypress/integration/modified-exports-ts.js","skipped":false,"dir":"e2e-tests"},{"name":"should have exports named config left alone","suites":["modifed exports","other JS files"],"updatePoint":{"line":39,"column":51,"index":1923},"line":39,"code":"    it(`should have exports named config left alone`, () => {\n      cy.getTestElement(`unmodified-exports-config`).invoke(`text`).should(`contain`, config);\n    });","file":"production-runtime/cypress/integration/modified-exports-ts.js","skipped":false,"dir":"e2e-tests"},{"name":"should have exports named getServerData left alone","suites":["modifed exports","other JS files"],"updatePoint":{"line":42,"column":58,"index":2095},"line":42,"code":"    it(`should have exports named getServerData left alone`, () => {\n      cy.getTestElement(`unmodified-exports-get-server-data`).invoke(`text`).should(`contain`, getServerData);\n    });","file":"production-runtime/cypress/integration/modified-exports-ts.js","skipped":false,"dir":"e2e-tests"},{"name":"should have other named exports left alone","suites":["modifed exports","other JS files"],"updatePoint":{"line":45,"column":50,"index":2275},"line":45,"code":"    it(`should have other named exports left alone`, () => {\n      cy.getTestElement(`unmodified-exports-hello-world`).invoke(`text`).should(`contain`, helloWorld);\n    });","file":"production-runtime/cypress/integration/modified-exports-ts.js","skipped":false,"dir":"e2e-tests"},{"name":"should have exports named config removed","suites":["modifed exports","page templates"],"updatePoint":{"line":22,"column":48,"index":911},"line":22,"code":"    it(`should have exports named config removed`, () => {\n      cy.getTestElement(`modified-exports-page-template-config`).invoke(`text`).should(`contain`, `undefined`);\n    });","file":"production-runtime/cypress/integration/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should have exports named getServerData removed","suites":["modifed exports","page templates"],"updatePoint":{"line":25,"column":55,"index":1097},"line":25,"code":"    it(`should have exports named getServerData removed`, () => {\n      cy.getTestElement(`modified-exports-page-template-get-server-data`).invoke(`text`).should(`contain`, `undefined`);\n    });","file":"production-runtime/cypress/integration/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should have imported exports named config left alone","suites":["modifed exports","page templates"],"updatePoint":{"line":28,"column":60,"index":1297},"line":28,"code":"    it(`should have imported exports named config left alone`, () => {\n      cy.getTestElement(`unmodified-exports-page-template-config`).invoke(`text`).should(`contain`, config);\n    });","file":"production-runtime/cypress/integration/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should have imported exports named getServerData left alone","suites":["modifed exports","page templates"],"updatePoint":{"line":31,"column":67,"index":1492},"line":31,"code":"    it(`should have imported exports named getServerData left alone`, () => {\n      cy.getTestElement(`unmodified-exports-page-template-get-server-data`).invoke(`text`).should(`contain`, getServerData);\n    });","file":"production-runtime/cypress/integration/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should have other imported exports left alone","suites":["modifed exports","page templates"],"updatePoint":{"line":34,"column":53,"index":1689},"line":34,"code":"    it(`should have other imported exports left alone`, () => {\n      cy.getTestElement(`unmodified-exports-page-template-hello-world`).invoke(`text`).should(`contain`, helloWorld);\n    });","file":"production-runtime/cypress/integration/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should have exports named config left alone","suites":["modifed exports","other JS files"],"updatePoint":{"line":39,"column":51,"index":1920},"line":39,"code":"    it(`should have exports named config left alone`, () => {\n      cy.getTestElement(`unmodified-exports-config`).invoke(`text`).should(`contain`, config);\n    });","file":"production-runtime/cypress/integration/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should have exports named getServerData left alone","suites":["modifed exports","other JS files"],"updatePoint":{"line":42,"column":58,"index":2092},"line":42,"code":"    it(`should have exports named getServerData left alone`, () => {\n      cy.getTestElement(`unmodified-exports-get-server-data`).invoke(`text`).should(`contain`, getServerData);\n    });","file":"production-runtime/cypress/integration/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should have other named exports left alone","suites":["modifed exports","other JS files"],"updatePoint":{"line":45,"column":50,"index":2272},"line":45,"code":"    it(`should have other named exports left alone`, () => {\n      cy.getTestElement(`unmodified-exports-hello-world`).invoke(`text`).should(`contain`, helloWorld);\n    });","file":"production-runtime/cypress/integration/modified-exports.js","skipped":false,"dir":"e2e-tests"},{"name":"should not prefetch if Googlebot","suites":["Prefetching"],"updatePoint":{"line":8,"column":40,"index":396},"line":8,"code":"    it(`should not prefetch if Googlebot`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.window().then(async win => {\n        const isPrefetching = await win.___loader.enqueue(`/page-2`);\n        expect(isPrefetching).to.equal(false);\n      });\n      cy.get(`link[rel=\"prefetch\"]`).should(`not.exist`);\n      cy.lifecycleCallCount(`onPrefetchPathname`).should(`equal`, 0);\n    });","file":"production-runtime/cypress/integration/prefetching.js","skipped":false,"dir":"e2e-tests"},{"name":"should prefetch","suites":["Prefetching"],"updatePoint":{"line":18,"column":23,"index":784},"line":18,"code":"    it(`should prefetch`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.window().then(async win => {\n        const isPrefetching = await win.___loader.enqueue(`/page-2`);\n        expect(isPrefetching).to.equal(true);\n      });\n      cy.get(`link[rel=\"prefetch\"]`).should(`exist`);\n      cy.lifecycleCallCount(`onPrefetchPathname`).should(`not.equal`, 0);\n    });","file":"production-runtime/cypress/integration/prefetching.js","skipped":false,"dir":"e2e-tests"},{"name":"should not have preloads in head","suites":["Preloads"],"updatePoint":{"line":7,"column":38,"index":341},"line":7,"code":"  it(`should not have preloads in head`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.get(`head link[rel=\"preload\"]`).should(\"not.exist\");\n  });","file":"production-runtime/cypress/integration/preload.js","skipped":false,"dir":"e2e-tests"},{"name":"Should extract and run query from gatsby component","suites":["queries in packages"],"updatePoint":{"line":5,"column":56,"index":183},"line":5,"code":"  it(`Should extract and run query from gatsby component`, () => {\n    cy.title().should(`eq`, `Testing queries in packages | Gatsby Default Starter`);\n  });","file":"production-runtime/cypress/integration/queries-in-packages.js","skipped":false,"dir":"e2e-tests"},{"name":"renders page when percent encoded query string value is used on client navigation","suites":["query-string","Supports percent encoded query string values"],"updatePoint":{"line":14,"column":89,"index":635},"line":14,"code":"    it(`renders page when percent encoded query string value is used on client navigation`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.window().then(win => win.___navigate(`/query-params?message=%25`)).waitForRouteChange();\n      cy.getTestElement(`location.search`).invoke(`text`).should(`equal`, `?message=%25`);\n    });","file":"production-runtime/cypress/integration/query-string.js","skipped":false,"dir":"e2e-tests"},{"name":"renders page when percent encoded query string value is used on direct visit ","suites":["query-string","Supports percent encoded query string values"],"updatePoint":{"line":19,"column":85,"index":970},"line":19,"code":"    it(`renders page when percent encoded query string value is used on direct visit `, () => {\n      cy.visit(`/query-params?message=%25`).waitForRouteChange();\n      cy.getTestElement(`location.search`).invoke(`text`).should(`equal`, `?message=%25`);\n    });","file":"production-runtime/cypress/integration/query-string.js","skipped":false,"dir":"e2e-tests"},{"name":"should not throw error when percent encoded query string value is used","suites":["query-string","Supports percent encoded query string values"],"updatePoint":{"line":23,"column":78,"index":1224},"line":23,"code":"    it(`should not throw error when percent encoded query string value is used`, () => {\n      cy.get(`@consoleError`).should(`not.be.called`);\n    });","file":"production-runtime/cypress/integration/query-string.js","skipped":false,"dir":"e2e-tests"},{"name":"are case insensitive when ignoreCase is set to true","suites":["Redirects"],"line":14,"code":"  it.skip(`are case insensitive when ignoreCase is set to true`, () => {","file":"production-runtime/cypress/integration/redirects.js","skipped":true,"dir":"e2e-tests"},{"name":"are case sensitive when ignoreCase is set to false","suites":["Redirects"],"updatePoint":{"line":20,"column":56,"index":759},"line":20,"code":"  it(`are case sensitive when ignoreCase is set to false`, () => {\n    cy.visit(`/PAGINA-larga/`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.get(`h1`).invoke(`text`).should(`contain`, `NOT FOUND`);\n  });","file":"production-runtime/cypress/integration/redirects.js","skipped":false,"dir":"e2e-tests"},{"name":"use redirects when preloading page-data","suites":["Redirects"],"updatePoint":{"line":26,"column":45,"index":977},"line":26,"code":"  it(`use redirects when preloading page-data`, {\n    retries: {\n      runMode: 3\n    }\n  }, () => {\n    const expectedLinks = [`/Longue-PAGE/`, `/pagina-larga/`];\n\n    // we should not hit those routes\n    cy.intercept(\"GET\", \"/page-data/Longue-PAGE/page-data.json\").as(\"page-data-for-redirected-page-a\");\n    cy.intercept(\"GET\", \"/page-data/pagina-larga/page-data.json\").as(\"page-data-for-redirected-page-b\");\n    cy.intercept(\"GET\", \"/page-data/long-page/page-data.json\").as(\"redirected-page-data\");\n    cy.visit(`/redirect-links/`).waitForRouteChange();\n    cy.get(\"a\").each(($el, index, $list) => {\n      cy.then(() => {\n        expect($el[0].href.replace(`http://localhost:9000`, ``)).to.be.oneOf(expectedLinks);\n      });\n      // focus / hover links to force trigger preload\n      cy.wrap($el).trigger(\"mouseover\");\n    });\n    cy.then(() => {\n      // those requests should not happen\n      cy.get(\"@page-data-for-redirected-page-a\").should(networkCall => {\n        expect(networkCall).to.be.null;\n      });\n      cy.get(\"@page-data-for-redirected-page-b\").should(networkCall => {\n        expect(networkCall).to.be.null;\n      });\n\n      // instead we want links to use redirects\n      cy.get(\"@redirected-page-data\").should(networkCall => {\n        expect(networkCall.response.statusCode).to.be.oneOf([304, 200]);\n      });\n    });\n  });","file":"production-runtime/cypress/integration/redirects.js","skipped":false,"dir":"e2e-tests"},{"name":"should support hash parameter with Link component","suites":["Redirects"],"updatePoint":{"line":60,"column":55,"index":2335},"line":60,"code":"  it(`should support hash parameter with Link component`, () => {\n    cy.visit(`/`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.getTestElement(`redirect-two-anchor`).click().waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/redirect-search-hash/`);\n    cy.location(`hash`).should(`equal`, `#anchor`);\n    cy.location(`search`).should(`equal`, ``);\n  });","file":"production-runtime/cypress/integration/redirects.js","skipped":false,"dir":"e2e-tests"},{"name":"should support hash parameter on direct visit","suites":["Redirects"],"line":73,"code":"  it.skip(`should support hash parameter on direct visit`, () => {","file":"production-runtime/cypress/integration/redirects.js","skipped":true,"dir":"e2e-tests"},{"name":"should support search parameter with Link component","suites":["Redirects"],"updatePoint":{"line":81,"column":57,"index":3250},"line":81,"code":"  it(`should support search parameter with Link component`, () => {\n    cy.visit(`/`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.getTestElement(`redirect-two-search`).click().waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/redirect-search-hash/`);\n    cy.location(`hash`).should(`equal`, ``);\n    cy.location(`search`).should(`equal`, `?query_param=hello`);\n  });","file":"production-runtime/cypress/integration/redirects.js","skipped":false,"dir":"e2e-tests"},{"name":"should support search parameter on direct visit","suites":["Redirects"],"updatePoint":{"line":90,"column":53,"index":3655},"line":90,"code":"  it(`should support search parameter on direct visit`, () => {\n    cy.visit(`/redirect-two/?query_param=hello`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/redirect-search-hash/`);\n    cy.location(`hash`).should(`equal`, ``);\n    cy.location(`search`).should(`equal`, `?query_param=hello`);\n  });","file":"production-runtime/cypress/integration/redirects.js","skipped":false,"dir":"e2e-tests"},{"name":"should support search & hash parameter with Link component","suites":["Redirects"],"updatePoint":{"line":98,"column":64,"index":4027},"line":98,"code":"  it(`should support search & hash parameter with Link component`, () => {\n    cy.visit(`/`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.getTestElement(`redirect-two-search-anchor`).click().waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/redirect-search-hash/`);\n    cy.location(`hash`).should(`equal`, `#anchor`);\n    cy.location(`search`).should(`equal`, `?query_param=hello`);\n  });","file":"production-runtime/cypress/integration/redirects.js","skipped":false,"dir":"e2e-tests"},{"name":"should support search & hash parameter on direct visit","suites":["Redirects"],"updatePoint":{"line":107,"column":60,"index":4453},"line":107,"code":"  it(`should support search & hash parameter on direct visit`, () => {\n    cy.visit(`/redirect-two/?query_param=hello#anchor`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/redirect-search-hash/`);\n    cy.location(`hash`).should(`equal`, `#anchor`);\n    cy.location(`search`).should(`equal`, `?query_param=hello`);\n  });","file":"production-runtime/cypress/integration/redirects.js","skipped":false,"dir":"e2e-tests"},{"name":"should render correct dimensions","suites":["remote-file"],"updatePoint":{"line":37,"column":38,"index":1164},"line":37,"code":"  it(`should render correct dimensions`, () => {\n    cy.get('[data-testid=\"public\"]').then(async $urls => {\n      const urls = Array.from($urls.map((_, $url) => $url.getAttribute(\"href\")));\n      for (const url of urls) {\n        const res = await fetch(url, {\n          method: \"HEAD\"\n        });\n        expect(res.ok).to.be.true;\n      }\n    });\n    cy.get(\".resize\").then(async $imgs => {\n      await testImages(Array.from($imgs), [{\n        width: 100,\n        height: 133\n      }, {\n        width: 100,\n        height: 160\n      }, {\n        width: 100,\n        height: 67\n      }]);\n    });\n    cy.get(\".fixed\").then(async $imgs => {\n      await testImages(Array.from($imgs), [{\n        width: 100,\n        height: 133\n      }, {\n        width: 100,\n        height: 160\n      }, {\n        width: 100,\n        height: 67\n      }]);\n    });\n    cy.get(\".constrained\").then(async $imgs => {\n      await testImages(Array.from($imgs), [{\n        width: 300,\n        height: 400\n      }, {\n        width: 300,\n        height: 481\n      }, {\n        width: 300,\n        height: 200\n      }]);\n    });\n    cy.get(\".full\").then(async $imgs => {\n      await testImages(Array.from($imgs), [{\n        height: 1229\n      }, {\n        height: 1478\n      }, {\n        height: 614\n      }]);\n    });\n  });","file":"production-runtime/cypress/integration/remote-file.js","skipped":false,"dir":"e2e-tests"},{"name":"should render a placeholder","suites":["remote-file"],"updatePoint":{"line":93,"column":33,"index":2456},"line":93,"code":"  it(`should render a placeholder`, () => {\n    cy.get(\".fixed [data-placeholder-image]\").first().should(\"have.css\", \"background-color\", \"rgb(232, 184, 8)\");\n    cy.get(\".constrained [data-placeholder-image]\").first().should($el => {\n      expect($el.prop(\"tagName\")).to.be.equal(\"IMG\");\n      expect($el.prop(\"src\")).to.contain(\"data:image/jpg;base64\");\n    });\n    cy.get(\".constrained_traced [data-placeholder-image]\").first().should($el => {\n      // traced falls back to DOMINANT_COLOR\n      expect($el.prop(\"tagName\")).to.be.equal(\"DIV\");\n      expect($el).to.be.empty;\n    });\n    cy.get(\".full [data-placeholder-image]\").first().should($el => {\n      expect($el.prop(\"tagName\")).to.be.equal(\"DIV\");\n      expect($el).to.be.empty;\n    });\n  });","file":"production-runtime/cypress/integration/remote-file.js","skipped":false,"dir":"e2e-tests"},{"name":"Loads index - ","suites":[],"updatePoint":{"line":10,"column":37,"index":252},"line":10,"code":"  it(`Loads index - ${testNameSuffix}`, () => {\n    cy.visit(`/`).waitForAPIorTimeout(`onRouteUpdate`, waitForAPIOptions);\n    cy.getTestElement(`dom-marker`).contains(`index`);\n  });","file":"production-runtime/cypress/integration/resource-loading-resilience.js","skipped":false,"dir":"e2e-tests"},{"name":"Navigates to second page - ","suites":[],"updatePoint":{"line":14,"column":50,"index":449},"line":14,"code":"  it(`Navigates to second page - ${testNameSuffix}`, () => {\n    cy.visit(`/`).waitForAPIorTimeout(`onRouteUpdate`, waitForAPIOptions);\n    cy.getTestElement(`page2`).click();\n    cy.waitForAPIorTimeout(`onRouteUpdate`, waitForAPIOptions);\n    cy.location(`pathname`).should(`equal`, `/page-2/`);\n    cy.getTestElement(`dom-marker`).contains(`page-2`);\n  });","file":"production-runtime/cypress/integration/resource-loading-resilience.js","skipped":false,"dir":"e2e-tests"},{"name":"Navigates to 404 page - ","suites":[],"updatePoint":{"line":21,"column":47,"index":805},"line":21,"code":"  it(`Navigates to 404 page - ${testNameSuffix}`, () => {\n    cy.visit(`/page-2/`).waitForAPIorTimeout(`onRouteUpdate`, waitForAPIOptions);\n    cy.getTestElement(`404`).click();\n    cy.waitForAPIorTimeout(`onRouteUpdate`, waitForAPIOptions);\n    cy.location(`pathname`).should(`equal`, `/page-3/`);\n    cy.getTestElement(`dom-marker`).contains(`404`);\n  });","file":"production-runtime/cypress/integration/resource-loading-resilience.js","skipped":false,"dir":"e2e-tests"},{"name":"Loads 404 - ","suites":[],"updatePoint":{"line":28,"column":35,"index":1151},"line":28,"code":"  it(`Loads 404 - ${testNameSuffix}`, () => {\n    cy.visit(`/page-3/`, {\n      failOnStatusCode: false\n    }).waitForAPIorTimeout(`onRouteUpdate`, waitForAPIOptions);\n    cy.location(`pathname`).should(`equal`, `/page-3/`);\n    cy.getTestElement(`dom-marker`).contains(`404`);\n  });","file":"production-runtime/cypress/integration/resource-loading-resilience.js","skipped":false,"dir":"e2e-tests"},{"name":"Can navigate from 404 to index - ","suites":[],"updatePoint":{"line":35,"column":56,"index":1455},"line":35,"code":"  it(`Can navigate from 404 to index - ${testNameSuffix}`, () => {\n    cy.visit(`/page-3/`, {\n      failOnStatusCode: false\n    }).waitForAPIorTimeout(`onRouteUpdate`, waitForAPIOptions);\n    cy.getTestElement(`index`).click();\n    cy.waitForAPIorTimeout(`onRouteUpdate`, waitForAPIOptions);\n    cy.location(`pathname`).should(`equal`, `/`);\n    cy.getTestElement(`dom-marker`).contains(`index`);\n  });","file":"production-runtime/cypress/integration/resource-loading-resilience.js","skipped":false,"dir":"e2e-tests"},{"name":"should not have page scripts in HTML","suites":["Preloads"],"updatePoint":{"line":7,"column":42,"index":345},"line":7,"code":"  it(`should not have page scripts in HTML`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.get(`body script`).each(script => {\n      cy.wrap(script).should(`not.have.attr`, `src`, /component---/);\n    });\n  });","file":"production-runtime/cypress/integration/scripts.js","skipped":false,"dir":"e2e-tests"},{"name":"should restore scroll position only when going back in history","suites":["Scroll behaviour"],"updatePoint":{"line":7,"column":68,"index":379},"line":7,"code":"  it(`should restore scroll position only when going back in history`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.getTestElement(`long-page`).click().waitForRouteChange();\n    cy.scrollTo(`bottom`);\n\n    // allow ScrollContext to update scroll position store\n    // it uses requestAnimationFrame so wait a bit to allow\n    // it to store scroll position\n    cy.wait(500);\n    cy.getTestElement(`below-the-fold`).click().waitForRouteChange();\n\n    // after going back we expect page will\n    // be restore previous scroll position\n    cy.go(`back`).waitForRouteChange();\n    cy.window().then(win => {\n      expect(win.scrollY).not.to.eq(0, 0);\n    });\n    cy.go(`forward`).waitForRouteChange();\n\n    // after clicking link we expect page will be scrolled to top\n    cy.getTestElement(`long-page`).click().waitForRouteChange();\n    cy.window().then(win => {\n      expect(win.scrollY).to.eq(0, 0);\n    });\n\n    // reset to index page\n    cy.getTestElement(`index-link`).click().waitForRouteChange();\n  });","file":"production-runtime/cypress/integration/scroll-behavior.js","skipped":false,"dir":"e2e-tests"},{"name":"should scroll to hashes - even with encoded characters","suites":["Scroll behaviour"],"updatePoint":{"line":35,"column":60,"index":1386},"line":35,"code":"  it(`should scroll to hashes - even with encoded characters`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.getTestElement(`long-page-id`).click().waitForRouteChange();\n\n    // UI should auto scroll to the id with a matching hash\n    cy.window().then(win => {\n      let idScrollY = win.scrollY;\n      expect(win.scrollY).not.to.eq(0, 0);\n      cy.scrollTo(`bottom`);\n      cy.wait(500); // allow ScrollContext to update scroll position store\n      cy.go(`back`).waitForRouteChange();\n      cy.go(`forward`).waitForRouteChange();\n      cy.window().then(updatedWindow => {\n        expect(updatedWindow.scrollY).to.eq(idScrollY);\n      });\n    });\n  });","file":"production-runtime/cypress/integration/scroll-behavior.js","skipped":false,"dir":"e2e-tests"},{"name":"should keep track of location.key","suites":["Scroll behaviour"],"updatePoint":{"line":52,"column":39,"index":2026},"line":52,"code":"  it(`should keep track of location.key`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.getTestElement(`long-page`).click().waitForRouteChange();\n    cy.getTestElement(`below-the-fold`).scrollIntoView({\n      // this is weird hack - seems like Cypress in run mode doesn't update scroll correctly\n      duration: 100\n    }).wait(500) // allow ScrollContext to update scroll position store\n    .storeScrollPosition(`middle-of-the-page`).click().waitForRouteChange();\n    cy.getTestElement(`long-page`).click().waitForRouteChange();\n    cy.getTestElement(`even-more-below-the-fold`).scrollIntoView({\n      // this is weird hack - seems like Cypress in run mode doesn't update scroll correctly\n      duration: 100\n    }).wait(500) // allow ScrollContext to update scroll position store\n    .storeScrollPosition(`bottom-of-the-page`).click().waitForRouteChange();\n    cy.go(`back`).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/long-page/`).wait(500)\n    // we went back in hitsory 1 time, so we should end up at the bottom of the page\n    .shouldMatchScrollPosition(`bottom-of-the-page`).shouldNotMatchScrollPosition(`middle-of-the-page`);\n    cy.go(`back`).waitForRouteChange();\n    cy.go(`back`).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, `/long-page/`).wait(500)\n    // we went back in hitsory 2 more times, so we should end up in the middle of the page\n    // instead of at the bottom\n    .shouldMatchScrollPosition(`middle-of-the-page`).shouldNotMatchScrollPosition(`bottom-of-the-page`);\n  });","file":"production-runtime/cypress/integration/scroll-behavior.js","skipped":false,"dir":"e2e-tests"},{"name":"Pages created with slices mapping have correct content","suites":["Slice passed via createPage"],"updatePoint":{"line":8,"column":60,"index":278},"line":8,"code":"  it(\"Pages created with slices mapping have correct content\", () => {\n    allRecipes.forEach(recipe => {\n      cy.visit(`recipe/${recipe.id}`).waitForRouteChange();\n      cy.getTestElement(`recipe-name`).invoke(`text`).should(`contain`, recipe.name);\n      cy.getTestElement(`recipe-description`).invoke(`text`).should(`contain`, recipe.description);\n      cy.getTestElement(`recipe-author-name`).invoke(`text`).should(`contain`, allRecipeAuthors.find(author => recipe.authorId === author.id).name);\n    });\n  });","file":"production-runtime/cypress/integration/slices/slice-via-create-page.js","skipped":false,"dir":"e2e-tests"},{"name":"404 pages with slices mapping have correct content","suites":["Slice passed via createPage"],"updatePoint":{"line":16,"column":56,"index":789},"line":16,"code":"  it(`404 pages with slices mapping have correct content`, () => {\n    cy.visit(`/doesnt-exist`, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.getTestElement(`mapped-slice`).should(\"have.text\", \"My mapped Slice\");\n  });","file":"production-runtime/cypress/integration/slices/slice-via-create-page.js","skipped":false,"dir":"e2e-tests"},{"name":"Slice content show on screen","suites":["Slices"],"updatePoint":{"line":14,"column":34,"index":472},"line":14,"code":"  it(`Slice content show on screen`, () => {\n    cy.getTestElement(`footer-static-text`).invoke(`text`).should(`contain`, `Built with`);\n  });","file":"production-runtime/cypress/integration/slices/slices.js","skipped":false,"dir":"e2e-tests"},{"name":"Slice recieves context passed via createSlice","suites":["Slices"],"updatePoint":{"line":17,"column":51,"index":632},"line":17,"code":"  it(`Slice recieves context passed via createSlice`, () => {\n    cy.getTestElement(`footer-slice-context-value`).invoke(`text`).should(`contain`, `Gatsby`);\n  });","file":"production-runtime/cypress/integration/slices/slices.js","skipped":false,"dir":"e2e-tests"},{"name":"Slice can take in props","suites":["Slices"],"updatePoint":{"line":20,"column":29,"index":774},"line":20,"code":"  it(`Slice can take in props`, () => {\n    cy.getTestElement(`footer-props`).invoke(`text`).should(`contains`, `Gatsbyjs`);\n  });","file":"production-runtime/cypress/integration/slices/slices.js","skipped":false,"dir":"e2e-tests"},{"name":"Slice can consume a context wrapped in WrapRootElement","suites":["Slices"],"updatePoint":{"line":23,"column":60,"index":936},"line":23,"code":"  it(`Slice can consume a context wrapped in WrapRootElement`, () => {\n    cy.getTestElement(`footer-context-derieved-value`).invoke(`text`).should(`contain`, `2`);\n  });","file":"production-runtime/cypress/integration/slices/slices.js","skipped":false,"dir":"e2e-tests"},{"name":"Slice with static query works","suites":["Slices"],"updatePoint":{"line":26,"column":35,"index":1082},"line":26,"code":"  it(`Slice with static query works`, () => {\n    cy.getTestElement(`footer-static-query-title`).contains(`Gatsby Default Starter`);\n  });","file":"production-runtime/cypress/integration/slices/slices.js","skipped":false,"dir":"e2e-tests"},{"name":"Direct visit no query params","suites":["Static path ('')"],"updatePoint":{"line":11,"column":34,"index":440},"line":11,"code":"  it(`Direct visit no query params`, () => {\n    cy.visit(staticPath).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{}`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Direct visit with query params","suites":["Static path ('')"],"updatePoint":{"line":16,"column":36,"index":635},"line":16,"code":"  it(`Direct visit with query params`, () => {\n    cy.visit(staticPath + `?foo=bar`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{}`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Client navigation to same path with different query params","suites":["Static path ('')"],"updatePoint":{"line":21,"column":64,"index":882},"line":21,"code":"  it(`Client navigation to same path with different query params`, () => {\n    cy.visit(staticPath).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{}`);\n    cy.window().then(win => win.___navigate(staticPath + `?foo=bar`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{}`);\n    cy.window().then(win => win.___navigate(staticPath + `?foo=baz`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"baz\"}`);\n    cy.getTestElement(`params`).contains(`{}`);\n    cy.window().then(win => win.___navigate(staticPath)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{}`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Preserves window.location.search as querystring passed","suites":["Static path ('')"],"updatePoint":{"line":35,"column":60,"index":1671},"line":35,"code":"  it(\"Preserves window.location.search as querystring passed\", () => {\n    const queryString = `?a=b%23&x=y%25&j=`;\n    cy.visit(staticPath + queryString).waitForRouteChange();\n    cy.window().then(win => {\n      expect(win.location.search).to.equal(queryString);\n    });\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Slice with static query works","suites":["Static path ('')"],"updatePoint":{"line":42,"column":35,"index":1924},"line":42,"code":"  it(`Slice with static query works`, () => {\n    cy.visit(staticPath).waitForRouteChange();\n    cy.getTestElement(`footer-static-query-title`).contains(`Gatsby Default Starter`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Direct visit no query params","suites":["Param path (':param')"],"updatePoint":{"line":48,"column":34,"index":2167},"line":48,"code":"  it(`Direct visit no query params`, () => {\n    cy.visit(paramPath + `foo/`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"param\":\"foo\"}`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Direct visit with query params","suites":["Param path (':param')"],"updatePoint":{"line":53,"column":36,"index":2383},"line":53,"code":"  it(`Direct visit with query params`, () => {\n    cy.visit(paramPath + `foo/` + `?foo=bar`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{\"param\":\"foo\"}`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Client navigation to same param path with different query params and url params","suites":["Param path (':param')"],"updatePoint":{"line":58,"column":85,"index":2672},"line":58,"code":"  it(`Client navigation to same param path with different query params and url params`, () => {\n    cy.visit(paramPath + `foo/`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"param\":\"foo\"}`);\n    cy.window().then(win => win.___navigate(paramPath + `foo/` + `?foo=bar`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{\"param\":\"foo\"}`);\n    cy.window().then(win => win.___navigate(paramPath + `baz/` + `?foo=bar`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{\"param\":\"baz\"}`);\n    cy.window().then(win => win.___navigate(paramPath + `baz/`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"param\":\"baz\"}`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Resolves to [...].js template at p1","suites":["Path ranking resolution ('*')"],"updatePoint":{"line":74,"column":54,"index":3606},"line":74,"code":"  it(`Resolves to [...].js template at ${pathRaking}p1`, () => {\n    cy.visit(pathRaking + `p1/`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"*\":\"p1\"}`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Resolves to [p1]/[p2].js template at p1/p2","suites":["Path ranking resolution ('*')"],"updatePoint":{"line":79,"column":61,"index":3842},"line":79,"code":"  it(`Resolves to [p1]/[p2].js template at ${pathRaking}p1/p2`, () => {\n    cy.visit(pathRaking + `p1/p2/`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"p1\":\"p1\",\"p2\":\"p2\"}`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Resolves to [p1]/page.js template at p1/page","suites":["Path ranking resolution ('*')"],"updatePoint":{"line":84,"column":63,"index":4094},"line":84,"code":"  it(`Resolves to [p1]/page.js template at ${pathRaking}p1/page`, () => {\n    cy.visit(pathRaking + `p1/page/`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"p1\":\"p1\"}`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Resolves to [...].js template at p1/p2/p3","suites":["Path ranking resolution ('*')"],"updatePoint":{"line":89,"column":60,"index":4335},"line":89,"code":"  it(`Resolves to [...].js template at ${pathRaking}p1/p2/p3`, () => {\n    cy.visit(pathRaking + `p1/p2/p3/`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"*\":\"p1/p2/p3\"}`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Direct visit no query params","suites":["Wildcard path ('*')"],"updatePoint":{"line":96,"column":34,"index":4615},"line":96,"code":"  it(`Direct visit no query params`, () => {\n    cy.visit(wildcardPath + `foo/nested/`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"wildcard\":\"foo/nested\"}`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Direct visit with query params","suites":["Wildcard path ('*')"],"updatePoint":{"line":101,"column":36,"index":4851},"line":101,"code":"  it(`Direct visit with query params`, () => {\n    cy.visit(wildcardPath + `foo/nested/` + `?foo=bar`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{\"wildcard\":\"foo/nested\"}`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Client navigation to same param path with different query params and url params","suites":["Wildcard path ('*')"],"updatePoint":{"line":106,"column":85,"index":5160},"line":106,"code":"  it(`Client navigation to same param path with different query params and url params`, () => {\n    cy.visit(wildcardPath + `foo/`).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"wildcard\":\"foo\"}`);\n    cy.window().then(win => win.___navigate(wildcardPath + `foo/` + `?foo=bar`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{\"wildcard\":\"foo\"}`);\n    cy.window().then(win => win.___navigate(wildcardPath + `baz/` + `?foo=bar`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{\"foo\":\"bar\"}`);\n    cy.getTestElement(`params`).contains(`{\"wildcard\":\"baz\"}`);\n    cy.window().then(win => win.___navigate(wildcardPath + `baz/`)).waitForRouteChange();\n    cy.getTestElement(`query`).contains(`{}`);\n    cy.getTestElement(`params`).contains(`{\"wildcard\":\"baz\"}`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Display 500 page on direct navigation","suites":["500 status"],"updatePoint":{"line":123,"column":43,"index":6115},"line":123,"code":"  it(`Display 500 page on direct navigation`, () => {\n    cy.visit(errorPath, {\n      failOnStatusCode: false\n    }).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, errorPath).getTestElement(`500`).should(`exist`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"Display 500 page on client navigation","suites":["500 status"],"updatePoint":{"line":129,"column":43,"index":6354},"line":129,"code":"  it(`Display 500 page on client navigation`, () => {\n    cy.visit(`/`).waitForRouteChange();\n    cy.window().then(win => win.___navigate(errorPath)).waitForRouteChange();\n    cy.location(`pathname`).should(`equal`, errorPath).getTestElement(`500`).should(`exist`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"engines work when bundled code contains node:path import","suites":["\"node:\" protocol"],"updatePoint":{"line":136,"column":62,"index":6686},"line":136,"code":"  it(`engines work when bundled code contains node:path import`, () => {\n    cy.visit(`/ssr/using-node-protocol/`).waitForRouteChange();\n\n    // validating that this page was rendered with SSR mode\n    cy.getTestElement(`is-ssr`).contains(`true`);\n\n    // content of field is generated using `node:path` import\n    cy.getTestElement(`field-result`).contains(`\"foo/bar\"`);\n  });","file":"production-runtime/cypress/integration/ssr.js","skipped":false,"dir":"e2e-tests"},{"name":"renders a spacer svg","suites":["constrained"],"updatePoint":{"line":10,"column":26,"index":423},"line":10,"code":"  it(`renders a spacer svg`, () => {\n    cy.getTestElement(`image-constrained`).find(`img[role=presentation]`).should(`have.attr`, `src`).and(`match`, /svg\\+xml/);\n  });","file":"production-runtime/cypress/integration/static-image/constrained.js","skipped":false,"dir":"e2e-tests"},{"name":"includes sizes attribute with default width","suites":["constrained"],"updatePoint":{"line":13,"column":49,"index":616},"line":13,"code":"  it(`includes sizes attribute with default width`, () => {\n    cy.getTestElement(`image-constrained`).find(`[data-main-image]`).should(`have.attr`, `sizes`).and(`equal`, `(min-width: 4015px) 4015px, 100vw`);\n  });","file":"production-runtime/cypress/integration/static-image/constrained.js","skipped":false,"dir":"e2e-tests"},{"name":"includes sizes attribute with specified width","suites":["constrained"],"updatePoint":{"line":16,"column":51,"index":833},"line":16,"code":"  it(`includes sizes attribute with specified width`, () => {\n    cy.getTestElement(`image-constrained-limit`).find(`[data-main-image]`).should(`have.attr`, `sizes`).and(`equal`, `(min-width: 500px) 500px, 100vw`);\n  });","file":"production-runtime/cypress/integration/static-image/constrained.js","skipped":false,"dir":"e2e-tests"},{"name":"overrides sizes","suites":["constrained"],"updatePoint":{"line":19,"column":21,"index":1024},"line":19,"code":"  it(`overrides sizes`, () => {\n    cy.getTestElement(`image-constrained-override`).find(`[data-main-image]`).should(`have.attr`, `sizes`).and(`equal`, `100vw`);\n  });","file":"production-runtime/cypress/integration/static-image/constrained.js","skipped":false,"dir":"e2e-tests"},{"name":"applies height and width to wrapper","suites":["fixed"],"updatePoint":{"line":11,"column":41,"index":461},"line":11,"code":"  it(`applies height and width to wrapper`, () => {\n    cy.getTestElement(fixedTestId).find(`.gatsby-image-wrapper`).should(`have.attr`, `style`).and(style => {\n      ;\n      [`height:`, `width:`].forEach(part => {\n        expect(style).contains(part);\n      });\n    });\n  });","file":"production-runtime/cypress/integration/static-image/fixed.js","skipped":false,"dir":"e2e-tests"},{"name":"works on png files","suites":["fixed"],"updatePoint":{"line":19,"column":24,"index":721},"line":19,"code":"  it(`works on png files`, () => {\n    cy.getTestElement(`image-fixed-png`).find(`.gatsby-image-wrapper`).should(`exist`);\n  });","file":"production-runtime/cypress/integration/static-image/fixed.js","skipped":false,"dir":"e2e-tests"},{"name":"works on relative paths outside of src","suites":["fixed"],"updatePoint":{"line":22,"column":44,"index":870},"line":22,"code":"  it(`works on relative paths outside of src`, () => {\n    cy.getTestElement(`image-fixed-relative`).find(`.gatsby-image-wrapper`).should(`exist`);\n  });","file":"production-runtime/cypress/integration/static-image/fixed.js","skipped":false,"dir":"e2e-tests"},{"name":"includes sizes attribute","suites":["fixed"],"updatePoint":{"line":25,"column":30,"index":1010},"line":25,"code":"  it(`includes sizes attribute`, () => {\n    cy.getTestElement(fixedTestId).find(`[data-main-image]`).should(`have.attr`, `sizes`).should(`equal`, `500px`);\n  });","file":"production-runtime/cypress/integration/static-image/fixed.js","skipped":false,"dir":"e2e-tests"},{"name":"works on png files","suites":["full-width"],"updatePoint":{"line":11,"column":24,"index":454},"line":11,"code":"  it(`works on png files`, () => {\n    cy.getTestElement(`image-fluid-png`).find(`.gatsby-image-wrapper`).should(`exist`);\n  });","file":"production-runtime/cypress/integration/static-image/full-width.js","skipped":false,"dir":"e2e-tests"},{"name":"works on relative paths outside of src","suites":["full-width"],"updatePoint":{"line":14,"column":44,"index":603},"line":14,"code":"  it(`works on relative paths outside of src`, () => {\n    cy.getTestElement(`image-fluid-relative`).find(`.gatsby-image-wrapper`).should(`exist`);\n  });","file":"production-runtime/cypress/integration/static-image/full-width.js","skipped":false,"dir":"e2e-tests"},{"name":"renders a spacer div","suites":["full-width"],"updatePoint":{"line":17,"column":26,"index":739},"line":17,"code":"  it(`renders a spacer div`, () => {\n    cy.getTestElement(fluidTestId).find(`.gatsby-image-wrapper > div`).should(`have.attr`, `style`).and(`match`, /padding/);\n  });","file":"production-runtime/cypress/integration/static-image/full-width.js","skipped":false,"dir":"e2e-tests"},{"name":"includes sizes attribute","suites":["full-width"],"updatePoint":{"line":20,"column":30,"index":911},"line":20,"code":"  it(`includes sizes attribute`, () => {\n    cy.getTestElement(fluidTestId).find(`[data-main-image]`).should(`have.attr`, `sizes`).should(`equal`, `100vw`);\n  });","file":"production-runtime/cypress/integration/static-image/full-width.js","skipped":false,"dir":"e2e-tests"},{"name":"exists","suites":["Production gatsby-image","wrapping elements","outer div"],"updatePoint":{"line":13,"column":16,"index":533},"line":13,"code":"      it(`exists`, () => {\n        cy.getTestElement(fluidTestId).find(`.gatsby-image-wrapper`).its(`length`).should(`eq`, 1);\n      });","file":"production-runtime/cypress/integration/static-image/image.js","skipped":false,"dir":"e2e-tests"},{"name":"will not appear","suites":["Production gatsby-image","invalid image"],"updatePoint":{"line":19,"column":23,"index":727},"line":19,"code":"    it(`will not appear`, () => {\n      cy.getTestElement(`invalid-image`).find(`.gatsby-image-wrapper`).should(`not.exist`);\n    });","file":"production-runtime/cypress/integration/static-image/image.js","skipped":false,"dir":"e2e-tests"},{"name":"lazy loads an image when scrolling","suites":["gatsby-plugin-image / intersection observer"],"updatePoint":{"line":9,"column":40,"index":322},"line":9,"code":"  it(`lazy loads an image when scrolling`, () => {\n    cy.window().then(win => {\n      expect(`loading` in win.HTMLImageElement.prototype).to.equal(false);\n    });\n\n    // We need to wait for a decent amount of time so that the image\n    // can resolve. This is necessary because the assertion\n    // is done outside the Cypress scheduler and so, Cypress is not able\n    // to ping for the specific assertion to be truthy.\n    cy.wait(500);\n    cy.get(`[data-cy=already-loaded]`).should(`be.visible`).then($img => {\n      expect($img[0].complete).to.equal(true);\n    });\n    cy.get(`[data-cy=lazy-loaded]`).should(`exist`).then($img => {\n      expect($img[0].naturalHeight).to.equal(0);\n    });\n    cy.scrollTo(`bottom`);\n    cy.wait(500);\n    cy.get(`[data-cy=lazy-loaded]`).should(`exist`).then($img => {\n      expect($img[0].naturalHeight).to.be.greaterThan(0);\n    });\n  });","file":"production-runtime/cypress/integration/static-image/intesection-observer.js","skipped":false,"dir":"e2e-tests"},{"name":"lazy loads an image when scrolling","suites":["gatsby-plugin-image / native lazy loading"],"updatePoint":{"line":13,"column":40,"index":643},"line":13,"code":"  it(`lazy loads an image when scrolling`, () => {\n    // We need to wait for a decent amount of time so that the image\n    // can resolve. This is necessary because the assertion\n    // is done outside the Cypress scheduler and so, Cypress is not able\n    // to ping for the specific assertion to be truthy.\n    cy.wait(500);\n    cy.get(`[data-cy=already-loaded]`).should(`be.visible`).then($img => {\n      expect($img[0].complete).to.equal(true);\n    });\n    cy.get(`[data-cy=lazy-loaded]`).should(`exist`).then($img => {\n      expect($img[0].complete).to.equal(false);\n    });\n    cy.scrollTo(`bottom`);\n    cy.wait(500);\n    cy.get(`[data-cy=lazy-loaded]`).should(`exist`).then($img => {\n      expect($img[0].complete).to.equal(true);\n    });\n  });","file":"production-runtime/cypress/integration/static-image/native-lazy-loading.js","skipped":false,"dir":"e2e-tests"},{"name":"traced svg (falls back to DOMINANT_COLOR)","suites":["fixed"],"updatePoint":{"line":11,"column":47,"index":470},"line":11,"code":"  it(`traced svg (falls back to DOMINANT_COLOR)`, () => {\n    cy.getTestElement(tracedTestId).find(`.gatsby-image-wrapper > [data-placeholder-image]`).first().should($el => {\n      // traced falls\n      expect($el.prop(\"tagName\")).to.be.equal(\"DIV\");\n      expect($el).to.be.empty;\n    });\n  });","file":"production-runtime/cypress/integration/static-image/traced.js","skipped":false,"dir":"e2e-tests"},{"name":"works on png files","suites":["fixed"],"updatePoint":{"line":18,"column":24,"index":743},"line":18,"code":"  it(`works on png files`, () => {\n    cy.getTestElement(`image-traced-png`).find(`.gatsby-image-wrapper`).should(`exist`);\n  });","file":"production-runtime/cypress/integration/static-image/traced.js","skipped":false,"dir":"e2e-tests"},{"name":"works on relative paths outside of src","suites":["fixed"],"updatePoint":{"line":21,"column":44,"index":893},"line":21,"code":"  it(`works on relative paths outside of src`, () => {\n    cy.getTestElement(`image-traced-relative`).find(`.gatsby-image-wrapper`).should(`exist`);\n  });","file":"production-runtime/cypress/integration/static-image/traced.js","skipped":false,"dir":"e2e-tests"},{"name":"works with inline query","suites":["StaticQuery behavior"],"updatePoint":{"line":10,"column":29,"index":424},"line":10,"code":"  it(`works with inline query`, () => {\n    cy.getTestElement(`inline`).invoke(`text`).should(`not.contain`, `Loading`);\n  });","file":"production-runtime/cypress/integration/static-query.js","skipped":false,"dir":"e2e-tests"},{"name":"works with variable query","suites":["StaticQuery behavior"],"updatePoint":{"line":13,"column":31,"index":553},"line":13,"code":"  it(`works with variable query`, () => {\n    cy.getTestElement(`variable`).invoke(`text`).should(`not.contain`, `Loading`);\n  });","file":"production-runtime/cypress/integration/static-query.js","skipped":false,"dir":"e2e-tests"},{"name":"works with exported variable query","suites":["StaticQuery behavior"],"updatePoint":{"line":16,"column":40,"index":693},"line":16,"code":"  it(`works with exported variable query`, () => {\n    cy.getTestElement(`exported`).invoke(`text`).should(`not.contain`, `Loading`);\n  });","file":"production-runtime/cypress/integration/static-query.js","skipped":false,"dir":"e2e-tests"},{"name":"works when used in wrapRootElement API","suites":["StaticQuery behavior"],"updatePoint":{"line":19,"column":44,"index":837},"line":19,"code":"  it(`works when used in wrapRootElement API`, () => {\n    cy.getTestElement(`wrap-root-element-result`).invoke(`text`).should(`not.contain`, `Loading`).should(`contain`, `Gatsby Default Starter`);\n  });","file":"production-runtime/cypress/integration/static-query.js","skipped":false,"dir":"e2e-tests"},{"name":"works with inline query","suites":["StaticQuery behavior","useStaticQuery"],"updatePoint":{"line":23,"column":31,"index":1065},"line":23,"code":"    it(`works with inline query`, () => {\n      cy.getTestElement(`use-static-query-inline`).invoke(`text`).should(`not.contain`, `Error`);\n    });","file":"production-runtime/cypress/integration/static-query.js","skipped":false,"dir":"e2e-tests"},{"name":"works with variable query","suites":["StaticQuery behavior","useStaticQuery"],"updatePoint":{"line":26,"column":33,"index":1215},"line":26,"code":"    it(`works with variable query`, () => {\n      cy.getTestElement(`use-static-query-variable`).invoke(`text`).should(`not.contain`, `Error`);\n    });","file":"production-runtime/cypress/integration/static-query.js","skipped":false,"dir":"e2e-tests"},{"name":"works with exported variable query","suites":["StaticQuery behavior","useStaticQuery"],"updatePoint":{"line":29,"column":42,"index":1376},"line":29,"code":"    it(`works with exported variable query`, () => {\n      cy.getTestElement(`use-static-query-exported`).invoke(`text`).should(`not.contain`, `Error`);\n    });","file":"production-runtime/cypress/integration/static-query.js","skipped":false,"dir":"e2e-tests"},{"name":"works with destructuring","suites":["StaticQuery behavior","useStaticQuery"],"updatePoint":{"line":32,"column":32,"index":1527},"line":32,"code":"    it(`works with destructuring`, () => {\n      cy.getTestElement(`use-static-query-destructuring`).find(`li`).should(`have.length.gte`, 1);\n    });","file":"production-runtime/cypress/integration/static-query.js","skipped":false,"dir":"e2e-tests"},{"name":"works with mjs query","suites":["StaticQuery behavior","useStaticQuery"],"updatePoint":{"line":35,"column":28,"index":1673},"line":35,"code":"    it(`works with mjs query`, () => {\n      cy.getTestElement(`use-static-query-mjs`).invoke(`text`).should(`not.contain`, `Error`);\n    });","file":"production-runtime/cypress/integration/static-query.js","skipped":false,"dir":"e2e-tests"},{"name":"initial styling is correct","suites":["styling: css modules"],"updatePoint":{"line":5,"column":32,"index":160},"line":5,"code":"  it(`initial styling is correct`, () => {\n    cy.getTestElement(`styled-element`).should(`have.css`, `color`, `rgb(0, 128, 0)`);\n  });","file":"production-runtime/cypress/integration/styling/css-modules.js","skipped":false,"dir":"e2e-tests"},{"name":"initial styling is correct","suites":["styling: less"],"updatePoint":{"line":2,"column":32,"index":67},"line":2,"code":"  it(`initial styling is correct`, () => {\n    cy.visit(`/styling/less`).waitForRouteChange();\n    cy.getTestElement(`less-styled-element`).should(`have.css`, `color`, `rgb(255, 0, 0)`);\n    cy.getTestElement(`less-module-styled-element`).should(`have.css`, `color`, `rgb(0, 128, 0)`);\n  });","file":"production-runtime/cypress/integration/styling/less.js","skipped":false,"dir":"e2e-tests"},{"name":"initial styling is correct","suites":["styling: plain css"],"updatePoint":{"line":5,"column":32,"index":156},"line":5,"code":"  it(`initial styling is correct`, () => {\n    cy.getTestElement(`styled-element`).should(`have.css`, `color`, `rgb(255, 0, 0)`);\n  });","file":"production-runtime/cypress/integration/styling/plain-css.js","skipped":false,"dir":"e2e-tests"},{"name":"initial styling is correct","suites":["styling: sass"],"updatePoint":{"line":2,"column":32,"index":67},"line":2,"code":"  it(`initial styling is correct`, () => {\n    cy.visit(`/styling/sass`).waitForRouteChange();\n    cy.getTestElement(`sass-styled-element`).should(`have.css`, `color`, `rgb(255, 0, 0)`);\n    cy.getTestElement(`sass-module-styled-element`).should(`have.css`, `color`, `rgb(0, 128, 0)`);\n  });","file":"production-runtime/cypress/integration/styling/sass.js","skipped":false,"dir":"e2e-tests"},{"name":"initial styling is correct","suites":["stylineg: stylus"],"updatePoint":{"line":2,"column":32,"index":70},"line":2,"code":"  it(`initial styling is correct`, () => {\n    cy.visit(`/styling/stylus`).waitForRouteChange();\n    cy.getTestElement(`stylus-styled-element`).should(`have.css`, `color`, `rgb(255, 0, 0)`);\n    cy.getTestElement(`stylus-module-styled-element`).should(`have.css`, `color`, `rgb(0, 128, 0)`);\n  });","file":"production-runtime/cypress/integration/styling/stylus.js","skipped":false,"dir":"e2e-tests"},{"name":"includes the title","suites":["the site data object"],"updatePoint":{"line":10,"column":24,"index":394},"line":10,"code":"  it(`includes the title`, () => {\n    cy.getTestElement(`title`).invoke(`text`).should(`equal`, `Gatsby Default Starter`);\n  });","file":"production-runtime/cypress/integration/types/site-data.js","skipped":false,"dir":"e2e-tests"},{"name":"description is overridden by value in config","suites":["the site data object"],"updatePoint":{"line":13,"column":50,"index":550},"line":13,"code":"  it(`description is overridden by value in config`, () => {\n    cy.getTestElement(`description`).invoke(`text`).should(`equal`, `This is site for production runtime e2e tests`);\n  });","file":"production-runtime/cypress/integration/types/site-data.js","skipped":false,"dir":"e2e-tests"},{"name":"can recognise valid date strings","suites":["the site data object"],"updatePoint":{"line":16,"column":38,"index":723},"line":16,"code":"  it(`can recognise valid date strings`, () => {\n    cy.getTestElement(`validdate`).invoke(`text`).should(`equal`, `Invalid dates can be detected`);\n  });","file":"production-runtime/cypress/integration/types/site-data.js","skipped":false,"dir":"e2e-tests"},{"name":"includes valid build time","suites":["the site data object"],"updatePoint":{"line":19,"column":31,"index":871},"line":19,"code":"  it(`includes valid build time`, () => {\n    cy.getTestElement(`buildtime`).invoke(`text`).should(`equal`, `buildTime is valid`);\n  });","file":"production-runtime/cypress/integration/types/site-data.js","skipped":false,"dir":"e2e-tests"},{"name":"supports dynamic url segments","suites":["client-side-routing"],"updatePoint":{"line":10,"column":35,"index":388},"line":10,"code":"  it(`supports dynamic url segments`, () => {\n    cy.visit(`/client-dynamic-route/foo`).waitForRouteChange();\n    cy.getTestElement(`params`).invoke(`text`).should(`equal`, `foo`);\n  });","file":"production-runtime/cypress/integration/unified-routing/client-side-routes.js","skipped":false,"dir":"e2e-tests"},{"name":"supports splats","suites":["client-side-routing"],"updatePoint":{"line":14,"column":21,"index":561},"line":14,"code":"  it(`supports splats`, () => {\n    cy.visit(`/client-dynamic-route/splat/blah/blah/blah`).waitForRouteChange();\n    cy.getTestElement(`splat`).invoke(`text`).should(`equal`, `blah/blah/blah`);\n  });","file":"production-runtime/cypress/integration/unified-routing/client-side-routes.js","skipped":false,"dir":"e2e-tests"},{"name":"can navigate to a collection route and see its content rendered","suites":["collection-routing"],"updatePoint":{"line":10,"column":69,"index":449},"line":10,"code":"  it(`can navigate to a collection route and see its content rendered`, () => {\n    cy.visit(`/collection-routing/root`).waitForRouteChange();\n    cy.getTestElement(`collection-routing-blog`).invoke(`attr`, `data-testproductname`).then(name => {\n      // should navigate us to an actual collection builder route.\n      cy.getTestElement(`collection-routing-blog`).first().click().waitForRouteChange();\n      cy.getTestElement(`name`).invoke(`text`).should(`equal`, name);\n    });\n  });","file":"production-runtime/cypress/integration/unified-routing/collection-routing.js","skipped":false,"dir":"e2e-tests"},{"name":"should load successfully when the page is visited directly","suites":[],"updatePoint":{"line":11,"column":66,"index":447},"line":11,"code":"  test(`should load successfully when the page is visited directly`, async ({\n    page\n  }) => {\n    await page.goto(`/gatsby-script-off-main-thread/`);\n    const partytownSnippet = page.locator(`[data-partytown]`);\n    const scriptWithSrc = page.locator(`[id=${id.three}]`);\n    const templateLiteral = page.locator(`[id=${id.templateLiteral}]`);\n    const dangerouslySet = page.locator(`[id=${id.dangerouslySet}]`);\n\n    // Unsure why this locator appears to behave differently, get text content to compare directly\n    const partytownSnippetText = await partytownSnippet.textContent();\n    expect(partytownSnippetText).toMatch(/THREE/); // Forwards configured\n\n    await expect(templateLiteral).toHaveText(`${id.templateLiteral}: success`); // Template literal inline scripts loaded\n    await expect(dangerouslySet).toHaveText(`${id.dangerouslySet}: success`); // Dangerously set inline scripts loaded\n    await expect(scriptWithSrc).toHaveAttribute(`type`, `text/partytown-x`); // Scripts with sources loaded\n  });","file":"production-runtime/playwright/gatsby-script-off-main-thread.spec.ts","skipped":false,"dir":"e2e-tests"},{"name":"should load successfully when navigating via Gatsby Link to a page with off-main-thread scripts","suites":[],"line":30,"code":"  test.skip(`should load successfully when navigating via Gatsby Link to a page with off-main-thread scripts`, async ({","file":"production-runtime/playwright/gatsby-script-off-main-thread.spec.ts","skipped":true,"dir":"e2e-tests"},{"name":"should load successfully when navigating via Gatsby Link between pages with off-main-thread scripts","suites":[],"line":50,"code":"  test.skip(`should load successfully when navigating via Gatsby Link between pages with off-main-thread scripts`, async ({","file":"production-runtime/playwright/gatsby-script-off-main-thread.spec.ts","skipped":true,"dir":"e2e-tests"},{"name":"installed theme","suites":["Components","can be added by themes"],"updatePoint":{"line":5,"column":23,"index":117},"line":5,"code":"    it(`installed theme`, () => {\n      cy.visit(`/shadowed`).waitForRouteChange();\n      cy.getTestElement(`date`).contains(`6/28/1993`);\n    });","file":"themes/development-runtime/cypress/integration/components.js","skipped":false,"dir":"e2e-tests"},{"name":"local theme","suites":["Components","can be added by themes"],"updatePoint":{"line":9,"column":19,"index":260},"line":9,"code":"    it(`local theme`, () => {\n      cy.visit(`/shadowed-local`).waitForRouteChange();\n      cy.getTestElement(`header`).contains(`This is component to test shadowing of local theme`);\n    });","file":"themes/development-runtime/cypress/integration/components.js","skipped":false,"dir":"e2e-tests"},{"name":"installed theme","suites":["Components","added by themes can be shadowed"],"updatePoint":{"line":15,"column":23,"index":516},"line":15,"code":"    it(`installed theme`, () => {\n      cy.visit(`/shadowed`).waitForRouteChange();\n      cy.getTestElement(`time`).contains(`2:39:07 PM`);\n    });","file":"themes/development-runtime/cypress/integration/components.js","skipped":false,"dir":"e2e-tests"},{"name":"local theme","suites":["Components","added by themes can be shadowed"],"updatePoint":{"line":19,"column":19,"index":660},"line":19,"code":"    it(`local theme`, () => {\n      cy.visit(`/shadowed-local`).waitForRouteChange();\n      cy.getTestElement(`pre`).contains(`This is in main site`);\n      cy.getTestElement(`pre`).should(`not.contain`, `This is in gatsby-theme-local`);\n    });","file":"themes/development-runtime/cypress/integration/components.js","skipped":false,"dir":"e2e-tests"},{"name":"works for changes in queries in themes","suites":["Hot Reloading"],"line":5,"code":"  it.skip(`works for changes in queries in themes`, () => {","file":"themes/development-runtime/cypress/integration/hot-reloading.js","skipped":true,"dir":"e2e-tests"},{"name":"installed theme","suites":["Pages","can be added by themes"],"updatePoint":{"line":5,"column":23,"index":112},"line":5,"code":"    it(`installed theme`, () => {\n      cy.visit(`/about`).waitForRouteChange();\n      cy.getTestElement(`title`).contains(`Blog Title Placeholder`);\n    });","file":"themes/development-runtime/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"local theme","suites":["Pages","can be added by themes"],"updatePoint":{"line":9,"column":19,"index":266},"line":9,"code":"    it(`local theme`, () => {\n      cy.visit(`/page-from-local`).waitForRouteChange();\n      cy.getTestElement(`title`).contains(`Page from local theme`);\n    });","file":"themes/development-runtime/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"installed theme","suites":["Pages","added by themes can be shadowed"],"updatePoint":{"line":15,"column":23,"index":493},"line":15,"code":"    it(`installed theme`, () => {\n      cy.visit(`/contact`).waitForRouteChange();\n      cy.getTestElement(`title`).contains(`A title since the theme didn't have one`);\n    });","file":"themes/development-runtime/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"local theme","suites":["Pages","added by themes can be shadowed"],"updatePoint":{"line":19,"column":19,"index":666},"line":19,"code":"    it(`local theme`, () => {\n      cy.visit(`/page-from-local-overwrite`).waitForRouteChange();\n      cy.getTestElement(`title`).contains(`Overwritten page from local theme`);\n    });","file":"themes/development-runtime/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"page queries can be shadowed","suites":["Pages","added by themes can be shadowed"],"updatePoint":{"line":24,"column":34,"index":872},"line":24,"code":"  it(`page queries can be shadowed`, () => {\n    cy.visit(`/about`).waitForRouteChange();\n    cy.getTestElement(`author`).contains(`Sidhartha Chatterjee`);\n  });","file":"themes/development-runtime/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"can use different extensions to shadow","suites":["Pages","added by themes can be shadowed"],"updatePoint":{"line":28,"column":44,"index":1044},"line":28,"code":"  it(`can use different extensions to shadow`, () => {\n    cy.visit(`/bio`).waitForRouteChange();\n    cy.getTestElement(`bio`).contains(`A bio all about me.`);\n  });","file":"themes/development-runtime/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"installed theme","suites":["Site Metadata","can be added by themes"],"updatePoint":{"line":5,"column":23,"index":120},"line":5,"code":"    it(`installed theme`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.getTestElement(`title`).contains(`Blog Title Placeholder`);\n    });","file":"themes/development-runtime/cypress/integration/site-metadata.js","skipped":false,"dir":"e2e-tests"},{"name":"local theme","suites":["Site Metadata","can be added by themes"],"updatePoint":{"line":9,"column":19,"index":269},"line":9,"code":"    it(`local theme`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.getTestElement(`description`).contains(`Description placeholder`);\n    });","file":"themes/development-runtime/cypress/integration/site-metadata.js","skipped":false,"dir":"e2e-tests"},{"name":"installed theme","suites":["Site Metadata","added by themes can be overridden"],"updatePoint":{"line":15,"column":23,"index":491},"line":15,"code":"    it(`installed theme`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.getTestElement(`author`).contains(`Sidhartha Chatterjee`);\n    });","file":"themes/development-runtime/cypress/integration/site-metadata.js","skipped":false,"dir":"e2e-tests"},{"name":"local theme","suites":["Site Metadata","added by themes can be overridden"],"updatePoint":{"line":19,"column":19,"index":639},"line":19,"code":"    it(`local theme`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.getTestElement(`social_twitter`).contains(`chatsidhartha`);\n    });","file":"themes/development-runtime/cypress/integration/site-metadata.js","skipped":false,"dir":"e2e-tests"},{"name":"installed theme","suites":["Components","can be added by themes"],"updatePoint":{"line":5,"column":23,"index":117},"line":5,"code":"    it(`installed theme`, () => {\n      cy.visit(`/shadowed`).waitForRouteChange();\n      cy.getTestElement(`date`).contains(`6/28/1993`);\n    });","file":"themes/production-runtime/cypress/integration/components.js","skipped":false,"dir":"e2e-tests"},{"name":"local theme","suites":["Components","can be added by themes"],"updatePoint":{"line":9,"column":19,"index":260},"line":9,"code":"    it(`local theme`, () => {\n      cy.visit(`/shadowed-local`).waitForRouteChange();\n      cy.getTestElement(`header`).contains(`This is component to test shadowing of local theme`);\n    });","file":"themes/production-runtime/cypress/integration/components.js","skipped":false,"dir":"e2e-tests"},{"name":"installed theme","suites":["Components","added by themes can be shadowed"],"updatePoint":{"line":15,"column":23,"index":516},"line":15,"code":"    it(`installed theme`, () => {\n      cy.visit(`/shadowed`).waitForRouteChange();\n      cy.getTestElement(`time`).contains(`2:39:07 PM`);\n    });","file":"themes/production-runtime/cypress/integration/components.js","skipped":false,"dir":"e2e-tests"},{"name":"local theme","suites":["Components","added by themes can be shadowed"],"updatePoint":{"line":19,"column":19,"index":660},"line":19,"code":"    it(`local theme`, () => {\n      cy.visit(`/shadowed-local`).waitForRouteChange();\n      cy.getTestElement(`pre`).contains(`This is in main site`);\n      cy.getTestElement(`pre`).should(`not.contain`, `This is in gatsby-theme-local`);\n    });","file":"themes/production-runtime/cypress/integration/components.js","skipped":false,"dir":"e2e-tests"},{"name":"installed theme","suites":["Pages","can be added by themes"],"updatePoint":{"line":5,"column":23,"index":112},"line":5,"code":"    it(`installed theme`, () => {\n      cy.visit(`/about`).waitForRouteChange();\n      cy.getTestElement(`title`).contains(`Blog Title Placeholder`);\n    });","file":"themes/production-runtime/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"local theme","suites":["Pages","can be added by themes"],"updatePoint":{"line":9,"column":19,"index":266},"line":9,"code":"    it(`local theme`, () => {\n      cy.visit(`/page-from-local`).waitForRouteChange();\n      cy.getTestElement(`title`).contains(`Page from local theme`);\n    });","file":"themes/production-runtime/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"installed theme","suites":["Pages","added by themes can be shadowed"],"updatePoint":{"line":15,"column":23,"index":493},"line":15,"code":"    it(`installed theme`, () => {\n      cy.visit(`/contact`).waitForRouteChange();\n      cy.getTestElement(`title`).contains(`A title since the theme didn't have one`);\n    });","file":"themes/production-runtime/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"local theme","suites":["Pages","added by themes can be shadowed"],"updatePoint":{"line":19,"column":19,"index":666},"line":19,"code":"    it(`local theme`, () => {\n      cy.visit(`/page-from-local-overwrite`).waitForRouteChange();\n      cy.getTestElement(`title`).contains(`Overwritten page from local theme`);\n    });","file":"themes/production-runtime/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"page queries can be shadowed","suites":["Pages","added by themes can be shadowed"],"updatePoint":{"line":24,"column":34,"index":872},"line":24,"code":"  it(`page queries can be shadowed`, () => {\n    cy.visit(`/about`).waitForRouteChange();\n    cy.getTestElement(`author`).contains(`Sidhartha Chatterjee`);\n  });","file":"themes/production-runtime/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"page templates with resourceQuery can be shadowed","suites":["Pages","added by themes can be shadowed"],"updatePoint":{"line":28,"column":55,"index":1055},"line":28,"code":"  it(`page templates with resourceQuery can be shadowed`, () => {\n    cy.visit(`/dune`).waitForRouteChange();\n    cy.getTestElement(`post-template`).contains(`Dune - Shadowed`);\n  });","file":"themes/production-runtime/cypress/integration/pages.js","skipped":false,"dir":"e2e-tests"},{"name":"installed theme","suites":["Site Metadata","can be added by themes"],"updatePoint":{"line":5,"column":23,"index":120},"line":5,"code":"    it(`installed theme`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.getTestElement(`title`).contains(`Blog Title Placeholder`);\n    });","file":"themes/production-runtime/cypress/integration/site-metadata.js","skipped":false,"dir":"e2e-tests"},{"name":"local theme","suites":["Site Metadata","can be added by themes"],"updatePoint":{"line":9,"column":19,"index":269},"line":9,"code":"    it(`local theme`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.getTestElement(`description`).contains(`Description placeholder`);\n    });","file":"themes/production-runtime/cypress/integration/site-metadata.js","skipped":false,"dir":"e2e-tests"},{"name":"installed theme","suites":["Site Metadata","added by themes can be overridden"],"updatePoint":{"line":15,"column":23,"index":491},"line":15,"code":"    it(`installed theme`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.getTestElement(`author`).contains(`Sidhartha Chatterjee`);\n    });","file":"themes/production-runtime/cypress/integration/site-metadata.js","skipped":false,"dir":"e2e-tests"},{"name":"local theme","suites":["Site Metadata","added by themes can be overridden"],"updatePoint":{"line":19,"column":19,"index":639},"line":19,"code":"    it(`local theme`, () => {\n      cy.visit(`/`).waitForRouteChange();\n      cy.getTestElement(`social_twitter`).contains(`chatsidhartha`);\n    });","file":"themes/production-runtime/cypress/integration/site-metadata.js","skipped":false,"dir":"e2e-tests"},{"name":"page-creator without slash","suites":["always"],"updatePoint":{"line":11,"column":32,"index":420},"line":11,"code":"  it(`page-creator without slash`, () => {\n    cy.getTestElement(`page-creator-without`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"page-creator with slash","suites":["always"],"updatePoint":{"line":15,"column":29,"index":574},"line":15,"code":"  it(`page-creator with slash`, () => {\n    cy.getTestElement(`page-creator-with`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"create-page with slash","suites":["always"],"updatePoint":{"line":19,"column":28,"index":724},"line":19,"code":"  it(`create-page with slash`, () => {\n    cy.getTestElement(`create-page-with`).click();\n    cy.waitForRouteChange().assertRoute(`/create-page/with/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"create-page without slash","suites":["always"],"updatePoint":{"line":23,"column":31,"index":886},"line":23,"code":"  it(`create-page without slash`, () => {\n    cy.getTestElement(`create-page-without`).click();\n    cy.waitForRouteChange().assertRoute(`/create-page/without/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api with slash","suites":["always"],"updatePoint":{"line":27,"column":23,"index":1046},"line":27,"code":"  it(`fs-api with slash`, () => {\n    cy.getTestElement(`fs-api-with`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api/with/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api without slash","suites":["always"],"updatePoint":{"line":31,"column":26,"index":1193},"line":31,"code":"  it(`fs-api without slash`, () => {\n    cy.getTestElement(`fs-api-without`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api/without/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api client only splat without slash","suites":["always"],"updatePoint":{"line":35,"column":44,"index":1364},"line":35,"code":"  it(`fs-api client only splat without slash`, () => {\n    cy.getTestElement(`fs-api-client-only-without`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api/without/without/`);\n    cy.getTestElement(`title`).should(`have.text`, `without`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api client only splat with slash","suites":["always"],"updatePoint":{"line":40,"column":41,"index":1615},"line":40,"code":"  it(`fs-api client only splat with slash`, () => {\n    cy.getTestElement(`fs-api-client-only-with`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api/with/with/`);\n    cy.getTestElement(`title`).should(`have.text`, `with`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api-simple with slash","suites":["always"],"updatePoint":{"line":45,"column":30,"index":1843},"line":45,"code":"  it(`fs-api-simple with slash`, () => {\n    cy.getTestElement(`fs-api-simple-with`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api-simple/with/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api-simple without slash","suites":["always"],"updatePoint":{"line":49,"column":33,"index":2011},"line":49,"code":"  it(`fs-api-simple without slash`, () => {\n    cy.getTestElement(`fs-api-simple-without`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api-simple/without/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"gatsbyPath works","suites":["always"],"updatePoint":{"line":53,"column":22,"index":2174},"line":53,"code":"  it(`gatsbyPath works`, () => {\n    cy.getTestElement(`gatsby-path-1`).should(\"have.attr\", \"href\", \"/fs-api-simple/with/\");\n    cy.getTestElement(`gatsby-path-2`).should(\"have.attr\", \"href\", \"/fs-api-simple/without/\");\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"hash","suites":["always"],"updatePoint":{"line":57,"column":10,"index":2388},"line":57,"code":"  it(`hash`, () => {\n    cy.getTestElement(`hash`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2/#anchor`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"hash trailing","suites":["always"],"updatePoint":{"line":61,"column":19,"index":2523},"line":61,"code":"  it(`hash trailing`, () => {\n    cy.getTestElement(`hash-trailing`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2/#anchor`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"query-param","suites":["always"],"updatePoint":{"line":65,"column":17,"index":2665},"line":65,"code":"  it(`query-param`, () => {\n    cy.getTestElement(`query-param`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2/?query_param=hello`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"query-param-hash","suites":["always"],"updatePoint":{"line":69,"column":22,"index":2821},"line":69,"code":"  it(`query-param-hash`, () => {\n    cy.getTestElement(`query-param-hash`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2/?query_param=hello#anchor`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only without slash","suites":["always"],"updatePoint":{"line":73,"column":31,"index":2998},"line":73,"code":"  it(`client-only without slash`, () => {\n    cy.getTestElement(`client-only-simple-without`).click();\n    cy.waitForRouteChange().assertRoute(`/client-only/without/`);\n    cy.getTestElement(`title`).should(`have.text`, `without`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only with slash","suites":["always"],"updatePoint":{"line":78,"column":28,"index":3233},"line":78,"code":"  it(`client-only with slash`, () => {\n    cy.getTestElement(`client-only-simple-with`).click();\n    cy.waitForRouteChange().assertRoute(`/client-only/with/`);\n    cy.getTestElement(`title`).should(`have.text`, `with`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only-splat without slash","suites":["always"],"updatePoint":{"line":83,"column":37,"index":3468},"line":83,"code":"  it(`client-only-splat without slash`, () => {\n    cy.getTestElement(`client-only-splat-without`).click();\n    cy.waitForRouteChange().assertRoute(`/client-only-splat/without/without/`);\n    cy.getTestElement(`title`).should(`have.text`, `without/without`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only-splat with slash","suites":["always"],"updatePoint":{"line":88,"column":34,"index":3730},"line":88,"code":"  it(`client-only-splat with slash`, () => {\n    cy.getTestElement(`client-only-splat-with`).click();\n    cy.waitForRouteChange().assertRoute(`/client-only-splat/with/with/`);\n    cy.getTestElement(`title`).should(`have.text`, `with/with`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"relative path with trailing slash","suites":["always"],"updatePoint":{"line":93,"column":39,"index":3982},"line":93,"code":"  it(\"relative path with trailing slash\", () => {\n    cy.getTestElement(`relative-path-with-trailing-slash`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"page-creator","suites":["always (direct visits)"],"updatePoint":{"line":102,"column":18,"index":4252},"line":102,"code":"  it(`page-creator`, () => {\n    assertPageVisits([{\n      path: \"/page-2/\",\n      status: 200\n    }, {\n      path: \"/page-2\",\n      status: 301,\n      destinationPath: \"/page-2/\"\n    }]);\n    cy.visit(`/page-2`).waitForRouteChange().assertRoute(`/page-2/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"create-page with","suites":["always (direct visits)"],"updatePoint":{"line":113,"column":22,"index":4521},"line":113,"code":"  it(`create-page with`, () => {\n    assertPageVisits([{\n      path: \"/create-page/with/\",\n      status: 200\n    }]);\n    cy.visit(`/create-page/with/`).waitForRouteChange().assertRoute(`/create-page/with/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"create-page without","suites":["always (direct visits)"],"updatePoint":{"line":120,"column":25,"index":4739},"line":120,"code":"  it(`create-page without`, () => {\n    assertPageVisits([{\n      path: \"/create-page/without\",\n      status: 301,\n      destinationPath: \"/create-page/without\"\n    }]);\n    cy.visit(`/create-page/without`).waitForRouteChange().assertRoute(`/create-page/without/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api-simple with","suites":["always (direct visits)"],"updatePoint":{"line":128,"column":24,"index":5010},"line":128,"code":"  it(`fs-api-simple with`, () => {\n    assertPageVisits([{\n      path: \"/fs-api-simple/with/\",\n      status: 200\n    }]);\n    cy.visit(`/fs-api-simple/with/`).waitForRouteChange().assertRoute(`/fs-api-simple/with/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api-simple without","suites":["always (direct visits)"],"updatePoint":{"line":135,"column":27,"index":5236},"line":135,"code":"  it(`fs-api-simple without`, () => {\n    assertPageVisits([{\n      path: \"/fs-api-simple/without\",\n      status: 301,\n      destinationPath: \"/fs-api-simple/without/\"\n    }]);\n    cy.visit(`/fs-api-simple/without`).waitForRouteChange().assertRoute(`/fs-api-simple/without/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api client only splat with","suites":["always (direct visits)"],"updatePoint":{"line":143,"column":35,"index":5527},"line":143,"code":"  it(`fs-api client only splat with`, () => {\n    assertPageVisits([{\n      path: \"/fs-api/with/with/\",\n      status: 200\n    }]);\n    cy.visit(`/fs-api/with/with/`).waitForRouteChange().assertRoute(`/fs-api/with/with/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api client only splat without","suites":["always (direct visits)"],"updatePoint":{"line":150,"column":38,"index":5758},"line":150,"code":"  it(`fs-api client only splat without`, () => {\n    assertPageVisits([{\n      path: \"`/fs-api/without/without\",\n      status: 301,\n      destinationPath: \"`/fs-api/without/without/\"\n    }]);\n    cy.visit(`/fs-api/without/without`).waitForRouteChange().assertRoute(`/fs-api/without/without/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only with","suites":["always (direct visits)"],"updatePoint":{"line":158,"column":22,"index":6042},"line":158,"code":"  it(`client-only with`, () => {\n    assertPageVisits([{\n      path: \"/create-page/with/\",\n      status: 200\n    }]);\n    cy.visit(`/client-only/with/`).waitForRouteChange().assertRoute(`/client-only/with/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only without","suites":["always (direct visits)"],"updatePoint":{"line":165,"column":25,"index":6260},"line":165,"code":"  it(`client-only without`, () => {\n    assertPageVisits([{\n      path: \"/client-only/without\",\n      status: 301,\n      destinationPath: \"/client-only/without\"\n    }]);\n    cy.visit(`/client-only/without`).waitForRouteChange().assertRoute(`/client-only/without/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only-splat with","suites":["always (direct visits)"],"updatePoint":{"line":173,"column":28,"index":6535},"line":173,"code":"  it(`client-only-splat with`, () => {\n    assertPageVisits([{\n      path: \"/client-only-splat/with/with/\",\n      status: 200\n    }]);\n    cy.visit(`/client-only-splat/with/with/`).waitForRouteChange().assertRoute(`/client-only-splat/with/with/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only-splat without","suites":["always (direct visits)"],"updatePoint":{"line":180,"column":31,"index":6792},"line":180,"code":"  it(`client-only-splat without`, () => {\n    assertPageVisits([{\n      path: \"`/client-only-splat/without/without\",\n      status: 301,\n      destinationPath: \"`/client-only-splat/without/without/\"\n    }]);\n    cy.visit(`/client-only-splat/without/without`).waitForRouteChange().assertRoute(`/client-only-splat/without/without/`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"query-param-hash with","suites":["always (direct visits)"],"updatePoint":{"line":188,"column":27,"index":7125},"line":188,"code":"  it(`query-param-hash with`, () => {\n    assertPageVisits([{\n      path: \"/page-2/?query_param=hello#anchor\",\n      status: 200\n    }]);\n    cy.visit(`/page-2/?query_param=hello#anchor`).waitForRouteChange().assertRoute(`/page-2/?query_param=hello#anchor`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"query-param-hash without","suites":["always (direct visits)"],"updatePoint":{"line":195,"column":30,"index":7393},"line":195,"code":"  it(`query-param-hash without`, () => {\n    assertPageVisits([{\n      path: \"/page-2?query_param=hello#anchor\",\n      status: 200\n    }]);\n    cy.visit(`/page-2?query_param=hello#anchor`).waitForRouteChange().assertRoute(`/page-2/?query_param=hello#anchor`);\n  });","file":"trailing-slash/cypress/integration/always.js","skipped":false,"dir":"e2e-tests"},{"name":"functions are always accessible without trailing slash","suites":["functions","src/api/test.js"],"updatePoint":{"line":4,"column":62,"index":191},"line":4,"code":"    it(`functions are always accessible without trailing slash`, () => {\n      assertPageVisits([{\n        path: \"/api/test\",\n        status: 200\n      }]);\n      cy.visit(`/api/test`).assertRoute(`/api/test`);\n    });","file":"trailing-slash/cypress/integration/functions.js","skipped":false,"dir":"e2e-tests"},{"name":"functions 404 with trailing slash","suites":["functions","src/api/test.js"],"updatePoint":{"line":11,"column":41,"index":389},"line":11,"code":"    it(`functions 404 with trailing slash`, () => {\n      assertPageVisits([{\n        path: \"/api/test/\",\n        status: 404\n      }]);\n      cy.visit(`/api/test/`, {\n        failOnStatusCode: false\n      }).assertRoute(`/api/test/`);\n    });","file":"trailing-slash/cypress/integration/functions.js","skipped":false,"dir":"e2e-tests"},{"name":"functions are always accessible without trailing slash","suites":["functions","src/api/nested/index.js"],"updatePoint":{"line":22,"column":62,"index":706},"line":22,"code":"    it(`functions are always accessible without trailing slash`, () => {\n      assertPageVisits([{\n        path: \"/api/nested\",\n        status: 200\n      }]);\n      cy.visit(`/api/nested`).assertRoute(`/api/nested`);\n    });","file":"trailing-slash/cypress/integration/functions.js","skipped":false,"dir":"e2e-tests"},{"name":"functions 404 with trailing slash","suites":["functions","src/api/nested/index.js"],"updatePoint":{"line":29,"column":41,"index":910},"line":29,"code":"    it(`functions 404 with trailing slash`, () => {\n      assertPageVisits([{\n        path: \"/api/nested/\",\n        status: 404\n      }]);\n      cy.visit(`/api/nested/`, {\n        failOnStatusCode: false\n      }).assertRoute(`/api/nested/`);\n    });","file":"trailing-slash/cypress/integration/functions.js","skipped":false,"dir":"e2e-tests"},{"name":"page-creator without slash","suites":["ignore"],"updatePoint":{"line":11,"column":32,"index":420},"line":11,"code":"  it(`page-creator without slash`, () => {\n    cy.getTestElement(`page-creator-without`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"page-creator with slash","suites":["ignore"],"updatePoint":{"line":15,"column":29,"index":573},"line":15,"code":"  it(`page-creator with slash`, () => {\n    cy.getTestElement(`page-creator-with`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2/`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"create-page with slash","suites":["ignore"],"updatePoint":{"line":19,"column":28,"index":723},"line":19,"code":"  it(`create-page with slash`, () => {\n    cy.getTestElement(`create-page-with`).click();\n    cy.waitForRouteChange().assertRoute(`/create-page/with/`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"create-page without slash","suites":["ignore"],"updatePoint":{"line":23,"column":31,"index":885},"line":23,"code":"  it(`create-page without slash`, () => {\n    cy.getTestElement(`create-page-without`).click();\n    cy.waitForRouteChange().assertRoute(`/create-page/without`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api with slash","suites":["ignore"],"updatePoint":{"line":27,"column":23,"index":1044},"line":27,"code":"  it(`fs-api with slash`, () => {\n    cy.getTestElement(`fs-api-with`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api/with/`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api without slash","suites":["ignore"],"updatePoint":{"line":31,"column":26,"index":1191},"line":31,"code":"  it(`fs-api without slash`, () => {\n    cy.getTestElement(`fs-api-without`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api/without`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api client only splat without slash","suites":["ignore"],"updatePoint":{"line":35,"column":44,"index":1361},"line":35,"code":"  it(`fs-api client only splat without slash`, () => {\n    cy.getTestElement(`fs-api-client-only-without`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api/without/without`);\n    cy.getTestElement(`title`).should(`have.text`, `without`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api client only splat with slash","suites":["ignore"],"updatePoint":{"line":40,"column":41,"index":1611},"line":40,"code":"  it(`fs-api client only splat with slash`, () => {\n    cy.getTestElement(`fs-api-client-only-with`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api/with/with/`);\n    cy.getTestElement(`title`).should(`have.text`, `with`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api-simple with slash","suites":["ignore"],"updatePoint":{"line":45,"column":30,"index":1839},"line":45,"code":"  it(`fs-api-simple with slash`, () => {\n    cy.getTestElement(`fs-api-simple-with`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api-simple/with/`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api-simple without slash","suites":["ignore"],"updatePoint":{"line":49,"column":33,"index":2007},"line":49,"code":"  it(`fs-api-simple without slash`, () => {\n    cy.getTestElement(`fs-api-simple-without`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api-simple/without`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"gatsbyPath works","suites":["ignore"],"updatePoint":{"line":53,"column":22,"index":2169},"line":53,"code":"  it(`gatsbyPath works`, () => {\n    cy.getTestElement(`gatsby-path-1`).should(\"have.attr\", \"href\", \"/fs-api-simple/with/\");\n    cy.getTestElement(`gatsby-path-2`).should(\"have.attr\", \"href\", \"/fs-api-simple/without\");\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"hash","suites":["ignore"],"updatePoint":{"line":57,"column":10,"index":2382},"line":57,"code":"  it(`hash`, () => {\n    cy.getTestElement(`hash`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2#anchor`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"hash trailing","suites":["ignore"],"updatePoint":{"line":61,"column":19,"index":2516},"line":61,"code":"  it(`hash trailing`, () => {\n    cy.getTestElement(`hash-trailing`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2/#anchor`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"query-param","suites":["ignore"],"updatePoint":{"line":65,"column":17,"index":2658},"line":65,"code":"  it(`query-param`, () => {\n    cy.getTestElement(`query-param`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2?query_param=hello`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"query-param-hash","suites":["ignore"],"updatePoint":{"line":69,"column":22,"index":2813},"line":69,"code":"  it(`query-param-hash`, () => {\n    cy.getTestElement(`query-param-hash`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2?query_param=hello#anchor`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only without slash","suites":["ignore"],"updatePoint":{"line":73,"column":31,"index":2989},"line":73,"code":"  it(`client-only without slash`, () => {\n    cy.getTestElement(`client-only-simple-without`).click();\n    cy.waitForRouteChange().assertRoute(`/client-only/without`);\n    cy.getTestElement(`title`).should(`have.text`, `without`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only with slash","suites":["ignore"],"updatePoint":{"line":78,"column":28,"index":3223},"line":78,"code":"  it(`client-only with slash`, () => {\n    cy.getTestElement(`client-only-simple-with`).click();\n    cy.waitForRouteChange().assertRoute(`/client-only/with/`);\n    cy.getTestElement(`title`).should(`have.text`, `with`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only-splat without slash","suites":["ignore"],"updatePoint":{"line":83,"column":37,"index":3458},"line":83,"code":"  it(`client-only-splat without slash`, () => {\n    cy.getTestElement(`client-only-splat-without`).click();\n    cy.waitForRouteChange().assertRoute(`/client-only-splat/without/without`);\n    cy.getTestElement(`title`).should(`have.text`, `without/without`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only-splat with slash","suites":["ignore"],"updatePoint":{"line":88,"column":34,"index":3719},"line":88,"code":"  it(`client-only-splat with slash`, () => {\n    cy.getTestElement(`client-only-splat-with`).click();\n    cy.waitForRouteChange().assertRoute(`/client-only-splat/with/with/`);\n    cy.getTestElement(`title`).should(`have.text`, `with/with`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"page-creator","suites":["ignore (direct visits)"],"updatePoint":{"line":99,"column":18,"index":4106},"line":99,"code":"  it(`page-creator`, () => {\n    assertPageVisits([{\n      path: \"/page-2\",\n      destinationPath: IS_BUILD ? `/page-2/` : false,\n      status: IS_BUILD ? 301 : 200\n    }]);\n    cy.visit(`/page-2`).waitForRouteChange().assertRoute(`/page-2`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"create-page with","suites":["ignore (direct visits)"],"updatePoint":{"line":107,"column":22,"index":4359},"line":107,"code":"  it(`create-page with`, () => {\n    assertPageVisits([{\n      path: \"/create-page/with/\",\n      status: 200\n    }]);\n    cy.visit(`/create-page/with/`).waitForRouteChange().assertRoute(`/create-page/with/`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"create-page without","suites":["ignore (direct visits)"],"updatePoint":{"line":114,"column":25,"index":4577},"line":114,"code":"  it(`create-page without`, () => {\n    assertPageVisits([{\n      path: \"/create-page/without\",\n      status: 200\n    }]);\n    cy.visit(`/create-page/without`).waitForRouteChange().assertRoute(`/create-page/without`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api-simple with","suites":["ignore (direct visits)"],"updatePoint":{"line":121,"column":24,"index":4800},"line":121,"code":"  it(`fs-api-simple with`, () => {\n    assertPageVisits([{\n      path: \"/fs-api-simple/with/\",\n      status: 200\n    }]);\n    cy.visit(`/fs-api-simple/with/`).waitForRouteChange().assertRoute(`/fs-api-simple/with/`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api-simple without","suites":["ignore (direct visits)"],"updatePoint":{"line":128,"column":27,"index":5026},"line":128,"code":"  it(`fs-api-simple without`, () => {\n    assertPageVisits([{\n      path: \"/fs-api-simple/without\",\n      status: 200\n    }]);\n    cy.visit(`/fs-api-simple/without`).waitForRouteChange().assertRoute(`/fs-api-simple/without`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api client only splat with","suites":["ignore (direct visits)"],"updatePoint":{"line":135,"column":35,"index":5266},"line":135,"code":"  it(`fs-api client only splat with`, () => {\n    assertPageVisits([{\n      path: \"/fs-api/with/with/\",\n      status: 200\n    }]);\n    cy.visit(`/fs-api/with/with/`).waitForRouteChange().assertRoute(`/fs-api/with/with/`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api client only splat without","suites":["ignore (direct visits)"],"updatePoint":{"line":142,"column":38,"index":5497},"line":142,"code":"  it(`fs-api client only splat without`, () => {\n    assertPageVisits([{\n      path: \"/fs-api/without/without\",\n      status: 200\n    }]);\n    cy.visit(`/fs-api/without/without`).waitForRouteChange().assertRoute(`/fs-api/without/without`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only with","suites":["ignore (direct visits)"],"updatePoint":{"line":149,"column":22,"index":5727},"line":149,"code":"  it(`client-only with`, () => {\n    assertPageVisits([{\n      path: \"/client-only/with/\",\n      status: 200\n    }]);\n    cy.visit(`/client-only/with/`).waitForRouteChange().assertRoute(`/client-only/with/`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only without","suites":["ignore (direct visits)"],"updatePoint":{"line":156,"column":25,"index":5945},"line":156,"code":"  it(`client-only without`, () => {\n    assertPageVisits([{\n      path: \"/create-page/without\",\n      status: 200\n    }]);\n    cy.visit(`/client-only/without`).waitForRouteChange().assertRoute(`/client-only/without`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only-splat with","suites":["ignore (direct visits)"],"updatePoint":{"line":163,"column":28,"index":6172},"line":163,"code":"  it(`client-only-splat with`, () => {\n    assertPageVisits([{\n      path: \"/create-page/without\",\n      status: 200\n    }]);\n    cy.visit(`/client-only-splat/with/with/`).waitForRouteChange().assertRoute(`/client-only-splat/with/with/`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only-splat without","suites":["ignore (direct visits)"],"updatePoint":{"line":170,"column":31,"index":6420},"line":170,"code":"  it(`client-only-splat without`, () => {\n    assertPageVisits([{\n      path: \"/create-page/without\",\n      status: 200\n    }]);\n    cy.visit(`/client-only-splat/without/without`).waitForRouteChange().assertRoute(`/client-only-splat/without/without`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"query-param-hash with","suites":["ignore (direct visits)"],"updatePoint":{"line":177,"column":27,"index":6674},"line":177,"code":"  it(`query-param-hash with`, () => {\n    assertPageVisits([{\n      path: \"/create-page/without\",\n      status: 200\n    }]);\n    cy.visit(`/page-2/?query_param=hello#anchor`).waitForRouteChange().assertRoute(IS_BUILD ? `/page-2?query_param=hello#anchor` : `/page-2/?query_param=hello#anchor`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"query-param-hash without","suites":["ignore (direct visits)"],"updatePoint":{"line":184,"column":30,"index":6977},"line":184,"code":"  it(`query-param-hash without`, () => {\n    assertPageVisits([{\n      path: \"/page-2?query_param=hello#anchor\",\n      status: IS_BUILD ? 301 : 200,\n      destinationPath: IS_BUILD ? \"/page-2/?query_param=hello#anchor\" : false\n    }]);\n    cy.visit(`/page-2?query_param=hello#anchor`).waitForRouteChange().assertRoute(`/page-2?query_param=hello#anchor`);\n  });","file":"trailing-slash/cypress/integration/ignore.js","skipped":false,"dir":"e2e-tests"},{"name":"page-creator without slash","suites":["never"],"updatePoint":{"line":11,"column":32,"index":419},"line":11,"code":"  it(`page-creator without slash`, () => {\n    cy.getTestElement(`page-creator-without`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"page-creator with slash","suites":["never"],"updatePoint":{"line":15,"column":29,"index":572},"line":15,"code":"  it(`page-creator with slash`, () => {\n    cy.getTestElement(`page-creator-with`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"create-page with slash","suites":["never"],"updatePoint":{"line":19,"column":28,"index":721},"line":19,"code":"  it(`create-page with slash`, () => {\n    cy.getTestElement(`create-page-with`).click();\n    cy.waitForRouteChange().assertRoute(`/create-page/with`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"create-page without slash","suites":["never"],"updatePoint":{"line":23,"column":31,"index":882},"line":23,"code":"  it(`create-page without slash`, () => {\n    cy.getTestElement(`create-page-without`).click();\n    cy.waitForRouteChange().assertRoute(`/create-page/without`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api with slash","suites":["never"],"updatePoint":{"line":27,"column":23,"index":1041},"line":27,"code":"  it(`fs-api with slash`, () => {\n    cy.getTestElement(`fs-api-with`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api/with`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api without slash","suites":["never"],"updatePoint":{"line":31,"column":26,"index":1187},"line":31,"code":"  it(`fs-api without slash`, () => {\n    cy.getTestElement(`fs-api-without`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api/without`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api client only splat without slash","suites":["never"],"updatePoint":{"line":35,"column":44,"index":1357},"line":35,"code":"  it(`fs-api client only splat without slash`, () => {\n    cy.getTestElement(`fs-api-client-only-without`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api/without/without`);\n    cy.getTestElement(`title`).should(`have.text`, `without`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api client only splat with slash","suites":["never"],"updatePoint":{"line":40,"column":41,"index":1607},"line":40,"code":"  it(`fs-api client only splat with slash`, () => {\n    cy.getTestElement(`fs-api-client-only-with`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api/with/with`);\n    cy.getTestElement(`title`).should(`have.text`, `with`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api-simple with slash","suites":["never"],"updatePoint":{"line":45,"column":30,"index":1834},"line":45,"code":"  it(`fs-api-simple with slash`, () => {\n    cy.getTestElement(`fs-api-simple-with`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api-simple/with`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api-simple without slash","suites":["never"],"updatePoint":{"line":49,"column":33,"index":2001},"line":49,"code":"  it(`fs-api-simple without slash`, () => {\n    cy.getTestElement(`fs-api-simple-without`).click();\n    cy.waitForRouteChange().assertRoute(`/fs-api-simple/without`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"gatsbyPath works","suites":["never"],"updatePoint":{"line":53,"column":22,"index":2163},"line":53,"code":"  it(`gatsbyPath works`, () => {\n    cy.getTestElement(`gatsby-path-1`).should(\"have.attr\", \"href\", \"/fs-api-simple/with\");\n    cy.getTestElement(`gatsby-path-2`).should(\"have.attr\", \"href\", \"/fs-api-simple/without\");\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"hash","suites":["never"],"updatePoint":{"line":57,"column":10,"index":2375},"line":57,"code":"  it(`hash`, () => {\n    cy.getTestElement(`hash`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2#anchor`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"hash trailing","suites":["never"],"updatePoint":{"line":61,"column":19,"index":2509},"line":61,"code":"  it(`hash trailing`, () => {\n    cy.getTestElement(`hash-trailing`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2#anchor`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"query-param","suites":["never"],"updatePoint":{"line":65,"column":17,"index":2650},"line":65,"code":"  it(`query-param`, () => {\n    cy.getTestElement(`query-param`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2?query_param=hello`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"query-param-hash","suites":["never"],"updatePoint":{"line":69,"column":22,"index":2805},"line":69,"code":"  it(`query-param-hash`, () => {\n    cy.getTestElement(`query-param-hash`).click();\n    cy.waitForRouteChange().assertRoute(`/page-2?query_param=hello#anchor`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only without slash","suites":["never"],"updatePoint":{"line":73,"column":31,"index":2981},"line":73,"code":"  it(`client-only without slash`, () => {\n    cy.getTestElement(`client-only-simple-without`).click();\n    cy.waitForRouteChange().assertRoute(`/client-only/without`);\n    cy.getTestElement(`title`).should(`have.text`, `without`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only with slash","suites":["never"],"updatePoint":{"line":78,"column":28,"index":3215},"line":78,"code":"  it(`client-only with slash`, () => {\n    cy.getTestElement(`client-only-simple-with`).click();\n    cy.waitForRouteChange().assertRoute(`/client-only/with`);\n    cy.getTestElement(`title`).should(`have.text`, `with`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only-splat without slash","suites":["never"],"updatePoint":{"line":83,"column":37,"index":3449},"line":83,"code":"  it(`client-only-splat without slash`, () => {\n    cy.getTestElement(`client-only-splat-without`).click();\n    cy.waitForRouteChange().assertRoute(`/client-only-splat/without/without`);\n    cy.getTestElement(`title`).should(`have.text`, `without/without`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only-splat with slash","suites":["never"],"updatePoint":{"line":88,"column":34,"index":3710},"line":88,"code":"  it(`client-only-splat with slash`, () => {\n    cy.getTestElement(`client-only-splat-with`).click();\n    cy.waitForRouteChange().assertRoute(`/client-only-splat/with/with`);\n    cy.getTestElement(`title`).should(`have.text`, `with/with`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"page-creator","suites":["never (direct visits)"],"updatePoint":{"line":98,"column":18,"index":4053},"line":98,"code":"  it(`page-creator`, () => {\n    assertPageVisits([{\n      path: \"/page-2\",\n      status: 200\n    }]);\n    cy.visit(`/page-2`).waitForRouteChange().assertRoute(`/page-2`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"create-page with","suites":["never (direct visits)"],"updatePoint":{"line":105,"column":22,"index":4235},"line":105,"code":"  it(`create-page with`, () => {\n    assertPageVisits([{\n      path: \"/create-page/with/\",\n      status: 301,\n      destinationPath: \"/create-page/with\"\n    }]);\n    cy.visit(`/create-page/with/`).waitForRouteChange().assertRoute(`/create-page/with`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"create-page without","suites":["never (direct visits)"],"updatePoint":{"line":113,"column":25,"index":4496},"line":113,"code":"  it(`create-page without`, () => {\n    assertPageVisits([{\n      path: \"/create-page/without\",\n      status: 200\n    }]);\n    cy.visit(`/create-page/without`).waitForRouteChange().assertRoute(`/create-page/without`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api-simple with","suites":["never (direct visits)"],"updatePoint":{"line":120,"column":24,"index":4719},"line":120,"code":"  it(`fs-api-simple with`, () => {\n    assertPageVisits([{\n      path: \"/fs-api-simple/with/\",\n      status: 301,\n      destinationPath: \"/fs-api-simple/with\"\n    }, {\n      path: \"/fs-api-simple/without\",\n      status: 301,\n      destinationPath: \"/fs-api-simple/without\"\n    }]);\n    cy.visit(`/fs-api-simple/with/`).waitForRouteChange().assertRoute(`/fs-api-simple/with`);\n    cy.visit(`/fs-api-simple/without`).waitForRouteChange().assertRoute(`/fs-api-simple/without`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api-simple without","suites":["never (direct visits)"],"updatePoint":{"line":133,"column":27,"index":5203},"line":133,"code":"  it(`fs-api-simple without`, () => {\n    assertPageVisits([{\n      path: \"/fs-api-simple/without\",\n      status: 200\n    }]);\n    cy.visit(`/fs-api-simple/without`).waitForRouteChange().assertRoute(`/fs-api-simple/without`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api client only splat with","suites":["never (direct visits)"],"updatePoint":{"line":140,"column":35,"index":5443},"line":140,"code":"  it(`fs-api client only splat with`, () => {\n    assertPageVisits([{\n      path: \"/fs-api/with/with/\",\n      status: 301,\n      destinationPath: \"/fs-api/with/with\"\n    }]);\n    cy.visit(`/fs-api/with/with/`).waitForRouteChange().assertRoute(`/fs-api/with/with`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"fs-api client only splat without","suites":["never (direct visits)"],"updatePoint":{"line":148,"column":38,"index":5717},"line":148,"code":"  it(`fs-api client only splat without`, () => {\n    assertPageVisits([{\n      path: \"/fs-api/without/without\",\n      status: 200\n    }]);\n    cy.visit(`/fs-api/without/without`).waitForRouteChange().assertRoute(`/fs-api/without/without`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only with","suites":["never (direct visits)"],"updatePoint":{"line":155,"column":22,"index":5947},"line":155,"code":"  it(`client-only with`, () => {\n    assertPageVisits([{\n      path: \"/client-only/with/\",\n      status: 301,\n      destinationPath: \"/client-only/with\"\n    }]);\n    cy.visit(`/client-only/with/`).waitForRouteChange().assertRoute(`/client-only/with`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only without","suites":["never (direct visits)"],"updatePoint":{"line":163,"column":25,"index":6208},"line":163,"code":"  it(`client-only without`, () => {\n    assertPageVisits([{\n      path: \"/client-only/without\",\n      status: 200\n    }]);\n    cy.visit(`/client-only/without`).waitForRouteChange().assertRoute(`/client-only/without`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only-splat with","suites":["never (direct visits)"],"updatePoint":{"line":170,"column":28,"index":6435},"line":170,"code":"  it(`client-only-splat with`, () => {\n    assertPageVisits([{\n      path: \"/client-only-splat/with/with/\",\n      status: 301,\n      destinationPath: \"/client-only-splat/with/with\"\n    }]);\n    cy.visit(`/client-only-splat/with/with/`).waitForRouteChange().assertRoute(`/client-only-splat/with/with`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"client-only-splat without","suites":["never (direct visits)"],"updatePoint":{"line":178,"column":31,"index":6746},"line":178,"code":"  it(`client-only-splat without`, () => {\n    assertPageVisits([{\n      path: \"/client-only-splat/without/without\",\n      status: 200\n    }]);\n    cy.visit(`/client-only-splat/without/without`).waitForRouteChange().assertRoute(`/client-only-splat/without/without`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"query-param-hash with","suites":["never (direct visits)"],"updatePoint":{"line":185,"column":27,"index":7014},"line":185,"code":"  it(`query-param-hash with`, () => {\n    assertPageVisits([{\n      path: \"/page-2/?query_param=hello#anchor\",\n      status: 301,\n      destinationPath: \"/page-2?query_param=hello#anchor\"\n    }]);\n    cy.visit(`/page-2/?query_param=hello#anchor`).waitForRouteChange().assertRoute(`/page-2?query_param=hello#anchor`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"query-param-hash without","suites":["never (direct visits)"],"updatePoint":{"line":193,"column":30,"index":7340},"line":193,"code":"  it(`query-param-hash without`, () => {\n    assertPageVisits([{\n      path: \"/page-2?query_param=hello#anchor\",\n      status: 200\n    }]);\n    cy.visit(`/page-2?query_param=hello#anchor`).waitForRouteChange().assertRoute(`/page-2?query_param=hello#anchor`);\n  });","file":"trailing-slash/cypress/integration/never.js","skipped":false,"dir":"e2e-tests"},{"name":"visiting with trailing slash returns 404","suites":["static directory","static/nested/index.html"],"updatePoint":{"line":32,"column":48,"index":1126},"line":32,"code":"    it(`visiting with trailing slash returns 404`, () => {\n      assertPageVisits([{\n        path: \"/nested/\",\n        status: 404\n      }]);\n      cy.visit(`/nested/`, {\n        failOnStatusCode: false\n      }).assertRoute(`/nested/`);\n    });","file":"trailing-slash/cypress/integration/static.js","skipped":false,"dir":"e2e-tests"},{"name":"renders correctly on ","suites":["GatsbyImage",""],"updatePoint":{"line":8,"column":50,"index":770},"line":8,"code":"        it(`renders correctly on ${size.join(\"x\")}`, () => {\n          cy.viewport(...size);\n          cy.visit(path);\n          // Wait for main image to load\n          cy.get(\"[data-main-image]\").should(\"exist\");\n          // Wait for blur-up\n          cy.wait(1000);\n          cy.get(\"#test-wrapper\").matchImageSnapshot();\n        });","file":"visual-regression/cypress/integration/image.js","skipped":false,"dir":"e2e-tests"},{"name":"renders correctly on ","suites":["StaticImage",""],"updatePoint":{"line":25,"column":50,"index":1283},"line":25,"code":"        it(`renders correctly on ${size.join(\"x\")}`, () => {\n          cy.viewport(...size);\n          cy.visit(path);\n          // Wait for main image to load\n          cy.get(\"[data-main-image]\").should(\"exist\");\n          // Wait for blur-up\n          cy.wait(1000);\n          cy.get(\"#test-wrapper\").matchImageSnapshot();\n        });","file":"visual-regression/cypress/integration/image.js","skipped":false,"dir":"e2e-tests"},{"name":"respects outputPixelDensities on ","suites":["StaticImage","sharp props"],"updatePoint":{"line":37,"column":60,"index":1685},"line":37,"code":"      it(`respects outputPixelDensities on ${size.join(\"x\")}`, () => {\n        cy.viewport(...size);\n        cy.visit(\"/static-images/sharp-props\");\n        // Wait for main image to load\n        cy.get(\"[data-main-image]\").should(\"exist\");\n        // Check srcset for 1x, 2x, 3x\n        cy.get(\"[data-main-image]\").then(img => {\n          expect(img[0].attributes.srcset.value).to.contain(`300w`);\n          expect(img[0].attributes.srcset.value).to.contain(`600w`);\n          expect(img[0].attributes.srcset.value).to.contain(`900w`);\n        });\n      });","file":"visual-regression/cypress/integration/image.js","skipped":false,"dir":"e2e-tests"},{"name":"Transforms queries in useStaticQuery","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":59,"column":42,"index":1608},"line":59,"code":"  it(`Transforms queries in useStaticQuery`, () => {\n    matchesSnapshot(`\n  import * as React from 'react'\n  import { graphql, useStaticQuery } from 'gatsby'\n\n  export default () => {\n    const siteTitle = useStaticQuery(graphql\\`{site { siteMetadata { title }}}\\`)\n\n    return (\n      <h1>{siteTitle.site.siteMetadata.title}</h1>\n    )\n  }\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Transforms queries in useStaticQuery that use commonjs","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":73,"column":60,"index":1980},"line":73,"code":"  it(`Transforms queries in useStaticQuery that use commonjs`, () => {\n    matchesSnapshot(`\n  const React = require(\"react\")\n  const { graphql, useStaticQuery } = require(\"gatsby\")\n\n  module.exports = () => {\n    const siteTitle = useStaticQuery(graphql\\`{site { siteMetadata { title }}}\\`)\n\n    return (\n      <h1>{siteTitle.site.siteMetadata.title}</h1>\n    )\n  }\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Transforms exported queries in useStaticQuery","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":87,"column":51,"index":2350},"line":87,"code":"  it(`Transforms exported queries in useStaticQuery`, () => {\n    matchesSnapshot(`\n  import * as React from 'react'\n  import { graphql, useStaticQuery } from 'gatsby'\n\n  export default () => {\n    const data = useStaticQuery(query)\n\n    return (\n      <>\n        <h1>{data.site.siteMetadata.title}</h1>\n        <p>{data.site.siteMetadata.description}</p>\n      </>\n    )\n  }\n\n  export const query = graphql\\`{site { siteMetadata { title }}}\\`\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Transforms queries defined in own variable in useStaticQuery","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":106,"column":66,"index":2821},"line":106,"code":"  it(`Transforms queries defined in own variable in useStaticQuery`, () => {\n    matchesSnapshot(`\n  import * as React from 'react'\n  import { graphql, useStaticQuery } from 'gatsby'\n\n  export default () => {\n    const query = graphql\\`{site { siteMetadata { title }}}\\`\n    const siteTitle = useStaticQuery(query)\n\n    return (\n      <h1>{siteTitle.site.siteMetadata.title}</h1>\n    )\n  }\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Transforms queries and preserves destructuring in useStaticQuery","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":121,"column":70,"index":3227},"line":121,"code":"  it(`Transforms queries and preserves destructuring in useStaticQuery`, () => {\n    matchesSnapshot(`\n  import * as React from 'react'\n  import { graphql, useStaticQuery } from 'gatsby'\n\n  export default () => {\n    const query = graphql\\`{site { siteMetadata { title }}}\\`\n    const { site } = useStaticQuery(query)\n\n    return (\n      <h1>{site.siteMetadata.title}</h1>\n    )\n  }\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Transforms queries and preserves variable type in useStaticQuery","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":136,"column":70,"index":3622},"line":136,"code":"  it(`Transforms queries and preserves variable type in useStaticQuery`, () => {\n    matchesSnapshot(`\n  import * as React from 'react'\n  import { graphql, useStaticQuery } from 'gatsby'\n\n  export default () => {\n    const query = graphql\\`{site { siteMetadata { title }}}\\`\n    let { site } = useStaticQuery(query)\n\n    return (\n      <h1>{site.siteMetadata.title}</h1>\n    )\n  }\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Transformation does not break custom hooks","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":151,"column":48,"index":3993},"line":151,"code":"  it(`Transformation does not break custom hooks`, () => {\n    matchesSnapshot(`\n  import React from \"react\"\n  import { graphql, useStaticQuery } from \"gatsby\"\n\n  const useSiteMetadata = () => {\n    const data = useStaticQuery(graphql\\`{site { siteMetadata { title }}}\\`)\n    return data.site.siteMetadata\n  }\n\n  export default () => {\n    const siteMetadata = useSiteMetadata()\n\n    return <h1>{site.siteMetadata.title}</h1>\n  }\n\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Transforms only the call expression in useStaticQuery","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":169,"column":59,"index":4447},"line":169,"code":"  it(`Transforms only the call expression in useStaticQuery`, () => {\n    matchesSnapshot(`\n  import React from \"react\"\n  import { graphql, useStaticQuery } from \"gatsby\"\n\n  const useSiteMetadata = () => {\n    return useStaticQuery(\n      graphql\\`{site { siteMetadata { title }}}\\`\n    ).site.siteMetadata\n  }\n\n  export default () => {\n    const siteMetadata = useSiteMetadata()\n\n    return <h1>{siteMetadata.title}</h1>\n  }\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Only runs transforms if useStaticQuery is imported from gatsby","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":187,"column":68,"index":4894},"line":187,"code":"  it(`Only runs transforms if useStaticQuery is imported from gatsby`, () => {\n    matchesSnapshot(`\n  import * as React from 'react'\n  import { graphql } from 'gatsby'\n\n  export default () => {\n    const query = graphql\\`{site { siteMetadata { title }}}\\`\n    const siteTitle = useStaticQuery(query)\n\n    return (\n      <h1>{siteTitle.site.siteMetadata.title}</h1>\n    )\n  }\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Allow alternative import of useStaticQuery","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":202,"column":48,"index":5262},"line":202,"code":"  it(`Allow alternative import of useStaticQuery`, () => {\n    matchesSnapshot(`\n  import * as React from 'react'\n  import * as Gatsby from 'gatsby'\n\n  export default () => {\n    const query = Gatsby.graphql\\`{site { siteMetadata { title }}}\\`\n    const siteTitle = Gatsby.useStaticQuery(query)\n\n    return (\n      <h1>{siteTitle.site.siteMetadata.title}</h1>\n    )\n  }\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Transforms queries in <StaticQuery>","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":217,"column":41,"index":5637},"line":217,"code":"  it(`Transforms queries in <StaticQuery>`, () => {\n    matchesSnapshot(`\n  import * as React from 'react'\n  import { graphql, StaticQuery } from 'gatsby'\n\n  export default () => (\n    <StaticQuery\n      query={graphql\\`{site { siteMetadata { title }}}\\`}\n      render={data => <div>{data.site.siteMetadata.title}</div>}\n    />\n  )\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Transforms queries defined in own variable in <StaticQuery>","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":230,"column":65,"index":6005},"line":230,"code":"  it(`Transforms queries defined in own variable in <StaticQuery>`, () => {\n    matchesSnapshot(`\n  import * as React from 'react'\n  import { graphql, StaticQuery } from 'gatsby'\n\n  const query = graphql\\`{site { siteMetadata { title }}}\\`\n\n  export default () => (\n    <StaticQuery\n      query={query}\n      render={data => <div>{data.site.siteMetadata.title}</div>}\n    />\n  )\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"transforms exported variable queries in <StaticQuery>","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":245,"column":59,"index":6390},"line":245,"code":"  it(`transforms exported variable queries in <StaticQuery>`, () => {\n    matchesSnapshot(`\n  import * as React from 'react'\n  import { graphql, StaticQuery } from 'gatsby'\n\n  export const query = graphql\\`{site { siteMetadata { title }}}\\`\n\n  export default () => (\n    <StaticQuery\n      query={query}\n      render={data => <div>{data.site.siteMetadata.title}</div>}\n    />\n  )\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Transforms queries in page components","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":260,"column":43,"index":6766},"line":260,"code":"  it(`Transforms queries in page components`, () => {\n    matchesSnapshot(`\n  import { graphql } from 'gatsby'\n\n  export const query = graphql\\`\n     {\n       site { siteMetadata { title }}\n     }\n  \\`\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"allows the global tag","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":271,"column":27,"index":6964},"line":271,"code":"  it(`allows the global tag`, () => {\n    matchesSnapshot(`\n  export const query = graphql\\`\n     {\n       site { siteMetadata { title }}\n     }\n  \\`\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"distinguishes between the right tags","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":280,"column":42,"index":7141},"line":280,"code":"  it(`distinguishes between the right tags`, () => {\n    matchesSnapshot(`\n  const foo = styled('div')\\`\n     {\n       $\\{foo}\n     }\n  \\`\n\n  const pulse = keyframes\\`\n    0% {\n      transform: scale(1);\n      animation-timing-function: ease-in;\n    }\n    25% {\n      animation-timing-function: ease-out;\n      transform: scale(1.05);\n    }\n    50% {\n      transform: scale(1.12);\n      animation-timing-function: ease-in;\n    }\n    to {\n      transform: scale(1);\n      animation-timing-function: ease-out;\n    }\n  \\`;\n\n  export const query = graphql\\`\n     {\n       site { siteMetadata { title }}\n     }\n  \\`\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"handles import aliasing","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":314,"column":29,"index":7751},"line":314,"code":"  it(`handles import aliasing`, () => {\n    matchesSnapshot(`\n  import { graphql as gql } from 'gatsby'\n\n  export const query = gql\\`\n     {\n       site { siteMetadata { title }}\n     }\n  \\`\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"handles require","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":325,"column":21,"index":7946},"line":325,"code":"  it(`handles require`, () => {\n    matchesSnapshot(`\n  const { graphql } = require('gatsby')\n\n  export const query = graphql\\`\n     {\n       site { siteMetadata { title }}\n     }\n  \\`\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"handles require namespace","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":336,"column":31,"index":8153},"line":336,"code":"  it(`handles require namespace`, () => {\n    matchesSnapshot(`\n  const Gatsby = require('gatsby')\n\n  export const query = Gatsby.graphql\\`\n     {\n       site { siteMetadata { title }}\n     }\n  \\`\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"handles require alias","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":347,"column":27,"index":8358},"line":347,"code":"  it(`handles require alias`, () => {\n    matchesSnapshot(`\n  const { graphql: gql } = require('gatsby')\n\n  export const query = gql\\`\n     {\n       site { siteMetadata { title }}\n     }\n  \\`\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Leaves other graphql tags alone","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":358,"column":37,"index":8572},"line":358,"code":"  it(`Leaves other graphql tags alone`, () => {\n    matchesSnapshot(`\n  import * as React from 'react'\n  import { graphql } from 'relay'\n\n  export default () => (\n    <div>{data.site.siteMetadata.title}</div>\n  )\n\n  export const query = graphql\\`\n     {\n       site { siteMetadata { title }}\n     }\n  \\`\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Removes all gatsby queries","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":374,"column":32,"index":8883},"line":374,"code":"  it(`Removes all gatsby queries`, () => {\n    matchesSnapshot(`\n  import { graphql } from 'gatsby'\n\n  export default () => (\n    <div>{data.site.siteMetadata.title}</div>\n  )\n\n  export const siteMetaQuery = graphql\\`\n    fragment siteMetaQuery on RootQueryType {\n      site {\n        siteMetadata {\n          title\n        }\n      }\n    }\n  \\`\n\n  export const query = graphql\\`\n     {\n       ...siteMetaQuery\n     }\n  \\`\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Handles closing StaticQuery tag","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":399,"column":37,"index":9322},"line":399,"code":"  it(`Handles closing StaticQuery tag`, () => {\n    matchesSnapshot(`\n  import * as React from 'react'\n  import { graphql, StaticQuery } from 'gatsby'\n\n  export default () => (\n    <StaticQuery\n      query={graphql\\`{site { siteMetadata { title }}}\\`}\n    >\n      {data => <div>{data.site.siteMetadata.title}</div>}\n    </StaticQuery>\n  )\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Doesn't add data import for non static queries","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":413,"column":52,"index":9688},"line":413,"code":"  it(`Doesn't add data import for non static queries`, () => {\n    matchesSnapshot(`\n  import * as React from 'react'\n  import { StaticQuery, graphql } from \"gatsby\"\n\n  const Test = () => (\n    <StaticQuery\n      query={graphql\\`\n      {\n        site {\n          siteMetadata {\n            title\n          }\n        }\n      }\n      \\`}\n      render={data => <div>{data.site.siteMetadata.title}</div>}\n    />\n  )\n\n  export default Test\n\n  export const fragment = graphql\\`\n    fragment MarkdownNodeFragment on MarkdownRemark {\n      html\n    }\n  \\`\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"Replaces graphql query inside config with global call","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":442,"column":59,"index":10255},"line":442,"code":"  it(`Replaces graphql query inside config with global call`, () => {\n    matchesSnapshot(`\n  import * as React from 'react'\n  import { graphql } from \"gatsby\"\n\n  const Test = () => (\n    <div></div>\n  )\n\n  export default Test\n\n  export async function config() {\n    const data = graphql\\`{ __typename }\\`\n\n    return () => {\n      return {\n        defer: true\n      }\n    }\n  }\n  `);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"validates that config export is async","suites":["babel-plugin-remove-graphql-queries"],"updatePoint":{"line":464,"column":43,"index":10630},"line":464,"code":"  it(`validates that config export is async`, () => {\n    const run = () => transform(`\n  import * as React from 'react'\n  import { graphql } from \"gatsby\"\n\n  const Test = () => (\n    <div></div>\n  )\n\n  export default Test\n\n  export function config() {\n    const data = graphql\\`{ __typename }\\`\n\n    return () => {\n      return {\n        defer: true\n      }\n    }\n  }\n  `);\n    expect(run).toThrowErrorMatchingInlineSnapshot(`\"unknown file: BabelPluginRemoveGraphQLQueries: the \\\\\"config\\\\\" export must be async when using it with graphql\"`);\n  });","file":"index.ts","skipped":false,"dir":"packages/babel-plugin-remove-graphql-queries/src/__tests__"},{"name":"should specify proper presets and plugins","suites":["dependencies"],"updatePoint":{"line":8,"column":47},"line":8,"code":"  it(`should specify proper presets and plugins`, () => {\n    expect(preset()).toMatchSnapshot()\n  })","file":"dependencies.ts","skipped":false,"dir":"packages/babel-preset-gatsby/src/__tests__"},{"name":"should specify proper presets and plugins when stage is %s","suites":["babel-preset-gatsby"],"line":18,"code":"  it.each([`develop-html`, `develop`, `build-javascript`, `build-html`])(\n    `should specify proper presets and plugins when stage is %s`,\n    stage => {\n      expect(preset(null, { stage })).toMatchSnapshot()\n    }\n  )","file":"index.js","skipped":false,"dir":"packages/babel-preset-gatsby/src/__tests__"},{"name":"Allows to configure browser targets","suites":["babel-preset-gatsby"],"updatePoint":{"line":25,"column":41},"line":25,"code":"  it(`Allows to configure browser targets`, () => {\n    const targets = `last 1 version`\n    const { presets } = preset(null, {\n      stage: `build-javascript`,\n      targets,\n    })\n\n    expect(presets[0]).toEqual([\n      expect.stringContaining(path.join(`@babel`, `preset-env`)),\n      expect.objectContaining({\n        targets,\n      }),\n    ])\n  })","file":"index.js","skipped":false,"dir":"packages/babel-preset-gatsby/src/__tests__"},{"name":"Allows to configure react runtime","suites":["babel-preset-gatsby"],"updatePoint":{"line":40,"column":39},"line":40,"code":"  it(`Allows to configure react runtime`, () => {\n    const { presets } = preset(null, {\n      reactRuntime: `automatic`,\n    })\n\n    expect(presets[1]).toEqual([\n      expect.stringContaining(path.join(`@babel`, `preset-react`)),\n      expect.objectContaining({\n        pragma: undefined,\n        runtime: `automatic`,\n      }),\n    ])\n  })","file":"index.js","skipped":false,"dir":"packages/babel-preset-gatsby/src/__tests__"},{"name":"Allows to configure react importSource","suites":["babel-preset-gatsby"],"updatePoint":{"line":54,"column":44},"line":54,"code":"  it(`Allows to configure react importSource`, () => {\n    const { presets } = preset(null, {\n      reactImportSource: `@emotion/react`,\n      reactRuntime: `automatic`,\n    })\n\n    expect(presets[1]).toEqual([\n      expect.stringContaining(path.join(`@babel`, `preset-react`)),\n      expect.objectContaining({\n        importSource: `@emotion/react`,\n      }),\n    ])\n  })","file":"index.js","skipped":false,"dir":"packages/babel-preset-gatsby/src/__tests__"},{"name":"Fails to configure react importSource if source is classic","suites":["babel-preset-gatsby"],"updatePoint":{"line":68,"column":64},"line":68,"code":"  it(`Fails to configure react importSource if source is classic`, () => {\n    expect(() => preset(null, { reactImportSource: `@emotion/react` })).toThrow(\n      `@babel/preset-react\\` requires reactRuntime \\`automatic\\` in order to use \\`importSource\\`.`\n    )\n  })","file":"index.js","skipped":false,"dir":"packages/babel-preset-gatsby/src/__tests__"},{"name":"should transform Array-destructured hook return values use object destructuring","suites":["optimize-hook-destructuring"],"updatePoint":{"line":23,"column":85},"line":23,"code":"  it(`should transform Array-destructured hook return values use object destructuring`, () => {\n    const output = babel(\n      trim`\n      import { useState } from 'react';\n      const [count, setCount] = useState(0);\n    `\n    )\n\n    expect(output).toMatch(trim`\n    \\\"use strict\\\";var _react=require(\\\"react\\\");const{0:count,1:setCount}=(0,_react.useState)(0);\n    `)\n\n    expect(output).toMatchInlineSnapshot(\n      `\"\\\\\"use strict\\\\\";var _react=require(\\\\\"react\\\\\");const{0:count,1:setCount}=(0,_react.useState)(0);\"`\n    )\n  })","file":"optimize-hook-destructuring.js","skipped":false,"dir":"packages/babel-preset-gatsby/src/__tests__"},{"name":"should handle skipped items","suites":["optimize-hook-destructuring"],"updatePoint":{"line":40,"column":33},"line":40,"code":"  it(`should handle skipped items`, () => {\n    const input = trim`\n      import { useState } from 'react';\n      const [, setCount] = useState(0);\n    `\n\n    expect(() => babel(input)).not.toThrow()\n    expect(babel(input)).toMatchInlineSnapshot(\n      `\"\\\\\"use strict\\\\\";var _react=require(\\\\\"react\\\\\");const{1:setCount}=(0,_react.useState)(0);\"`\n    )\n  })","file":"optimize-hook-destructuring.js","skipped":false,"dir":"packages/babel-preset-gatsby/src/__tests__"},{"name":"reports an error when it s not possible to clone the repo","suites":["init-starter","initStarter / cloning"],"updatePoint":{"line":51,"column":65},"line":51,"code":"    it(`reports an error when it s not possible to clone the repo`, async () => {\n      ;(path as any).join.mockImplementation(() => `/somewhere-here`)\n      ;(execa as any).mockImplementation(() => {\n        throw new Error(`Not possible to clone the repo`)\n      })\n\n      try {\n        await initStarter(\n          `gatsby-starter-hello-world`,\n          `./somewhere`,\n          [],\n          `A site`\n        )\n      } catch (e) {\n        expect(execa).toBeCalledWith(`git`, [\n          `clone`,\n          `gatsby-starter-hello-world`,\n          `--recursive`,\n          `--depth=1`,\n          `--quiet`,\n        ])\n        expect(reporter.panic).toBeCalledWith(`Not possible to clone the repo`)\n        expect(reporter.success).not.toBeCalledWith(\n          `Created site from template`\n        )\n        expect(fs.remove).toBeCalledWith(`/somewhere-here`)\n      }\n    })","file":"init-starter.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"reports a success when everything is going ok","suites":["init-starter","initStarter / cloning"],"updatePoint":{"line":80,"column":53},"line":80,"code":"    it(`reports a success when everything is going ok`, async () => {\n      ;(path as any).join.mockImplementation(() => `/somewhere-here`)\n      ;(execa as any).mockImplementation(() => Promise.resolve())\n      ;(fs as any).readJSON.mockImplementation(() => {\n        return { name: `gatsby-project` }\n      })\n\n      await initStarter(\n        `gatsby-starter-hello-world`,\n        `./somewhere`,\n        [],\n        `A site`\n      )\n\n      expect(execa).toBeCalledWith(`git`, [\n        `clone`,\n        `gatsby-starter-hello-world`,\n        `--recursive`,\n        `--depth=1`,\n        `--quiet`,\n      ])\n      expect(reporter.panic).not.toBeCalled()\n      expect(reporter.success).toBeCalledWith(`Created site from template`)\n      expect(fs.remove).toBeCalledWith(`/somewhere-here`)\n    })","file":"init-starter.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"process package installation with yarn","suites":["init-starter","initStarter / install"],"updatePoint":{"line":108,"column":46},"line":108,"code":"    it(`process package installation with yarn`, async () => {\n      process.env.npm_config_user_agent = `yarn`\n      ;(path as any).join.mockImplementation(() => `/somewhere-here`)\n      ;(execa as any).mockImplementation(() => Promise.resolve())\n      ;(fs as any).readJSON.mockImplementation(() => {\n        return { name: `gatsby-project` }\n      })\n\n      await initStarter(\n        `gatsby-starter-hello-world`,\n        `./somewhere`,\n        [],\n        `A site`\n      )\n\n      expect(fs.remove).toBeCalledWith(`package-lock.json`)\n      expect(reporter.success).toBeCalledWith(`Installed plugins`)\n      expect(reporter.panic).not.toBeCalled()\n      expect(execa).toBeCalledWith(`yarnpkg`, [`--silent`], {\n        stderr: `inherit`,\n      })\n    })","file":"init-starter.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"process package installation with NPM","suites":["init-starter","initStarter / install"],"updatePoint":{"line":131,"column":45},"line":131,"code":"    it(`process package installation with NPM`, async () => {\n      process.env.npm_config_user_agent = `npm`\n      ;(path as any).join.mockImplementation(() => `/somewhere-here`)\n      ;(execa as any).mockImplementation(() => Promise.resolve())\n      ;(fs as any).readJSON.mockImplementation(() => {\n        return { name: `gatsby-project` }\n      })\n\n      await initStarter(\n        `gatsby-starter-hello-world`,\n        `./somewhere`,\n        [`one-package`],\n        `A site`\n      )\n\n      expect(fs.remove).toBeCalledWith(`yarn.lock`)\n      expect(reporter.success).toBeCalledWith(`Installed Gatsby`)\n      expect(reporter.success).toBeCalledWith(`Installed plugins`)\n      expect(reporter.panic).not.toBeCalled()\n      expect(execa).toBeCalledWith(\n        `npm`,\n        [\n          `install`,\n          `--loglevel`,\n          `error`,\n          `--color`,\n          `always`,\n          `--legacy-peer-deps`,\n          `--no-audit`,\n        ],\n        { stderr: `inherit` }\n      )\n      expect(execa).toBeCalledWith(\n        `npm`,\n        [\n          `install`,\n          `--loglevel`,\n          `error`,\n          `--color`,\n          `always`,\n          `--legacy-peer-deps`,\n          `--no-audit`,\n          `one-package`,\n        ],\n        { stderr: `inherit` }\n      )\n    })","file":"init-starter.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"gently informs the user that yarn is not available when trying to use it","suites":["init-starter","initStarter / install"],"updatePoint":{"line":179,"column":80},"line":179,"code":"    it(`gently informs the user that yarn is not available when trying to use it`, async () => {\n      process.env.npm_config_user_agent = `yarn`\n      ;(execSync as any).mockImplementation(() => {\n        throw new Error(`Something wrong occurred when trying to use yarn`)\n      })\n      ;(path as any).join.mockImplementation(() => `/somewhere-here`)\n      ;(execa as any).mockImplementation(() => Promise.resolve())\n      ;(fs as any).readJSON.mockImplementation(() => {\n        return { name: `gatsby-project` }\n      })\n\n      await initStarter(\n        `gatsby-starter-hello-world`,\n        `./somewhere`,\n        [`one-package`],\n        `A site`\n      )\n\n      expect(reporter.info).toBeCalledWith(\n        `Woops! You have chosen \"yarn\" as your package manager, but it doesn't seem be installed on your machine. You can install it from https://yarnpkg.com/getting-started/install or change your preferred package manager with the command \"gatsby options set pm npm\". As a fallback, we will run the next steps with npm.`\n      )\n    })","file":"init-starter.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"reports an error explaining that gatsby is not installed","suites":["install-plugins"],"updatePoint":{"line":22,"column":62},"line":22,"code":"  it(`reports an error explaining that gatsby is not installed`, async () => {\n    ;(requireResolve as jest.Mock).mockImplementation(() => undefined)\n\n    await installPlugins([], {}, `not-existing-path`, [])\n\n    // Test function behaviour but improves the DX, it probably worth it\n    expect(reporter.error).toBeCalledWith(\n      `Could not find \"gatsby\" in not-existing-path. Perhaps it wasn't installed properly?`\n    )\n  })","file":"install-plugins.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"reports an error when the gatsby cli is not installed","suites":["install-plugins"],"updatePoint":{"line":33,"column":59},"line":33,"code":"  it(`reports an error when the gatsby cli is not installed`, async () => {\n    ;(requireResolve as jest.Mock).mockImplementation(path => {\n      if (\n        path === `gatsby-cli/lib/handlers/plugin-add` ||\n        path === `gatsby-cli/lib/plugin-add`\n      ) {\n        throw new Error()\n      }\n      return `somewhere-i-belong`\n    })\n\n    await installPlugins([], {}, `not-existing-path`, [])\n\n    // Test function behaviour but improves the DX, it probably worth it\n    expect(reporter.error).toBeCalledWith(\n      `Could not find a suitable version of gatsby-cli. Please report this issue at https://www.github.com/gatsbyjs/gatsby/issues`\n    )\n  })","file":"install-plugins.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"reports an error when add plugins fails somehow","suites":["install-plugins"],"updatePoint":{"line":52,"column":53},"line":52,"code":"  it(`reports an error when add plugins fails somehow`, async () => {\n    ;(requireResolve as jest.Mock).mockImplementation(\n      () => `somewhere-virtually-existing`\n    )\n\n    await installPlugins([], {}, `not-existing-path`, [])\n\n    // Test function behaviour but improves the DX, it probably worth it\n    expect(reporter.error).toBeCalledWith(\n      `Something went wrong when trying to add the plugins to the project: addPlugins is not a function`\n    )\n  })","file":"install-plugins.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"returns an empty array when nothing is passed","suites":["plugin-options-form"],"updatePoint":{"line":5,"column":51},"line":5,"code":"  it(`returns an empty array when nothing is passed`, () => {\n    const plugins = []\n    expect(makePluginConfigQuestions(plugins)).toEqual([])\n  })","file":"plugin-options-form.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"returns an empty array when the plugin is not available for config","suites":["plugin-options-form"],"updatePoint":{"line":10,"column":72},"line":10,"code":"  it(`returns an empty array when the plugin is not available for config`, () => {\n    const plugins = [`not-valid-plugin`]\n    expect(makePluginConfigQuestions(plugins)).toEqual([])\n  })","file":"plugin-options-form.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"returns an array containing only the wordpress options (choices are included)","suites":["plugin-options-form"],"updatePoint":{"line":15,"column":83},"line":15,"code":"  it(`returns an array containing only the wordpress options (choices are included)`, () => {\n    const plugins = [`gatsby-source-wordpress`]\n    expect(makePluginConfigQuestions(plugins)).toEqual([\n      {\n        type: `forminput`,\n        name: `gatsby-source-wordpress`,\n        multiple: true,\n        message: `Configure the WordPress plugin.\\nSee \\u001b[94mhttps://www.gatsbyjs.com/plugins/gatsby-source-wordpress/\\u001b[39m for help.`,\n        choices: [\n          {\n            name: `url`,\n            message: `url`,\n            hint: `This should be the full url of your GraphQL endpoint set up by WP GraphQL`,\n          },\n        ],\n      },\n    ])\n  })","file":"plugin-options-form.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"returns an array with all the plugins schemas","suites":["plugin-options-form"],"updatePoint":{"line":34,"column":51},"line":34,"code":"  it(`returns an array with all the plugins schemas`, () => {\n    expect(makePluginConfigQuestions(Object.keys(pluginSchemas))).toEqual([\n      {\n        type: `forminput`,\n        name: `gatsby-source-wordpress`,\n        multiple: true,\n        message: `Configure the WordPress plugin.\\nSee \\u001b[94mhttps://www.gatsbyjs.com/plugins/gatsby-source-wordpress/\\u001b[39m for help.`,\n        choices: [\n          {\n            name: `url`,\n            message: `url`,\n            hint: `This should be the full url of your GraphQL endpoint set up by WP GraphQL`,\n          },\n        ],\n      },\n      {\n        type: `forminput`,\n        name: `gatsby-source-contentful`,\n        multiple: true,\n        message: `Configure the Contentful plugin.\\nSee \\u001b[94mhttps://www.gatsbyjs.com/plugins/gatsby-source-contentful/\\u001b[39m for help.\\n\\u001b[32mUse arrow keys to move between fields, and enter to finish\\u001b[39m`,\n        choices: [\n          {\n            name: `accessToken`,\n            message: `accessToken`,\n            hint: `Contentful delivery api key, when using the Preview API use your Preview API key`,\n          },\n          { name: `spaceId`, message: `spaceId`, hint: `Contentful spaceId` },\n        ],\n      },\n      {\n        type: `forminput`,\n        name: `gatsby-source-sanity`,\n        multiple: true,\n        message: `Configure the Sanity plugin.\\nSee \\u001b[94mhttps://www.gatsbyjs.com/plugins/gatsby-source-sanity/\\u001b[39m for help.\\n\\u001b[32mUse arrow keys to move between fields, and enter to finish\\u001b[39m`,\n        choices: [\n          {\n            name: `projectId`,\n            message: `projectId`,\n            hint: `Your Sanity project's ID`,\n          },\n          {\n            name: `dataset`,\n            message: `dataset`,\n            hint: `The dataset to fetch from`,\n          },\n        ],\n      },\n      {\n        type: `forminput`,\n        name: `gatsby-source-shopify`,\n        multiple: true,\n        message: `Configure the Shopify plugin.\\nSee \\u001b[94mhttps://www.gatsbyjs.com/plugins/gatsby-source-shopify/\\u001b[39m for help.\\n\\u001b[32mUse arrow keys to move between fields, and enter to finish\\u001b[39m`,\n        choices: [\n          {\n            name: `shopName`,\n            message: `shopName`,\n            hint: `The domain name of your Shopify shop`,\n          },\n          {\n            name: `accessToken`,\n            message: `accessToken`,\n            hint: `An API access token to your Shopify shop`,\n          },\n        ],\n      },\n      {\n        type: `forminput`,\n        name: `gatsby-source-datocms`,\n        multiple: true,\n        message: `Configure the DatoCMS plugin.\\nSee \\u001b[94mhttps://www.gatsbyjs.com/plugins/gatsby-source-datocms/\\u001b[39m for help.`,\n        choices: [\n          {\n            name: `apiToken`,\n            message: `apiToken`,\n            hint: `Your read-only API token under the Settings > API tokens section of your administrative area in DatoCMS`,\n          },\n        ],\n      },\n      {\n        type: `forminput`,\n        name: `gatsby-source-agility`,\n        multiple: true,\n        message: `Configure the gatsby-source-agility plugin.\\nSee \\u001b[94mhttps://www.gatsbyjs.com/plugins/gatsby-source-agility/\\u001b[39m for help.`,\n        choices: [\n          {\n            name: `guid`,\n            message: `guid`,\n            hint: `your Agility Content Fetch API Guid`,\n          },\n        ],\n      },\n      {\n        type: `forminput`,\n        name: `gatsby-plugin-google-analytics`,\n        multiple: true,\n        message: `Configure the gatsby-plugin-google-analytics plugin.\\nSee \\u001b[94mhttps://www.gatsbyjs.com/plugins/gatsby-plugin-google-analytics/\\u001b[39m for help.`,\n        choices: [\n          {\n            name: `trackingId`,\n            message: `trackingId`,\n            hint: `The property ID; the tracking code won't be generated without it`,\n          },\n        ],\n      },\n    ])\n  })","file":"plugin-options-form.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should use siteName as site title","suites":["run","gatsby-config.js "],"updatePoint":{"line":103,"column":41},"line":103,"code":"    it(`should use siteName as site title`, async () => {\n      await run()\n      expect(setSiteMetadata).toHaveBeenCalledWith(fullPath, `title`, siteName)\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should welcome the user","suites":["run","no skip flag"],"updatePoint":{"line":117,"column":31},"line":117,"code":"    it(`should welcome the user`, async () => {\n      await run()\n      expect(reporter.info).toHaveBeenCalledWith(\n        expect.stringContaining(`Welcome to Gatsby!`)\n      )\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should communicate setup questions will be asked","suites":["run","no skip flag"],"updatePoint":{"line":123,"column":56},"line":123,"code":"    it(`should communicate setup questions will be asked`, async () => {\n      await run()\n      expect(reporter.info).toHaveBeenCalledWith(\n        expect.stringContaining(\n          `This command will generate a new Gatsby site for you`\n        )\n      )\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should confirm actions","suites":["run","no skip flag"],"updatePoint":{"line":131,"column":30},"line":131,"code":"    it(`should confirm actions`, async () => {\n      await run()\n      expect(reporter.info).toHaveBeenCalledWith(\n        expect.stringContaining(`Thanks! Here's what we'll now do`)\n      )\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should notify of successful site creation","suites":["run","no skip flag"],"updatePoint":{"line":137,"column":49},"line":137,"code":"    it(`should notify of successful site creation`, async () => {\n      await run()\n      expect(reporter.success).toHaveBeenCalledWith(\n        expect.stringContaining(`Created site`)\n      )\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should welcome the user","suites":["run","skip flag"],"updatePoint":{"line":153,"column":31},"line":153,"code":"    it(`should welcome the user`, async () => {\n      await run()\n      expect(reporter.info).toHaveBeenCalledWith(\n        expect.stringContaining(`Welcome to Gatsby!`)\n      )\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should not communicate setup questions","suites":["run","skip flag"],"updatePoint":{"line":159,"column":46},"line":159,"code":"    it(`should not communicate setup questions`, async () => {\n      await run()\n      expect(reporter.info).not.toHaveBeenCalledWith(\n        expect.stringContaining(\n          `This command will generate a new Gatsby site for you`\n        )\n      )\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should not confirm actions","suites":["run","skip flag"],"updatePoint":{"line":167,"column":34},"line":167,"code":"    it(`should not confirm actions`, async () => {\n      await run()\n      expect(reporter.info).not.toHaveBeenCalledWith(\n        expect.stringContaining(`Thanks! Here's what we'll now do`)\n      )\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should notify of successful site creation","suites":["run","skip flag"],"updatePoint":{"line":173,"column":49},"line":173,"code":"    it(`should notify of successful site creation`, async () => {\n      await run()\n      expect(reporter.success).toHaveBeenCalledWith(\n        expect.stringContaining(`Created site`)\n      )\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should use the JS starter by default","suites":["run","skip flag"],"updatePoint":{"line":179,"column":44},"line":179,"code":"    it(`should use the JS starter by default`, async () => {\n      await run()\n      expect(initStarter).toHaveBeenCalledWith(\n        DEFAULT_STARTERS.js,\n        dirName,\n        [],\n        dirName\n      )\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should track JS was selected as language","suites":["run","skip flag"],"updatePoint":{"line":188,"column":48},"line":188,"code":"    it(`should track JS was selected as language`, async () => {\n      await run()\n      expect(trackCli).toHaveBeenCalledWith(`CREATE_GATSBY_SELECT_OPTION`, {\n        name: `LANGUAGE`,\n        valueString: `js`,\n      })\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should use the JS starter","suites":["run","no ts flag"],"updatePoint":{"line":205,"column":33},"line":205,"code":"    it(`should use the JS starter`, async () => {\n      await run()\n      expect(initStarter).toHaveBeenCalledWith(\n        DEFAULT_STARTERS.js,\n        dirName,\n        [],\n        siteName\n      )\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should track JS was selected as language","suites":["run","no ts flag"],"updatePoint":{"line":214,"column":48},"line":214,"code":"    it(`should track JS was selected as language`, async () => {\n      await run()\n      expect(trackCli).toHaveBeenCalledWith(`CREATE_GATSBY_SELECT_OPTION`, {\n        name: `LANGUAGE`,\n        valueString: `js`,\n      })\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should use the TS starter","suites":["run","ts flag"],"updatePoint":{"line":231,"column":33},"line":231,"code":"    it(`should use the TS starter`, async () => {\n      await run()\n      expect(initStarter).toHaveBeenCalledWith(\n        DEFAULT_STARTERS.ts,\n        dirName,\n        [],\n        siteName\n      )\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should track TS was selected as language","suites":["run","ts flag"],"updatePoint":{"line":241,"column":48},"line":241,"code":"    it(`should track TS was selected as language`, async () => {\n      await run()\n      expect(trackCli).toHaveBeenCalledWith(`CREATE_GATSBY_SELECT_OPTION`, {\n        name: `LANGUAGE`,\n        valueString: `ts`,\n      })\n    })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should use the TS starter","suites":["skip and ts flag"],"updatePoint":{"line":259,"column":31},"line":259,"code":"  it(`should use the TS starter`, async () => {\n    await run()\n    expect(initStarter).toHaveBeenCalledWith(\n      DEFAULT_STARTERS.ts,\n      dirName,\n      [],\n      dirName\n    )\n  })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should track TS was selected as language","suites":["skip and ts flag"],"updatePoint":{"line":268,"column":46},"line":268,"code":"  it(`should track TS was selected as language`, async () => {\n    await run()\n    expect(trackCli).toHaveBeenCalledWith(`CREATE_GATSBY_SELECT_OPTION`, {\n      name: `LANGUAGE`,\n      valueString: `ts`,\n    })\n  })","file":"run.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"is enabled by default","suites":["isTrackingEnabled"],"updatePoint":{"line":23,"column":27},"line":23,"code":"  it(`is enabled by default`, () => {\n    const enabled = isTrackingEnabled()\n    expect(enabled).toBeTrue()\n  })","file":"tracking.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"respects the setting of the config store","suites":["isTrackingEnabled"],"updatePoint":{"line":28,"column":46},"line":28,"code":"  it(`respects the setting of the config store`, () => {\n    get.mockImplementationOnce(key => {\n      if (key === `telemetry.enabled`) {\n        return false\n      } else {\n        return true\n      }\n    })\n\n    const enabled = isTrackingEnabled()\n    expect(enabled).toBeFalse()\n\n    const cachedEnabled = isTrackingEnabled()\n    expect(cachedEnabled).toBeFalse()\n  })","file":"tracking.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"respects the setting of the environment variable","suites":["isTrackingEnabled","process.env.GATSBY_TELEMETRY_DISABLED"],"updatePoint":{"line":49,"column":56},"line":49,"code":"    it(`respects the setting of the environment variable`, () => {\n      const enabled = isTrackingEnabled()\n      expect(enabled).toBeFalse()\n\n      const cachedEnabled = isTrackingEnabled()\n      expect(cachedEnabled).toBeFalse()\n    })","file":"tracking.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"create npm-legal package names","suites":["the string util functions"],"updatePoint":{"line":26,"column":36},"line":26,"code":"  it(`create npm-legal package names`, () => {\n    tests.forEach(([input, output]) => {\n      expect(makeNpmSafe(input)).toEqual(output)\n    })\n  })","file":"utils/make-npm-safe.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should parse without flags and dir name","suites":["parseArgs"],"updatePoint":{"line":9,"column":45},"line":9,"code":"  it(`should parse without flags and dir name`, () => {\n    const { flags, dirName } = parseArgs([])\n    expect(flags.yes).toBeFalsy()\n    expect(flags.ts).toBeFalsy()\n    expect(dirName).toEqual(``)\n  })","file":"utils/parse-args.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should parse with dir name without flags","suites":["parseArgs"],"updatePoint":{"line":15,"column":46},"line":15,"code":"  it(`should parse with dir name without flags`, () => {\n    const { flags, dirName } = parseArgs([dirNameArg])\n    expect(flags.yes).toBeFalsy()\n    expect(flags.ts).toBeFalsy()\n    expect(dirName).toEqual(dirNameArg)\n  })","file":"utils/parse-args.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should parse with flags before dir name","suites":["parseArgs"],"updatePoint":{"line":21,"column":45},"line":21,"code":"  it(`should parse with flags before dir name`, () => {\n    const { flags, dirName } = parseArgs([`-y`, `-ts`, dirNameArg])\n    expect(flags.yes).toBeTruthy()\n    expect(flags.ts).toBeTruthy()\n    expect(dirName).toEqual(dirNameArg)\n  })","file":"utils/parse-args.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should parse with flags after dir name","suites":["parseArgs"],"updatePoint":{"line":27,"column":44},"line":27,"code":"  it(`should parse with flags after dir name`, () => {\n    const { flags, dirName } = parseArgs([dirNameArg, `-y`, `-ts`])\n    expect(flags.yes).toBeTruthy()\n    expect(flags.ts).toBeTruthy()\n    expect(dirName).toEqual(dirNameArg)\n  })","file":"utils/parse-args.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should parse with flags before and after dir name","suites":["parseArgs"],"updatePoint":{"line":33,"column":55},"line":33,"code":"  it(`should parse with flags before and after dir name`, () => {\n    const { flags, dirName } = parseArgs([`-y`, dirNameArg, `-ts`])\n    expect(flags.yes).toBeTruthy()\n    expect(flags.ts).toBeTruthy()\n    expect(dirName).toEqual(dirNameArg)\n  })","file":"utils/parse-args.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should warn if unknown flags are used","suites":["parseArgs"],"updatePoint":{"line":39,"column":43},"line":39,"code":"  it(`should warn if unknown flags are used`, () => {\n    const unknownFlag = `-unknown`\n    const { flags, dirName } = parseArgs([dirNameArg, unknownFlag])\n    expect(reporter.warn).toBeCalledTimes(1)\n    expect(reporter.warn).toBeCalledWith(\n      expect.stringContaining(\n        `Found unknown argument \"${unknownFlag}\", ignoring. Known arguments are: -y, -ts`\n      )\n    )\n    expect(flags.yes).toBeFalsy()\n    expect(flags.ts).toBeFalsy()\n    expect(dirName).toEqual(dirNameArg)\n  })","file":"utils/parse-args.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should return a select none option by default","suites":["question-helpers","makeChoices"],"updatePoint":{"line":14,"column":53},"line":14,"code":"    it(`should return a select none option by default`, () => {\n      const options = {\n        init: {\n          message: `hello world`,\n        },\n      }\n      const choices = makeChoices(options)\n      const [none] = choices\n      expect(none).toMatchObject({\n        message: `No (or I'll add it later)`,\n      })\n    })","file":"utils/question-helpers.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should return no select none option if must select indicated","suites":["question-helpers","makeChoices"],"updatePoint":{"line":27,"column":68},"line":27,"code":"    it(`should return no select none option if must select indicated`, () => {\n      const name = `init`\n      const message = `hello world`\n      const options = {\n        [name]: {\n          message,\n        },\n      }\n      const choices = makeChoices(options, true)\n      const [option] = choices\n      expect(option).toMatchObject({\n        message,\n        name,\n      })\n    })","file":"utils/question-helpers.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should warn if no dir name","suites":["question-helpers","validateProjectName"],"updatePoint":{"line":45,"column":34},"line":45,"code":"    it(`should warn if no dir name`, () => {\n      const valid = validateProjectName(``)\n      expect(valid).toBeFalsy()\n      expect(reporter.warn).toBeCalledWith(\n        expect.stringContaining(\n          `You have not provided a directory name for your site. Please do so when running with the 'y' flag.`\n        )\n      )\n    })","file":"utils/question-helpers.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should warn if dir name has special character","suites":["question-helpers","validateProjectName"],"updatePoint":{"line":55,"column":53},"line":55,"code":"    it(`should warn if dir name has special character`, () => {\n      const name = `<hello:\"world`\n      const valid = validateProjectName(name)\n      expect(valid).toBeFalsy()\n      expect(reporter.warn).toBeCalledWith(\n        expect.stringContaining(\n          `The destination \"${name}\" is not a valid filename. Please try again, avoiding special characters.`\n        )\n      )\n    })","file":"utils/question-helpers.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should warn if dir already exists","suites":["question-helpers","validateProjectName"],"updatePoint":{"line":66,"column":41},"line":66,"code":"    it(`should warn if dir already exists`, () => {\n      jest.spyOn(fs, `existsSync`).mockReturnValueOnce(true)\n      const name = `hello-world`\n      const valid = validateProjectName(name)\n      expect(valid).toBeFalsy()\n      expect(reporter.warn).toBeCalledWith(\n        expect.stringContaining(\n          `The destination \"${name}\" already exists. Please choose a different name`\n        )\n      )\n    })","file":"utils/question-helpers.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should return true if the dir name meets all conditions","suites":["question-helpers","validateProjectName"],"updatePoint":{"line":78,"column":63},"line":78,"code":"    it(`should return true if the dir name meets all conditions`, () => {\n      const valid = validateProjectName(`hello-world`)\n      expect(valid).toBeTruthy()\n    })","file":"utils/question-helpers.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should warn if dir name has invalid patterns","suites":["question-helpers","validateProjectName","windows"],"updatePoint":{"line":94,"column":54},"line":94,"code":"      it(`should warn if dir name has invalid patterns`, () => {\n        const name = `aux`\n        const valid = validateProjectName(name)\n        expect(valid).toBeFalsy()\n        expect(reporter.warn).toBeCalledWith(\n          expect.stringContaining(\n            `The destination \"${name}\" is not a valid Windows filename. Please try another name`\n          )\n        )\n      })","file":"utils/question-helpers.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should return one question if the skip flag is passed","suites":["question-helpers","generateQuestions"],"updatePoint":{"line":108,"column":61},"line":108,"code":"    it(`should return one question if the skip flag is passed`, () => {\n      const question = generateQuestions(`hello-world`, {\n        yes: true,\n        ts: false,\n      })\n      expect(question.name).toEqual(`project`)\n    })","file":"utils/question-helpers.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should return all questions if no skip flag is passed","suites":["question-helpers","generateQuestions"],"updatePoint":{"line":116,"column":61},"line":116,"code":"    it(`should return all questions if no skip flag is passed`, () => {\n      const questions = generateQuestions(`hello-world`, {\n        yes: false,\n        ts: false,\n      })\n      const [first, second, third, fourth, fifth] = questions\n      expect(questions).toHaveLength(5)\n      expect(first.name).toEqual(`project`)\n      expect(second.name).toEqual(`language`)\n      expect(third.name).toEqual(`cms`)\n      expect(fourth.name).toEqual(`styling`)\n      expect(fifth.name).toEqual(`features`)\n    })","file":"utils/question-helpers.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should return all questions except for language if ts flag is passed","suites":["question-helpers","generateQuestions"],"updatePoint":{"line":130,"column":76},"line":130,"code":"    it(`should return all questions except for language if ts flag is passed`, () => {\n      const questions = generateQuestions(`hello-world`, {\n        yes: false,\n        ts: true,\n      })\n      const [first, second, third, fourth] = questions\n      expect(questions).toHaveLength(4)\n      expect(first.name).toEqual(`project`)\n      expect(second.name).toEqual(`cms`)\n      expect(third.name).toEqual(`styling`)\n      expect(fourth.name).toEqual(`features`)\n    })","file":"utils/question-helpers.ts","skipped":false,"dir":"packages/create-gatsby/src/__tests__"},{"name":"should not write with no plugins","suites":["addPlugins","gatsby-config.js"],"updatePoint":{"line":44,"column":40},"line":44,"code":"    it(`should not write with no plugins`, async () => {\n      await addPlugins([], {}, fixtures, [])\n      const gatsbyConfig = (await readFile(config.js.fixture)).toString()\n      expect(gatsbyConfig).toMatchSnapshot()\n    })","file":"handlers/plugin-add.ts","skipped":false,"dir":"packages/gatsby-cli/src/__tests__"},{"name":"should write a single plugin","suites":["addPlugins","gatsby-config.js"],"updatePoint":{"line":50,"column":36},"line":50,"code":"    it(`should write a single plugin`, async () => {\n      await addPlugins([plugin.hello], {}, fixtures, [])\n      const gatsbyConfig = (await readFile(config.js.fixture)).toString()\n      expect(gatsbyConfig).toMatchSnapshot()\n    })","file":"handlers/plugin-add.ts","skipped":false,"dir":"packages/gatsby-cli/src/__tests__"},{"name":"should write multiple plugins","suites":["addPlugins","gatsby-config.js"],"updatePoint":{"line":56,"column":37},"line":56,"code":"    it(`should write multiple plugins`, async () => {\n      await addPlugins([plugin.hello, plugin.world], {}, fixtures, [])\n      const gatsbyConfig = (await readFile(config.js.fixture)).toString()\n      expect(gatsbyConfig).toMatchSnapshot()\n    })","file":"handlers/plugin-add.ts","skipped":false,"dir":"packages/gatsby-cli/src/__tests__"},{"name":"should write a plugin with options","suites":["addPlugins","gatsby-config.js"],"updatePoint":{"line":62,"column":42},"line":62,"code":"    it(`should write a plugin with options`, async () => {\n      await addPlugins(\n        [plugin.hello],\n        {\n          [plugin.hello]: {\n            greet: true,\n          },\n        },\n        fixtures,\n        []\n      )\n      const gatsbyConfig = (await readFile(config.js.fixture)).toString()\n      expect(gatsbyConfig).toMatchSnapshot()\n    })","file":"handlers/plugin-add.ts","skipped":false,"dir":"packages/gatsby-cli/src/__tests__"},{"name":"should not write with no plugins","suites":["addPlugins","gatsby-config.ts"],"updatePoint":{"line":87,"column":40},"line":87,"code":"    it(`should not write with no plugins`, async () => {\n      await addPlugins([], {}, fixtures, [])\n      const gatsbyConfig = (await readFile(config.ts.fixture)).toString()\n      expect(gatsbyConfig).toMatchSnapshot()\n    })","file":"handlers/plugin-add.ts","skipped":false,"dir":"packages/gatsby-cli/src/__tests__"},{"name":"should write a single plugin","suites":["addPlugins","gatsby-config.ts"],"updatePoint":{"line":93,"column":36},"line":93,"code":"    it(`should write a single plugin`, async () => {\n      await addPlugins([plugin.hello], {}, fixtures, [])\n      const gatsbyConfig = (await readFile(config.ts.fixture)).toString()\n      expect(gatsbyConfig).toMatchSnapshot()\n    })","file":"handlers/plugin-add.ts","skipped":false,"dir":"packages/gatsby-cli/src/__tests__"},{"name":"should write multiple plugins","suites":["addPlugins","gatsby-config.ts"],"updatePoint":{"line":99,"column":37},"line":99,"code":"    it(`should write multiple plugins`, async () => {\n      await addPlugins([plugin.hello, plugin.world], {}, fixtures, [])\n      const gatsbyConfig = (await readFile(config.ts.fixture)).toString()\n      expect(gatsbyConfig).toMatchSnapshot()\n    })","file":"handlers/plugin-add.ts","skipped":false,"dir":"packages/gatsby-cli/src/__tests__"},{"name":"should write a plugin with options","suites":["addPlugins","gatsby-config.ts"],"updatePoint":{"line":105,"column":42},"line":105,"code":"    it(`should write a plugin with options`, async () => {\n      await addPlugins(\n        [plugin.hello],\n        {\n          [plugin.hello]: {\n            greet: true,\n          },\n        },\n        fixtures,\n        []\n      )\n      const gatsbyConfig = (await readFile(config.ts.fixture)).toString()\n      expect(gatsbyConfig).toMatchSnapshot()\n    })","file":"handlers/plugin-add.ts","skipped":false,"dir":"packages/gatsby-cli/src/__tests__"},{"name":"shows error with link to more info","suites":["error handling"],"updatePoint":{"line":78,"column":40},"line":78,"code":"  it(`shows error with link to more info`, () => {\n    const { reporter } = setup(`v6.0.0`)\n\n    expect(reporter.panic).toHaveBeenCalledWith(\n      expect.stringContaining(`https://gatsby.dev/upgrading-node-js`)\n    )\n  })","file":"index.ts","skipped":false,"dir":"packages/gatsby-cli/src/__tests__"},{"name":"allows prerelease versions","suites":["error handling"],"updatePoint":{"line":86,"column":32},"line":86,"code":"  it(`allows prerelease versions`, () => {\n    const { reporter } = setup(`v19.0.0-pre`)\n\n    expect(reporter.panic).not.toHaveBeenCalled()\n  })","file":"index.ts","skipped":false,"dir":"packages/gatsby-cli/src/__tests__"},{"name":"warns on prerelease versions","suites":["error handling"],"updatePoint":{"line":92,"column":34},"line":92,"code":"  it(`warns on prerelease versions`, () => {\n    const { reporter } = setup(`v15.0.0-pre`)\n\n    expect(reporter.warn).toHaveBeenCalledWith(\n      expect.stringContaining(`prerelease`)\n    )\n  })","file":"index.ts","skipped":false,"dir":"packages/gatsby-cli/src/__tests__"},{"name":"invokes createCli","suites":["normal behavior"],"updatePoint":{"line":128,"column":23},"line":128,"code":"  it(`invokes createCli`, () => {\n    const { createCli } = setup()\n\n    expect(createCli).toHaveBeenCalledTimes(1)\n    expect(createCli).toHaveBeenCalledWith(process.argv)\n  })","file":"index.ts","skipped":false,"dir":"packages/gatsby-cli/src/__tests__"},{"name":"Detects CI when ci-info detects one","suites":["CI detection"],"updatePoint":{"line":23,"column":41},"line":23,"code":"  it(`Detects CI when ci-info detects one`, () => {\n    const ciInfo = require(`ci-info`)\n    ciInfo.setIsCI(true)\n    ciInfo.setName(`testname`)\n\n    const { isCI, getCIName } = require(`../ci`)\n    expect(isCI()).toBeTruthy()\n    expect(getCIName()).toEqual(`testname`)\n  })","file":"ci.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"Detects Now v2","suites":["CI detection"],"updatePoint":{"line":33,"column":20},"line":33,"code":"  it(`Detects Now v2`, () => {\n    process.env.NOW_BUILDER_ANNOTATE = `1`\n    const { isCI, getCIName } = require(`../ci`)\n\n    expect(isCI()).toBeTruthy()\n    expect(getCIName()).toEqual(`ZEIT Now`)\n  })","file":"ci.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"Detects Now v1","suites":["CI detection"],"updatePoint":{"line":41,"column":20},"line":41,"code":"  it(`Detects Now v1`, () => {\n    process.env.NOW_REGION = `none`\n    const { isCI, getCIName } = require(`../ci`)\n\n    expect(isCI()).toBeTruthy()\n    expect(getCIName()).toEqual(`ZEIT Now v1`)\n  })","file":"ci.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"Detects Heroku","suites":["CI detection"],"updatePoint":{"line":49,"column":20},"line":49,"code":"  it(`Detects Heroku`, () => {\n    process.env.NODE = `/tmp/build_8a43526a8849e690a3b67906d404e434/.heroku/node/bin/node`\n    const { isCI, getCIName } = require(`../ci`)\n\n    expect(isCI()).toBeTruthy()\n    expect(getCIName()).toEqual(`Heroku`)\n  })","file":"ci.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"Detects CI and CI_NAME","suites":["CI detection"],"updatePoint":{"line":56,"column":28},"line":56,"code":"  it(`Detects CI and CI_NAME`, () => {\n    process.env.CI = `true`\n    process.env.CI_NAME = `test CI`\n    const { isCI, getCIName } = require(`../ci`)\n\n    expect(isCI()).toBeTruthy()\n    expect(getCIName()).toEqual(`test CI`)\n  })","file":"ci.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"Detects CI and no CI_NAME","suites":["CI detection"],"updatePoint":{"line":64,"column":31},"line":64,"code":"  it(`Detects CI and no CI_NAME`, () => {\n    process.env.CI = `true`\n    delete process.env.CI_NAME\n    const { isCI, getCIName } = require(`../ci`)\n\n    expect(isCI()).toBeTruthy()\n    expect(getCIName()).toEqual(`CI detected without name`)\n  })","file":"ci.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"it defaults to physical CPU count, if override not detected","suites":[],"updatePoint":{"line":10,"column":65},"line":10,"code":"test(`it defaults to physical CPU count, if override not detected`, () => {\n  expect(cpuCoreCount(false)).toBe(1)\n})","file":"cpu-core-count.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"it does not use env far override, if ignoreEnvVar is true","suites":[],"updatePoint":{"line":14,"column":63},"line":14,"code":"test(`it does not use env far override, if ignoreEnvVar is true`, () => {\n  process.env.GATSBY_CPU_COUNT = `9001`\n\n  expect(cpuCoreCount(true)).not.toBe(Number(process.env.GATSBY_CPU_COUNT))\n})","file":"cpu-core-count.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"uses env var override, if exists","suites":[],"updatePoint":{"line":20,"column":38},"line":20,"code":"test(`uses env var override, if exists`, () => {\n  process.env.GATSBY_CPU_COUNT = `9001`\n\n  expect(cpuCoreCount(false)).toBe(Number(process.env.GATSBY_CPU_COUNT))\n})","file":"cpu-core-count.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns the content digest when the input is a string","suites":["Create content digest"],"updatePoint":{"line":4,"column":59},"line":4,"code":"  it(`returns the content digest when the input is a string`, () => {\n    const input = `this is a string`\n\n    const contentDigest = createContentDigest(input)\n\n    expect(typeof contentDigest).toEqual(`string`)\n    expect(contentDigest).toMatchInlineSnapshot(\n      `\"b37e16c620c055cf8207b999e3270e9b\"`\n    )\n  })","file":"create-content-digest.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns the content digest when the input is a non string","suites":["Create content digest"],"updatePoint":{"line":15,"column":63},"line":15,"code":"  it(`returns the content digest when the input is a non string`, () => {\n    const input = { id: 1 }\n\n    const contentDigest = createContentDigest(input)\n\n    expect(typeof contentDigest).toEqual(`string`)\n    expect(contentDigest).toMatchInlineSnapshot(\n      `\"db1aa405ee004296a31f04620bbb8e28\"`\n    )\n  })","file":"create-content-digest.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns the content digest when input is a Buffer","suites":["Create content digest"],"updatePoint":{"line":27,"column":55},"line":27,"code":"  it(`returns the content digest when input is a Buffer`, () => {\n    const input = Buffer.from(`1234`)\n    const input2 = Buffer.from(`5678`)\n\n    const contentDigest = createContentDigest(input)\n    const contentDigest2 = createContentDigest(input2)\n\n    expect(typeof contentDigest).toEqual(`string`)\n    expect(contentDigest).toMatchInlineSnapshot(\n      `\"81dc9bdb52d04dc20036dbd8313ed055\"`\n    )\n    expect(contentDigest2).toMatchInlineSnapshot(\n      `\"674f3c2c1a8a6f90461e8a66fb5550ba\"`\n    )\n    expect(contentDigest).not.toEqual(contentDigest2)\n  })","file":"create-content-digest.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns a deterministic hash from a Buffer","suites":["Create content digest"],"updatePoint":{"line":45,"column":48},"line":45,"code":"  it(`returns a deterministic hash from a Buffer`, () => {\n    const input = Buffer.from(`1234`)\n    const input2 = Buffer.from(`1234`)\n\n    expect(createContentDigest(input)).toEqual(createContentDigest(input2))\n  })","file":"create-content-digest.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns a deterministic hash from an object","suites":["Create content digest"],"updatePoint":{"line":52,"column":49},"line":52,"code":"  it(`returns a deterministic hash from an object`, () => {\n    const input = {\n      id: `12345`,\n      args: {\n        arg1: `test`,\n        arg2: `test2`,\n        arg3: [1, 2],\n      },\n    }\n    const input2 = {\n      args: {\n        arg2: `test2`,\n        arg1: `test`,\n        arg3: [1, 2],\n      },\n      id: `12345`,\n    }\n\n    expect(createContentDigest(input)).toEqual(createContentDigest(input2))\n  })","file":"create-content-digest.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"shouldn't threat arrays as deterministic by default","suites":["Create content digest"],"updatePoint":{"line":73,"column":57},"line":73,"code":"  it(`shouldn't threat arrays as deterministic by default`, () => {\n    const input = {\n      id: `12345`,\n      args: {\n        arg1: `test`,\n        arg2: `test2`,\n        arg3: [2, 1],\n      },\n    }\n    const input2 = {\n      args: {\n        arg2: `test2`,\n        arg1: `test`,\n        arg3: [1, 2],\n      },\n      id: `12345`,\n    }\n\n    expect(createContentDigest(input)).not.toEqual(createContentDigest(input2))\n  })","file":"create-content-digest.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"downloads and create a svg file","suites":["fetch-remote-file"],"updatePoint":{"line":316,"column":37},"line":316,"code":"  it(`downloads and create a svg file`, async () => {\n    const filePath = await fetchRemoteFile({\n      url: `http://external.com/logo.svg`,\n      cache,\n    })\n\n    expect(path.basename(filePath)).toBe(`logo.svg`)\n    expect(gotStream).toBeCalledTimes(1)\n  })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"downloads and create a gzip file","suites":["fetch-remote-file"],"updatePoint":{"line":326,"column":38},"line":326,"code":"  it(`downloads and create a gzip file`, async () => {\n    const filePath = await fetchRemoteFile({\n      url: `http://external.com/logo-gzip.svg`,\n      cache,\n    })\n\n    expect(path.basename(filePath)).toBe(`logo-gzip.svg`)\n    expect(getFileSize(filePath)).resolves.toBe(\n      await getFileSize(path.join(__dirname, `./fixtures/gatsby-logo.svg`))\n    )\n    expect(gotStream).toBeCalledTimes(1)\n  })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"downloads and create a jpg file","suites":["fetch-remote-file"],"updatePoint":{"line":339,"column":37},"line":339,"code":"  it(`downloads and create a jpg file`, async () => {\n    const filePath = await fetchRemoteFile({\n      url: `http://external.com/dog.jpg`,\n      cache,\n    })\n\n    expect(path.basename(filePath)).toBe(`dog.jpg`)\n    expect(getFileSize(filePath)).resolves.toBe(\n      await getFileSize(path.join(__dirname, `./fixtures/dog-thumbnail.jpg`))\n    )\n    expect(gotStream).toBeCalledTimes(1)\n  })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"downloads and create a jpg file for file with non-ascii url","suites":["fetch-remote-file"],"updatePoint":{"line":352,"column":65},"line":352,"code":"  it(`downloads and create a jpg file for file with non-ascii url`, async () => {\n    const filePath = await fetchRemoteFile({\n      url: `http://external.com/${encodeURIComponent(``)}.jpg`,\n      cache,\n    })\n\n    expect(path.basename(filePath)).toBe(`.jpg`)\n    expect(getFileSize(filePath)).resolves.toBe(\n      await getFileSize(path.join(__dirname, `./fixtures/dog-thumbnail.jpg`))\n    )\n    expect(gotStream).toBeCalledTimes(1)\n  })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"downloads and create a jpg file for file with non-ascii filename","suites":["fetch-remote-file"],"updatePoint":{"line":365,"column":70},"line":365,"code":"  it(`downloads and create a jpg file for file with non-ascii filename`, async () => {\n    const filePath = await fetchRemoteFile({\n      url: `http://external.com/dog.jpg`,\n      name: `${encodeURIComponent(``)}`,\n      cache,\n    })\n\n    expect(path.basename(filePath)).toBe(`.jpg`)\n    expect(getFileSize(filePath)).resolves.toBe(\n      await getFileSize(path.join(__dirname, `./fixtures/dog-thumbnail.jpg`))\n    )\n    expect(gotStream).toBeCalledTimes(1)\n  })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"downloads and create a jpg file for unknown extension","suites":["fetch-remote-file"],"updatePoint":{"line":379,"column":59},"line":379,"code":"  it(`downloads and create a jpg file for unknown extension`, async () => {\n    const filePath = await fetchRemoteFile({\n      url: `http://external.com/dog`,\n      cache,\n    })\n\n    expect(path.basename(filePath)).toBe(`dog.jpg`)\n    expect(getFileSize(filePath)).resolves.toBe(\n      await getFileSize(path.join(__dirname, `./fixtures/dog-thumbnail.jpg`))\n    )\n    expect(gotStream).toBeCalledTimes(1)\n  })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"downloads and create a jpg file that has invalid characters","suites":["fetch-remote-file"],"updatePoint":{"line":392,"column":65},"line":392,"code":"  it(`downloads and create a jpg file that has invalid characters`, async () => {\n    const filePath = await fetchRemoteFile({\n      url: `http://external.com/invalid:dog*name.jpg`,\n      cache,\n    })\n\n    expect(path.basename(filePath, `.js`)).toContain(`invalid-dog-name`)\n    expect(getFileSize(filePath)).resolves.toBe(\n      await getFileSize(path.join(__dirname, `./fixtures/dog-thumbnail.jpg`))\n    )\n    expect(gotStream).toBeCalledTimes(1)\n  })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"doesn't retry when no content-length is given","suites":["fetch-remote-file"],"updatePoint":{"line":405,"column":51},"line":405,"code":"  it(`doesn't retry when no content-length is given`, async () => {\n    const filePath = await fetchRemoteFile({\n      url: `http://external.com/logo-gzip.svg?attempts=1&maxBytes=300&contentLength=false`,\n      cache,\n    })\n\n    expect(path.basename(filePath)).toBe(`logo-gzip.svg`)\n    expect(getFileSize(filePath)).resolves.not.toBe(\n      await getFileSize(path.join(__dirname, `./fixtures/gatsby-logo.svg`))\n    )\n    expect(gotStream).toBeCalledTimes(1)\n  })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"does not request same url during the same build","suites":["fetch-remote-file"],"updatePoint":{"line":418,"column":53},"line":418,"code":"  it(`does not request same url during the same build`, async () => {\n    const filePath = await fetchRemoteFile({\n      url: `http://external.com/logo.svg`,\n      cache,\n    })\n    const cachedFilePath = await fetchRemoteFile({\n      url: `http://external.com/logo.svg`,\n      cache,\n    })\n\n    expect(filePath).toBe(cachedFilePath)\n    expect(path.basename(filePath)).toBe(`logo.svg`)\n    expect(gotStream).toBeCalledTimes(1)\n  })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"handles 304 responses correctly","suites":["fetch-remote-file"],"updatePoint":{"line":433,"column":37},"line":433,"code":"  it(`handles 304 responses correctly`, async () => {\n    const currentGlobal = global.__GATSBY\n    global.__GATSBY = { buildId: `304-1` }\n    const filePath = await fetchRemoteFile({\n      url: `http://external.com/dog-304.jpg`,\n      directory: cachePath,\n    })\n\n    global.__GATSBY = { buildId: `304-2` }\n    const filePathCached = await fetchRemoteFile({\n      url: `http://external.com/dog-304.jpg`,\n      directory: cachePath,\n    })\n\n    expect(filePathCached).toBe(filePath)\n    expect(fsMove).toBeCalledTimes(1)\n    expect(gotStream).toBeCalledTimes(2)\n    global.__GATSBY = currentGlobal\n  })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"handles 304 responses correctly when file does not exists","suites":["fetch-remote-file"],"updatePoint":{"line":453,"column":63},"line":453,"code":"  it(`handles 304 responses correctly when file does not exists`, async () => {\n    const currentGlobal = global.__GATSBY\n    global.__GATSBY = { buildId: `304-3` }\n    const filePath = await fetchRemoteFile({\n      url: `http://external.com/dog-304.jpg`,\n      directory: cachePath,\n    })\n\n    await fs.remove(filePath)\n\n    global.__GATSBY = { buildId: `304-4` }\n    const filePathCached = await fetchRemoteFile({\n      url: `http://external.com/dog-304.jpg`,\n      directory: cachePath,\n    })\n\n    expect(filePathCached).toBe(filePath)\n    expect(fsMove).toBeCalledTimes(2)\n    expect(gotStream).toBeCalledTimes(2)\n    global.__GATSBY = currentGlobal\n  })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"fails when 404 is triggered","suites":["fetch-remote-file"],"updatePoint":{"line":475,"column":33},"line":475,"code":"  it(`fails when 404 is triggered`, async () => {\n    await expect(\n      fetchRemoteFile({\n        url: `http://external.com/404.jpg`,\n        cache,\n      })\n    ).rejects.toThrow(`Response code 404 (Not Found)`)\n  })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"fails when 500 is triggered","suites":["fetch-remote-file"],"updatePoint":{"line":484,"column":33},"line":484,"code":"  it(`fails when 500 is triggered`, async () => {\n    await expect(\n      fetchRemoteFile({\n        url: `http://external.com/500.jpg`,\n        cache,\n      })\n    ).rejects.toThrowErrorMatchingInlineSnapshot(`\n\"Unable to fetch:\nhttp://external.com/500.jpg\n---\nReason: Response code 500 (Internal Server Error)\n---\nFetch details:\n{\n  \\\\\"attempt\\\\\": 3,\n  \\\\\"method\\\\\": \\\\\"GET\\\\\",\n  \\\\\"errorCode\\\\\": \\\\\"ERR_NON_2XX_3XX_RESPONSE\\\\\",\n  \\\\\"responseStatusCode\\\\\": 500,\n  \\\\\"responseStatusMessage\\\\\": \\\\\"Internal Server Error\\\\\",\n  \\\\\"requestHeaders\\\\\": {\n    \\\\\"user-agent\\\\\": \\\\\"got (https://github.com/sindresorhus/got)\\\\\",\n    \\\\\"accept-encoding\\\\\": \\\\\"gzip, deflate, br\\\\\"\n  },\n  \\\\\"responseHeaders\\\\\": {\n    \\\\\"x-powered-by\\\\\": \\\\\"msw\\\\\",\n    \\\\\"content-length\\\\\": \\\\\"12\\\\\",\n    \\\\\"content-type\\\\\": \\\\\"text/html\\\\\"\n  }\n}\n---\"\n`)\n  })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"with excludeDigest %s","suites":["fetch-remote-file"],"line":518,"code":"  describe.each([false, true])(`with excludeDigest %s`, excludeDigest => {\n    function getExternalUrl(cacheVersion) {\n      return `http://external.com/dog-${cacheVersion}.jpg?v=${cacheVersion}`\n    }\n\n    it(`should not re-download file if cache is set`, async () => {\n      const filePath = await fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        cache,\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePath = await fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        cache,\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      expect(filePath).toBe(cachedFilePath)\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(1)\n      expect(fs.copy).not.toBeCalled()\n    })\n\n    it(`should not re-download and use same path if ouputDir is not inside public folder`, async () => {\n      const filePath = await fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        directory: cache.directory,\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePath = await fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        directory: path.join(cache.directory, `diff`),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      expect(filePath).toBe(cachedFilePath)\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(1)\n      expect(fs.copy).not.toBeCalled()\n    })\n\n    it(`should not re-download but copy file to public folder`, async () => {\n      const currentGlobal = global.__GATSBY\n      global.__GATSBY = {\n        root: cache.directory,\n      }\n      await fs.ensureDir(path.join(cache.directory, `public`))\n      const filePath = await fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        directory: cache.directory,\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePath = await fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        directory: path.join(cache.directory, `public`),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      expect(filePath).not.toBe(cachedFilePath)\n      expect(cachedFilePath).toStartWith(path.join(cache.directory, `public`))\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(1)\n      expect(fs.copy).toBeCalledTimes(1)\n      expect(await fs.pathExists(cachedFilePath)).toBe(true)\n      global.__GATSBY = currentGlobal\n    })\n\n    it(`should not re-download but copy file to public folder (with slashes)`, async () => {\n      const currentGlobal = global.__GATSBY\n      global.__GATSBY = {\n        root: cache.directory,\n      }\n      await fs.ensureDir(path.join(cache.directory, `public`))\n      const filePath = await fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        directory: slash(cache.directory),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePath = await fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        directory: slash(path.join(cache.directory, `public`)),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      expect(filePath).not.toBe(cachedFilePath)\n      expect(cachedFilePath).toStartWith(path.join(cache.directory, `public`))\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(1)\n      expect(fs.copy).toBeCalledTimes(1)\n      expect(await fs.pathExists(cachedFilePath)).toBe(true)\n      global.__GATSBY = currentGlobal\n    })\n\n    it(`should not re-download but copy file to public folder when the same url is requested`, async () => {\n      const currentGlobal = global.__GATSBY\n      global.__GATSBY = {\n        root: cache.directory,\n      }\n      await fs.ensureDir(path.join(cache.directory, `public`))\n      const filePathPromise = fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        directory: cache.directory,\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePathPromise = fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        directory: path.join(cache.directory, `public`),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      const [filePath, cachedFilePath] = await Promise.all([\n        filePathPromise,\n        cachedFilePathPromise,\n      ])\n\n      expect(filePath).not.toBe(cachedFilePath)\n      expect(cachedFilePath).toStartWith(path.join(cache.directory, `public`))\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(0)\n      expect(fs.copy).toBeCalledTimes(1)\n      global.__GATSBY = currentGlobal\n    })\n\n    it(`should not re-download but copy file to public folder when the same url is requested (with slashes)`, async () => {\n      const currentGlobal = global.__GATSBY\n      global.__GATSBY = {\n        root: cache.directory,\n      }\n      await fs.ensureDir(path.join(cache.directory, `public`))\n      const filePathPromise = fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        directory: slash(cache.directory),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePathPromise = fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        directory: slash(path.join(cache.directory, `public`)),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      const [filePath, cachedFilePath] = await Promise.all([\n        filePathPromise,\n        cachedFilePathPromise,\n      ])\n\n      expect(filePath).not.toBe(cachedFilePath)\n      expect(cachedFilePath).toStartWith(path.join(cache.directory, `public`))\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(0)\n      expect(fs.copy).toBeCalledTimes(1)\n      global.__GATSBY = currentGlobal\n    })\n\n    it(`should not re-download and not copy when the dist folder is the same`, async () => {\n      const currentGlobal = global.__GATSBY\n      global.__GATSBY = {\n        root: cache.directory,\n      }\n      await fs.ensureDir(path.join(cache.directory, `public`))\n      const filePathPromise = await fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        directory: path.join(cache.directory, `public`),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePathPromise = await fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        directory: path.join(cache.directory, `public`),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      const [, cachedFilePath] = await Promise.all([\n        filePathPromise,\n        cachedFilePathPromise,\n      ])\n\n      expect(cachedFilePath).toStartWith(path.join(cache.directory, `public`))\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(1)\n      expect(fs.copy).toBeCalledTimes(excludeDigest ? 0 : 1)\n      global.__GATSBY = currentGlobal\n    })\n\n    it(`should re-download and not copy when the dist folder is the same`, async () => {\n      const currentGlobal = global.__GATSBY\n      global.__GATSBY = {\n        root: cache.directory,\n      }\n      await fs.ensureDir(path.join(cache.directory, `public`))\n      const filePathPromise = fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        directory: path.join(cache.directory, `public`),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePathPromise = fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        directory: path.join(cache.directory, `public`),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      const [filePath, cachedFilePath] = await Promise.all([\n        filePathPromise,\n        cachedFilePathPromise,\n      ])\n\n      expect(filePath).toBe(cachedFilePath)\n      expect(cachedFilePath).toStartWith(path.join(cache.directory, `public`))\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(0)\n      expect(fs.copy).toBeCalledTimes(0)\n      global.__GATSBY = currentGlobal\n    })\n  })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should not re-download file if cache is set","suites":["fetch-remote-file"],"updatePoint":{"line":523,"column":51},"line":523,"code":"    it(`should not re-download file if cache is set`, async () => {\n      const filePath = await fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        cache,\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePath = await fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        cache,\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      expect(filePath).toBe(cachedFilePath)\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(1)\n      expect(fs.copy).not.toBeCalled()\n    })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should not re-download and use same path if ouputDir is not inside public folder","suites":["fetch-remote-file"],"updatePoint":{"line":543,"column":88},"line":543,"code":"    it(`should not re-download and use same path if ouputDir is not inside public folder`, async () => {\n      const filePath = await fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        directory: cache.directory,\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePath = await fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        directory: path.join(cache.directory, `diff`),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      expect(filePath).toBe(cachedFilePath)\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(1)\n      expect(fs.copy).not.toBeCalled()\n    })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should not re-download but copy file to public folder","suites":["fetch-remote-file"],"updatePoint":{"line":563,"column":61},"line":563,"code":"    it(`should not re-download but copy file to public folder`, async () => {\n      const currentGlobal = global.__GATSBY\n      global.__GATSBY = {\n        root: cache.directory,\n      }\n      await fs.ensureDir(path.join(cache.directory, `public`))\n      const filePath = await fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        directory: cache.directory,\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePath = await fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        directory: path.join(cache.directory, `public`),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      expect(filePath).not.toBe(cachedFilePath)\n      expect(cachedFilePath).toStartWith(path.join(cache.directory, `public`))\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(1)\n      expect(fs.copy).toBeCalledTimes(1)\n      expect(await fs.pathExists(cachedFilePath)).toBe(true)\n      global.__GATSBY = currentGlobal\n    })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should not re-download but copy file to public folder (with slashes)","suites":["fetch-remote-file"],"updatePoint":{"line":591,"column":76},"line":591,"code":"    it(`should not re-download but copy file to public folder (with slashes)`, async () => {\n      const currentGlobal = global.__GATSBY\n      global.__GATSBY = {\n        root: cache.directory,\n      }\n      await fs.ensureDir(path.join(cache.directory, `public`))\n      const filePath = await fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        directory: slash(cache.directory),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePath = await fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        directory: slash(path.join(cache.directory, `public`)),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      expect(filePath).not.toBe(cachedFilePath)\n      expect(cachedFilePath).toStartWith(path.join(cache.directory, `public`))\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(1)\n      expect(fs.copy).toBeCalledTimes(1)\n      expect(await fs.pathExists(cachedFilePath)).toBe(true)\n      global.__GATSBY = currentGlobal\n    })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should not re-download but copy file to public folder when the same url is requested","suites":["fetch-remote-file"],"updatePoint":{"line":619,"column":92},"line":619,"code":"    it(`should not re-download but copy file to public folder when the same url is requested`, async () => {\n      const currentGlobal = global.__GATSBY\n      global.__GATSBY = {\n        root: cache.directory,\n      }\n      await fs.ensureDir(path.join(cache.directory, `public`))\n      const filePathPromise = fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        directory: cache.directory,\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePathPromise = fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        directory: path.join(cache.directory, `public`),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      const [filePath, cachedFilePath] = await Promise.all([\n        filePathPromise,\n        cachedFilePathPromise,\n      ])\n\n      expect(filePath).not.toBe(cachedFilePath)\n      expect(cachedFilePath).toStartWith(path.join(cache.directory, `public`))\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(0)\n      expect(fs.copy).toBeCalledTimes(1)\n      global.__GATSBY = currentGlobal\n    })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should not re-download but copy file to public folder when the same url is requested (with slashes)","suites":["fetch-remote-file"],"updatePoint":{"line":651,"column":107},"line":651,"code":"    it(`should not re-download but copy file to public folder when the same url is requested (with slashes)`, async () => {\n      const currentGlobal = global.__GATSBY\n      global.__GATSBY = {\n        root: cache.directory,\n      }\n      await fs.ensureDir(path.join(cache.directory, `public`))\n      const filePathPromise = fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        directory: slash(cache.directory),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePathPromise = fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        directory: slash(path.join(cache.directory, `public`)),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      const [filePath, cachedFilePath] = await Promise.all([\n        filePathPromise,\n        cachedFilePathPromise,\n      ])\n\n      expect(filePath).not.toBe(cachedFilePath)\n      expect(cachedFilePath).toStartWith(path.join(cache.directory, `public`))\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(0)\n      expect(fs.copy).toBeCalledTimes(1)\n      global.__GATSBY = currentGlobal\n    })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should not re-download and not copy when the dist folder is the same","suites":["fetch-remote-file"],"updatePoint":{"line":683,"column":76},"line":683,"code":"    it(`should not re-download and not copy when the dist folder is the same`, async () => {\n      const currentGlobal = global.__GATSBY\n      global.__GATSBY = {\n        root: cache.directory,\n      }\n      await fs.ensureDir(path.join(cache.directory, `public`))\n      const filePathPromise = await fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        directory: path.join(cache.directory, `public`),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePathPromise = await fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        directory: path.join(cache.directory, `public`),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      const [, cachedFilePath] = await Promise.all([\n        filePathPromise,\n        cachedFilePathPromise,\n      ])\n\n      expect(cachedFilePath).toStartWith(path.join(cache.directory, `public`))\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(1)\n      expect(fs.copy).toBeCalledTimes(excludeDigest ? 0 : 1)\n      global.__GATSBY = currentGlobal\n    })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should re-download and not copy when the dist folder is the same","suites":["fetch-remote-file"],"updatePoint":{"line":714,"column":72},"line":714,"code":"    it(`should re-download and not copy when the dist folder is the same`, async () => {\n      const currentGlobal = global.__GATSBY\n      global.__GATSBY = {\n        root: cache.directory,\n      }\n      await fs.ensureDir(path.join(cache.directory, `public`))\n      const filePathPromise = fetchRemoteFile({\n        url: getExternalUrl(++cacheVersion),\n        directory: path.join(cache.directory, `public`),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n      const cachedFilePathPromise = fetchRemoteFile({\n        url: getExternalUrl(cacheVersion),\n        directory: path.join(cache.directory, `public`),\n        cacheKey: `${cacheVersion}`,\n        excludeDigest,\n      })\n\n      const [filePath, cachedFilePath] = await Promise.all([\n        filePathPromise,\n        cachedFilePathPromise,\n      ])\n\n      expect(filePath).toBe(cachedFilePath)\n      expect(cachedFilePath).toStartWith(path.join(cache.directory, `public`))\n      expect(gotStream).toBeCalledTimes(1)\n      expect(fs.pathExists).toBeCalledTimes(0)\n      expect(fs.copy).toBeCalledTimes(0)\n      global.__GATSBY = currentGlobal\n    })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"Retries when gzip compression file is incomplete","suites":["fetch-remote-file","retries the download"],"updatePoint":{"line":748,"column":56},"line":748,"code":"    it(`Retries when gzip compression file is incomplete`, async () => {\n      const filePath = await fetchRemoteFile({\n        url: `http://external.com/logo-gzip.svg?attempts=1&maxBytes=300`,\n        cache,\n      })\n\n      expect(path.basename(filePath)).toBe(`logo-gzip.svg`)\n      expect(getFileSize(filePath)).resolves.toBe(\n        await getFileSize(path.join(__dirname, `./fixtures/gatsby-logo.svg`))\n      )\n      expect(gotStream).toBeCalledTimes(2)\n    })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"Retries when binary file is incomplete","suites":["fetch-remote-file","retries the download"],"updatePoint":{"line":761,"column":46},"line":761,"code":"    it(`Retries when binary file is incomplete`, async () => {\n      const filePath = await fetchRemoteFile({\n        url: `http://external.com/dog.jpg?attempts=1&maxBytes=300`,\n        cache,\n      })\n\n      expect(path.basename(filePath)).toBe(`dog.jpg`)\n      expect(getFileSize(filePath)).resolves.toBe(\n        await getFileSize(path.join(__dirname, `./fixtures/dog-thumbnail.jpg`))\n      )\n      expect(gotStream).toBeCalledTimes(2)\n    })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"Retries when server returns 503 error till server returns 200","suites":["fetch-remote-file","retries the download"],"updatePoint":{"line":774,"column":69},"line":774,"code":"    it(`Retries when server returns 503 error till server returns 200`, async () => {\n      const fetchRemoteFileInstance = fetchRemoteFile({\n        url: `http://external.com/503-twice.svg`,\n        cache,\n      })\n\n      const filePath = await fetchRemoteFileInstance\n\n      expect(path.basename(filePath)).toBe(`503-twice.svg`)\n      expect(getFileSize(filePath)).resolves.toBe(\n        await getFileSize(path.join(__dirname, `./fixtures/gatsby-logo.svg`))\n      )\n      expect(gotStream).toBeCalledTimes(3)\n    })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"Stops retry when maximum attempts is reached","suites":["fetch-remote-file","retries the download"],"updatePoint":{"line":789,"column":52},"line":789,"code":"    it(`Stops retry when maximum attempts is reached`, async () => {\n      await expect(\n        fetchRemoteFile({\n          url: `http://external.com/503-forever.svg`,\n          cache,\n        })\n      ).rejects.toThrowErrorMatchingInlineSnapshot(`\n\"Unable to fetch:\nhttp://external.com/503-forever.svg\n---\nReason: Response code 503 (Service Unavailable)\n---\nFetch details:\n{\n  \\\\\"attempt\\\\\": 3,\n  \\\\\"method\\\\\": \\\\\"GET\\\\\",\n  \\\\\"errorCode\\\\\": \\\\\"ERR_NON_2XX_3XX_RESPONSE\\\\\",\n  \\\\\"responseStatusCode\\\\\": 503,\n  \\\\\"responseStatusMessage\\\\\": \\\\\"Service Unavailable\\\\\",\n  \\\\\"requestHeaders\\\\\": {\n    \\\\\"user-agent\\\\\": \\\\\"got (https://github.com/sindresorhus/got)\\\\\",\n    \\\\\"accept-encoding\\\\\": \\\\\"gzip, deflate, br\\\\\"\n  },\n  \\\\\"responseHeaders\\\\\": {\n    \\\\\"x-powered-by\\\\\": \\\\\"msw\\\\\",\n    \\\\\"content-length\\\\\": \\\\\"12\\\\\",\n    \\\\\"content-type\\\\\": \\\\\"text/html\\\\\"\n  }\n}\n---\"\n`)\n\n      expect(gotStream).toBeCalledTimes(3)\n    })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"Retries on network errors","suites":["fetch-remote-file","retries the download"],"updatePoint":{"line":824,"column":33},"line":824,"code":"    it(`Retries on network errors`, async () => {\n      await expect(\n        fetchRemoteFile({\n          url: `http://external.com/network-error.svg`,\n          cache,\n        })\n      ).rejects.toThrowErrorMatchingInlineSnapshot(`\n\"Unable to fetch:\nhttp://external.com/network-error.svg\n---\nReason: ECONNREFUSED\n---\nFetch details:\n{\n  \\\\\"attempt\\\\\": 3,\n  \\\\\"method\\\\\": \\\\\"GET\\\\\",\n  \\\\\"errorCode\\\\\": \\\\\"ERR_GOT_REQUEST_ERROR\\\\\",\n  \\\\\"requestHeaders\\\\\": {\n    \\\\\"user-agent\\\\\": \\\\\"got (https://github.com/sindresorhus/got)\\\\\",\n    \\\\\"accept-encoding\\\\\": \\\\\"gzip, deflate, br\\\\\"\n  }\n}\n---\"\n`)\n\n      expect(gotStream).toBeCalledTimes(3)\n    })","file":"fetch-remote-file.js","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"handles one instance of incorrect char","suites":["createFilePath"],"updatePoint":{"line":5,"column":44},"line":5,"code":"  it(`handles one instance of incorrect char`, () => {\n    const filename = `some:invalid`\n    const assert = path.join(\n      `dir`,\n      `some-invalid-${createFileHash(filename)}.png`\n    )\n    expect(createFilePath(`dir`, filename, `.png`)).toBe(assert)\n  })","file":"filename-utils.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"handles filename without forbibben chars correctly","suites":["createFilePath"],"updatePoint":{"line":13,"column":56},"line":13,"code":"  it(`handles filename without forbibben chars correctly`, () => {\n    const filename = `some-valid`\n    const assert = path.join(`dir`, `${filename}.png`)\n    expect(createFilePath(`dir`, filename, `.png`)).toBe(assert)\n  })","file":"filename-utils.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"handles all instances of incorrect chars","suites":["createFilePath"],"updatePoint":{"line":18,"column":46},"line":18,"code":"  it(`handles all instances of incorrect chars`, () => {\n    const filename = `a:b*c?d\"e<f>`\n    const assert = path.join(\n      `dir`,\n      `a-b-c-d-e-f--${createFileHash(filename)}.png`\n    )\n    expect(createFilePath(`dir`, filename, `.png`)).toBe(assert)\n  })","file":"filename-utils.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"creates different files for possible duplicates","suites":["createFilePath"],"updatePoint":{"line":26,"column":53},"line":26,"code":"  it(`creates different files for possible duplicates`, () => {\n    const filename1 = `some:file`\n    const filename2 = `some*file`\n    const assert1 = path.join(\n      `dir`,\n      `some-file-${createFileHash(filename1)}.png`\n    )\n    const assert2 = path.join(\n      `dir`,\n      `some-file-${createFileHash(filename2)}.png`\n    )\n    expect(createFilePath(`dir`, filename1, `.png`)).toBe(assert1)\n    expect(createFilePath(`dir`, filename2, `.png`)).toBe(assert2)\n  })","file":"filename-utils.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"handles Booleans","suites":["isTruthy"],"updatePoint":{"line":4,"column":22},"line":4,"code":"  it(`handles Booleans`, () => {\n    expect(isTruthy(true)).toBe(true)\n    expect(isTruthy(false)).toBe(false)\n  })","file":"is-truthy.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"handles true or false strings ","suites":["isTruthy"],"updatePoint":{"line":8,"column":36},"line":8,"code":"  it(`handles true or false strings `, () => {\n    expect(isTruthy(`true`)).toBe(true)\n    expect(isTruthy(`false`)).toBe(false)\n    expect(isTruthy(`TRUE`)).toBe(true)\n    expect(isTruthy(`FALSE`)).toBe(false)\n    expect(isTruthy(`TruE`)).toBe(true)\n    expect(isTruthy(`FalsE`)).toBe(false)\n  })","file":"is-truthy.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"handles numbers","suites":["isTruthy"],"updatePoint":{"line":16,"column":21},"line":16,"code":"  it(`handles numbers`, () => {\n    expect(isTruthy(`1`)).toBe(true)\n    expect(isTruthy(`0`)).toBe(false)\n    expect(isTruthy(`-1`)).toBe(false)\n  })","file":"is-truthy.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"defaults to false","suites":["isTruthy"],"updatePoint":{"line":21,"column":23},"line":21,"code":"  it(`defaults to false`, () => {\n    expect(isTruthy(`blah`)).toBe(false)\n  })","file":"is-truthy.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"works for strings and objects with \"resolve\"","suites":["list-plugins"],"updatePoint":{"line":5,"column":50},"line":5,"code":"  it(`works for strings and objects with \"resolve\"`, async () => {\n    const root = path.join(__dirname, `./fixtures`)\n\n    const list = listPlugins({ root })\n    expect(list).toEqual([`gatsby-transformer-remark`, `gatsby-plugin-mdx`])\n  })","file":"list-plugins.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns an empty object when there is no match path interpolation","suites":["getMatchPath"],"updatePoint":{"line":4,"column":71},"line":4,"code":"  it(`returns an empty object when there is no match path interpolation`, () => {\n    expect(getMatchPath(`{Product.foo}/bar`)).toBeUndefined()\n  })","file":"match-path.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns a match for segments","suites":["getMatchPath"],"updatePoint":{"line":8,"column":34},"line":8,"code":"  it(`returns a match for segments`, () => {\n    expect(getMatchPath(`baz/123/[bar]`)).toEqual(`baz/123/:bar`)\n  })","file":"match-path.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns a match for named splats","suites":["getMatchPath"],"updatePoint":{"line":12,"column":38},"line":12,"code":"  it(`returns a match for named splats`, () => {\n    expect(getMatchPath(`baz/123/[...bar]`)).toEqual(`baz/123/*bar`)\n  })","file":"match-path.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns a match for splats","suites":["getMatchPath"],"updatePoint":{"line":16,"column":32},"line":16,"code":"  it(`returns a match for splats`, () => {\n    expect(getMatchPath(`baz/123/[...]`)).toEqual(`baz/123/*`)\n  })","file":"match-path.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"handles multiple matches","suites":["getMatchPath"],"updatePoint":{"line":20,"column":30},"line":20,"code":"  it(`handles multiple matches`, () => {\n    expect(getMatchPath(`/products/[id]/[...page]`)).toEqual(\n      `/products/:id/*page`\n    )\n    expect(getMatchPath(`/products/[brand]/offer/[coupon]`)).toEqual(\n      `/products/:brand/offer/:coupon`\n    )\n  })","file":"match-path.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"handles collection paths in-between","suites":["getMatchPath"],"updatePoint":{"line":29,"column":41},"line":29,"code":"  it(`handles collection paths in-between`, () => {\n    expect(getMatchPath(`/products/{Model.foo}/[...page]`)).toEqual(\n      `/products/{Model.foo}/*page`\n    )\n  })","file":"match-path.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns a hash for a string","suites":["murmurhash"],"updatePoint":{"line":4,"column":33},"line":4,"code":"  it(`returns a hash for a string`, () => {\n    expect(murmurhash(`foo`, 0)).toEqual(2414502773)\n  })","file":"murmurhash.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns same hash for same input string and seed","suites":["murmurhash"],"updatePoint":{"line":7,"column":54},"line":7,"code":"  it(`returns same hash for same input string and seed`, () => {\n    const result = murmurhash(`foo`, 0)\n    expect(murmurhash(`foo`, 0)).toEqual(result)\n  })","file":"murmurhash.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns different hashes for same input string and different seed","suites":["murmurhash"],"updatePoint":{"line":11,"column":71},"line":11,"code":"  it(`returns different hashes for same input string and different seed`, () => {\n    const one = murmurhash(`foo`, 1)\n    const two = murmurhash(`foo`, 2)\n    expect(two).not.toEqual(one)\n    expect(two).toEqual(1907694736)\n  })","file":"murmurhash.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should only allow one action go through at the same time","suites":["mutex"],"updatePoint":{"line":40,"column":62},"line":40,"code":"  it(`should only allow one action go through at the same time`, async () => {\n    const mutex = createMutex(`test-key`, 300)\n\n    const result: Array<string> = []\n\n    doAsync(mutex, result, 50, `1`)\n    await sleep(0)\n    await doAsync(mutex, result, 10, `2`)\n\n    expect(result).toMatchInlineSnapshot(`\n      Array [\n        \"start 1\",\n        \"stop 1\",\n        \"start 2\",\n        \"stop 2\",\n      ]\n    `)\n  })","file":"mutex.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should generate the same mutex if key are identical","suites":["mutex"],"updatePoint":{"line":59,"column":57},"line":59,"code":"  it(`should generate the same mutex if key are identical`, async () => {\n    const mutex1 = createMutex(`test-key`, 300)\n    const mutex2 = createMutex(`test-key`, 300)\n\n    const result: Array<string> = []\n\n    const mutexPromise = doAsync(mutex1, result, 50, `1`)\n    await sleep(0)\n    await doAsync(mutex2, result, 10, `2`)\n    await mutexPromise\n\n    expect(result).toMatchInlineSnapshot(`\n      Array [\n        \"start 1\",\n        \"stop 1\",\n        \"start 2\",\n        \"stop 2\",\n      ]\n    `)\n  })","file":"mutex.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"shouldn't wait if keys are different","suites":["mutex"],"updatePoint":{"line":80,"column":42},"line":80,"code":"  it(`shouldn't wait if keys are different`, async () => {\n    const mutex1 = createMutex(`test-key`, 300)\n    const mutex2 = createMutex(`other-key`, 300)\n\n    const result: Array<string> = []\n\n    const mutexPromise = doAsync(mutex1, result, 50, `1`)\n    await sleep(0)\n    await doAsync(mutex2, result, 10, `2`)\n    await mutexPromise\n\n    expect(result).toMatchInlineSnapshot(`\n      Array [\n        \"start 1\",\n        \"start 2\",\n        \"stop 2\",\n        \"stop 1\",\n      ]\n    `)\n  })","file":"mutex.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns correct page data path","suites":["page-data"],"updatePoint":{"line":5,"column":36},"line":5,"code":"  it(`returns correct page data path`, () => {\n    if (os.platform() !== `win32`) {\n      expect(generatePageDataPath(`public`, `/path/1`)).toBe(\n        `public/page-data/path/1/page-data.json`\n      )\n\n      expect(generatePageDataPath(`public`, `/`)).toBe(\n        `public/page-data/index/page-data.json`\n      )\n    }\n\n    if (os.platform() === `win32`) {\n      expect(generatePageDataPath(`public`, `/path/1`)).toBe(\n        `public\\\\page-data\\\\path\\\\1\\\\page-data.json`\n      )\n\n      expect(generatePageDataPath(`public`, `/`)).toBe(\n        `public\\\\page-data\\\\index\\\\page-data.json`\n      )\n    }\n  })","file":"page-data.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns correct html path","suites":["page-html"],"updatePoint":{"line":5,"column":31},"line":5,"code":"  it(`returns correct html path`, () => {\n    if (os.platform() !== `win32`) {\n      expect(generateHtmlPath(`public`, `/path/1`)).toBe(\n        `public/path/1/index.html`\n      )\n\n      expect(generateHtmlPath(`public`, `/path/1/index.html`)).toBe(\n        `public/path/1/index.html`\n      )\n    }\n\n    if (os.platform() === `win32`) {\n      expect(generateHtmlPath(`public`, `/path/1`)).toBe(\n        `public\\\\path\\\\1\\\\index.html`\n      )\n\n      expect(generateHtmlPath(`public`, `/path/1/index.html`)).toBe(\n        `public\\\\path\\\\1\\\\index.html`\n      )\n    }\n  })","file":"page-html.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"joins paths like path.join on Unix-type platforms.","suites":["paths","joinPath"],"updatePoint":{"line":7,"column":60},"line":7,"code":"      it(`joins paths like path.join on Unix-type platforms.`, () => {\n        const paths = [`/foo`, `bar`, `baz`]\n        const expected = paths.join(`/`)\n        const actual = joinPath(...paths)\n        expect(actual).toBe(expected)\n      })","file":"path.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"replaces '\\\\' with '\\\\\\\\' on Windows.","suites":["paths","joinPath"],"updatePoint":{"line":16,"column":47},"line":16,"code":"      it(`replaces '\\\\' with '\\\\\\\\' on Windows.`, () => {\n        const paths = [`foo`, `bar`, `baz`]\n        const expected = paths.join(`\\\\\\\\`)\n        const actual = joinPath(...paths)\n        expect(actual).toBe(expected)\n      })","file":"path.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"Matches common node files","suites":["paths","isNodePath"],"updatePoint":{"line":25,"column":33},"line":25,"code":"    it(`Matches common node files`, () => {\n      expect(isNodeInternalModulePath(`console.js`)).toBe(true)\n      expect(isNodeInternalModulePath(`http.js`)).toBe(true)\n      expect(isNodeInternalModulePath(`internal/foo`)).toBe(true)\n      const modulePath = `/Users/username/dev/project/node_modules/package-name/index.js`\n      expect(isNodeInternalModulePath(modulePath)).toBe(false)\n    })","file":"path.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"can correctly slash path","suites":["paths","slash path"],"updatePoint":{"line":35,"column":32},"line":35,"code":"    it(`can correctly slash path`, () => {\n      ;[\n        [`foo\\\\bar`, `foo/bar`],\n        [`foo/bar`, `foo/bar`],\n        [`foo\\\\`, `foo/`],\n        [`foo/`, `foo/`],\n        [`foo/`, `foo/`],\n        [`foo\\\\`, `foo/`],\n      ].forEach(([path, expectRes]) => {\n        expect(slash(path)).toBe(expectRes)\n      })\n    })","file":"path.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"does not modify extended length paths","suites":["paths","slash path"],"updatePoint":{"line":48,"column":45},"line":48,"code":"    it(`does not modify extended length paths`, () => {\n      const extended = `\\\\\\\\?\\\\some\\\\path`\n      expect(slash(extended)).toBe(extended)\n    })","file":"path.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should return correct CPU count on %s","suites":["physical-cpu-count"],"line":15,"code":"  it.each([`linux`, `darwin`])(\n    `should return correct CPU count on %s`,\n    (platform: string): void => {\n      const cProc = require(`child_process`)\n      cProc.execSync.mockImplementation((): string => `4`)\n      mockPlatform(platform)\n      const { getPhysicalCpuCount } = require(`../physical-cpu-count`)\n      expect(getPhysicalCpuCount()).toBe(4)\n    }\n  )","file":"physical-cpu-count.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should return fallback CPU count on %s when childProcess fails","suites":["physical-cpu-count"],"line":26,"code":"  it.each([`linux`, `darwin`])(\n    `should return fallback CPU count on %s when childProcess fails`,\n    (platform: string): void => {\n      const cProc = require(`child_process`)\n      cProc.execSync.mockImplementation(() => `4`)\n      mockPlatform(platform)\n      const { getPhysicalCpuCount } = require(`../physical-cpu-count`)\n      expect(getPhysicalCpuCount()).toBe(4)\n    }\n  )","file":"physical-cpu-count.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should return correct CPU count on Windows","suites":["physical-cpu-count"],"updatePoint":{"line":37,"column":48},"line":37,"code":"  it(`should return correct CPU count on Windows`, () => {\n    const cProc = require(`child_process`)\n    os.cpus.mockImplementation(() => [{ model: `Test` }])\n    cProc.execSync.mockImplementation(\n      () => `NumberOfCores\n    4\n    `\n    )\n    mockPlatform(`win32`)\n    const { getPhysicalCpuCount } = require(`../physical-cpu-count`)\n    expect(getPhysicalCpuCount()).toBe(4)\n  })","file":"physical-cpu-count.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should return fallback CPU count on Windows when childProcess fails","suites":["physical-cpu-count"],"updatePoint":{"line":50,"column":73},"line":50,"code":"  it(`should return fallback CPU count on Windows when childProcess fails`, () => {\n    const cProc = require(`child_process`)\n    cProc.execSync.mockImplementation(() => {\n      throw new Error(`Fail!`)\n    })\n    mockPlatform(`win32`)\n    const { getPhysicalCpuCount } = require(`../physical-cpu-count`)\n    expect(getPhysicalCpuCount()).toBe(1)\n  })","file":"physical-cpu-count.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"should check for hyperthreading when intel is the processor","suites":["physical-cpu-count"],"updatePoint":{"line":60,"column":65},"line":60,"code":"  it(`should check for hyperthreading when intel is the processor`, () => {\n    const cProc = require(`child_process`)\n    cProc.execSync.mockImplementation(() => {\n      throw new Error(`Fail!`)\n    })\n\n    os.cpus.mockImplementation(() => [{ model: `Intel` }, { model: `Intel` }])\n    mockPlatform(`linux`)\n    const { getPhysicalCpuCount } = require(`../physical-cpu-count`)\n    expect(getPhysicalCpuCount()).toBe(1)\n  })","file":"physical-cpu-count.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"works for simplest case","suites":["site-metadata","addFieldToMinimalSiteMetadata"],"updatePoint":{"line":21,"column":31},"line":21,"code":"    it(`works for simplest case`, async () => {\n      const root = path.join(__dirname, `./fixtures`)\n\n      await addFieldToMinimalSiteMetadata({ root }, { name, value })\n\n      expect(writeFileMock.mock.calls[0][1]).toMatchInlineSnapshot(`\n        \"module.exports = {\n          siteMetadata: {\n            title: \\`Arrakis\\`,\n            siteUrl: \\`https://www.yourdomain.tld\\`,\n          },\n          plugins: [\n            \\\\\"gatsby-transformer-remark\\\\\",\n            {\n              resolve: \\\\\"gatsby-plugin-mdx\\\\\",\n              options: {}\n            }\n          ]\n        }\"\n      `)\n    })","file":"site-metadata.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"resolves segments into valid url pathname","suites":["url","urlResolve"],"updatePoint":{"line":5,"column":49},"line":5,"code":"    it(`resolves segments into valid url pathname`, () => {\n      const paths = [`/`, ``, `./foo`, `bar`, `baz`]\n      const actual = urlResolve(...paths)\n      expect(actual).toBe(`/foo/bar/baz`)\n    })","file":"url.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"returns","suites":["uuid"],"updatePoint":{"line":9,"column":13},"line":9,"code":"  it(`returns`, () => {\n    const out = uuid()\n    expect(out).toHaveLength(36)\n    expect(typeof out).toBe(`string`)\n  })","file":"uuid.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"unique","suites":["uuid"],"updatePoint":{"line":15,"column":12},"line":15,"code":"  it(`unique`, () => {\n    const length = 1e6\n    expect(uuid()).not.toBe(uuid())\n\n    const unique = new Set(Array.from({ length }, uuid))\n    expect(unique.size).toBe(length)\n  })","file":"uuid.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"validate","suites":["uuid"],"updatePoint":{"line":23,"column":14},"line":23,"code":"  it(`validate`, () => {\n    const arr = Array.from({ length: 1e3 }, uuid)\n    expect(arr.map(item => isUUID.v4(item)).filter(Boolean)).toHaveLength(1e3)\n  })","file":"uuid.ts","skipped":false,"dir":"packages/gatsby-core-utils/src/__tests__"},{"name":"watches files","suites":["watching"],"updatePoint":{"line":81,"column":19,"index":2201},"line":81,"code":"  it(`watches files`, () => {\n    watch(...args);\n    expect(chokidar.watch).toHaveBeenCalledTimes(1);\n    expect(chokidar.watch).toHaveBeenCalledWith(expect.any(Array), {\n      ignored: [expect.any(Function)]\n    });\n  });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"registers on handlers","suites":["watching"],"updatePoint":{"line":88,"column":27,"index":2433},"line":88,"code":"  it(`registers on handlers`, () => {\n    watch(...args);\n    expect(on).toHaveBeenCalledTimes(2);\n    expect(on).toHaveBeenLastCalledWith(`ready`, expect.any(Function));\n  });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"does not copy files on non-watch event","suites":["watching","copying files"],"updatePoint":{"line":94,"column":46,"index":2665},"line":94,"code":"    it(`does not copy files on non-watch event`, () => {\n      watch(...args);\n      callEventCallback(`test`);\n      expect(fs.copy).not.toHaveBeenCalled();\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"it doesn't copy files before ready event","suites":["watching","copying files"],"updatePoint":{"line":99,"column":48,"index":2833},"line":99,"code":"    it(`it doesn't copy files before ready event`, async () => {\n      const filePath = path.join(process.cwd(), `packages/gatsby/dist/index.js`);\n      watch(...args);\n      await callEventCallback(`add`, filePath);\n      expect(fs.copy).toHaveBeenCalledTimes(0);\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"copies files after ready event","suites":["watching","copying files"],"updatePoint":{"line":105,"column":38,"index":3096},"line":105,"code":"    it(`copies files after ready event`, async () => {\n      const filePath = path.join(process.cwd(), `packages/gatsby/dist/index.js`);\n      watch(...args);\n      await callEventCallback(`add`, filePath);\n      await callReadyCallback();\n      expect(fs.copy).toHaveBeenCalledTimes(1);\n      expect(fs.copy).toHaveBeenCalledWith(filePath, path.join(`node_modules`, `gatsby`, `dist`, `index.js`), expect.any(Function));\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"copies cache-dir files","suites":["watching","copying files"],"updatePoint":{"line":113,"column":30,"index":3517},"line":113,"code":"    it(`copies cache-dir files`, async () => {\n      watch(...args);\n      const filePath = path.join(process.cwd(), `packages/gatsby/cache-dir/register-service-worker.js`);\n      await callEventCallback(`add`, filePath);\n      await callReadyCallback();\n      expect(fs.copy).toHaveBeenCalledTimes(2);\n      expect(fs.copy).toHaveBeenLastCalledWith(filePath, path.join(`.cache`, `register-service-worker.js`), expect.any(Function));\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"filters non-existent files/directories","suites":["watching","copying files"],"updatePoint":{"line":121,"column":46,"index":3975},"line":121,"code":"    it(`filters non-existent files/directories`, () => {\n      fs.existsSync.mockReset().mockImplementation(file => false);\n      watch(...args);\n      expect(chokidar.watch).toHaveBeenCalledWith([], expect.any(Object));\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"filters duplicate directories","suites":["watching","copying files"],"updatePoint":{"line":126,"column":37,"index":4195},"line":126,"code":"    it(`filters duplicate directories`, () => {\n      watch(process.cwd(), [`gatsby`, `gatsby`], {\n        ...args[2],\n        localPackages: [`gatsby`]\n      });\n      expect(chokidar.watch).toHaveBeenCalledWith([expect.stringContaining(`gatsby`)], expect.any(Object));\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"does not exit if scanOnce is not defined","suites":["watching","exiting"],"updatePoint":{"line":146,"column":48,"index":4755},"line":146,"code":"    it(`does not exit if scanOnce is not defined`, async () => {\n      watch(...args);\n      await callReadyCallback();\n      expect(process.exit).not.toHaveBeenCalled();\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"exits if scanOnce is defined","suites":["watching","exiting"],"updatePoint":{"line":151,"column":36,"index":4922},"line":151,"code":"    it(`exits if scanOnce is defined`, async () => {\n      watch(process.cwd(), [`gatsby`], {\n        ...args[2],\n        scanOnce: true,\n        localPackages: [`gatsby`]\n      });\n      await callReadyCallback();\n      expect(process.exit).toHaveBeenCalledTimes(1);\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"watching gatsby installs gatsby","suites":["dependency changes","publishing and installing packages"],"updatePoint":{"line":263,"column":39,"index":11016},"line":263,"code":"    it(`watching gatsby installs gatsby`, async () => {\n      checkDepsChanges.mockImplementationOnce(mockDepsChanges([`gatsby`]));\n      watch(process.cwd(), [`gatsby`], {\n        scanOnce: true,\n        quiet: true,\n        monoRepoPackages,\n        packageNameToPath,\n        localPackages: [`gatsby`, `gatsby-plugin-sharp`]\n      });\n      const filePath = path.join(process.cwd(), `packages/gatsby/package.json`);\n      await callEventCallback(`add`, filePath);\n      await callReadyCallback();\n      assertPublish({\n        include: [`gatsby`],\n        exclude: [`gatsby-plugin-sharp`]\n      });\n      assertInstall({\n        include: [`gatsby`],\n        exclude: [`gatsby-cli`, `gatsby-plugin-sharp`]\n      });\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"watching gatsby and gatsby-plugin-sharp installs gatsby and copies gatsby-plugin-sharp","suites":["dependency changes","publishing and installing packages"],"updatePoint":{"line":284,"column":94,"index":11797},"line":284,"code":"    it(`watching gatsby and gatsby-plugin-sharp installs gatsby and copies gatsby-plugin-sharp`, async () => {\n      checkDepsChanges.mockImplementationOnce(mockDepsChanges([`gatsby`]));\n      watch(process.cwd(), [`gatsby`, `gatsby-plugin-sharp`], {\n        scanOnce: true,\n        quiet: true,\n        monoRepoPackages,\n        packageNameToPath,\n        localPackages: [`gatsby`, `gatsby-plugin-sharp`]\n      });\n      const filePath = path.join(process.cwd(), `packages/gatsby/package.json`);\n      await callEventCallback(`add`, filePath);\n      // no deps changes in gatsby-plugin-sharp, just copy files over\n      await callEventCallback(`add`, path.join(process.cwd(), `packages/gatsby-plugin-sharp/index.js`));\n      await callReadyCallback();\n      assertPublish({\n        include: [`gatsby`],\n        exclude: [`gatsby-plugin-sharp`]\n      });\n      assertInstall({\n        include: [`gatsby`],\n        exclude: [`gatsby-cli`, `gatsby-plugin-sharp`]\n      });\n      assertCopy([`gatsby`, `gatsby-plugin-sharp`]);\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"watching gatsby-cli installs gatsby","suites":["dependency changes","publishing and installing packages"],"updatePoint":{"line":308,"column":43,"index":12778},"line":308,"code":"    it(`watching gatsby-cli installs gatsby`, async () => {\n      checkDepsChanges.mockImplementationOnce(mockDepsChanges([`gatsby-cli`]));\n      watch(process.cwd(), [`gatsby-cli`], {\n        scanOnce: true,\n        quiet: true,\n        monoRepoPackages,\n        packageNameToPath,\n        localPackages: [`gatsby`, `gatsby-plugin-sharp`]\n      });\n      const filePath = path.join(process.cwd(), `packages/gatsby-cli/package.json`);\n      await callEventCallback(`add`, filePath);\n      await callReadyCallback();\n      assertPublish({\n        include: [`gatsby`, `gatsby-cli`],\n        exclude: [`gatsby-plugin-sharp`]\n      });\n      assertInstall({\n        include: [`gatsby`],\n        exclude: [`gatsby-cli`, `gatsby-plugin-sharp`]\n      });\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"watching gatsby-source-filesystem and having gatsby-source-wordpress installs gatsby-source-wordpress","suites":["dependency changes","publishing and installing packages"],"updatePoint":{"line":329,"column":109,"index":13600},"line":329,"code":"    it(`watching gatsby-source-filesystem and having gatsby-source-wordpress installs gatsby-source-wordpress`, async () => {\n      checkDepsChanges.mockImplementationOnce(mockDepsChanges([`gatsby-source-filesystem`]));\n      watch(process.cwd(), [`gatsby-source-filesystem`], {\n        scanOnce: true,\n        quiet: true,\n        monoRepoPackages,\n        packageNameToPath,\n        localPackages: [`gatsby`, `gatsby-source-wordpress`, `gatsby-plugin-sharp`]\n      });\n      const filePath = path.join(process.cwd(), `packages/gatsby-source-filesystem/package.json`);\n      await callEventCallback(`add`, filePath);\n      await callReadyCallback();\n      assertPublish({\n        include: [`gatsby-source-wordpress`, `gatsby-source-filesystem`],\n        exclude: [`gatsby`, `gatsby-plugin-sharp`]\n      });\n      assertInstall({\n        include: [`gatsby-source-wordpress`],\n        exclude: [`gatsby`, `gatsby-source-filesystem`, `gatsby-plugin-sharp`]\n      });\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"watching gatsby-source-filesystem and having gatsby-source-filesystem installs gatsby-source-filesystem","suites":["dependency changes","publishing and installing packages"],"updatePoint":{"line":350,"column":111,"index":14575},"line":350,"code":"    it(`watching gatsby-source-filesystem and having gatsby-source-filesystem installs gatsby-source-filesystem`, async () => {\n      checkDepsChanges.mockImplementationOnce(mockDepsChanges([`gatsby-source-filesystem`]));\n      watch(process.cwd(), [`gatsby-source-filesystem`], {\n        scanOnce: true,\n        quiet: true,\n        monoRepoPackages,\n        packageNameToPath,\n        localPackages: [`gatsby`, `gatsby-source-filesystem`, `gatsby-plugin-sharp`]\n      });\n      const filePath = path.join(process.cwd(), `packages/gatsby-source-filesystem/package.json`);\n      await callEventCallback(`add`, filePath);\n      await callReadyCallback();\n      assertPublish({\n        include: [`gatsby-source-filesystem`],\n        exclude: [`gatsby`, `gatsby-plugin-sharp`]\n      });\n      assertInstall({\n        include: [`gatsby-source-filesystem`],\n        exclude: [`gatsby`, `gatsby-plugin-sharp`]\n      });\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"watching gatsby-source-filesystem and not having gatsby-source-filesystem or gatsby-source-wordpress, installs nothing","suites":["dependency changes","publishing and installing packages"],"updatePoint":{"line":371,"column":126,"index":15512},"line":371,"code":"    it(`watching gatsby-source-filesystem and not having gatsby-source-filesystem or gatsby-source-wordpress, installs nothing`, async () => {\n      checkDepsChanges.mockImplementationOnce(mockDepsChanges([`gatsby-source-filesystem`]));\n      watch(process.cwd(), [`gatsby-source-filesystem`], {\n        scanOnce: true,\n        quiet: true,\n        monoRepoPackages,\n        packageNameToPath,\n        localPackages: [`gatsby`, `gatsby-plugin-sharp`]\n      });\n      const filePath = path.join(process.cwd(), `packages/gatsby-source-filesystem/package.json`);\n      await callEventCallback(`add`, filePath);\n      await callReadyCallback();\n      assertPublish({\n        include: [],\n        exclude: [`gatsby`, `gatsby-source-filesystem`, `gatsby-source-wordpress`, `gatsby-plugin-sharp`]\n      });\n      assertInstall({\n        include: [],\n        exclude: [`gatsby`, `gatsby-source-filesystem`, `gatsby-source-wordpress`, `gatsby-plugin-sharp`]\n      });\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"watching gatsby-source-filesystem and both having gatsby-source-filesystem and gatsby-source-wordpress, should install both","suites":["dependency changes","publishing and installing packages"],"updatePoint":{"line":392,"column":131,"index":16484},"line":392,"code":"    it(`watching gatsby-source-filesystem and both having gatsby-source-filesystem and gatsby-source-wordpress, should install both`, async () => {\n      checkDepsChanges.mockImplementationOnce(mockDepsChanges([`gatsby-source-filesystem`]));\n      watch(process.cwd(), [`gatsby-source-filesystem`], {\n        scanOnce: true,\n        quiet: true,\n        monoRepoPackages,\n        packageNameToPath,\n        localPackages: [`gatsby`, `gatsby-source-wordpress`, `gatsby-source-filesystem`, `gatsby-plugin-sharp`]\n      });\n      const filePath = path.join(process.cwd(), `packages/gatsby-source-filesystem/package.json`);\n      await callEventCallback(`add`, filePath);\n      await callReadyCallback();\n      assertPublish({\n        include: [`gatsby-source-filesystem`, `gatsby-source-wordpress`],\n        exclude: [`gatsby`, `gatsby-plugin-sharp`]\n      });\n      assertInstall({\n        include: [`gatsby-source-filesystem`, `gatsby-source-wordpress`],\n        exclude: [`gatsby`, `gatsby-plugin-sharp`]\n      });\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"handle case of package name not matching directory name","suites":["dependency changes","publishing and installing packages"],"updatePoint":{"line":413,"column":63,"index":17439},"line":413,"code":"    it(`handle case of package name not matching directory name`, async () => {\n      checkDepsChanges.mockImplementationOnce(mockDepsChanges([`@gatsbyjs/parcel-namer-relative-to-cwd`]));\n      watch(process.cwd(), [`gatsby`], {\n        scanOnce: true,\n        quiet: true,\n        monoRepoPackages,\n        packageNameToPath,\n        localPackages: [`gatsby`, `gatsby-source-wordpress`, `gatsby-source-filesystem`, `gatsby-plugin-sharp`]\n      });\n      const filePath = path.join(process.cwd(), `packages/gatsby-parcel-namer-relative-to-cwd/package.json`);\n      await callEventCallback(`add`, filePath);\n      await callReadyCallback();\n      assertPublish({\n        include: [`@gatsbyjs/parcel-namer-relative-to-cwd`, `gatsby`, `gatsby-parcel-config`],\n        exclude: [`gatsby-plugin-sharp`]\n      });\n      assertInstall({\n        include: [`gatsby`],\n        exclude: [`@gatsbyjs/parcel-namer-relative-to-cwd`, `gatsby-plugin-sharp`]\n      });\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"publish and installs from verdaccio before copying files","suites":["dependency changes","order of operation"],"updatePoint":{"line":436,"column":64,"index":18447},"line":436,"code":"    it(`publish and installs from verdaccio before copying files`, async () => {\n      let lastOp = null;\n      let installWasCalledAfterFsCopy = false;\n      installPackages.mockImplementation(() => {\n        if (lastOp === fs.copy) {\n          installWasCalledAfterFsCopy = true;\n        }\n        lastOp = installPackages;\n      });\n      fs.copy.mockImplementation(() => {\n        lastOp = fs.copy;\n      });\n      checkDepsChanges.mockImplementationOnce(mockDepsChanges([`gatsby`]));\n      watch(process.cwd(), [`gatsby`], {\n        scanOnce: true,\n        quiet: true,\n        monoRepoPackages,\n        packageNameToPath,\n        localPackages: [`gatsby`, `gatsby-plugin-sharp`]\n      });\n      const filePath = path.join(process.cwd(), `packages/gatsby/package.json`);\n      await callEventCallback(`add`, path.join(process.cwd(), `packages/gatsby/not-package.json`));\n      await callEventCallback(`add`, filePath);\n      await callReadyCallback();\n      expect(installWasCalledAfterFsCopy).toBe(false);\n      expect(installPackages).toBeCalled();\n      expect(fs.copy).toBeCalled();\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"installs from npm before copying files","suites":["dependency changes","order of operation"],"updatePoint":{"line":464,"column":46,"index":19529},"line":464,"code":"    it(`installs from npm before copying files`, async () => {\n      let lastOp = null;\n      let installWasCalledAfterFsCopy = false;\n      promisifiedSpawn.mockImplementation(() => {\n        if (lastOp === fs.copy) {\n          installWasCalledAfterFsCopy = true;\n        }\n        lastOp = promisifiedSpawn;\n      });\n      fs.copy.mockImplementation(() => {\n        lastOp = fs.copy;\n      });\n      checkDepsChanges.mockImplementationOnce(() => Promise.resolve({\n        didDepsChanged: false,\n        packageNotInstalled: true\n      }));\n      watch(process.cwd(), [`gatsby`], {\n        scanOnce: true,\n        quiet: true,\n        monoRepoPackages,\n        packageNameToPath,\n        localPackages: [`gatsby`, `gatsby-plugin-sharp`]\n      });\n      const filePath = path.join(process.cwd(), `packages/gatsby/package.json`);\n      await callEventCallback(`add`, path.join(process.cwd(), `packages/gatsby/not-package.json`));\n      await callEventCallback(`add`, filePath);\n      await callReadyCallback();\n      expect(installWasCalledAfterFsCopy).toBe(false);\n      expect(promisifiedSpawn).toBeCalled();\n      expect(fs.copy).toBeCalled();\n    });","file":"watch.js","skipped":false,"dir":"packages/gatsby-dev-cli/src/__tests__"},{"name":"has the correct polyfills","suites":["polyfills"],"updatePoint":{"line":19,"column":31,"index":694},"line":19,"code":"  it(`has the correct polyfills`, () => {\n    const polyfills = require(`../exclude`).LEGACY_POLYFILLS;\n    const polyfillMap = path.join(packageRoot, tmpDir, `polyfills.js.map`);\n    expect(fs.existsSync(polyfillMap)).toBe(true);\n    const fileMap = polyfills.map(polyfill => {\n      if (polyfill === `features/dom-collections`) {\n        return `core-js/modules/web.dom-collections`;\n      }\n      return `core-js/modules/${polyfill.replace(/^(features|modules)\\//, `es.`).replace(`/`, `.`)}`;\n    });\n    const polyfillMapSource = fs.readFileSync(polyfillMap, `utf8`);\n    const tracer = new TraceMap(polyfillMapSource);\n    const sources = tracer.sources.map(source => source.replace(/.*\\/node_modules\\//, ``));\n\n    // check if all polyfills are in the bundle\n    expect(sources).toEqual(expect.arrayContaining(fileMap.map(file => expect.stringContaining(file))));\n  });","file":"polyfills.js","skipped":false,"dir":"packages/gatsby-legacy-polyfills/src/__tests__"},{"name":"matches basic snapshot","suites":["<Link />"],"updatePoint":{"line":80,"column":28,"index":2427},"line":80,"code":"  it(`matches basic snapshot`, () => {\n    const {\n      container\n    } = setup({\n      linkProps: {\n        to: `/active`\n      }\n    });\n    expect(container).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"matches active snapshot","suites":["<Link />"],"updatePoint":{"line":90,"column":29,"index":2615},"line":90,"code":"  it(`matches active snapshot`, () => {\n    const {\n      container\n    } = setup({\n      sourcePath: `/active`,\n      linkProps: {\n        to: `/active`\n      }\n    });\n    expect(container).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"matches partially active snapshot","suites":["<Link />"],"updatePoint":{"line":101,"column":39,"index":2842},"line":101,"code":"  it(`matches partially active snapshot`, () => {\n    const {\n      container\n    } = setup({\n      sourcePath: `/active`,\n      linkProps: {\n        to: `/active/nested`,\n        partiallyActive: true\n      }\n    });\n    expect(container).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"does not fail to initialize without --prefix-paths","suites":["<Link />"],"updatePoint":{"line":113,"column":56,"index":3124},"line":113,"code":"  it(`does not fail to initialize without --prefix-paths`, () => {\n    expect(() => {\n      getInstance({});\n    }).not.toThrow();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"does not fail with missing __BASE_PATH__","suites":["<Link />"],"updatePoint":{"line":118,"column":46,"index":3251},"line":118,"code":"  it(`does not fail with missing __BASE_PATH__`, () => {\n    delete global.__PATH_PREFIX__;\n    delete global.__BASE_PATH__;\n    const source = createMemorySource(`/active`);\n    expect(() => render( /*#__PURE__*/React.createElement(LocationProvider, {\n      history: createHistory(source)\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: \"/\",\n      className: \"link\",\n      style: {\n        color: `black`\n      },\n      activeClassName: \"is-active\",\n      activeStyle: {\n        textDecoration: `underline`\n      }\n    }, \"link\")))).not.toThrow();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"accepts to as a string","suites":["<Link />","the location to link to"],"updatePoint":{"line":140,"column":30,"index":3903},"line":140,"code":"    it(`accepts to as a string`, () => {\n      const location = `/courses?sort=name`;\n      const {\n        link\n      } = setup({\n        linkProps: {\n          to: location\n        }\n      });\n      expect(link.getAttribute(`href`)).toEqual(location);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"includes the pathPrefix","suites":["<Link />","the location to link to"],"updatePoint":{"line":151,"column":31,"index":4166},"line":151,"code":"    it(`includes the pathPrefix`, () => {\n      const pathPrefix = `/prefixed`;\n      const location = `/courses?sort=name`;\n      const {\n        link\n      } = setup({\n        linkProps: {\n          to: location\n        },\n        pathPrefix\n      });\n      expect(link.getAttribute(`href`)).toEqual(`${pathPrefix}${location}`);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"correctly handles pathPrefix with trailing slash","suites":["<Link />","the location to link to"],"updatePoint":{"line":164,"column":56,"index":4530},"line":164,"code":"    it(`correctly handles pathPrefix with trailing slash`, () => {\n      const pathPrefix = `/prefixed/`;\n      const location = `/courses?sort=name`;\n      const {\n        link\n      } = setup({\n        linkProps: {\n          to: location\n        },\n        pathPrefix\n      });\n      expect(link.getAttribute(`href`)).toEqual(`/prefixed${location}`);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"ignores pathPrefix for external links","suites":["<Link />","the location to link to"],"updatePoint":{"line":177,"column":45,"index":4880},"line":177,"code":"    it(`ignores pathPrefix for external links`, () => {\n      const pathPrefix = `/prefixed/`;\n      const location = `https://example.com`;\n      const {\n        link\n      } = setup({\n        linkProps: {\n          to: location\n        },\n        pathPrefix\n      });\n      expect(link.getAttribute(`href`)).toEqual(location);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"handles relative link with \"./\"","suites":["<Link />","the location to link to"],"updatePoint":{"line":190,"column":39,"index":5211},"line":190,"code":"    it(`handles relative link with \"./\"`, () => {\n      const location = `./courses?sort=name`;\n      const {\n        link\n      } = setup({\n        sourcePath: `/active`,\n        linkProps: {\n          to: location\n        }\n      });\n      expect(link.getAttribute(`href`)).toEqual(`/active/courses?sort=name`);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"handles relative link with \"../\"","suites":["<Link />","the location to link to"],"updatePoint":{"line":202,"column":40,"index":5534},"line":202,"code":"    it(`handles relative link with \"../\"`, () => {\n      const location = `../courses?sort=name`;\n      const {\n        link\n      } = setup({\n        sourcePath: `/active`,\n        linkProps: {\n          to: location\n        }\n      });\n      expect(link.getAttribute(`href`)).toEqual(`/courses?sort=name`);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"handles bare relative link","suites":["<Link />","the location to link to"],"updatePoint":{"line":214,"column":34,"index":5845},"line":214,"code":"    it(`handles bare relative link`, () => {\n      const location = `courses?sort=name`;\n      const {\n        link\n      } = setup({\n        sourcePath: `/active`,\n        linkProps: {\n          to: location\n        }\n      });\n      expect(link.getAttribute(`href`)).toEqual(`/active/courses?sort=name`);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"handles relative link with pathPrefix","suites":["<Link />","the location to link to"],"updatePoint":{"line":226,"column":45,"index":6171},"line":226,"code":"    it(`handles relative link with pathPrefix`, () => {\n      const pathPrefix = `/prefixed`;\n      const sourcePath = `/prefixed/active/`;\n      const location = `./courses?sort=name`;\n      const {\n        link\n      } = setup({\n        linkProps: {\n          to: location\n        },\n        pathPrefix,\n        sourcePath\n      });\n      expect(link.getAttribute(`href`)).toEqual(`${pathPrefix}/active/courses?sort=name`);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"does not warn when internal","suites":["<Link />","the location to link to"],"updatePoint":{"line":241,"column":35,"index":6595},"line":241,"code":"    it(`does not warn when internal`, () => {\n      jest.spyOn(global.console, `warn`);\n      const to = `/courses?sort=name`;\n      setup({\n        linkProps: {\n          to\n        }\n      });\n      expect(console.warn).not.toBeCalled();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"does not warn when relative","suites":["<Link />","the location to link to"],"updatePoint":{"line":251,"column":35,"index":6843},"line":251,"code":"    it(`does not warn when relative`, () => {\n      jest.spyOn(global.console, `warn`);\n      const to = `./courses?sort=name`;\n      setup({\n        linkProps: {\n          to\n        }\n      });\n      expect(console.warn).not.toBeCalled();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"warns when not internal","suites":["<Link />","the location to link to"],"updatePoint":{"line":261,"column":31,"index":7088},"line":261,"code":"    it(`warns when not internal`, () => {\n      jest.spyOn(global.console, `warn`);\n      const to = `https://gatsby.org`;\n      setup({\n        linkProps: {\n          to\n        }\n      });\n      expect(console.warn).toBeCalled();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"respects force disabling replace","suites":["<Link />","uses push or replace adequately"],"updatePoint":{"line":273,"column":40,"index":7397},"line":273,"code":"    it(`respects force disabling replace`, () => {\n      const to = `/`;\n      getNavigate();\n      const {\n        link\n      } = setup({\n        linkProps: {\n          to,\n          replace: false\n        }\n      });\n      link.click();\n      expect(global.___navigate).toHaveBeenCalledWith(`${global.__BASE_PATH__}${to}`, {\n        replace: false\n      });\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"respects force enabling replace","suites":["<Link />","uses push or replace adequately"],"updatePoint":{"line":289,"column":39,"index":7764},"line":289,"code":"    it(`respects force enabling replace`, () => {\n      const to = `/courses`;\n      getNavigate();\n      const {\n        link\n      } = setup({\n        linkProps: {\n          to,\n          replace: true\n        }\n      });\n      link.click();\n      expect(global.___navigate).toHaveBeenCalledWith(`${global.__BASE_PATH__}${to}`, {\n        replace: true\n      });\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"does not replace history when navigating away","suites":["<Link />","uses push or replace adequately"],"updatePoint":{"line":305,"column":53,"index":8150},"line":305,"code":"    it(`does not replace history when navigating away`, () => {\n      const to = `/courses`;\n      getNavigate();\n      const {\n        link\n      } = setup({\n        linkProps: {\n          to\n        }\n      });\n      link.click();\n      expect(global.___navigate).toHaveBeenCalledWith(`${global.__BASE_PATH__}${to}`, {});\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"does replace history when navigating on the same page","suites":["<Link />","uses push or replace adequately"],"updatePoint":{"line":318,"column":61,"index":8490},"line":318,"code":"    it(`does replace history when navigating on the same page`, () => {\n      const to = `/`;\n      getNavigate();\n      const {\n        link\n      } = setup({\n        linkProps: {\n          to\n        }\n      });\n      link.click();\n      expect(global.___navigate).toHaveBeenCalledWith(`${global.__BASE_PATH__}${to}`, {\n        replace: true\n      });\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"default prefix does not return \"//\"","suites":["withPrefix","works with default prefix"],"updatePoint":{"line":337,"column":43,"index":8923},"line":337,"code":"    it(`default prefix does not return \"//\"`, () => {\n      const to = `/`;\n      const root = getWithPrefix()(to);\n      expect(root).toEqual(to);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"respects path prefix","suites":["withPrefix","works with default prefix"],"updatePoint":{"line":342,"column":28,"index":9064},"line":342,"code":"    it(`respects path prefix`, () => {\n      const to = `/abc/`;\n      const pathPrefix = `/blog`;\n      const root = getWithPrefix(pathPrefix)(to);\n      expect(root).toEqual(`${pathPrefix}${to}`);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"falls back to __PATH_PREFIX__ if __BASE_PATH__ is undefined","suites":["withPrefix","works with default prefix"],"updatePoint":{"line":348,"column":67,"index":9310},"line":348,"code":"    it(`falls back to __PATH_PREFIX__ if __BASE_PATH__ is undefined`, () => {\n      global.__BASE_PATH__ = undefined;\n      global.__PATH_PREFIX__ = `/blog`;\n      const to = `/abc/`;\n      expect(withPrefix(to)).toBe(`${global.__PATH_PREFIX__}${to}`);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"default prefix does not return \"//\"","suites":["withAssetPrefix"],"updatePoint":{"line":357,"column":41,"index":9591},"line":357,"code":"  it(`default prefix does not return \"//\"`, () => {\n    const to = `/`;\n    const root = getWithAssetPrefix()(to);\n    expect(root).toEqual(to);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"respects pathPrefix","suites":["withAssetPrefix"],"updatePoint":{"line":362,"column":25,"index":9726},"line":362,"code":"  it(`respects pathPrefix`, () => {\n    const to = `/abc/`;\n    const pathPrefix = `/blog`;\n    const root = getWithAssetPrefix(pathPrefix)(to);\n    expect(root).toEqual(`${pathPrefix}${to}`);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"respects joined assetPrefix + pathPrefix","suites":["withAssetPrefix"],"updatePoint":{"line":368,"column":46,"index":9946},"line":368,"code":"  it(`respects joined assetPrefix + pathPrefix`, () => {\n    const to = `/itsdatboi/`;\n    const pathPrefix = `https://cdn.example.com/blog`;\n    const root = getWithAssetPrefix(pathPrefix)(to);\n    expect(root).toEqual(`${pathPrefix}${to}`);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"navigates to correct path","suites":["navigate"],"updatePoint":{"line":376,"column":31,"index":10213},"line":376,"code":"  it(`navigates to correct path`, () => {\n    const to = `/some-path`;\n    getNavigate()(to);\n    expect(global.___navigate).toHaveBeenCalledWith(to, undefined);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"respects pathPrefix","suites":["navigate"],"updatePoint":{"line":381,"column":25,"index":10375},"line":381,"code":"  it(`respects pathPrefix`, () => {\n    const to = `/some-path`;\n    global.__BASE_PATH__ = `/blog`;\n    getNavigate()(to);\n    expect(global.___navigate).toHaveBeenCalledWith(`${global.__BASE_PATH__}${to}`, undefined);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"passes a state object","suites":["navigate"],"updatePoint":{"line":387,"column":27,"index":10603},"line":387,"code":"  it(`passes a state object`, () => {\n    const to = `/some-path`;\n    const options = {\n      state: {\n        myStateKey: `a state value`\n      }\n    };\n    getNavigate()(to, options);\n    expect(global.___navigate).toHaveBeenCalledWith(`${global.__BASE_PATH__}${to}`, options);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"forwards ref","suites":["ref forwarding"],"updatePoint":{"line":399,"column":18,"index":10920},"line":399,"code":"  it(`forwards ref`, () => {\n    const ref = jest.fn();\n    setup({\n      linkProps: {\n        ref\n      }\n    });\n    expect(ref).toHaveBeenCalledTimes(1);\n    expect(ref).toHaveBeenCalledWith(expect.any(HTMLElement));\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"remains backwards compatible with innerRef","suites":["ref forwarding"],"updatePoint":{"line":409,"column":48,"index":11176},"line":409,"code":"  it(`remains backwards compatible with innerRef`, () => {\n    const innerRef = jest.fn();\n    setup({\n      linkProps: {\n        innerRef\n      }\n    });\n    expect(innerRef).toHaveBeenCalledTimes(1);\n    expect(innerRef).toHaveBeenCalledWith(expect.any(HTMLElement));\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"handles a RefObject (React >=16.4)","suites":["ref forwarding"],"updatePoint":{"line":419,"column":40,"index":11444},"line":419,"code":"  it(`handles a RefObject (React >=16.4)`, () => {\n    const ref = /*#__PURE__*/React.createRef(null);\n    setup({\n      linkProps: {\n        ref\n      }\n    });\n    expect(ref.current).toEqual(expect.any(HTMLElement));\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"passes a state object","suites":["state"],"updatePoint":{"line":430,"column":27,"index":11687},"line":430,"code":"  it(`passes a state object`, () => {\n    const to = `/`;\n    const state = {\n      myStateKey: `a state value`\n    };\n    getNavigate();\n    const {\n      link\n    } = setup({\n      linkProps: {\n        state\n      }\n    });\n    link.click();\n    expect(global.___navigate).toHaveBeenCalledWith(`${global.__BASE_PATH__}${to}`, {\n      replace: true,\n      state\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"it prefetches when in viewport","suites":["prefetch"],"updatePoint":{"line":456,"column":36,"index":12190},"line":456,"code":"  it(`it prefetches when in viewport`, () => {\n    const to = `/active`;\n    const {\n      link,\n      triggerInViewport\n    } = setup({\n      linkProps: {\n        to\n      }\n    });\n    triggerInViewport(link);\n    expect(global.___loader.enqueue).toHaveBeenCalledWith(`${global.__BASE_PATH__}${to}`);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"it does not prefetch if link is current page","suites":["prefetch"],"updatePoint":{"line":469,"column":50,"index":12513},"line":469,"code":"  it(`it does not prefetch if link is current page`, () => {\n    const to = `/active`;\n    const {\n      link,\n      triggerInViewport\n    } = setup({\n      sourcePath: `/active`,\n      linkProps: {\n        to\n      }\n    });\n    triggerInViewport(link);\n    expect(global.___loader.enqueue).not.toHaveBeenCalledWith(`${global.__BASE_PATH__}${to}`);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"returns true on relative link","suites":["isLocalLink"],"updatePoint":{"line":3,"column":35,"index":116},"line":3,"code":"  it(`returns true on relative link`, () => {\n    expect(isLocalLink(`/docs/some-doc`)).toBe(true);\n  });","file":"is-local-link.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"returns false on absolute link","suites":["isLocalLink"],"updatePoint":{"line":6,"column":36,"index":223},"line":6,"code":"  it(`returns false on absolute link`, () => {\n    expect(isLocalLink(`https://www.gatsbyjs.com`)).toBe(false);\n  });","file":"is-local-link.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"returns undefined if input is undefined or not a string","suites":["isLocalLink"],"updatePoint":{"line":9,"column":61,"index":366},"line":9,"code":"  it(`returns undefined if input is undefined or not a string`, () => {\n    expect(isLocalLink(undefined)).toBeUndefined();\n    expect(isLocalLink(-1)).toBeUndefined();\n  });","file":"is-local-link.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"throws TypeError if input is undefined","suites":["isLocalLink"],"line":14,"code":"  it.skip(`throws TypeError if input is undefined`, () => {","file":"is-local-link.js","skipped":true,"dir":"packages/gatsby-link/src/__tests__"},{"name":"throws TypeError if input is not a string","suites":["isLocalLink"],"line":17,"code":"  it.skip(`throws TypeError if input is not a string`, () => {","file":"is-local-link.js","skipped":true,"dir":"packages/gatsby-link/src/__tests__"},{"name":"it defaults to root if undefined","suites":[],"updatePoint":{"line":2,"column":38,"index":82},"line":2,"code":"test(`it defaults to root if undefined`, () => {\n  expect(parsePath()).toEqual({\n    pathname: `/`,\n    search: ``,\n    hash: ``\n  });\n});","file":"parse-path.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"it uses passed path, if defined","suites":[],"updatePoint":{"line":9,"column":37,"index":220},"line":9,"code":"test(`it uses passed path, if defined`, () => {\n  const path = `/admin`;\n  expect(parsePath(path)).toEqual({\n    pathname: path,\n    search: ``,\n    hash: ``\n  });\n});","file":"parse-path.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"it returns query string","suites":[],"updatePoint":{"line":17,"column":29,"index":380},"line":17,"code":"test(`it returns query string`, () => {\n  const search = `?some-thing=true&other-thing=false`;\n  const pathname = `/admin`;\n  const path = `${pathname}${search}`;\n  expect(parsePath(path)).toEqual({\n    pathname,\n    search,\n    hash: ``\n  });\n});","file":"parse-path.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"it returns hash","suites":[],"updatePoint":{"line":27,"column":21,"index":620},"line":27,"code":"test(`it returns hash`, () => {\n  const hash = `#some-id`;\n  const pathname = `/admin`;\n  const path = `${pathname}${hash}`;\n  expect(parsePath(path)).toEqual({\n    pathname,\n    hash,\n    search: ``\n  });\n});","file":"parse-path.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"it returns hash, search, and pathname if all defined","suites":[],"updatePoint":{"line":37,"column":58,"index":867},"line":37,"code":"test(`it returns hash, search, and pathname if all defined`, () => {\n  const hash = `#some-id`;\n  const pathname = `/admin`;\n  const search = `?this-thing=true&other-thing=false`;\n  const path = `${pathname}${search}${hash}`;\n  expect(parsePath(path)).toEqual({\n    pathname,\n    search,\n    hash\n  });\n});","file":"parse-path.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"handles always option","suites":["rewriteLinkPath"],"updatePoint":{"line":12,"column":27,"index":397},"line":12,"code":"  it(`handles always option`, () => {\n    expect(getRewriteLinkPath(`always`)(`/path`, `/`)).toBe(`/path/`);\n    expect(getRewriteLinkPath(`always`)(`/path/`, `/`)).toBe(`/path/`);\n    expect(getRewriteLinkPath(`always`)(`#hash`, `/`)).toBe(`/#hash`);\n    expect(getRewriteLinkPath(`always`)(`?query_param=hello`, `/`)).toBe(`/?query_param=hello`);\n    expect(getRewriteLinkPath(`always`)(`?query_param=hello#anchor`, `/`)).toBe(`/?query_param=hello#anchor`);\n    expect(getRewriteLinkPath(`always`)(`/path#hash`, `/`)).toBe(`/path/#hash`);\n    expect(getRewriteLinkPath(`always`)(`/path?query_param=hello`, `/`)).toBe(`/path/?query_param=hello`);\n    expect(getRewriteLinkPath(`always`)(`/path?query_param=hello#anchor`, `/`)).toBe(`/path/?query_param=hello#anchor`);\n    expect(getRewriteLinkPath(`always`, `/prefix`)(`/`, `/`)).toBe(`/prefix/`);\n  });","file":"rewrite-link-path.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"handles never option","suites":["rewriteLinkPath"],"updatePoint":{"line":23,"column":26,"index":1251},"line":23,"code":"  it(`handles never option`, () => {\n    expect(getRewriteLinkPath(`never`)(`/path`, `/`)).toBe(`/path`);\n    expect(getRewriteLinkPath(`never`)(`/path/`, `/`)).toBe(`/path`);\n    expect(getRewriteLinkPath(`always`)(`#hash`, `/`)).toBe(`/#hash`);\n    expect(getRewriteLinkPath(`always`)(`?query_param=hello`, `/`)).toBe(`/?query_param=hello`);\n    expect(getRewriteLinkPath(`always`)(`?query_param=hello#anchor`, `/`)).toBe(`/?query_param=hello#anchor`);\n    expect(getRewriteLinkPath(`never`)(`/path/#hash`, `/`)).toBe(`/path#hash`);\n    expect(getRewriteLinkPath(`never`)(`/path/?query_param=hello`, `/`)).toBe(`/path?query_param=hello`);\n    expect(getRewriteLinkPath(`never`)(`/path/?query_param=hello#anchor`, `/`)).toBe(`/path?query_param=hello#anchor`);\n    expect(getRewriteLinkPath(`never`, `/prefix`)(`/`, `/`)).toBe(`/prefix`);\n  });","file":"rewrite-link-path.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"handles ignore option","suites":["rewriteLinkPath"],"updatePoint":{"line":34,"column":27,"index":2097},"line":34,"code":"  it(`handles ignore option`, () => {\n    expect(getRewriteLinkPath(`ignore`)(`/path`, `/`)).toBe(`/path`);\n    expect(getRewriteLinkPath(`ignore`)(`/path/`, `/`)).toBe(`/path/`);\n    expect(getRewriteLinkPath(`always`)(`#hash`, `/`)).toBe(`/#hash`);\n    expect(getRewriteLinkPath(`always`)(`?query_param=hello`, `/`)).toBe(`/?query_param=hello`);\n    expect(getRewriteLinkPath(`always`)(`?query_param=hello#anchor`, `/`)).toBe(`/?query_param=hello#anchor`);\n    expect(getRewriteLinkPath(`ignore`)(`/path#hash`, `/`)).toBe(`/path#hash`);\n    expect(getRewriteLinkPath(`ignore`)(`/path?query_param=hello`, `/`)).toBe(`/path?query_param=hello`);\n    expect(getRewriteLinkPath(`ignore`)(`/path?query_param=hello#anchor`, `/`)).toBe(`/path?query_param=hello#anchor`);\n    expect(getRewriteLinkPath(`ignore`, `/prefix`)(`/`, `/`)).toBe(`/prefix/`);\n  });","file":"rewrite-link-path.js","skipped":false,"dir":"packages/gatsby-link/src/__tests__"},{"name":"returns / for root index page","suites":["applyTrailingSlashOption"],"updatePoint":{"line":8,"column":35},"line":8,"code":"  it(`returns / for root index page`, () => {\n    expect(applyTrailingSlashOption(indexPage)).toEqual(indexPage)\n  })","file":"apply-trailing-slash-option.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should leave non-trailing paths for certain suffixes","suites":["applyTrailingSlashOption"],"updatePoint":{"line":11,"column":58},"line":11,"code":"  it(`should leave non-trailing paths for certain suffixes`, () => {\n    expect(applyTrailingSlashOption(`/nested/path.html`)).toEqual(\n      `/nested/path.html`\n    )\n    expect(applyTrailingSlashOption(`/nested/path.xml`)).toEqual(\n      `/nested/path.xml`\n    )\n  })","file":"apply-trailing-slash-option.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should add trailing slash","suites":["applyTrailingSlashOption","always"],"updatePoint":{"line":20,"column":33},"line":20,"code":"    it(`should add trailing slash`, () => {\n      expect(applyTrailingSlashOption(withoutSlash, `always`)).toEqual(\n        withSlash\n      )\n    })","file":"apply-trailing-slash-option.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should leave existing slash","suites":["applyTrailingSlashOption","always"],"updatePoint":{"line":25,"column":35},"line":25,"code":"    it(`should leave existing slash`, () => {\n      expect(applyTrailingSlashOption(withSlash, `always`)).toEqual(withSlash)\n    })","file":"apply-trailing-slash-option.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should leave root index","suites":["applyTrailingSlashOption","never"],"updatePoint":{"line":30,"column":31},"line":30,"code":"    it(`should leave root index`, () => {\n      expect(applyTrailingSlashOption(indexPage, `never`)).toEqual(indexPage)\n    })","file":"apply-trailing-slash-option.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should remove trailing slashes","suites":["applyTrailingSlashOption","never"],"updatePoint":{"line":33,"column":38},"line":33,"code":"    it(`should remove trailing slashes`, () => {\n      expect(applyTrailingSlashOption(withSlash, `never`)).toEqual(withoutSlash)\n    })","file":"apply-trailing-slash-option.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should leave non-trailing paths","suites":["applyTrailingSlashOption","never"],"updatePoint":{"line":36,"column":39},"line":36,"code":"    it(`should leave non-trailing paths`, () => {\n      expect(applyTrailingSlashOption(withoutSlash, `never`)).toEqual(\n        withoutSlash\n      )\n    })","file":"apply-trailing-slash-option.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should return input (trailing)","suites":["applyTrailingSlashOption","ignore"],"updatePoint":{"line":43,"column":38},"line":43,"code":"    it(`should return input (trailing)`, () => {\n      expect(applyTrailingSlashOption(withSlash, `ignore`)).toEqual(withSlash)\n    })","file":"apply-trailing-slash-option.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should return input (non-trailing)","suites":["applyTrailingSlashOption","ignore"],"updatePoint":{"line":46,"column":42},"line":46,"code":"    it(`should return input (non-trailing)`, () => {\n      expect(applyTrailingSlashOption(withoutSlash, `ignore`)).toEqual(\n        withoutSlash\n      )\n    })","file":"apply-trailing-slash-option.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should create unix paths","suites":["create-path"],"updatePoint":{"line":4,"column":30},"line":4,"code":"  it(`should create unix paths`, () => {\n    const paths = [`b/c/de`, `bee`, `b/d/c/`]\n\n    expect(paths.map(p => createPath(p))).toMatchInlineSnapshot(`\n      Array [\n        \"/b/c/de\",\n        \"/bee\",\n        \"/b/d/c\",\n      ]\n    `)\n  })","file":"create-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should convert windows seperator to unix seperator","suites":["create-path"],"updatePoint":{"line":15,"column":56},"line":15,"code":"  it(`should convert windows seperator to unix seperator`, () => {\n    expect(createPath(`lorem\\\\foo\\\\bar`)).toEqual(`/lorem/foo/bar`)\n  })","file":"create-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should parse index","suites":["create-path"],"updatePoint":{"line":18,"column":24},"line":18,"code":"  it(`should parse index`, () => {\n    expect(createPath(`foo/bar/index`)).toEqual(`/foo/bar`)\n  })","file":"create-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should have working trailingSlash option","suites":["create-path"],"updatePoint":{"line":21,"column":46},"line":21,"code":"  it(`should have working trailingSlash option`, () => {\n    expect(createPath(`foo/bar/`, false)).toEqual(`/foo/bar`)\n    expect(createPath(`foo/bar/index`, false)).toEqual(`/foo/bar`)\n    expect(createPath(`foo/bar/`, true)).toEqual(`/foo/bar/`)\n    expect(createPath(`foo/bar/index`, true)).toEqual(`/foo/bar/`)\n  })","file":"create-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should support client-only routes","suites":["create-path"],"updatePoint":{"line":27,"column":39},"line":27,"code":"  it(`should support client-only routes`, () => {\n    expect(createPath(`foo/[name]`, false, true)).toEqual(`/foo/[name]`)\n  })","file":"create-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should support client-only splat routes","suites":["create-path"],"updatePoint":{"line":30,"column":45},"line":30,"code":"  it(`should support client-only splat routes`, () => {\n    expect(createPath(`foo/[...name]`, false, true)).toEqual(`/foo/[...name]`)\n    expect(createPath(`foo/[...]`, false, true)).toEqual(`/foo/[...]`)\n  })","file":"create-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"does not filter files without an ignore object","suites":["ignore-path"],"updatePoint":{"line":4,"column":52},"line":4,"code":"  it(`does not filter files without an ignore object`, () => {\n    const ignoreFiles = [\n      { path: `blog.js` },\n      { path: `post.tsx` },\n      { path: `file.example.jsx` },\n      { path: `file.example.tsx` },\n      { path: `dir/file.example.js` },\n    ]\n\n    const testFiles = ignoreFiles.concat([\n      // blog or post in sub directory, other pages in top directory\n      { path: `dir/blog.jsx` },\n      { path: `dir/post.ts` },\n      { path: `other.js` },\n      // example page or directory without the prepended extension\n      { path: `example.js` },\n      { path: `example/file.tsx` },\n      { path: `dir/example.jsx` },\n    ])\n\n    expect(testFiles.filter(file => ignorePath(file.path, null))).toEqual([])\n  })","file":"ignore-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"does not filter files without any ignore patterns","suites":["ignore-path"],"updatePoint":{"line":27,"column":55},"line":27,"code":"  it(`does not filter files without any ignore patterns`, () => {\n    const ignoreFiles = [\n      { path: `blog.js` },\n      { path: `post.tsx` },\n      { path: `file.example.jsx` },\n      { path: `file.example.tsx` },\n      { path: `dir/file.example.js` },\n    ]\n\n    const testFiles = ignoreFiles.concat([\n      // blog or post in sub directory, other pages in top directory\n      { path: `dir/blog.jsx` },\n      { path: `dir/post.ts` },\n      { path: `other.js` },\n      // example page or directory without the preprended extension\n      { path: `example.js` },\n      { path: `example/file.tsx` },\n      { path: `dir/example.jsx` },\n    ])\n\n    expect(testFiles.filter(file => ignorePath(file.path, {}))).toEqual([])\n  })","file":"ignore-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"filters out files matching ignore patterns","suites":["ignore-path"],"updatePoint":{"line":50,"column":48},"line":50,"code":"  it(`filters out files matching ignore patterns`, () => {\n    const patterns = [\n      // files named 'blog' or 'post' in top of pages directory\n      `(blog|post).(js|ts|jsx|tsx)*`,\n      // any files with .example prepended to the js(x)/ts(x) extension\n      `**/*.example.(js|ts|jsx|tsx)`,\n    ]\n\n    const ignoreFiles = [\n      { path: `blog.js` },\n      { path: `post.tsx` },\n      { path: `file.example.jsx` },\n      { path: `file.example.tsx` },\n      { path: `dir/file.example.js` },\n    ]\n\n    const testFiles = ignoreFiles.concat([\n      // blog or post in sub directory, other pages in top directory\n      { path: `dir/blog.jsx` },\n      { path: `dir/post.ts` },\n      { path: `other.js` },\n      // example page or directory without the preprended extension\n      { path: `example.js` },\n      { path: `example/file.tsx` },\n      { path: `dir/example.jsx` },\n    ])\n\n    expect(\n      testFiles.filter(file => ignorePath(file.path, { patterns }))\n    ).toEqual(ignoreFiles)\n  })","file":"ignore-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"filters out files matching ignore patterns w/ options.nocase","suites":["ignore-path"],"updatePoint":{"line":82,"column":66},"line":82,"code":"  it(`filters out files matching ignore patterns w/ options.nocase`, () => {\n    const patterns = [\n      // files named 'blog' or 'post' in top of pages directory\n      `(blog|post).(js|ts|jsx|tsx)*`,\n      // any files with .example prepended to the js(x)/ts(x) extension\n      `**/*.example.(js|ts|jsx|tsx)`,\n    ]\n\n    // https://www.npmjs.com/package/micromatch#optionsnocase\n    const options = { nocase: true }\n\n    const ignoreFiles = [\n      { path: `blog.js` },\n      { path: `POST.tsx` },\n      { path: `file.example.jsx` },\n      { path: `file.EXAMPLE.tsx` },\n      { path: `dir/file.example.js` },\n      { path: `dir/file.EXAMPLE.js` },\n    ]\n\n    const testFiles = ignoreFiles.concat([\n      // blog or post in sub directory, other pages in top directory\n      { path: `dir/blog.jsx` },\n      { path: `dir/post.ts` },\n      { path: `other.js` },\n      // example page or directory without the preprended extension\n      { path: `example.js` },\n      { path: `example/file.tsx` },\n      { path: `dir/example.jsx` },\n    ])\n\n    expect(\n      testFiles.filter(file => ignorePath(file.path, { patterns, options }))\n    ).toEqual(ignoreFiles)\n  })","file":"ignore-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"filters out files matching ignore patterns as shorthand array","suites":["ignore-path"],"updatePoint":{"line":118,"column":67},"line":118,"code":"  it(`filters out files matching ignore patterns as shorthand array`, () => {\n    const patterns = [\n      // files named 'blog' or 'post' in top of pages directory\n      `(blog|post).(js|ts|jsx|tsx)*`,\n      // any files with .example prepended to the js(x)/ts(x) extension\n      `**/*.example.(js|ts|jsx|tsx)`,\n    ]\n\n    const ignoreFiles = [\n      { path: `blog.js` },\n      { path: `post.tsx` },\n      { path: `file.example.jsx` },\n      { path: `file.example.tsx` },\n      { path: `dir/file.example.js` },\n    ]\n\n    const testFiles = ignoreFiles.concat([\n      // blog or post in sub directory, other pages in top directory\n      { path: `dir/blog.jsx` },\n      { path: `dir/post.ts` },\n      { path: `other.js` },\n      // example page or directory without the preprended extension\n      { path: `example.js` },\n      { path: `example/file.tsx` },\n      { path: `dir/example.jsx` },\n    ])\n\n    expect(testFiles.filter(file => ignorePath(file.path, patterns))).toEqual(\n      ignoreFiles\n    )\n  })","file":"ignore-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"filters out files matching ignore pattern as shorthand string","suites":["ignore-path"],"updatePoint":{"line":150,"column":67},"line":150,"code":"  it(`filters out files matching ignore pattern as shorthand string`, () => {\n    const pattern = `(blog|post).(js|ts|jsx|tsx)*`\n    // files named 'blog' or 'post' in top of pages directory\n\n    const ignoreFiles = [{ path: `blog.js` }, { path: `post.tsx` }]\n\n    const testFiles = ignoreFiles.concat([\n      // blog or post in sub directory, other pages in top directory\n      { path: `dir/blog.jsx` },\n      { path: `dir/post.ts` },\n      { path: `other.js` },\n    ])\n\n    expect(testFiles.filter(file => ignorePath(file.path, pattern))).toEqual(\n      ignoreFiles\n    )\n  })","file":"ignore-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"includes the correct file types","suites":["validatePath"],"updatePoint":{"line":4,"column":37},"line":4,"code":"  it(`includes the correct file types`, () => {\n    const validFiles = [\n      { path: `test1.js` },\n      { path: `somedir/test1.js` },\n      { path: `somedir/test2.ts` },\n      { path: `somedir/dir2/test1.js` },\n    ]\n\n    expect(validFiles.filter(file => validatePath(file.path))).toEqual(\n      validFiles\n    )\n  })","file":"validate-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"filters out files that start with underscores","suites":["validatePath"],"updatePoint":{"line":17,"column":51},"line":17,"code":"  it(`filters out files that start with underscores`, () => {\n    const validFiles = [{ path: `something/blah.js` }, { path: `test1.js` }]\n\n    const testFiles = validFiles.concat([\n      { path: `something/_foo.js` },\n      { path: `_blah.js` },\n    ])\n\n    expect(testFiles.filter(file => validatePath(file.path))).toEqual(\n      validFiles\n    )\n  })","file":"validate-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"filters out files that start with dot","suites":["validatePath"],"updatePoint":{"line":30,"column":43},"line":30,"code":"  it(`filters out files that start with dot`, () => {\n    const validFiles = [{ path: `something/blah.js` }, { path: `test1.ts` }]\n\n    const testFiles = validFiles.concat([\n      { path: `.eslintrc` },\n      { path: `something/.eslintrc` },\n      { path: `something/.eslintrc.js` },\n      { path: `.markdownlint.json` },\n      { path: `something/.markdownlint.json` },\n    ])\n\n    expect(testFiles.filter(file => validatePath(file.path))).toEqual(\n      validFiles\n    )\n  })","file":"validate-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"filters out json and yaml files","suites":["validatePath"],"updatePoint":{"line":46,"column":37},"line":46,"code":"  it(`filters out json and yaml files`, () => {\n    const validFiles = [{ path: `somefile.js` }, { path: `something/blah.js` }]\n\n    const testFiles = validFiles.concat([\n      { path: `something/otherConfig.yml` },\n      { path: `config.yaml` },\n      { path: `somefile.json` },\n      { path: `dir1/file.json` },\n      { path: `dir1/dir2/file.json` },\n    ])\n\n    expect(testFiles.filter(file => validatePath(file.path))).toEqual(\n      validFiles\n    )\n  })","file":"validate-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"filters out files that start with template-*","suites":["validatePath"],"updatePoint":{"line":62,"column":50},"line":62,"code":"  it(`filters out files that start with template-*`, () => {\n    const validFiles = [{ path: `something/blah.js` }, { path: `file1.js` }]\n\n    const testFiles = validFiles.concat([\n      { path: `template-cool-page-type.js` },\n    ])\n\n    expect(testFiles.filter(file => validatePath(file.path))).toEqual(\n      validFiles\n    )\n  })","file":"validate-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"filters out files that have TypeScript declaration extensions","suites":["validatePath"],"updatePoint":{"line":74,"column":67},"line":74,"code":"  it(`filters out files that have TypeScript declaration extensions`, () => {\n    const validFiles = [\n      { path: `something/foo.ts` },\n      { path: `something/bar.tsx` },\n    ]\n\n    const testFiles = validFiles.concat([\n      { path: `something/declaration-file.d.ts` },\n      { path: `something-else/other-declaration-file.d.tsx` },\n    ])\n\n    expect(testFiles.filter(file => validatePath(file.path))).toEqual(\n      validFiles\n    )\n  })","file":"validate-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"filters out test files","suites":["validatePath"],"updatePoint":{"line":90,"column":28},"line":90,"code":"  it(`filters out test files`, () => {\n    const validFiles = [{ path: `page.js` }, { path: `page.jsx` }]\n\n    const testFiles = validFiles.concat([\n      { path: `src/pages/__tests__/something.test.js` },\n      { path: `src/pages/__tests__/something.test.tsx` },\n      { path: `src/pages/__tests__/something.js` },\n      { path: `src/pages/__tests__/nested-directory/something.js` },\n      { path: `src/pages/foo.spec.js` },\n      { path: `src/pages/foo.spec.tsx` },\n      { path: `src/pages/bar.test.js` },\n      { path: `src/pages/bar.test.tsx` },\n      { path: `src\\\\pages\\\\bar.test.js` },\n      { path: `src\\\\pages\\\\__tests__\\\\nested-directory\\\\something.js` },\n    ])\n\n    expect(testFiles.filter(file => validatePath(file.path))).toEqual(\n      validFiles\n    )\n  })","file":"validate-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"doesn't filter out test.js","suites":["validatePath"],"updatePoint":{"line":111,"column":32},"line":111,"code":"  it(`doesn't filter out test.js`, () => {\n    const validFiles = [{ path: `src/pages/test.js` }]\n\n    expect(validFiles.filter(file => validatePath(file.path))).toEqual(\n      validFiles\n    )\n  })","file":"validate-path.ts","skipped":false,"dir":"packages/gatsby-page-utils/src/__tests__"},{"name":"should update the href","suites":["gatsby-plugin-canonical-urls"],"updatePoint":{"line":13,"column":28,"index":361},"line":13,"code":"  it(`should update the href`, () => {\n    onRouteUpdate({\n      location: {\n        pathname: `/hogwarts`,\n        hash: ``,\n        search: ``\n      }\n    });\n    expect(global.document.head.innerHTML).toMatchInlineSnapshot(`\"<link data-basehost=\\\\\"someurl.com\\\\\" data-baseprotocol=\\\\\"http:\\\\\" href=\\\\\"http://someurl.com/hogwarts\\\\\" rel=\\\\\"canonical\\\\\">\"`);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-canonical-urls/src/__tests__"},{"name":"should keep the hash","suites":["gatsby-plugin-canonical-urls"],"updatePoint":{"line":23,"column":26,"index":725},"line":23,"code":"  it(`should keep the hash`, () => {\n    onRouteUpdate({\n      location: {\n        pathname: `/hogwarts`,\n        hash: `#harry-potter`,\n        search: ``\n      }\n    });\n    expect(global.document.head.innerHTML).toMatchInlineSnapshot(`\"<link data-basehost=\\\\\"someurl.com\\\\\" data-baseprotocol=\\\\\"http:\\\\\" href=\\\\\"http://someurl.com/hogwarts#harry-potter\\\\\" rel=\\\\\"canonical\\\\\">\"`);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-canonical-urls/src/__tests__"},{"name":"shouldn't strip search parameter by default","suites":["gatsby-plugin-canonical-urls"],"updatePoint":{"line":33,"column":49,"index":1138},"line":33,"code":"  it(`shouldn't strip search parameter by default`, () => {\n    onRouteUpdate({\n      location: {\n        pathname: `/hogwarts`,\n        hash: ``,\n        search: `?house=gryffindor`\n      }\n    });\n    expect(global.document.head.innerHTML).toMatchInlineSnapshot(`\"<link data-basehost=\\\\\"someurl.com\\\\\" data-baseprotocol=\\\\\"http:\\\\\" href=\\\\\"http://someurl.com/hogwarts?house=gryffindor\\\\\" rel=\\\\\"canonical\\\\\">\"`);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-canonical-urls/src/__tests__"},{"name":"should strip search parameters if option stripQueryString is true","suites":["gatsby-plugin-canonical-urls"],"updatePoint":{"line":43,"column":71,"index":1581},"line":43,"code":"  it(`should strip search parameters if option stripQueryString is true`, () => {\n    const pluginOptions = {\n      stripQueryString: true\n    };\n    onRouteUpdate({\n      location: {\n        pathname: `/hogwarts`,\n        hash: ``,\n        search: `?house=gryffindor`\n      }\n    }, pluginOptions);\n    expect(global.document.head.innerHTML).toMatchInlineSnapshot(`\"<link data-basehost=\\\\\"someurl.com\\\\\" data-baseprotocol=\\\\\"http:\\\\\" href=\\\\\"http://someurl.com/hogwarts\\\\\" rel=\\\\\"canonical\\\\\">\"`);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-canonical-urls/src/__tests__"},{"name":"creates a canonical link if siteUrl is set","suites":["gatsby-plugin-canonical-urls"],"updatePoint":{"line":5,"column":48,"index":151},"line":5,"code":"  it(`creates a canonical link if siteUrl is set`, async () => {\n    const pluginOptions = {\n      siteUrl: `http://someurl.com`\n    };\n    const setHeadComponents = jest.fn();\n    const pathname = `/somepost`;\n    await onRenderBody({\n      setHeadComponents,\n      pathname\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-canonical-urls/src/__tests__"},{"name":"strips a trailing slash on the siteUrl and leaves search parameters","suites":["gatsby-plugin-canonical-urls"],"updatePoint":{"line":18,"column":73,"index":586},"line":18,"code":"  it(`strips a trailing slash on the siteUrl and leaves search parameters`, async () => {\n    const pluginOptions = {\n      siteUrl: `http://someurl.com/`\n    };\n    const setHeadComponents = jest.fn();\n    const pathname = `/somepost?tag=foobar`;\n    await onRenderBody({\n      setHeadComponents,\n      pathname\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-canonical-urls/src/__tests__"},{"name":"strips search parameters if option stripQueryString is true","suites":["gatsby-plugin-canonical-urls"],"updatePoint":{"line":31,"column":65,"index":1025},"line":31,"code":"  it(`strips search parameters if option stripQueryString is true`, async () => {\n    const pluginOptions = {\n      siteUrl: `http://someurl.com`,\n      stripQueryString: true\n    };\n    const setHeadComponents = jest.fn();\n    const pathname = `/somepost?tag=foobar`;\n    await onRenderBody({\n      setHeadComponents,\n      pathname\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-canonical-urls/src/__tests__"},{"name":"does not create a canonical link if siteUrl is not set","suites":["gatsby-plugin-canonical-urls"],"updatePoint":{"line":45,"column":60,"index":1488},"line":45,"code":"  it(`does not create a canonical link if siteUrl is not set`, async () => {\n    const pluginOptions = {};\n    const setHeadComponents = jest.fn();\n    const pathname = `/somepost`;\n    await onRenderBody({\n      setHeadComponents,\n      pathname\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(0);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-canonical-urls/src/__tests__"},{"name":"creates a click event","suites":["catchLinks"],"updatePoint":{"line":34,"column":27,"index":890},"line":34,"code":"  it(`creates a click event`, () => {\n    expect(mockedAEH).toHaveBeenCalledWith(`click`, expect.any(Function));\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"uses an instance of the handler returned by routeThroughBrowserOrApp","suites":["catchLinks"],"updatePoint":{"line":37,"column":74,"index":1056},"line":37,"code":"  it(`uses an instance of the handler returned by routeThroughBrowserOrApp`, () => {\n    expect(handler.toString()).toEqual(catchLinks.routeThroughBrowserOrApp(jest.fn()).toString());\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"checks if the user might be forcing navigation","suites":["the click event"],"line":44,"code":"  it.skip(`checks if the user might be forcing navigation`, () => {});","file":"catch-links.js","skipped":true,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"checks if we clicked on an anchor","suites":["the click event"],"line":45,"code":"  it.skip(`checks if we clicked on an anchor`, () => {});","file":"catch-links.js","skipped":true,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"checks if the document author might be forcing navigation","suites":["the click event"],"line":46,"code":"  it.skip(`checks if the document author might be forcing navigation`, () => {});","file":"catch-links.js","skipped":true,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"checks if the destination/origin URLs have matching origins","suites":["the click event"],"line":47,"code":"  it.skip(`checks if the destination/origin URLs have matching origins`, () => {});","file":"catch-links.js","skipped":true,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"checks if the destination/origin URLs have matching top level paths","suites":["the click event"],"line":48,"code":"  it.skip(`checks if the destination/origin URLs have matching top level paths`, () => {});","file":"catch-links.js","skipped":true,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"checks if the destination URL wants to scroll the page with a hash anchor","suites":["the click event"],"line":49,"code":"  it.skip(`checks if the destination URL wants to scroll the page with a hash anchor`, () => {});","file":"catch-links.js","skipped":true,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"handles pathPrefix if necessary","suites":["the click event"],"line":50,"code":"  it.skip(`handles pathPrefix if necessary`, () => {});","file":"catch-links.js","skipped":true,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"routes the destination href through gatsby","suites":["the click event"],"line":51,"code":"  it.skip(`routes the destination href through gatsby`, () => {});","file":"catch-links.js","skipped":true,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"\"auxiliary\" button","suites":["a user may be forcing navigation if","the \"main\" button was not clicked"],"updatePoint":{"line":56,"column":28,"index":2120},"line":56,"code":"    test(`\"auxiliary\" button`, () => {\n      const event = {\n        button: 1\n      };\n      expect(catchLinks.userIsForcingNavigation(event)).toBe(true);\n    });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"\"secondary\" button","suites":["a user may be forcing navigation if","the \"main\" button was not clicked"],"updatePoint":{"line":62,"column":28,"index":2284},"line":62,"code":"    test(`\"secondary\" button`, () => {\n      const event = {\n        button: 2\n      };\n      expect(catchLinks.userIsForcingNavigation(event)).toBe(true);\n    });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"\"fourth\" button","suites":["a user may be forcing navigation if","the \"main\" button was not clicked"],"updatePoint":{"line":68,"column":25,"index":2445},"line":68,"code":"    test(`\"fourth\" button`, () => {\n      const event = {\n        button: 3\n      };\n      expect(catchLinks.userIsForcingNavigation(event)).toBe(true);\n    });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"\"fifth\" button","suites":["a user may be forcing navigation if","the \"main\" button was not clicked"],"updatePoint":{"line":74,"column":24,"index":2605},"line":74,"code":"    test(`\"fifth\" button`, () => {\n      const event = {\n        button: 4\n      };\n      expect(catchLinks.userIsForcingNavigation(event)).toBe(true);\n    });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"alt key","suites":["a user may be forcing navigation if","the user is holding down a modifier key"],"updatePoint":{"line":82,"column":17,"index":2826},"line":82,"code":"    test(`alt key`, () => {\n      const event = {\n        altKey: true\n      };\n      expect(catchLinks.userIsForcingNavigation(event)).toBe(true);\n    });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"control key","suites":["a user may be forcing navigation if","the user is holding down a modifier key"],"updatePoint":{"line":88,"column":21,"index":2986},"line":88,"code":"    test(`control key`, () => {\n      const event = {\n        ctrlKey: true\n      };\n      expect(catchLinks.userIsForcingNavigation(event)).toBe(true);\n    });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"meta key","suites":["a user may be forcing navigation if","the user is holding down a modifier key"],"updatePoint":{"line":94,"column":18,"index":3144},"line":94,"code":"    test(`meta key`, () => {\n      const event = {\n        metaKey: true\n      };\n      expect(catchLinks.userIsForcingNavigation(event)).toBe(true);\n    });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"shift key","suites":["a user may be forcing navigation if","the user is holding down a modifier key"],"updatePoint":{"line":100,"column":19,"index":3303},"line":100,"code":"    test(`shift key`, () => {\n      const event = {\n        shiftKey: true\n      };\n      expect(catchLinks.userIsForcingNavigation(event)).toBe(true);\n    });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"the default behavior was prevented elsewhere","suites":["a user may be forcing navigation if","the user is holding down a modifier key"],"updatePoint":{"line":107,"column":52,"index":3502},"line":107,"code":"  test(`the default behavior was prevented elsewhere`, () => {\n    const event = {\n      defaultPrevented: true\n    };\n    expect(catchLinks.navigationWasHandledElsewhere(event)).toBe(true);\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"must be an anchor tag","suites":["the clicked element"],"updatePoint":{"line":115,"column":27,"index":3718},"line":115,"code":"  it(`must be an anchor tag`, done => {\n    const testAnchor = document.createElement(`a`);\n    document.body.appendChild(testAnchor);\n\n    // create the click event we'll be using for testing\n    const clickEvent = new MouseEvent(`click`, {\n      bubbles: true,\n      cancelable: true,\n      view: window\n    });\n    const handler = event => {\n      expect(catchLinks.findClosestAnchor(event.target)).toBe(testAnchor);\n      testAnchor.remove();\n      window.removeEventListener(`click`, handler);\n      done();\n    };\n    window.addEventListener(`click`, handler);\n    testAnchor.dispatchEvent(clickEvent);\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"could be inside of an anchor","suites":["the clicked element"],"updatePoint":{"line":134,"column":34,"index":4340},"line":134,"code":"  it(`could be inside of an anchor`, done => {\n    const testAnchor = document.createElement(`a`);\n    const clickTarget = document.createElement(`span`);\n    testAnchor.appendChild(clickTarget);\n    document.body.appendChild(testAnchor);\n\n    // create the click event we'll be using for testing\n    const clickEvent = new MouseEvent(`click`, {\n      bubbles: true,\n      cancelable: true,\n      view: window\n    });\n    const handler = event => {\n      expect(catchLinks.findClosestAnchor(event.target)).toBe(testAnchor);\n      testAnchor.remove();\n      window.removeEventListener(`click`, handler);\n      done();\n    };\n    window.addEventListener(`click`, handler);\n    clickTarget.dispatchEvent(clickEvent);\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"if the clicked anchor is a download link","suites":["the author might be forcing navigation"],"updatePoint":{"line":157,"column":48,"index":5137},"line":157,"code":"  test(`if the clicked anchor is a download link`, () => {\n    const testAnchor = document.createElement(`a`);\n    testAnchor.setAttribute(`download`, ``);\n    expect(catchLinks.authorIsForcingNavigation(testAnchor)).toBe(true);\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"target=_blank","suites":["the author might be forcing navigation","if the clicked anchor does not target _self"],"updatePoint":{"line":170,"column":23,"index":5638},"line":170,"code":"    test(`target=_blank`, () => {\n      const testAnchor = document.createElement(`a`);\n      testAnchor.setAttribute(`target`, `_blank`);\n      expect(catchLinks.authorIsForcingNavigation(testAnchor)).toBe(true);\n    });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"target=_parent","suites":["the author might be forcing navigation","if the clicked anchor does not target _self"],"updatePoint":{"line":175,"column":24,"index":5861},"line":175,"code":"    test(`target=_parent`, () => {\n      const testAnchor = separateBrowsingContext.contentDocument.createElement(`a`);\n      testAnchor.setAttribute(`target`, `_parent`);\n      expect(catchLinks.authorIsForcingNavigation(testAnchor)).toBe(true);\n    });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"target=_top","suites":["the author might be forcing navigation","if the clicked anchor does not target _self"],"updatePoint":{"line":180,"column":21,"index":6113},"line":180,"code":"    test(`target=_top`, () => {\n      const testAnchor = separateBrowsingContext.contentDocument.createElement(`a`);\n      testAnchor.setAttribute(`target`, `_top`);\n      expect(catchLinks.authorIsForcingNavigation(testAnchor)).toBe(true);\n    });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"is not set","suites":["anchor target attribute looks like _self if"],"updatePoint":{"line":195,"column":16,"index":6642},"line":195,"code":"  it(`is not set`, () => {\n    const testAnchor = document.createElement(`a`);\n    expect(catchLinks.anchorsTargetIsEquivalentToSelf(testAnchor)).toBe(true);\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"is set to _self","suites":["anchor target attribute looks like _self if"],"updatePoint":{"line":199,"column":21,"index":6811},"line":199,"code":"  it(`is set to _self`, () => {\n    const testAnchor = document.createElement(`a`);\n    testAnchor.setAttribute(`target`, `_self`);\n    expect(catchLinks.anchorsTargetIsEquivalentToSelf(testAnchor)).toBe(true);\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"is set to _parent, but window = window.parent","suites":["anchor target attribute looks like _self if"],"updatePoint":{"line":204,"column":51,"index":7058},"line":204,"code":"  it(`is set to _parent, but window = window.parent`, () => {\n    const testAnchor = separateBrowsingContext.contentDocument.createElement(`a`);\n    testAnchor.setAttribute(`target`, `_parent`);\n    document.body.appendChild(testAnchor);\n    expect(catchLinks.anchorsTargetIsEquivalentToSelf(testAnchor)).toBe(true);\n    testAnchor.remove();\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"is set to _top, but window = window.top","suites":["anchor target attribute looks like _self if"],"updatePoint":{"line":211,"column":45,"index":7400},"line":211,"code":"  it(`is set to _top, but window = window.top`, () => {\n    const testAnchor = separateBrowsingContext.contentDocument.createElement(`a`);\n    testAnchor.setAttribute(`target`, `_top`);\n    document.body.appendChild(testAnchor);\n    expect(catchLinks.anchorsTargetIsEquivalentToSelf(testAnchor)).toBe(true);\n    testAnchor.remove();\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"shares the same origin and top path","suites":["navigation is routed through Gatsby if the destination href"],"updatePoint":{"line":230,"column":41,"index":8088},"line":230,"code":"  it(`shares the same origin and top path`, done => {\n    const sameOriginAndTopPath = document.createElement(`a`);\n    sameOriginAndTopPath.setAttribute(`href`, `${window.location.href}/someSubPath`);\n    document.body.appendChild(sameOriginAndTopPath);\n\n    // create the click event we'll be using for testing\n    const clickEvent = new MouseEvent(`click`, {\n      bubbles: true,\n      cancelable: true,\n      view: window\n    });\n    window.addEventListener(`click`, function onClick() {\n      window.removeEventListener(`click`, onClick);\n      expect(hrefHandler).toHaveBeenCalledWith(`${sameOriginAndTopPath.pathname}`);\n      sameOriginAndTopPath.remove();\n      done();\n    });\n    sameOriginAndTopPath.dispatchEvent(clickEvent);\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"is not a hash anchor for the current page","suites":["navigation is routed through Gatsby if the destination href"],"updatePoint":{"line":249,"column":47,"index":8839},"line":249,"code":"  it(`is not a hash anchor for the current page`, done => {\n    const withAnchor = document.createElement(`a`);\n    withAnchor.setAttribute(`href`, `${window.location.href}/someSubPath#inside`);\n    document.body.appendChild(withAnchor);\n\n    // create the click event we'll be using for testing\n    const clickEvent = new MouseEvent(`click`, {\n      bubbles: true,\n      cancelable: true,\n      view: window\n    });\n    window.addEventListener(`click`, function onClick() {\n      window.removeEventListener(`click`, onClick);\n      expect(hrefHandler).toHaveBeenCalledWith(`${withAnchor.pathname}${withAnchor.hash}`);\n      withAnchor.remove();\n      done();\n    });\n    withAnchor.dispatchEvent(clickEvent);\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"has a URL \"search\" portion","suites":["navigation is routed through Gatsby if the destination href"],"updatePoint":{"line":268,"column":32,"index":9540},"line":268,"code":"  it(`has a URL \"search\" portion`, done => {\n    const withSearch = document.createElement(`a`);\n    withSearch.setAttribute(`href`, `${window.location.href}${pathPrefix}/subPath?q=find+me#inside`);\n    document.body.appendChild(withSearch);\n\n    // create the click event we'll be using for testing\n    const clickEvent = new MouseEvent(`click`, {\n      bubbles: true,\n      cancelable: true,\n      view: window\n    });\n    window.addEventListener(`click`, function onClick() {\n      window.removeEventListener(`click`, onClick);\n      expect(hrefHandler).toHaveBeenCalledWith(`${withSearch.pathname}${withSearch.search}${withSearch.hash}`);\n      withSearch.remove();\n      done();\n    });\n    withSearch.dispatchEvent(clickEvent);\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"shares the same origin and top path","suites":["navigation is routed through browser if resources have failed and the destination href"],"updatePoint":{"line":301,"column":41,"index":10746},"line":301,"code":"  it(`shares the same origin and top path`, done => {\n    const sameOriginAndTopPath = document.createElement(`a`);\n    sameOriginAndTopPath.setAttribute(`href`, `${window.location.href}/someSubPath`);\n    document.body.appendChild(sameOriginAndTopPath);\n\n    // create the click event we'll be using for testing\n    const clickEvent = new MouseEvent(`click`, {\n      bubbles: true,\n      cancelable: true,\n      view: window\n    });\n    window.addEventListener(`click`, function onClick() {\n      window.removeEventListener(`click`, onClick);\n      expect(hrefHandler).not.toHaveBeenCalled();\n      sameOriginAndTopPath.remove();\n      done();\n    });\n    sameOriginAndTopPath.dispatchEvent(clickEvent);\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"on sites with pathPrefix ''","suites":["pathPrefix is handled if caught link to /article navigates to /article"],"updatePoint":{"line":333,"column":48,"index":11885},"line":333,"code":"  test(`on sites with pathPrefix '${pathPrefix}'`, done => {\n    // simulate case with --prefix-paths and prefix /blog\n    global.__BASE_PATH__ = pathPrefix;\n\n    // create the element with href /blog/article\n    const clickElement = document.createElement(`a`);\n    clickElement.setAttribute(`href`, `${window.location.href}/article`);\n    document.body.appendChild(clickElement);\n\n    // create the click event we'll be using for testing\n    const clickEvent = new MouseEvent(`click`, {\n      bubbles: true,\n      cancelable: true,\n      view: window\n    });\n\n    // fake module handler\n    hrefHandler.mockImplementation(path => {\n      // place a mock where processing exits gatsby-link\n      const checkPoint = global.___navigate = jest.fn();\n      // call gatsby-link.navigate as the default handler does\n      navigate(path);\n      // compare href past gatsby-link against our clickElement\n      expect(checkPoint).toHaveBeenCalledWith(`${pathPrefix}/article`, undefined);\n\n      // cleanup\n      clickElement.remove();\n      done();\n    });\n\n    // and trigger click\n    clickElement.dispatchEvent(clickEvent);\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"on sites without pathPrefix","suites":["pathPrefix is handled if caught link to /article navigates to /article"],"updatePoint":{"line":366,"column":35,"index":12997},"line":366,"code":"  test(`on sites without pathPrefix`, done => {\n    // simulate default case without --prefix-paths\n    global.__BASE_PATH__ = ``;\n\n    // create the element with href /blog/article\n    const clickElement = document.createElement(`a`);\n    clickElement.setAttribute(`href`, `${window.location.href}/article`);\n    document.body.appendChild(clickElement);\n\n    // create the click event we'll be using for testing\n    const clickEvent = new MouseEvent(`click`, {\n      bubbles: true,\n      cancelable: true,\n      view: window\n    });\n\n    // fake module handler\n    hrefHandler.mockImplementation(path => {\n      // place a mock where processing exits gatsby-link\n      const checkPoint = global.___navigate = jest.fn();\n      // call gatsby-link.navigate as the default handler does\n      navigate(path);\n      // compare href past gatsby-link against our clickElement\n      expect(checkPoint).toHaveBeenCalledWith(`${pathPrefix}/article`, undefined);\n\n      // cleanup\n      clickElement.remove();\n      done();\n    });\n\n    // and trigger click\n    clickElement.dispatchEvent(clickEvent);\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"works without throwing an error","suites":["navigation is routed through browser without SVGAnimatedString support"],"updatePoint":{"line":413,"column":39,"index":14543},"line":413,"code":"  test(`works without throwing an error`, () => {\n    // create a click element to use for testing\n    const clickElement = document.createElement(`a`);\n    clickElement.setAttribute(`href`, `${window.location.href}/article`);\n    document.body.appendChild(clickElement);\n\n    // create the click event we'll be using for testing\n    const clickEvent = new MouseEvent(`click`, {\n      bubbles: true,\n      cancelable: true,\n      view: window\n    });\n\n    // and trigger click\n    clickElement.dispatchEvent(clickEvent);\n    expect(() => catchLinks.routeThroughBrowserOrApp(jest.fn())(clickEvent)).not.toThrow();\n  });","file":"catch-links.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"calls catchLinks in gatsby-browser's onClientEntry API","suites":["gatsby-plugin-catch-links"],"updatePoint":{"line":15,"column":60,"index":409},"line":15,"code":"  it(`calls catchLinks in gatsby-browser's onClientEntry API`, () => {\n    onClientEntry();\n    expect(mockedCatchLinks).toHaveBeenCalledWith(window, {}, expect.any(Function));\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-catch-links/src/__tests__"},{"name":"contains coffee script extensions","suites":["gatsby-plugin-coffeescript"],"updatePoint":{"line":8,"column":39,"index":263},"line":8,"code":"  it(`contains coffee script extensions`, () => {\n    expect(resolvableExtensions()).toContain(`.coffee`);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-coffeescript/src/__tests__"},{"name":"modifies webpack config with coffeescript extensions","suites":["gatsby-plugin-coffeescript"],"updatePoint":{"line":11,"column":58,"index":395},"line":11,"code":"  it(`modifies webpack config with coffeescript extensions`, () => {\n    const actions = {\n      setWebpackConfig: jest.fn()\n    };\n    const loaders = {\n      js: () => `babel-loader`\n    };\n    onCreateWebpackConfig({\n      actions,\n      loaders\n    });\n    expect(actions.setWebpackConfig).toHaveBeenCalledTimes(resolvableExtensions().length);\n    expect(actions.setWebpackConfig).toHaveBeenLastCalledWith({\n      module: {\n        rules: [{\n          test: /\\.coffee$/,\n          use: [`babel-loader`, `/resolved/path/coffee-loader`]\n        }]\n      }\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-coffeescript/src/__tests__"},{"name":"returns null if non-coffeescript file","suites":["gatsby-plugin-coffeescript","pre processing"],"updatePoint":{"line":33,"column":45,"index":991},"line":33,"code":"    it(`returns null if non-coffeescript file`, () => {\n      expect(preprocessSource({\n        filename: `test.js`,\n        contents: `alert('hello');`\n      })).toBe(null);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-coffeescript/src/__tests__"},{"name":"transforms .coffee files","suites":["gatsby-plugin-coffeescript","pre processing"],"updatePoint":{"line":39,"column":32,"index":1161},"line":39,"code":"    it(`transforms .coffee files`, () => {\n      expect(preprocessSource({\n        filename: `test.coffee`,\n        contents: `alert \"I knew it!\" if elvis?`\n      }, {})).toMatchSnapshot();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-coffeescript/src/__tests__"},{"name":"should provide meaningful errors when fields are invalid","suites":[],"updatePoint":{"line":3,"column":60,"index":178},"line":3,"code":"it(`should provide meaningful errors when fields are invalid`, async () => {\n  const expectedWarnings = [`\"optionA\" is not allowed`];\n  const {\n    warnings,\n    isValid,\n    hasWarnings,\n    errors\n  } = await testPluginOptionsSchema(pluginOptionsSchema, {\n    optionA: `This options shouldn't exist`\n  });\n  expect(isValid).toBe(true);\n  expect(hasWarnings).toBe(true);\n  expect(warnings).toEqual(expectedWarnings);\n  expect(errors).toEqual([]);\n});","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-cxs/src/__tests__"},{"name":"should validate the schema: $options","suites":[],"line":18,"code":"it.each`\n  options\n  ${undefined}\n  ${{}}\n`(`should validate the schema: $options`, async ({\n  options\n}) => {\n  const {\n    isValid,\n    errors\n  } = await testPluginOptionsSchema(pluginOptionsSchema, options);\n  expect(isValid).toBe(true);\n  expect(errors).toEqual([]);\n});","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-cxs/src/__tests__"},{"name":"sets the correct head components","suites":["gatsby-plugin-cxs","onRenderBody"],"updatePoint":{"line":7,"column":40,"index":228},"line":7,"code":"    it(`sets the correct head components`, () => {\n      cxs.css = jest.fn(() => `cxs-css`);\n      const setHeadComponents = jest.fn();\n      onRenderBody({\n        setHeadComponents\n      });\n      expect(setHeadComponents).toHaveBeenCalledTimes(1);\n      expect(setHeadComponents).toHaveBeenCalledWith([/*#__PURE__*/React.createElement(\"style\", {\n        id: \"cxs-ids\",\n        key: \"cxs-ids\",\n        dangerouslySetInnerHTML: {\n          __html: `cxs-css`\n        }\n      })]);\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-cxs/src/__tests__"},{"name":"sets the correct babel preset","suites":["gatsby-plugin-emotion","onCreateBabelConfig"],"updatePoint":{"line":5,"column":37,"index":206},"line":5,"code":"    it(`sets the correct babel preset`, () => {\n      const actions = {\n        setBabelPreset: jest.fn()\n      };\n      const store = {\n        getState: () => {\n          return {\n            config: {}\n          };\n        }\n      };\n      onCreateBabelConfig({\n        actions,\n        store\n      }, null);\n      expect(actions.setBabelPreset).toHaveBeenCalledTimes(1);\n      expect(actions.setBabelPreset).toHaveBeenCalledWith({\n        name: expect.stringContaining(path.join(`@emotion`, `babel-preset-css-prop`)),\n        options: {\n          sourceMap: true,\n          autoLabel: `dev-only`\n        }\n      });\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-emotion/src/__tests__"},{"name":"sets the correct babel plugin when using automatic jsxRuntime","suites":["gatsby-plugin-emotion","onCreateBabelConfig"],"updatePoint":{"line":29,"column":69,"index":866},"line":29,"code":"    it(`sets the correct babel plugin when using automatic jsxRuntime`, () => {\n      const actions = {\n        setBabelPlugin: jest.fn()\n      };\n      const store = {\n        getState: () => {\n          return {\n            config: {\n              jsxRuntime: `automatic`\n            }\n          };\n        }\n      };\n      onCreateBabelConfig({\n        actions,\n        store\n      }, null);\n      expect(actions.setBabelPlugin).toHaveBeenCalledTimes(1);\n      expect(actions.setBabelPlugin).toHaveBeenCalledWith({\n        name: expect.stringContaining(path.join(`@emotion`, `babel-plugin`)),\n        options: {\n          sourceMap: true,\n          autoLabel: `dev-only`\n        }\n      });\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-emotion/src/__tests__"},{"name":"passes additional options to the preset","suites":["gatsby-plugin-emotion","onCreateBabelConfig"],"updatePoint":{"line":55,"column":47,"index":1546},"line":55,"code":"    it(`passes additional options to the preset`, () => {\n      const actions = {\n        setBabelPreset: jest.fn()\n      };\n      const pluginOptions = {\n        useBuiltIns: true\n      };\n      const store = {\n        getState: () => {\n          return {\n            config: {}\n          };\n        }\n      };\n      onCreateBabelConfig({\n        actions,\n        store\n      }, pluginOptions);\n      expect(actions.setBabelPreset).toHaveBeenCalledTimes(1);\n      expect(actions.setBabelPreset).toHaveBeenCalledWith({\n        name: expect.stringContaining(path.join(`@emotion`, `babel-preset-css-prop`)),\n        options: {\n          sourceMap: true,\n          autoLabel: `dev-only`,\n          useBuiltIns: true\n        }\n      });\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-emotion/src/__tests__"},{"name":"passes additional options to the plugin when using automatic jsxRuntime","suites":["gatsby-plugin-emotion","onCreateBabelConfig"],"updatePoint":{"line":83,"column":79,"index":2319},"line":83,"code":"    it(`passes additional options to the plugin when using automatic jsxRuntime`, () => {\n      const actions = {\n        setBabelPlugin: jest.fn()\n      };\n      const pluginOptions = {\n        useBuiltIns: true\n      };\n      const store = {\n        getState: () => {\n          return {\n            config: {\n              jsxRuntime: `automatic`\n            }\n          };\n        }\n      };\n      onCreateBabelConfig({\n        actions,\n        store\n      }, pluginOptions);\n      expect(actions.setBabelPlugin).toHaveBeenCalledTimes(1);\n      expect(actions.setBabelPlugin).toHaveBeenCalledWith({\n        name: expect.stringContaining(path.join(`@emotion`, `babel-plugin`)),\n        options: {\n          sourceMap: true,\n          autoLabel: `dev-only`,\n          useBuiltIns: true\n        }\n      });\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-emotion/src/__tests__"},{"name":"sets the correct babel preset","suites":["gatsby-plugin-emotion","onCreateBabelConfig","in production mode"],"updatePoint":{"line":122,"column":39,"index":3336},"line":122,"code":"      it(`sets the correct babel preset`, () => {\n        const actions = {\n          setBabelPreset: jest.fn()\n        };\n        const store = {\n          getState: () => {\n            return {\n              config: {}\n            };\n          }\n        };\n        onCreateBabelConfig({\n          actions,\n          store\n        }, null);\n        expect(actions.setBabelPreset).toHaveBeenCalledTimes(1);\n        expect(actions.setBabelPreset).toHaveBeenCalledWith({\n          name: expect.stringContaining(path.join(`@emotion`, `babel-preset-css-prop`)),\n          options: {\n            sourceMap: false,\n            autoLabel: `dev-only`\n          }\n        });\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-emotion/src/__tests__"},{"name":"does not log page views","suites":["gatsby-plugin-facebook-analytics","onRouteUpdate","in development mode"],"updatePoint":{"line":9,"column":33,"index":254},"line":9,"code":"      it(`does not log page views`, () => {\n        const logPageView = jest.fn();\n        window.FB = function () {};\n        window.FB.AppEvents = {\n          logPageView\n        };\n        onRouteUpdate();\n        expect(logPageView).not.toHaveBeenCalled();\n      });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-facebook-analytics/src/__tests__"},{"name":"logs page views","suites":["gatsby-plugin-facebook-analytics","onRouteUpdate","in production mode"],"updatePoint":{"line":28,"column":25,"index":767},"line":28,"code":"      it(`logs page views`, () => {\n        const logPageView = jest.fn();\n        window.FB = function () {};\n        window.FB.AppEvents = {\n          logPageView\n        };\n        onRouteUpdate();\n        expect(logPageView).toHaveBeenCalledTimes(1);\n      });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-facebook-analytics/src/__tests__"},{"name":"does not set any post body components","suites":["gatsby-plugin-facebook-analytics","onRenderBody","in development mode"],"updatePoint":{"line":10,"column":47,"index":309},"line":10,"code":"      it(`does not set any post body components`, () => {\n        const setPostBodyComponents = jest.fn();\n        onRenderBody({\n          setPostBodyComponents\n        }, {});\n        expect(setPostBodyComponents).not.toHaveBeenCalled();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-facebook-analytics/src/__tests__"},{"name":"sets the correct post body components","suites":["gatsby-plugin-facebook-analytics","onRenderBody","in production mode"],"updatePoint":{"line":27,"column":47,"index":809},"line":27,"code":"      it(`sets the correct post body components`, () => {\n        const setPostBodyComponents = jest.fn();\n        const pluginOptions = {\n          appId: 1\n        };\n        onRenderBody({\n          setPostBodyComponents\n        }, pluginOptions);\n        expect(setPostBodyComponents.mock.calls).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-facebook-analytics/src/__tests__"},{"name":"sets the correct script src during debug","suites":["gatsby-plugin-facebook-analytics","onRenderBody","in production mode"],"updatePoint":{"line":37,"column":50,"index":1141},"line":37,"code":"      it(`sets the correct script src during debug`, () => {\n        const setPostBodyComponents = jest.fn();\n        const pluginOptions = {\n          appId: 1,\n          debug: true\n        };\n        onRenderBody({\n          setPostBodyComponents\n        }, pluginOptions);\n        expect(setPostBodyComponents.mock.calls).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-facebook-analytics/src/__tests__"},{"name":"sets the correct script src for other languages than en_US","suites":["gatsby-plugin-facebook-analytics","onRenderBody","in production mode"],"updatePoint":{"line":48,"column":68,"index":1514},"line":48,"code":"      it(`sets the correct script src for other languages than en_US`, () => {\n        const setPostBodyComponents = jest.fn();\n        const pluginOptions = {\n          appId: 1,\n          language: `sv`\n        };\n        onRenderBody({\n          setPostBodyComponents\n        }, pluginOptions);\n        expect(setPostBodyComponents.mock.calls).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-facebook-analytics/src/__tests__"},{"name":"sets the correct SDK version when set in the config","suites":["gatsby-plugin-facebook-analytics","onRenderBody","in production mode"],"updatePoint":{"line":59,"column":61,"index":1883},"line":59,"code":"      it(`sets the correct SDK version when set in the config`, () => {\n        const setPostBodyComponents = jest.fn();\n        const pluginOptions = {\n          appId: 1,\n          version: `v3.3`\n        };\n        onRenderBody({\n          setPostBodyComponents\n        }, pluginOptions);\n        expect(setPostBodyComponents.mock.calls).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-facebook-analytics/src/__tests__"},{"name":"sets the existing SDK version as default when no version is set in config","suites":["gatsby-plugin-facebook-analytics","onRenderBody","in production mode"],"updatePoint":{"line":70,"column":83,"index":2275},"line":70,"code":"      it(`sets the existing SDK version as default when no version is set in config`, () => {\n        const setPostBodyComponents = jest.fn();\n        const pluginOptions = {\n          appId: 1\n        };\n        onRenderBody({\n          setPostBodyComponents\n        }, pluginOptions);\n        expect(setPostBodyComponents.mock.calls).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-facebook-analytics/src/__tests__"},{"name":"sets the correct xfbml value when set in the config","suites":["gatsby-plugin-facebook-analytics","onRenderBody","in production mode"],"updatePoint":{"line":80,"column":61,"index":2618},"line":80,"code":"      it(`sets the correct xfbml value when set in the config`, () => {\n        const setPostBodyComponents = jest.fn();\n        const pluginOptions = {\n          appId: 1,\n          xfbml: false\n        };\n        onRenderBody({\n          setPostBodyComponents\n        }, pluginOptions);\n        expect(setPostBodyComponents.mock.calls).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-facebook-analytics/src/__tests__"},{"name":"sets xfbml to true by default","suites":["gatsby-plugin-facebook-analytics","onRenderBody","in production mode"],"updatePoint":{"line":91,"column":39,"index":2963},"line":91,"code":"      it(`sets xfbml to true by default`, () => {\n        const setPostBodyComponents = jest.fn();\n        const pluginOptions = {\n          appId: 1\n        };\n        onRenderBody({\n          setPostBodyComponents\n        }, pluginOptions);\n        expect(setPostBodyComponents.mock.calls).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-facebook-analytics/src/__tests__"},{"name":"sets the correct cookie value when set in the config","suites":["gatsby-plugin-facebook-analytics","onRenderBody","in production mode"],"updatePoint":{"line":101,"column":62,"index":3307},"line":101,"code":"      it(`sets the correct cookie value when set in the config`, () => {\n        const setPostBodyComponents = jest.fn();\n        const pluginOptions = {\n          appId: 1,\n          cookie: true\n        };\n        onRenderBody({\n          setPostBodyComponents\n        }, pluginOptions);\n        expect(setPostBodyComponents.mock.calls).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-facebook-analytics/src/__tests__"},{"name":"sets cookie to false by default","suites":["gatsby-plugin-facebook-analytics","onRenderBody","in production mode"],"updatePoint":{"line":112,"column":41,"index":3654},"line":112,"code":"      it(`sets cookie to false by default`, () => {\n        const setPostBodyComponents = jest.fn();\n        const pluginOptions = {\n          appId: 1\n        };\n        onRenderBody({\n          setPostBodyComponents\n        }, pluginOptions);\n        expect(setPostBodyComponents.mock.calls).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-facebook-analytics/src/__tests__"},{"name":"custom properties work properly","suites":["Test plugin feed"],"updatePoint":{"line":18,"column":37,"index":546},"line":18,"code":"  it(`custom properties work properly`, async () => {\n    fs.writeFile = jest.fn();\n    fs.writeFile.mockResolvedValue(true);\n    const graphql = jest.fn();\n    graphql.mockResolvedValue({\n      data: {\n        site: {\n          siteMetadata: {\n            title: `site title`,\n            description: `a description`,\n            siteUrl: `http://dummy.url/`\n          }\n        },\n        allMarkdownRemark: {\n          edges: [{\n            node: {\n              frontmatter: {\n                path: `a-custom-path`\n              },\n              excerpt: `post description`\n            }\n          }, {\n            node: {\n              frontmatter: {\n                path: `another-custom-path`\n              },\n              excerpt: `post description`\n            }\n          }]\n        }\n      }\n    });\n    const customQuery = `\n    {\n      allMarkdownRemark(\n        limit: 1000,\n      ) {\n        edges {\n          node {\n            frontmatter {\n              path\n            }\n            excerpt\n          }\n        }\n      }\n    }\n  `;\n    const options = {\n      feeds: [{\n        output: `rss.xml`,\n        title: `feed title`,\n        language: `en`,\n        generator: `custom generator`,\n        query: customQuery,\n        serialize: ({\n          query: {\n            site,\n            allMarkdownRemark\n          }\n        }) => allMarkdownRemark.edges.map(edge => {\n          return {\n            ...edge.node.frontmatter,\n            description: edge.node.excerpt,\n            url: site.siteMetadata.siteUrl + edge.node.frontmatter.path\n          };\n        })\n      }]\n    };\n    await onPostBuild({\n      graphql\n    }, options);\n    const [filePath, contents] = fs.writeFile.mock.calls[0];\n    expect(filePath).toEqual(path.join(`public`, `rss.xml`));\n    expect(contents).toMatchSnapshot();\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-feed/src/__tests__"},{"name":"custom query runs","suites":["Test plugin feed"],"updatePoint":{"line":94,"column":23,"index":2361},"line":94,"code":"  it(`custom query runs`, async () => {\n    fs.writeFile = jest.fn();\n    fs.writeFile.mockResolvedValue(true);\n    const graphql = jest.fn();\n    graphql.mockResolvedValue({\n      data: {\n        site: {\n          siteMetadata: {\n            title: `a sample title`,\n            description: `a description`,\n            siteUrl: `http://dummy.url/`\n          }\n        },\n        allMarkdownRemark: {\n          edges: [{\n            node: {\n              frontmatter: {\n                path: `a-custom-path`\n              },\n              excerpt: `post description`\n            }\n          }, {\n            node: {\n              frontmatter: {\n                path: `another-custom-path`\n              },\n              excerpt: `post description`\n            }\n          }]\n        }\n      }\n    });\n    const customQuery = `\n    {\n      allMarkdownRemark(\n        limit: 1000,\n      ) {\n        edges {\n          node {\n            frontmatter {\n              path\n            }\n            excerpt\n          }\n        }\n      }\n    }\n  `;\n    const options = {\n      feeds: [{\n        output: `rss_new.xml`,\n        serialize: ({\n          query: {\n            site,\n            allMarkdownRemark\n          }\n        }) => allMarkdownRemark.edges.map(edge => {\n          return {\n            ...edge.node.frontmatter,\n            description: edge.node.excerpt,\n            url: site.siteMetadata.siteUrl + edge.node.frontmatter.path\n          };\n        }),\n        query: customQuery,\n        title: `my feed`\n      }]\n    };\n    await onPostBuild({\n      graphql\n    }, options);\n    const [filePath, contents] = fs.writeFile.mock.calls[0];\n    expect(filePath).toEqual(path.join(`public`, `rss_new.xml`));\n    expect(contents).toMatchSnapshot();\n    expect(graphql).toBeCalledWith(customQuery);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-feed/src/__tests__"},{"name":"does not mutate base query when merging","suites":["Test plugin feed"],"updatePoint":{"line":169,"column":45,"index":4193},"line":169,"code":"  it(`does not mutate base query when merging`, async () => {\n    fs.writeFile = jest.fn();\n    fs.writeFile.mockResolvedValue();\n    const siteQuery = {\n      data: {\n        site: {\n          siteMetadata: {\n            title: `Hello World`\n          }\n        }\n      }\n    };\n    const markdownQuery = {\n      data: {\n        allMarkdownRemark: {\n          edges: [{\n            node: {\n              fields: {\n                slug: `/hello-world`\n              },\n              frontmatter: {\n                title: `Hello World`\n              }\n            }\n          }]\n        }\n      }\n    };\n    const graphql = jest.fn().mockResolvedValueOnce(siteQuery).mockResolvedValueOnce(markdownQuery);\n    const options = {\n      query: `{}`,\n      feeds: [{\n        output: `rss.xml`,\n        query: `{ firstMarkdownQuery }`,\n        serialize: ({\n          query: {\n            allMarkdownRemark\n          }\n        }) => allMarkdownRemark.edges.map(edge => {\n          return {\n            ...edge.node.frontmatter\n          };\n        })\n      }]\n    };\n    await onPostBuild({\n      graphql\n    }, options);\n    expect(siteQuery).toEqual({\n      data: {\n        site: expect.any(Object)\n      }\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-feed/src/__tests__"},{"name":"creates Link if feeds does exist","suites":["Adds <Link> for feed to head"],"updatePoint":{"line":13,"column":38,"index":331},"line":13,"code":"  it(`creates Link if feeds does exist`, async () => {\n    const pluginOptions = {\n      feeds: [{\n        output: `feed.xml`\n      }]\n    };\n    const setHeadComponents = jest.fn();\n    await onRenderBody({\n      setHeadComponents\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-feed/src/__tests__"},{"name":"creates multiple Link if feeds are several","suites":["Adds <Link> for feed to head"],"updatePoint":{"line":26,"column":48,"index":707},"line":26,"code":"  it(`creates multiple Link if feeds are several`, async () => {\n    const pluginOptions = {\n      feeds: [{\n        output: `gryffindor/feed.xml`\n      }, {\n        output: `ravenclaw/feed.xml`\n      }]\n    };\n    const setHeadComponents = jest.fn();\n    await onRenderBody({\n      setHeadComponents\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-feed/src/__tests__"},{"name":"creates Link href with path prefix when __PATH_PREFIX__ sets","suites":["Adds <Link> for feed to head"],"updatePoint":{"line":41,"column":66,"index":1160},"line":41,"code":"  it(`creates Link href with path prefix when __PATH_PREFIX__ sets`, async () => {\n    global.__PATH_PREFIX__ = `/hogwarts`;\n    const pluginOptions = {\n      feeds: [{\n        output: `gryffindor/feed.xml`\n      }, {\n        output: `ravenclaw/feed.xml`\n      }]\n    };\n    const setHeadComponents = jest.fn();\n    await onRenderBody({\n      setHeadComponents\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-feed/src/__tests__"},{"name":"creates Link with a title if it does exist","suites":["Adds <Link> for feed to head"],"updatePoint":{"line":57,"column":48,"index":1637},"line":57,"code":"  it(`creates Link with a title if it does exist`, async () => {\n    const pluginOptions = {\n      feeds: [{\n        output: `gryffindor/feed.xml`,\n        title: `Gryffindor's RSS Feed`\n      }, {\n        output: `ravenclaw/feed.xml`,\n        title: `Ravenclaw's RSS Feed`\n      }]\n    };\n    const setHeadComponents = jest.fn();\n    await onRenderBody({\n      setHeadComponents\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-feed/src/__tests__"},{"name":"creates Link only if pathname satisfied match","suites":["Adds <Link> for feed to head"],"updatePoint":{"line":74,"column":51,"index":2154},"line":74,"code":"  it(`creates Link only if pathname satisfied match`, async () => {\n    const pluginOptions = {\n      feeds: [{\n        output: `gryffindor/feed.xml`,\n        title: `Gryffindor's RSS Feed`,\n        match: `^/gryffindor/`\n      }, {\n        output: `ravenclaw/feed.xml`,\n        title: `Ravenclaw's RSS Feed`,\n        match: `^/ravenclaw/`\n      }]\n    };\n    const setHeadComponents = jest.fn();\n    await onRenderBody({\n      setHeadComponents,\n      pathname: `/gryffindor/welcome`\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-feed/src/__tests__"},{"name":"creates Link that override href link generation from output with link set","suites":["Adds <Link> for feed to head"],"updatePoint":{"line":94,"column":79,"index":2801},"line":94,"code":"  it(`creates Link that override href link generation from output with link set`, async () => {\n    const pluginOptions = {\n      feeds: [{\n        output: `gryffindor/feed.xml`,\n        title: `Gryffindor's RSS Feed`\n      }, {\n        output: `gryffindor/feed.xml`,\n        title: `Gryffindor's RSS Feed`,\n        link: `https://harreypetter.com/gryffindor`\n      }]\n    };\n    const setHeadComponents = jest.fn();\n    await onRenderBody({\n      setHeadComponents\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-feed/src/__tests__"},{"name":"testing output with and without prefixes set","suites":["Adds <Link> for feed to head"],"updatePoint":{"line":112,"column":50,"index":3372},"line":112,"code":"  it(`testing output with and without prefixes set`, async () => {\n    const pluginOptions = {\n      feeds: [{\n        output: `/with-slash-prefix/feed.xml`,\n        title: `With slash prefix RSS Feed`\n      }, {\n        output: `without-slash-prefix/feed.xml`,\n        title: `Without slash prefix RSS Feed`\n      }]\n    };\n    const setHeadComponents = jest.fn();\n    await onRenderBody({\n      setHeadComponents\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-feed/src/__tests__"},{"name":"testing output prefixes with __PATH_PREFIX__ without path prefix set","suites":["Adds <Link> for feed to head"],"updatePoint":{"line":129,"column":74,"index":3945},"line":129,"code":"  it(`testing output prefixes with __PATH_PREFIX__ without path prefix set`, async () => {\n    global.__PATH_PREFIX__ = `without-path-prefix`;\n    const pluginOptions = {\n      feeds: [{\n        output: `/output-with-slash-prefix/feed.xml`,\n        title: `With slash prefix RSS Feed`\n      }, {\n        output: `output-without-slash-prefix/feed.xml`,\n        title: `Without slash prefix RSS Feed`\n      }]\n    };\n    const setHeadComponents = jest.fn();\n    await onRenderBody({\n      setHeadComponents\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-feed/src/__tests__"},{"name":"sets the correct babel preset","suites":["onCreateBabelConfig"],"updatePoint":{"line":5,"column":35,"index":244},"line":5,"code":"  it(`sets the correct babel preset`, () => {\n    const actions = {\n      setBabelPreset: jest.fn()\n    };\n    onCreateBabelConfig({\n      actions\n    });\n    expect(actions.setBabelPreset).toHaveBeenCalledTimes(1);\n    expect(actions.setBabelPreset).toHaveBeenCalledWith({\n      name: expect.stringContaining(path.join(`@babel`, `preset-flow`))\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-flow/src/__tests__"},{"name":"should provide meaningful errors when fields are invalid","suites":["pluginOptionsSchema"],"updatePoint":{"line":19,"column":62,"index":675},"line":19,"code":"  it(`should provide meaningful errors when fields are invalid`, async () => {\n    const expectedWarnings = [`\"optionA\" is not allowed`];\n    const {\n      isValid,\n      warnings,\n      hasWarnings\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      optionA: `This option shouldn't exist`\n    });\n    expect(isValid).toBe(true);\n    expect(hasWarnings).toBe(true);\n    expect(warnings).toEqual(expectedWarnings);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-flow/src/__tests__"},{"name":"should validate the schema: $options","suites":["pluginOptionsSchema"],"line":32,"code":"  it.each`\n    options\n    ${undefined}\n    ${{}}\n  `(`should validate the schema: $options`, async ({\n    options\n  }) => {\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, options);\n    expect(isValid).toBe(true);\n    expect(errors).toEqual([]);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-flow/src/__tests__"},{"name":"does not set any head components","suites":["gatsby-plugin-fullstory","onRenderBody","in development mode"],"updatePoint":{"line":5,"column":42,"index":212},"line":5,"code":"      it(`does not set any head components`, () => {\n        const setHeadComponents = jest.fn();\n        onRenderBody({\n          setHeadComponents\n        }, {});\n        expect(setHeadComponents).not.toHaveBeenCalled();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-fullstory/src/__tests__"},{"name":"sets the correct head components","suites":["gatsby-plugin-fullstory","onRenderBody","in production mode"],"updatePoint":{"line":22,"column":42,"index":695},"line":22,"code":"      it(`sets the correct head components`, () => {\n        const setHeadComponents = jest.fn();\n        const pluginOptions = {\n          fs_org: `test-org`\n        };\n        onRenderBody({\n          setHeadComponents\n        }, pluginOptions);\n        expect(setHeadComponents.mock.calls).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-fullstory/src/__tests__"},{"name":"with caching headers","suites":["build-headers-program"],"updatePoint":{"line":165,"column":26,"index":9361},"line":165,"code":"  it(`with caching headers`, async () => {\n    const pluginData = await createPluginData();\n    const pluginOptions = {\n      ...DEFAULT_OPTIONS,\n      mergeCachingHeaders: true\n    };\n    await buildHeadersProgram(pluginData, pluginOptions);\n    const output = await fs.readFile(pluginData.publicFolder(HEADERS_FILENAME), `utf8`);\n    expect(output).toMatchSnapshot();\n    expect(output).not.toMatch(/app-data\\.json/);\n    expect(output).not.toMatch(/page-data\\.json/);\n    const parsedOutput = JSON.parse(output);\n    // Making sure split chunk get caching headers\n    // even if manifest doesn't indicate it should\n    // be part of app or page-template group.\n    expect(parsedOutput?.[`/231-b2d35ff9bb1952aa22d1.js`]).toMatchInlineSnapshot(`\n      Array [\n        \"Cache-Control: public, max-age=31536000, immutable\",\n      ]\n    `);\n  });","file":"build-headers-program.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"with manifest['pages-manifest']","suites":["build-headers-program"],"updatePoint":{"line":186,"column":37,"index":10217},"line":186,"code":"  it(`with manifest['pages-manifest']`, async () => {\n    const pluginData = await createPluginData();\n    fs.existsSync.mockImplementation(path => {\n      if (path.includes(`page-data.json`) || path.includes(`app-data.json`)) {\n        return false;\n      }\n      return true;\n    });\n\n    // gatsby < 2.9 uses page-manifest\n    pluginData.manifest[`pages-manifest`] = [`pages-manifest-ab11f09e0ca7ecd3b43e.js`];\n    const pluginOptions = {\n      ...DEFAULT_OPTIONS,\n      mergeCachingHeaders: true\n    };\n    await buildHeadersProgram(pluginData, pluginOptions);\n    const output = await fs.readFile(pluginData.publicFolder(HEADERS_FILENAME), `utf8`);\n    expect(output).toMatchSnapshot();\n    expect(output).toMatch(/\\/pages-manifest-ab11f09e0ca7ecd3b43e\\.js/g);\n    expect(output).not.toMatch(/\\/app-data\\.json/g);\n    expect(output).not.toMatch(/\\/page-data\\.json/g);\n    expect(output).not.toMatch(/\\/undefined/g);\n  });","file":"build-headers-program.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"without app-data file","suites":["build-headers-program"],"updatePoint":{"line":209,"column":27,"index":11134},"line":209,"code":"  it(`without app-data file`, async () => {\n    const pluginData = await createPluginData();\n\n    // gatsby 2.17.0+ adds an app-data file\n    delete pluginData.manifest[`pages-manifest`];\n    const pluginOptions = {\n      ...DEFAULT_OPTIONS,\n      mergeCachingHeaders: true\n    };\n    fs.existsSync.mockImplementation(path => {\n      if (path.includes(`app-data.json`)) {\n        return false;\n      }\n      return true;\n    });\n    await buildHeadersProgram(pluginData, pluginOptions);\n    const output = await fs.readFile(pluginData.publicFolder(HEADERS_FILENAME), `utf8`);\n    expect(output).not.toMatch(/app-data\\.json/g);\n    expect(output).not.toMatch(/\\/undefined/g);\n  });","file":"build-headers-program.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"without caching headers","suites":["build-headers-program"],"updatePoint":{"line":229,"column":29,"index":11817},"line":229,"code":"  it(`without caching headers`, async () => {\n    const pluginData = await createPluginData();\n    const pluginOptions = {\n      ...DEFAULT_OPTIONS,\n      mergeCachingHeaders: false\n    };\n    await buildHeadersProgram(pluginData, pluginOptions);\n    expect(await fs.readFile(pluginData.publicFolder(HEADERS_FILENAME), `utf8`)).toMatchSnapshot();\n  });","file":"build-headers-program.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"with security headers","suites":["build-headers-program"],"updatePoint":{"line":238,"column":27,"index":12168},"line":238,"code":"  it(`with security headers`, async () => {\n    const pluginData = await createPluginData();\n    const pluginOptions = {\n      ...DEFAULT_OPTIONS,\n      mergeSecurityHeaders: true,\n      headers: {\n        \"/*\": [`Content-Security-Policy: frame-ancestors 'self' https://*.storyblok.com/`, `X-Frame-Options: ALLOW-FROM https://app.storyblok.com/`],\n        \"/hello\": [`X-Frame-Options: SAMEORIGIN`]\n      }\n    };\n    await buildHeadersProgram(pluginData, pluginOptions);\n    expect(await fs.readFile(pluginData.publicFolder(HEADERS_FILENAME), `utf8`)).toMatchSnapshot();\n  });","file":"build-headers-program.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"with security headers in preview mode","suites":["build-headers-program"],"updatePoint":{"line":251,"column":43,"index":12761},"line":251,"code":"  it(`with security headers in preview mode`, async () => {\n    const OLD_ENV = process.env;\n    process.env = {\n      ...OLD_ENV,\n      GATSBY_IS_PREVIEW: `true`\n    };\n    const pluginData = await createPluginData();\n    const pluginOptions = {\n      ...DEFAULT_OPTIONS,\n      mergeSecurityHeaders: true\n    };\n    const buildHeadersProgram = require(`../build-headers-program`).default;\n    await buildHeadersProgram(pluginData, pluginOptions);\n    expect(await fs.readFile(pluginData.publicFolder(HEADERS_FILENAME), `utf8`)).toMatchSnapshot();\n    jest.resetModules();\n    process.env = {\n      ...OLD_ENV\n    };\n  });","file":"build-headers-program.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"should emit headers via ipc","suites":["build-headers-program"],"updatePoint":{"line":270,"column":33,"index":13374},"line":270,"code":"  it(`should emit headers via ipc`, async () => {\n    const pluginData = await createPluginData();\n    const pluginOptions = {\n      ...DEFAULT_OPTIONS,\n      mergeSecurityHeaders: true,\n      headers: {\n        \"/hello\": [`X-Frame-Options: SAMEORIGIN`]\n      }\n    };\n    process.send = jest.fn();\n    await buildHeadersProgram(pluginData, pluginOptions);\n    expect(process.send).toHaveBeenCalledWith({\n      type: `LOG_ACTION`,\n      action: {\n        type: `CREATE_HEADER_ENTRY`,\n        payload: {\n          url: `/hello`,\n          headers: [`X-Frame-Options: SAMEORIGIN`]\n        }\n      }\n    }, expect.any(Function));\n  });","file":"build-headers-program.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"with an assetPrefix","suites":["build-headers-program"],"updatePoint":{"line":292,"column":25,"index":13999},"line":292,"code":"  it(`with an assetPrefix`, async () => {\n    let pluginData = await createPluginData();\n    pluginData = {\n      ...pluginData,\n      assetPrefix: `http://cloud.gatsbyjs.io`\n    };\n    const pluginOptions = {\n      ...DEFAULT_OPTIONS\n    };\n    await buildHeadersProgram(pluginData, pluginOptions);\n    const output = await fs.readFile(pluginData.publicFolder(HEADERS_FILENAME), `utf8`);\n    expect(output).toMatchSnapshot();\n  });","file":"build-headers-program.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"should assemble a redirects file even if there are no redirects","suites":["create-redirects"],"updatePoint":{"line":113,"column":69,"index":5040},"line":113,"code":"  it(`should assemble a redirects file even if there are no redirects`, async () => {\n    const pluginData = await createPluginData();\n    await createRedirects(pluginData, [], []);\n    const output = await fs.readFile(pluginData.publicFolder(REDIRECTS_FILENAME), `utf8`);\n    expect(output).toMatchSnapshot();\n  });","file":"create-redirects.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"should assemble a redirects file","suites":["create-redirects"],"updatePoint":{"line":119,"column":38,"index":5326},"line":119,"code":"  it(`should assemble a redirects file`, async () => {\n    const pluginData = await createPluginData();\n    await createRedirects(pluginData, [{\n      fromPath: `/old-url`,\n      toPath: `/new-url`,\n      isPermanent: true\n    }, {\n      fromPath: `/url_that_is/not_pretty`,\n      toPath: `/pretty/url`,\n      statusCode: 201\n    }], [{\n      fromPath: `/url_that_is/ugly`,\n      toPath: `/not_ugly/url`\n    }, {\n      fromPath: `/path2/*splatparam`,\n      toPath: `/path2/[...splatparam]/`\n    }, {\n      fromPath: `/path/*`,\n      toPath: `/path/[...]/`\n    }, {\n      fromPath: `/path3/:level1/:level2`,\n      toPath: `/path3/[level1]/[level2]/`\n    }, {\n      fromPath: `/path4/:param1`,\n      toPath: `/path4/[param1]/`\n    }]);\n    const output = await fs.readFile(pluginData.publicFolder(REDIRECTS_FILENAME), `utf8`);\n    expect(output).toMatchSnapshot();\n  });","file":"create-redirects.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"should remove pathPrefix from redirects","suites":["create-redirects"],"updatePoint":{"line":148,"column":45,"index":6202},"line":148,"code":"  it(`should remove pathPrefix from redirects`, async () => {\n    const pathPrefix = `/nested`;\n    const pluginData = await createPluginData({\n      pathPrefix\n    });\n    await createRedirects(pluginData, [{\n      fromPath: `${pathPrefix}/old-url`,\n      toPath: `${pathPrefix}/new-url`,\n      isPermanent: true\n    }, {\n      fromPath: `${pathPrefix}/url_that_is/not_pretty`,\n      toPath: `${pathPrefix}/pretty/url`,\n      statusCode: 201\n    }], []);\n    const output = await fs.readFile(pluginData.publicFolder(REDIRECTS_FILENAME), `utf8`);\n    expect(output).toMatchSnapshot();\n  });","file":"create-redirects.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"should emit IPC for each redirect/rewrite","suites":["create-redirects"],"updatePoint":{"line":165,"column":47,"index":6795},"line":165,"code":"  it(`should emit IPC for each redirect/rewrite`, async () => {\n    const pluginData = await createPluginData();\n    process.send = jest.fn();\n    await createRedirects(pluginData, [{\n      fromPath: `/old-url`,\n      toPath: `/new-url`,\n      isPermanent: true\n    }], [{\n      fromPath: `/url_that_is/ugly`,\n      toPath: `/not_ugly/url`\n    }]);\n    expect(process.send).toHaveBeenCalledWith({\n      type: `LOG_ACTION`,\n      action: {\n        type: `CREATE_REDIRECT_ENTRY`,\n        payload: {\n          fromPath: `/old-url`,\n          toPath: `/new-url`,\n          isPermanent: true\n        }\n      }\n    }, expect.any(Function));\n    expect(process.send).toHaveBeenCalledWith({\n      type: `LOG_ACTION`,\n      action: {\n        type: `CREATE_REWRITE_ENTRY`,\n        payload: {\n          fromPath: `/url_that_is/ugly`,\n          toPath: `/not_ugly/url`\n        }\n      }\n    }, expect.any(Function));\n  });","file":"create-redirects.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"should generate a site-config file with pathPrefix null","suites":["create-site-config"],"updatePoint":{"line":12,"column":61,"index":319},"line":12,"code":"  it(`should generate a site-config file with pathPrefix null`, async () => {\n    await createSiteConfig({\n      pathPrefix: ``,\n      publicFolder: file => `public/${file}`\n    }, {});\n    expect(fs.writeJSON).toBeCalledTimes(1);\n    expect(fs.writeJSON.mock.calls[0][0]).toBe(`public/_gatsby-config.json`);\n    expect(fs.writeJSON.mock.calls[0][1]).toMatchInlineSnapshot(`\n      Object {\n        \"pathPrefix\": null,\n      }\n    `);\n  });","file":"create-site-config.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"should generate a site-config file with pathPrefix set","suites":["create-site-config"],"updatePoint":{"line":25,"column":60,"index":758},"line":25,"code":"  it(`should generate a site-config file with pathPrefix set`, async () => {\n    await createSiteConfig({\n      pathPrefix: `/nested`,\n      publicFolder: file => `public/${file}`\n    }, {});\n    expect(fs.writeJSON).toBeCalledTimes(1);\n    expect(fs.writeJSON.mock.calls[0][0]).toBe(`public/_gatsby-config.json`);\n    expect(fs.writeJSON.mock.calls[0][1]).toMatchInlineSnapshot(`\n      Object {\n        \"pathPrefix\": \"/nested\",\n      }\n    `);\n  });","file":"create-site-config.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"Emits pages with mode","suites":["Routes IPC"],"updatePoint":{"line":68,"column":27,"index":1681},"line":68,"code":"  it(`Emits pages with mode`, () => {\n    process.send = jest.fn();\n    onPostBuild({\n      store: {\n        getState() {\n          return getMockedState();\n        }\n      }\n    }, {});\n    if (os.platform() !== `win32`) {\n      expect(process.send).toHaveBeenCalledWith({\n        type: `LOG_ACTION`,\n        action: {\n          type: `CREATE_ROUTE`,\n          payload: {\n            routes: {\n              \"index.html\": `DSG`,\n              \"page-data/index/page-data.json\": `DSG`,\n              \"path/1/index.html\": `DSG`,\n              \"page-data/path/1/page-data.json\": `DSG`,\n              \"path/2/index.html\": `SSR`,\n              \"page-data/path/2/page-data.json\": `SSR`,\n              \"page-data/path/*/page-data.json\": `SSR`,\n              \"page-data/path/:id/page-data.json\": `SSR`,\n              \"path/*/index.html\": `SSR`,\n              \"path/:id/index.html\": `SSR`\n            }\n          }\n        }\n      }, expect.any(Function));\n      expect(process.send).not.toHaveBeenCalledWith({\n        type: `LOG_ACTION`,\n        action: {\n          type: `CREATE_ROUTE`,\n          payload: {\n            routes: {\n              \"path/3/index.html\": `SSG`,\n              \"page-data/path/3/page-data.json\": `SSG`\n            }\n          }\n        }\n      }, expect.any(Function));\n    }\n    if (os.platform() === `win32`) {\n      expect(process.send).toHaveBeenCalledWith({\n        type: `LOG_ACTION`,\n        action: {\n          type: `CREATE_ROUTE`,\n          payload: {\n            routes: {\n              \"index.html\": `DSG`,\n              \"page-data\\\\index\\\\page-data.json\": `DSG`,\n              \"path\\\\1\\\\index.html\": `DSG`,\n              \"page-data\\\\path\\\\1\\\\page-data.json\": `DSG`,\n              \"path\\\\2\\\\index.html\": `SSR`,\n              \"page-data\\\\path\\\\2\\\\page-data.json\": `SSR`,\n              \"path\\\\:id\\\\index.html\": `SSR`,\n              \"page-data\\\\path\\\\:id\\\\page-data.json\": `SSR`,\n              \"path\\\\*\\\\index.html\": `SSR`,\n              \"page-data\\\\path\\\\*\\\\page-data.json\": `SSR`\n            }\n          }\n        }\n      }, expect.any(Function));\n      expect(process.send).not.toHaveBeenCalledWith({\n        type: `LOG_ACTION`,\n        action: {\n          type: `CREATE_ROUTE`,\n          payload: {\n            routes: {\n              \"path\\\\3\\\\index.html\": `SSG`,\n              \"page-data\\\\path\\\\3\\\\page-data.json\": `SSG`\n            }\n          }\n        }\n      }, expect.any(Function));\n    }\n  });","file":"routes.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"Emits totalPageCount","suites":["Routes IPC"],"updatePoint":{"line":146,"column":26,"index":4114},"line":146,"code":"  it(`Emits totalPageCount`, async () => {\n    const originalSend = process.send;\n    process.send = jest.fn();\n    await onPostBuild({\n      store: {\n        getState() {\n          return getMockedState();\n        }\n      }\n    }, {});\n    expect(process.send).toHaveBeenCalledWith({\n      type: `LOG_ACTION`,\n      action: {\n        type: `CREATE_TOTAL_RENDERED_PAGE_COUNT`,\n        payload: {\n          totalRenderedPageCount: 6\n        }\n      }\n    }, expect.anything());\n    process.send = originalSend;\n  });","file":"routes.js","skipped":false,"dir":"packages/gatsby-plugin-gatsby-cloud/src/__tests__"},{"name":"does not send page view","suites":["gatsby-plugin-google-analytics","gatsby-browser","onRouteUpdate","in non-production env"],"updatePoint":{"line":32,"column":35,"index":838},"line":32,"code":"        it(`does not send page view`, () => {\n          window.ga = jest.fn();\n          onRouteUpdate({});\n          expect(window.ga).not.toHaveBeenCalled();\n        });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"does not send page view when ga is undefined","suites":["gatsby-plugin-google-analytics","gatsby-browser","onRouteUpdate","in production env"],"updatePoint":{"line":57,"column":56,"index":1554},"line":57,"code":"        it(`does not send page view when ga is undefined`, () => {\n          delete window.ga;\n          onRouteUpdate({});\n          jest.runAllTimers();\n          expect(setTimeout).not.toHaveBeenCalled();\n        });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"does not send page view when path is excluded","suites":["gatsby-plugin-google-analytics","gatsby-browser","onRouteUpdate","in production env"],"updatePoint":{"line":63,"column":57,"index":1775},"line":63,"code":"        it(`does not send page view when path is excluded`, () => {\n          const mm = new Minimatch(`/test-pages/**`);\n          window.excludeGAPaths = [mm.makeRe()];\n          onRouteUpdate({\n            location: {\n              pathname: `/test-pages/example`\n            }\n          });\n          jest.runAllTimers();\n          expect(window.ga).not.toHaveBeenCalled();\n        });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sends page view","suites":["gatsby-plugin-google-analytics","gatsby-browser","onRouteUpdate","in production env"],"updatePoint":{"line":74,"column":27,"index":2135},"line":74,"code":"        it(`sends page view`, () => {\n          onRouteUpdate({});\n          jest.runAllTimers();\n          expect(window.ga).toHaveBeenCalledTimes(2);\n        });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"uses setTimeout with a minimum delay of 32ms","suites":["gatsby-plugin-google-analytics","gatsby-browser","onRouteUpdate","in production env"],"updatePoint":{"line":79,"column":56,"index":2328},"line":79,"code":"        it(`uses setTimeout with a minimum delay of 32ms`, () => {\n          onRouteUpdate({});\n          jest.runAllTimers();\n          expect(setTimeout).toHaveBeenCalledWith(expect.any(Function), 32);\n          expect(window.ga).toHaveBeenCalledTimes(2);\n        });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"uses setTimeout with the provided pageTransitionDelay value","suites":["gatsby-plugin-google-analytics","gatsby-browser","onRouteUpdate","in production env"],"updatePoint":{"line":85,"column":71,"index":2613},"line":85,"code":"        it(`uses setTimeout with the provided pageTransitionDelay value`, () => {\n          onRouteUpdate({}, {\n            pageTransitionDelay: 1000\n          });\n          jest.runAllTimers();\n          expect(setTimeout).toHaveBeenCalledWith(expect.any(Function), 1000);\n          expect(window.ga).toHaveBeenCalledTimes(2);\n        });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sends core web vitals when enabled","suites":["gatsby-plugin-google-analytics","gatsby-browser","onRouteUpdate","in production env"],"updatePoint":{"line":93,"column":46,"index":2928},"line":93,"code":"        it(`sends core web vitals when enabled`, async () => {\n          onInitialClientRender({}, {\n            enableWebVitalsTracking: true\n          });\n\n          // wait 2 ticks to wait for dynamic import to resolve\n          await Promise.resolve();\n          await Promise.resolve();\n          jest.runAllTimers();\n          expect(window.ga).toBeCalledTimes(3);\n          expect(window.ga).toBeCalledWith(`send`, `event`, expect.objectContaining({\n            eventAction: `LCP`,\n            eventCategory: `Web Vitals`,\n            eventLabel: `1`,\n            eventValue: 300\n          }));\n          expect(window.ga).toBeCalledWith(`send`, `event`, expect.objectContaining({\n            eventAction: `FID`,\n            eventCategory: `Web Vitals`,\n            eventLabel: `2`,\n            eventValue: 150\n          }));\n          expect(window.ga).toBeCalledWith(`send`, `event`, expect.objectContaining({\n            eventAction: `CLS`,\n            eventCategory: `Web Vitals`,\n            eventLabel: `3`,\n            eventValue: 100\n          }));\n        });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sends nothing when web vitals tracking is disabled","suites":["gatsby-plugin-google-analytics","gatsby-browser","onRouteUpdate","in production env"],"updatePoint":{"line":122,"column":62,"index":4020},"line":122,"code":"        it(`sends nothing when web vitals tracking is disabled`, async () => {\n          onInitialClientRender({}, {\n            enableWebVitalsTracking: false\n          });\n\n          // wait 2 ticks to wait for dynamic import to resolve\n          await Promise.resolve();\n          await Promise.resolve();\n          jest.runAllTimers();\n          expect(getLCP).not.toBeCalled();\n          expect(getFID).not.toBeCalled();\n          expect(getCLS).not.toBeCalled();\n        });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"does not set tracking script","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in non-production env"],"updatePoint":{"line":6,"column":40,"index":256},"line":6,"code":"        it(`does not set tracking script`, () => {\n          const setHeadComponents = jest.fn();\n          onRenderBody({\n            setHeadComponents\n          });\n          expect(setHeadComponents).not.toHaveBeenCalled();\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"does not set tracking script when trackingId not given","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":38,"column":66,"index":1246},"line":38,"code":"        it(`does not set tracking script when trackingId not given`, () => {\n          const {\n            setHeadComponents,\n            setPostBodyComponents\n          } = setup({\n            trackingId: ``\n          });\n          expect(setHeadComponents).not.toHaveBeenCalled();\n          expect(setPostBodyComponents).not.toHaveBeenCalled();\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sets tracking script","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":48,"column":32,"index":1571},"line":48,"code":"        it(`sets tracking script`, () => {\n          const {\n            setHeadComponents,\n            setPostBodyComponents\n          } = setup();\n          expect(setHeadComponents).toHaveBeenCalledTimes(1);\n          expect(setPostBodyComponents).toHaveBeenCalledTimes(1);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sets tracking script in head","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":56,"column":40,"index":1868},"line":56,"code":"        it(`sets tracking script in head`, () => {\n          const {\n            setHeadComponents,\n            setPostBodyComponents\n          } = setup({\n            head: true\n          });\n          expect(setHeadComponents).toHaveBeenCalledTimes(2);\n          expect(setPostBodyComponents).not.toHaveBeenCalled();\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sets trackingId","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":66,"column":27,"index":2186},"line":66,"code":"        it(`sets trackingId`, () => {\n          const {\n            setPostBodyComponents\n          } = setup();\n          const result = JSON.stringify(setPostBodyComponents.mock.calls[0][0]);\n          expect(result).toMatch(/TEST_TRACKING_ID/);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sets anonymize","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":73,"column":26,"index":2445},"line":73,"code":"        it(`sets anonymize`, () => {\n          const {\n            setPostBodyComponents\n          } = setup({\n            anonymize: true\n          });\n          const result = JSON.stringify(setPostBodyComponents.mock.calls[0][0]);\n          expect(result).toMatch(/anonymizeIp/);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sets respectDNT","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":82,"column":27,"index":2741},"line":82,"code":"        it(`sets respectDNT`, () => {\n          const {\n            setPostBodyComponents\n          } = setup({\n            respectDNT: true\n          });\n          const result = JSON.stringify(setPostBodyComponents.mock.calls[0][0]);\n          expect(result).toMatch(/doNotTrack/);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sets excluded paths","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":91,"column":31,"index":3041},"line":91,"code":"        it(`sets excluded paths`, () => {\n          const {\n            setPostBodyComponents\n          } = setup({\n            exclude: [`/some-path`]\n          });\n          const result = JSON.stringify(setPostBodyComponents.mock.calls[0][0]);\n          expect(result).toMatch(/excludeGAPaths/);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sets optimizeId","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":100,"column":27,"index":3348},"line":100,"code":"        it(`sets optimizeId`, () => {\n          const {\n            setPostBodyComponents\n          } = setup({\n            optimizeId: `TEST_OPTIMIZE_ID`\n          });\n          const result = JSON.stringify(setPostBodyComponents.mock.calls[0][0]);\n          expect(result).toMatch(/TEST_OPTIMIZE_ID/);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sets experimentId","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":109,"column":29,"index":3666},"line":109,"code":"        it(`sets experimentId`, () => {\n          const {\n            setPostBodyComponents\n          } = setup({\n            optimizeId: `TEST_EXPERIMENT_ID`\n          });\n          const result = JSON.stringify(setPostBodyComponents.mock.calls[0][0]);\n          expect(result).toMatch(/TEST_EXPERIMENT_ID/);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sets variationId","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":118,"column":28,"index":3987},"line":118,"code":"        it(`sets variationId`, () => {\n          const {\n            setPostBodyComponents\n          } = setup({\n            optimizeId: `TEST_VARIATION_ID`\n          });\n          const result = JSON.stringify(setPostBodyComponents.mock.calls[0][0]);\n          expect(result).toMatch(/TEST_VARIATION_ID/);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sets additional create only fields","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":127,"column":46,"index":4324},"line":127,"code":"        it(`sets additional create only fields`, () => {\n          const {\n            setPostBodyComponents\n          } = setup({\n            cookieName: `COOKIE_NAME`,\n            sampleRate: 5\n          });\n          const result = JSON.stringify(setPostBodyComponents.mock.calls[0][0]);\n          expect(result).toMatch(/cookieName/);\n          expect(result).toMatch(/sampleRate/);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sets additional general fields","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":138,"column":42,"index":4719},"line":138,"code":"        it(`sets additional general fields`, () => {\n          const {\n            setPostBodyComponents\n          } = setup({\n            transport: `beacon`,\n            allowAdFeatures: true,\n            queueTime: 5\n          });\n          const result = JSON.stringify(setPostBodyComponents.mock.calls[0][0]);\n          expect(result).toContain(`ga('set', 'transport', 'beacon')`);\n          expect(result).toContain(`ga('set', 'allowAdFeatures', 'true')`);\n          expect(result).toContain(`ga('set', 'queueTime', '5')`);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"does not set fields that have an invalid value","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":151,"column":58,"index":5277},"line":151,"code":"        it(`does not set fields that have an invalid value`, () => {\n          const {\n            setPostBodyComponents\n          } = setup({\n            allowAdFeatures: `swag`\n          });\n          const result = JSON.stringify(setPostBodyComponents.mock.calls[0][0]);\n          expect(result).not.toContain(`allowAdFeatures`);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"does not set fields that were not set","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":160,"column":49,"index":5613},"line":160,"code":"        it(`does not set fields that were not set`, () => {\n          const {\n            setPostBodyComponents\n          } = setup({});\n          const result = JSON.stringify(setPostBodyComponents.mock.calls[0][0]);\n          expect(result).not.toContain(`allowAdFeatures`);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"should defer script after the site render when set","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":167,"column":62,"index":5915},"line":167,"code":"        it(`should defer script after the site render when set`, () => {\n          const {\n            setPostBodyComponents\n          } = setup({\n            defer: true\n          });\n          const result = JSON.stringify(setPostBodyComponents.mock.calls[0][0]);\n          expect(result).toContain(`defer=1;`);\n          expect(result).not.toContain(`async=1;`);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"should not defer script after the site render","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":177,"column":57,"index":6288},"line":177,"code":"        it(`should not defer script after the site render`, () => {\n          const {\n            setPostBodyComponents\n          } = setup({});\n          const result = JSON.stringify(setPostBodyComponents.mock.calls[0][0]);\n          expect(result).not.toContain(`defer=1;`);\n          expect(result).toContain(`async=1;`);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"adds the web-vitals polyfill to the head","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":185,"column":52,"index":6621},"line":185,"code":"        it(`adds the web-vitals polyfill to the head`, () => {\n          const {\n            setHeadComponents\n          } = setup({\n            enableWebVitalsTracking: true,\n            head: false\n          });\n          expect(setHeadComponents.mock.calls.length).toBe(2);\n          expect(setHeadComponents.mock.calls[1][0][0].key).toBe(`gatsby-plugin-google-analytics-web-vitals`);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"should not add the web-vitals polyfill when enableWebVitalsTracking is false ","suites":["gatsby-plugin-google-analytics","gatsby-ssr","onRenderBody","in production env"],"updatePoint":{"line":195,"column":89,"index":7058},"line":195,"code":"        it(`should not add the web-vitals polyfill when enableWebVitalsTracking is false `, () => {\n          const {\n            setHeadComponents\n          } = setup({\n            enableWebVitalsTracking: false,\n            head: false\n          });\n          expect(setHeadComponents.mock.calls.length).toBe(1);\n        });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"matches basic snapshot","suites":["index.js","<OutboundLink />"],"updatePoint":{"line":17,"column":30,"index":525},"line":17,"code":"    it(`matches basic snapshot`, () => {\n      const {\n        container\n      } = setup();\n      expect(container).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"matches snapshot with href set","suites":["index.js","<OutboundLink />"],"updatePoint":{"line":23,"column":38,"index":676},"line":23,"code":"    it(`matches snapshot with href set`, () => {\n      const props = {\n        href: `https://www.google.com`\n      };\n      const {\n        container\n      } = setup(props);\n      expect(container).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"matches snapshot with additional props set","suites":["index.js","<OutboundLink />"],"updatePoint":{"line":32,"column":50,"index":914},"line":32,"code":"    it(`matches snapshot with additional props set`, () => {\n      const props = {\n        href: `https://www.google.com`,\n        target: `_blank`,\n        className: `link-class`,\n        rel: `noopener noreferrer`\n      };\n      const {\n        container\n      } = setup(props);\n      expect(container).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sends tracking event when clicked","suites":["index.js","<OutboundLink />"],"updatePoint":{"line":44,"column":41,"index":1238},"line":44,"code":"    it(`sends tracking event when clicked`, () => {\n      window.ga = jest.fn();\n      const {\n        link\n      } = setup();\n      fireEvent.click(link);\n      expect(window.ga).toHaveBeenCalled();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"calls custom onClick function","suites":["index.js","<OutboundLink />"],"updatePoint":{"line":52,"column":37,"index":1442},"line":52,"code":"    it(`calls custom onClick function`, () => {\n      const props = {\n        onClick: jest.fn()\n      };\n      const {\n        link\n      } = setup(props);\n      fireEvent.click(link);\n      expect(props.onClick).toHaveBeenCalled();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"sends tracking event when clicked","suites":["index.js","trackCustomEvent()"],"updatePoint":{"line":81,"column":41,"index":2206},"line":81,"code":"    it(`sends tracking event when clicked`, () => {\n      window.ga = jest.fn();\n      const {\n        button\n      } = setup();\n      fireEvent.click(button);\n      expect(window.ga).toHaveBeenCalled();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-google-analytics/src/__tests__"},{"name":"should invalidate incorrect options","suites":["pluginOptionsSchema"],"updatePoint":{"line":4,"column":41,"index":199},"line":4,"code":"  it(`should invalidate incorrect options`, async () => {\n    const options = {\n      trackingIds: undefined,\n      // Is required\n      gtagConfig: `test`,\n      pluginConfig: {\n        head: `test`,\n        respectDNT: `test`,\n        exclude: `test`,\n        origin: 1,\n        delayOnRouteUpdate: `test`\n      }\n    };\n    const expectedErrors = [`\"trackingIds\" is required`, `\"gtagConfig\" must be of type object`, `\"pluginConfig.head\" must be a boolean`, `\"pluginConfig.respectDNT\" must be a boolean`, `\"pluginConfig.exclude\" must be an array`, `\"pluginConfig.origin\" must be a string`, `\"pluginConfig.delayOnRouteUpdate\" must be a number`];\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, options);\n    expect(isValid).toBe(false);\n    expect(errors).toEqual(expectedErrors);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-google-gtag/src/__tests__"},{"name":"should validate correct options","suites":["pluginOptionsSchema"],"updatePoint":{"line":25,"column":37,"index":1034},"line":25,"code":"  it(`should validate correct options`, async () => {\n    const options = {\n      trackingIds: [`test`],\n      gtagConfig: {\n        anonymize_ip: true\n      },\n      pluginConfig: {\n        head: true,\n        respectDNT: true,\n        exclude: [`test`],\n        origin: `test`,\n        delayOnRouteUpdate: 1\n      }\n    };\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, options);\n    expect(isValid).toBe(true);\n    expect(errors).toEqual([]);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-google-gtag/src/__tests__"},{"name":"does not crash when no pluginConfig is provided","suites":[],"updatePoint":{"line":5,"column":51,"index":132},"line":5,"code":"it(`does not crash when no pluginConfig is provided`, () => {\n  const mocks = {\n    setHeadComponents: () => null,\n    setPostBodyComponents: () => null\n  };\n  const pluginOptions = {\n    trackingIds: [`GA_TRACKING_ID`]\n  };\n  onRenderBody(mocks, pluginOptions);\n});","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-gtag/src/__tests__"},{"name":"adds a preconnect link for Google Tag Manager","suites":[],"updatePoint":{"line":16,"column":49,"index":487},"line":16,"code":"it(`adds a preconnect link for Google Tag Manager`, () => {\n  const mocks = {\n    setHeadComponents: jest.fn(),\n    setPostBodyComponents: jest.fn()\n  };\n  const pluginOptions = {\n    trackingIds: [`GA_TRACKING_ID`],\n    pluginConfig: {}\n  };\n  onRenderBody(mocks, pluginOptions);\n  const [link] = mocks.setHeadComponents.mock.calls[0][0];\n  expect(link).toEqual( /*#__PURE__*/React.createElement(\"link\", {\n    rel: \"preconnect\",\n    key: \"preconnect-google-gtag\",\n    href: \"https://www.googletagmanager.com\"\n  }), /*#__PURE__*/React.createElement(\"link\", {\n    rel: \"dns-prefetch\",\n    key: \"dns-prefetch-google-gtag\",\n    href: \"https://www.googletagmanager.com\"\n  }));\n});","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-gtag/src/__tests__"},{"name":"defaults respectDNT option to false","suites":["respectDNT"],"updatePoint":{"line":38,"column":41,"index":1187},"line":38,"code":"  it(`defaults respectDNT option to false`, () => {\n    const mocks = {\n      setHeadComponents: jest.fn(),\n      setPostBodyComponents: jest.fn()\n    };\n    const pluginOptions = {\n      trackingIds: [`GA_TRACKING_ID`],\n      pluginConfig: {}\n    };\n    onRenderBody(mocks, pluginOptions);\n    const [, config] = mocks.setPostBodyComponents.mock.calls[0][0];\n    expect(config.props.dangerouslySetInnerHTML.__html).not.toContain(DO_NOT_TRACK_STRING);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-gtag/src/__tests__"},{"name":"listens to respectDNT option","suites":["respectDNT"],"updatePoint":{"line":51,"column":34,"index":1638},"line":51,"code":"  it(`listens to respectDNT option`, () => {\n    const mocks = {\n      setHeadComponents: jest.fn(),\n      setPostBodyComponents: jest.fn()\n    };\n    const pluginOptions = {\n      trackingIds: [`GA_TRACKING_ID`],\n      pluginConfig: {\n        respectDNT: true\n      }\n    };\n    onRenderBody(mocks, pluginOptions);\n    const [, config] = mocks.setPostBodyComponents.mock.calls[0][0];\n    expect(config.props.dangerouslySetInnerHTML.__html).toContain(DO_NOT_TRACK_STRING);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-gtag/src/__tests__"},{"name":"should set selfHostedOrigin as googletagmanager.com by default","suites":["selfHostedOrigin"],"updatePoint":{"line":68,"column":68,"index":2192},"line":68,"code":"  it(`should set selfHostedOrigin as googletagmanager.com by default`, () => {\n    const mocks = {\n      setHeadComponents: jest.fn(),\n      setPostBodyComponents: jest.fn()\n    };\n    const pluginOptions = {\n      trackingIds: [`GA_TRACKING_ID`]\n    };\n    onRenderBody(mocks, pluginOptions);\n    const [bodyConfig] = mocks.setPostBodyComponents.mock.calls[0][0];\n    const headConfig = mocks.setHeadComponents.mock.calls[0][0];\n    expect(bodyConfig.props.src).toContain(`https://www.googletagmanager.com`);\n    expect(headConfig[0].props.href).toContain(`https://www.googletagmanager.com`);\n    expect(headConfig[1].props.href).toContain(`https://www.googletagmanager.com`);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-gtag/src/__tests__"},{"name":"should set selfHostedOrigin","suites":["selfHostedOrigin"],"updatePoint":{"line":83,"column":33,"index":2841},"line":83,"code":"  it(`should set selfHostedOrigin`, () => {\n    const origin = `YOUR_SELF_HOSTED_ORIGIN`;\n    const mocks = {\n      setHeadComponents: jest.fn(),\n      setPostBodyComponents: jest.fn()\n    };\n    const pluginOptions = {\n      trackingIds: [`GA_TRACKING_ID`],\n      pluginConfig: {\n        origin: origin\n      }\n    };\n    onRenderBody(mocks, pluginOptions);\n    const [bodyConfig] = mocks.setPostBodyComponents.mock.calls[0][0];\n    const headConfig = mocks.setHeadComponents.mock.calls[0][0];\n    expect(bodyConfig.props.src).toContain(origin);\n    expect(headConfig[0].props.href).toContain(origin);\n    expect(headConfig[1].props.href).toContain(origin);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-gtag/src/__tests__"},{"name":"does not register if NODE_ENV is not production","suites":["onRouteUpdate"],"updatePoint":{"line":45,"column":53,"index":982},"line":45,"code":"  it(`does not register if NODE_ENV is not production`, () => {\n    const {\n      onRouteUpdate\n    } = getAPI(() => {\n      process.env.NODE_ENV = `development`;\n    });\n    onRouteUpdate({}, {});\n    jest.runAllTimers();\n    expect(window.dataLayer).toHaveLength(0);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"registers a route change event","suites":["onRouteUpdate"],"updatePoint":{"line":55,"column":36,"index":1240},"line":55,"code":"  it(`registers a route change event`, () => {\n    const {\n      onRouteUpdate\n    } = getAPI(() => {\n      process.env.NODE_ENV = `production`;\n    });\n    onRouteUpdate({}, {});\n    jest.runAllTimers();\n    expect(window.dataLayer).toEqual([{\n      event: `gatsby-route-change`\n    }]);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"registers if NODE_ENV is production","suites":["onRouteUpdate"],"updatePoint":{"line":67,"column":41,"index":1540},"line":67,"code":"  it(`registers if NODE_ENV is production`, () => {\n    const {\n      onRouteUpdate\n    } = getAPI(() => {\n      process.env.NODE_ENV = `production`;\n    });\n    onRouteUpdate({}, {});\n    jest.runAllTimers();\n    expect(window.dataLayer).toHaveLength(1);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"registers if includeInDevelopment is true","suites":["onRouteUpdate"],"updatePoint":{"line":77,"column":47,"index":1808},"line":77,"code":"  it(`registers if includeInDevelopment is true`, () => {\n    const {\n      onRouteUpdate\n    } = getAPI(() => {});\n    onRouteUpdate({}, {\n      includeInDevelopment: true\n    });\n    jest.runAllTimers();\n    expect(window.dataLayer).toHaveLength(1);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"registers a custom route change event name if given in routeChangeEventName","suites":["onRouteUpdate"],"updatePoint":{"line":87,"column":81,"index":2100},"line":87,"code":"  it(`registers a custom route change event name if given in routeChangeEventName`, () => {\n    const {\n      onRouteUpdate\n    } = getAPI(() => {\n      process.env.NODE_ENV = `production`;\n    });\n    const customEventName = `custom-route-change-event-name`;\n    onRouteUpdate({}, {\n      routeChangeEventName: customEventName\n    });\n    jest.runAllTimers();\n    expect(window.dataLayer).toEqual([{\n      event: customEventName\n    }]);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"registers new data layer variable if dataLayerName is specified","suites":["onRouteUpdate"],"updatePoint":{"line":102,"column":69,"index":2533},"line":102,"code":"  it(`registers new data layer variable if dataLayerName is specified`, () => {\n    const {\n      onRouteUpdate\n    } = getAPI(() => {\n      process.env.NODE_ENV = `production`;\n    });\n    const dataLayerName = `fooBarDataLater`;\n    window[dataLayerName] = [];\n    onRouteUpdate({}, {\n      dataLayerName\n    });\n    jest.runAllTimers();\n    expect(window[dataLayerName]).toHaveLength(1);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"sends core web vitals when enabled","suites":["onRouteUpdate"],"updatePoint":{"line":116,"column":40,"index":2901},"line":116,"code":"  it(`sends core web vitals when enabled`, async () => {\n    const {\n      onInitialClientRender\n    } = getAPI(() => {\n      process.env.NODE_ENV = `production`;\n    });\n    onInitialClientRender({}, {\n      enableWebVitalsTracking: true\n    });\n\n    // wait 2 ticks to wait for dynamic import to resolve\n    await Promise.resolve();\n    await Promise.resolve();\n    jest.runAllTimers();\n    expect(window.dataLayer.length).toBe(3);\n    expect(window.dataLayer).toContainEqual({\n      event: `core-web-vitals`,\n      webVitalsMeasurement: {\n        name: `LCP`,\n        id: `1`,\n        value: 300\n      }\n    });\n    expect(window.dataLayer).toContainEqual({\n      event: `core-web-vitals`,\n      webVitalsMeasurement: {\n        name: `FID`,\n        id: `2`,\n        value: 150\n      }\n    });\n    expect(window.dataLayer).toContainEqual({\n      event: `core-web-vitals`,\n      webVitalsMeasurement: {\n        name: `CLS`,\n        id: `3`,\n        value: 100\n      }\n    });\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"sends nothing when web vitals tracking is disabled","suites":["onRouteUpdate"],"updatePoint":{"line":156,"column":56,"index":3900},"line":156,"code":"  it(`sends nothing when web vitals tracking is disabled`, async () => {\n    const {\n      onInitialClientRender\n    } = getAPI(() => {\n      process.env.NODE_ENV = `production`;\n    });\n    onInitialClientRender({}, {\n      enableWebVitalsTracking: false\n    });\n\n    // wait 2 ticks to wait for dynamic import to resolve\n    await Promise.resolve();\n    await Promise.resolve();\n    jest.runAllTimers();\n    expect(getLCP).not.toBeCalled();\n    expect(getFID).not.toBeCalled();\n    expect(getCLS).not.toBeCalled();\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"should validate valid options","suites":["pluginOptionsSchema"],"updatePoint":{"line":4,"column":35,"index":193},"line":4,"code":"  it(`should validate valid options`, async () => {\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      id: `YOUR_GOOGLE_TAGMANAGER_ID`,\n      includeInDevelopment: false,\n      defaultDataLayer: {\n        platform: `gatsby`\n      },\n      gtmAuth: `YOUR_GOOGLE_TAGMANAGER_ENVIRONMENT_AUTH_STRING`,\n      gtmPreview: `YOUR_GOOGLE_TAGMANAGER_ENVIRONMENT_PREVIEW_NAME`,\n      dataLayerName: `YOUR_DATA_LAYER_NAME`,\n      routeChangeEventName: `YOUR_ROUTE_CHANGE_EVENT_NAME`,\n      enableWebVitalsTracking: true,\n      selfHostedOrigin: `YOUR_SELF_HOSTED_ORIGIN`\n    });\n    expect(isValid).toEqual(true);\n    expect(errors).toEqual([]);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"should support defaultDataLayer as a function","suites":["pluginOptionsSchema"],"updatePoint":{"line":24,"column":51,"index":905},"line":24,"code":"  it(`should support defaultDataLayer as a function`, async () => {\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      defaultDataLayer: () => {\n        return {\n          originalLocation: document.location.protocol + `//` + document.location.hostname + document.location.pathname + document.location.search\n        };\n      }\n    });\n    expect(isValid).toEqual(true);\n    expect(errors).toEqual([]);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"should load gtm","suites":["gatsby-plugin-google-tagmanager"],"updatePoint":{"line":8,"column":21,"index":173},"line":8,"code":"  it(`should load gtm`, () => {\n    const mocks = {\n      setHeadComponents: jest.fn(),\n      setPreBodyComponents: jest.fn()\n    };\n    const pluginOptions = {\n      includeInDevelopment: true\n    };\n    onRenderBody(mocks, pluginOptions);\n    const [headConfig] = mocks.setHeadComponents.mock.calls[0][0];\n    const [preBodyConfig] = mocks.setPreBodyComponents.mock.calls[0][0];\n    expect(headConfig.props.dangerouslySetInnerHTML.__html).toMatchSnapshot();\n    expect(preBodyConfig.props.dangerouslySetInnerHTML.__html).toMatchSnapshot();\n    // check if no newlines were added\n    expect(preBodyConfig.props.dangerouslySetInnerHTML.__html).not.toContain(`\\n`);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"should add no dataLayer by default","suites":["gatsby-plugin-google-tagmanager","defaultDatalayer"],"updatePoint":{"line":25,"column":42,"index":904},"line":25,"code":"    it(`should add no dataLayer by default`, () => {\n      const mocks = {\n        setHeadComponents: jest.fn(),\n        setPreBodyComponents: jest.fn()\n      };\n      const pluginOptions = {\n        id: `123`,\n        includeInDevelopment: true\n      };\n      onRenderBody(mocks, pluginOptions);\n      const [headConfig] = mocks.setHeadComponents.mock.calls[0][0];\n      // eslint-disable-next-line no-useless-escape\n      expect(headConfig.props.dangerouslySetInnerHTML.__html).not.toContain(`window.dataLayer`);\n      expect(headConfig.props.dangerouslySetInnerHTML.__html).not.toContain(`undefined`);\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"should add a static object as defaultDatalayer","suites":["gatsby-plugin-google-tagmanager","defaultDatalayer"],"updatePoint":{"line":40,"column":54,"index":1529},"line":40,"code":"    it(`should add a static object as defaultDatalayer`, () => {\n      const mocks = {\n        setHeadComponents: jest.fn(),\n        setPreBodyComponents: jest.fn()\n      };\n      const pluginOptions = {\n        includeInDevelopment: true,\n        defaultDataLayer: {\n          type: `object`,\n          value: {\n            pageCategory: `home`\n          }\n        }\n      };\n      onRenderBody(mocks, pluginOptions);\n      const [headConfig] = mocks.setHeadComponents.mock.calls[0][0];\n      expect(headConfig.props.dangerouslySetInnerHTML.__html).toMatchSnapshot();\n      expect(headConfig.props.dangerouslySetInnerHTML.__html).toContain(`window.dataLayer`);\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"should add a function as defaultDatalayer","suites":["gatsby-plugin-google-tagmanager","defaultDatalayer"],"updatePoint":{"line":59,"column":49,"index":2194},"line":59,"code":"    it(`should add a function as defaultDatalayer`, () => {\n      const mocks = {\n        setHeadComponents: jest.fn(),\n        setPreBodyComponents: jest.fn()\n      };\n      const pluginOptions = {\n        includeInDevelopment: true,\n        defaultDataLayer: {\n          type: `function`,\n          value: function () {\n            return {\n              pageCategory: window.pageType\n            };\n          }.toString()\n        }\n      };\n      const datalayerFuncAsString = oneLine`${pluginOptions.defaultDataLayer.value}`;\n      onRenderBody(mocks, pluginOptions);\n      const [headConfig] = mocks.setHeadComponents.mock.calls[0][0];\n      expect(headConfig.props.dangerouslySetInnerHTML.__html).toMatchSnapshot();\n      expect(headConfig.props.dangerouslySetInnerHTML.__html).toContain(`window.dataLayer.push((${datalayerFuncAsString})());`);\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"should report an error when data is not valid","suites":["gatsby-plugin-google-tagmanager","defaultDatalayer"],"updatePoint":{"line":81,"column":53,"index":3057},"line":81,"code":"    it(`should report an error when data is not valid`, () => {\n      const mocks = {\n        setHeadComponents: jest.fn(),\n        setPreBodyComponents: jest.fn(),\n        reporter: {\n          panic: msg => {\n            throw new Error(msg);\n          }\n        }\n      };\n      let pluginOptions = {\n        includeInDevelopment: true,\n        defaultDataLayer: {\n          type: `number`,\n          value: 5\n        }\n      };\n      expect(() => onRenderBody(mocks, pluginOptions)).toThrow();\n      class Test {}\n      pluginOptions = {\n        includeInDevelopment: true,\n        defaultDataLayer: {\n          type: `object`,\n          value: new Test()\n        }\n      };\n      expect(() => onRenderBody(mocks, pluginOptions)).toThrow();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"should add a renamed dataLayer","suites":["gatsby-plugin-google-tagmanager","defaultDatalayer"],"updatePoint":{"line":109,"column":38,"index":3795},"line":109,"code":"    it(`should add a renamed dataLayer`, () => {\n      const dataLayerName = `TEST_DATA_LAYER_NAME`;\n      const mocks = {\n        setHeadComponents: jest.fn(),\n        setPreBodyComponents: jest.fn()\n      };\n      const pluginOptions = {\n        includeInDevelopment: true,\n        defaultDataLayer: {\n          type: `object`,\n          value: {\n            pageCategory: `home`\n          }\n        },\n        dataLayerName,\n        enableWebVitalsTracking: false\n      };\n      onRenderBody(mocks, pluginOptions);\n      const [headConfig] = mocks.setHeadComponents.mock.calls[0][0];\n      expect(headConfig.props.dangerouslySetInnerHTML.__html).toMatchSnapshot();\n      expect(headConfig.props.dangerouslySetInnerHTML.__html).toContain(`window.${dataLayerName}`);\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"adds the web-vitals polyfill to the head","suites":["gatsby-plugin-google-tagmanager","defaultDatalayer"],"updatePoint":{"line":131,"column":48,"index":4581},"line":131,"code":"    it(`adds the web-vitals polyfill to the head`, () => {\n      const mocks = {\n        setHeadComponents: jest.fn(),\n        setPreBodyComponents: jest.fn()\n      };\n      const pluginOptions = {\n        includeInDevelopment: true,\n        enableWebVitalsTracking: true\n      };\n      onRenderBody(mocks, pluginOptions);\n      const [headConfig] = mocks.setHeadComponents.mock.calls[0][0];\n      expect(mocks.setHeadComponents.mock.calls[0][0].length).toBe(2);\n      expect(headConfig.key).toBe(`gatsby-plugin-google-tagmanager-web-vitals`);\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"should not add the web-vitals polyfill when enableWebVitalsTracking is false ","suites":["gatsby-plugin-google-tagmanager","defaultDatalayer"],"updatePoint":{"line":145,"column":85,"index":5170},"line":145,"code":"    it(`should not add the web-vitals polyfill when enableWebVitalsTracking is false `, () => {\n      const mocks = {\n        setHeadComponents: jest.fn(),\n        setPreBodyComponents: jest.fn()\n      };\n      const pluginOptions = {\n        includeInDevelopment: true,\n        enableWebVitalsTracking: false\n      };\n      onRenderBody(mocks, pluginOptions);\n      const [headConfig] = mocks.setHeadComponents.mock.calls[0][0];\n      expect(mocks.setHeadComponents.mock.calls[0].length).toBe(1);\n      expect(headConfig.key).toBe(`plugin-google-tagmanager`);\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"should set selfHostedOrigin as googletagmanager.com by default","suites":["gatsby-plugin-google-tagmanager","defaultDatalayer"],"updatePoint":{"line":159,"column":70,"index":5724},"line":159,"code":"    it(`should set selfHostedOrigin as googletagmanager.com by default`, () => {\n      const mocks = {\n        setHeadComponents: jest.fn(),\n        setPreBodyComponents: jest.fn()\n      };\n      const pluginOptions = {\n        id: `123`,\n        includeInDevelopment: true\n      };\n      onRenderBody(mocks, pluginOptions);\n      const [headConfig] = mocks.setHeadComponents.mock.calls[0][0];\n      const [preBodyConfig] = mocks.setPreBodyComponents.mock.calls[0][0];\n\n      // eslint-disable-next-line no-useless-escape\n      expect(headConfig.props.dangerouslySetInnerHTML.__html).toContain(`https://www.googletagmanager.com/gtm.js`);\n      expect(preBodyConfig.props.dangerouslySetInnerHTML.__html).toContain(`https://www.googletagmanager.com/ns.html`);\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"should set selfHostedOrigin","suites":["gatsby-plugin-google-tagmanager","defaultDatalayer"],"updatePoint":{"line":176,"column":35,"index":6455},"line":176,"code":"    it(`should set selfHostedOrigin`, () => {\n      const selfHostedOrigin = `YOUR_SELF_HOSTED_ORIGIN`;\n      const mocks = {\n        setHeadComponents: jest.fn(),\n        setPreBodyComponents: jest.fn()\n      };\n      const pluginOptions = {\n        id: `123`,\n        includeInDevelopment: true,\n        selfHostedOrigin: selfHostedOrigin\n      };\n      onRenderBody(mocks, pluginOptions);\n      const [headConfig] = mocks.setHeadComponents.mock.calls[0][0];\n      const [preBodyConfig] = mocks.setPreBodyComponents.mock.calls[0][0];\n\n      // eslint-disable-next-line no-useless-escape\n      expect(headConfig.props.dangerouslySetInnerHTML.__html).toContain(`${selfHostedOrigin}/gtm.js`);\n      expect(preBodyConfig.props.dangerouslySetInnerHTML.__html).toContain(`${selfHostedOrigin}/ns.html`);\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-google-tagmanager/src/__tests__"},{"name":"normalises props","suites":["static-image babel parser"],"updatePoint":{"line":4,"column":22},"line":4,"code":"  it(`normalises props`, () => {\n    const input = {\n      formats: [`webP`, `JPG`, `png`],\n      placeholder: `DOMINANT_COLOR`,\n      layout: `FLUID`,\n    }\n    expect(normalizeProps(input)).toEqual({\n      formats: [`webp`, `jpg`, `png`],\n      layout: `fluid`,\n      placeholder: `dominantColor`,\n    })\n  })","file":"babel-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"handles tracedSvg","suites":["static-image babel parser"],"updatePoint":{"line":17,"column":23},"line":17,"code":"  it(`handles tracedSvg`, () => {\n    expect(\n      normalizeProps({\n        placeholder: `TRACED_SVG`,\n      })\n    ).toEqual({\n      placeholder: `tracedSVG`,\n    })\n\n    expect(\n      normalizeProps({\n        placeholder: `tracedSVG`,\n      })\n    ).toEqual({\n      placeholder: `tracedSVG`,\n    })\n\n    expect(\n      normalizeProps({\n        placeholder: `tracedSvg`,\n      })\n    ).toEqual({\n      placeholder: `tracedSVG`,\n    })\n  })","file":"babel-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"throws if there's not a valid generateImageData function","suites":["the image data helper"],"updatePoint":{"line":58,"column":62},"line":58,"code":"  it(`throws if there's not a valid generateImageData function`, () => {\n    const generateImageSource = `this should be a function`\n\n    expect(() =>\n      generateImageData({\n        ...args,\n        generateImageSource,\n      } as any as IGatsbyImageHelperArgs)\n    ).toThrow()\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"warns if generateImageSource function returns invalid values","suites":["the image data helper"],"updatePoint":{"line":69,"column":66},"line":69,"code":"  it(`warns if generateImageSource function returns invalid values`, () => {\n    const generateImageSource = jest\n      .fn()\n      .mockReturnValue({ width: 100, height: 200, src: undefined })\n\n    const myArgs = {\n      ...args,\n      generateImageSource,\n    }\n\n    generateImageData(myArgs)\n\n    expect(args.reporter?.warn).toHaveBeenCalledWith(\n      `[gatsby-plugin-fake] The resolver for image afile.jpg returned an invalid value.`\n    )\n    ;(args.reporter?.warn as jest.Mock).mockReset()\n\n    generateImageSource.mockReturnValue({\n      width: 100,\n      height: undefined,\n      src: `example`,\n      format: `jpg`,\n    })\n    generateImageData(myArgs)\n\n    expect(args.reporter?.warn).toHaveBeenCalledWith(\n      `[gatsby-plugin-fake] The resolver for image afile.jpg returned an invalid value.`\n    )\n    ;(args.reporter?.warn as jest.Mock).mockReset()\n\n    generateImageSource.mockReturnValue({\n      width: undefined,\n      height: 100,\n      src: `example`,\n      format: `jpg`,\n    })\n    generateImageData(myArgs)\n\n    expect(args.reporter?.warn).toHaveBeenCalledWith(\n      `[gatsby-plugin-fake] The resolver for image afile.jpg returned an invalid value.`\n    )\n    ;(args.reporter?.warn as jest.Mock).mockReset()\n\n    generateImageSource.mockReturnValue({\n      width: 100,\n      height: 100,\n      src: `example`,\n      format: undefined,\n    })\n    generateImageData(myArgs)\n\n    expect(args.reporter?.warn).toHaveBeenCalledWith(\n      `[gatsby-plugin-fake] The resolver for image afile.jpg returned an invalid value.`\n    )\n    ;(args.reporter?.warn as jest.Mock).mockReset()\n    generateImageSource.mockReturnValue({\n      width: 100,\n      height: 100,\n      src: `example`,\n      format: `jpg`,\n    })\n    generateImageData(myArgs)\n    expect(args.reporter?.warn).not.toHaveBeenCalled()\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"warns if there's no plugin name","suites":["the image data helper"],"updatePoint":{"line":134,"column":37},"line":134,"code":"  it(`warns if there's no plugin name`, () => {\n    generateImageData({\n      ...args,\n      pluginName: undefined,\n    } as any as IGatsbyImageHelperArgs)\n    expect(args.reporter?.warn).toHaveBeenCalledWith(\n      `[gatsby-plugin-image] \"generateImageData\" was not passed a plugin name`\n    )\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"calls the generateImageSource function","suites":["the image data helper"],"updatePoint":{"line":144,"column":44},"line":144,"code":"  it(`calls the generateImageSource function`, () => {\n    const generateImageSource = jest.fn()\n    generateImageData({ ...args, generateImageSource })\n    expect(generateImageSource).toHaveBeenCalledWith(\n      `afile.jpg`,\n      800,\n      600,\n      `jpg`,\n      undefined,\n      undefined\n    )\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"calculates sizes for fixed","suites":["the image data helper"],"updatePoint":{"line":157,"column":32},"line":157,"code":"  it(`calculates sizes for fixed`, () => {\n    const data = generateImageData(args)\n    expect(data.images.fallback?.sizes).toEqual(`400px`)\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"calculates sizes for fullWidth","suites":["the image data helper"],"updatePoint":{"line":162,"column":36},"line":162,"code":"  it(`calculates sizes for fullWidth`, () => {\n    const data = generateImageData(fullWidthArgs)\n    expect(data.images.fallback?.sizes).toEqual(`100vw`)\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"calculates sizes for constrained","suites":["the image data helper"],"updatePoint":{"line":167,"column":38},"line":167,"code":"  it(`calculates sizes for constrained`, () => {\n    const data = generateImageData(constrainedArgs)\n    expect(data.images.fallback?.sizes).toEqual(\n      `(min-width: 400px) 400px, 100vw`\n    )\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"returns URLs for fixed","suites":["the image data helper"],"updatePoint":{"line":174,"column":28},"line":174,"code":"  it(`returns URLs for fixed`, () => {\n    const data = generateImageData(args)\n    expect(data?.images?.fallback?.src).toEqual(\n      `https://example.com/afile.jpg/400/300/image.jpg`\n    )\n\n    expect(data.images?.sources?.[0].srcSet).toEqual(\n      `https://example.com/afile.jpg/400/300/image.webp 400w,\\nhttps://example.com/afile.jpg/800/600/image.webp 800w`\n    )\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"returns URLs for fullWidth","suites":["the image data helper"],"updatePoint":{"line":185,"column":32},"line":185,"code":"  it(`returns URLs for fullWidth`, () => {\n    const data = generateImageData(fullWidthArgs)\n    expect(data?.images?.fallback?.src).toEqual(\n      `https://example.com/afile.jpg/750/563/image.jpg`\n    )\n\n    expect(data.images?.sources?.[0].srcSet)\n      .toEqual(`https://example.com/afile.jpg/750/563/image.webp 750w,\nhttps://example.com/afile.jpg/1080/810/image.webp 1080w,\nhttps://example.com/afile.jpg/1366/1025/image.webp 1366w,\nhttps://example.com/afile.jpg/1920/1440/image.webp 1920w`)\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"converts to PNG if requested","suites":["the image data helper"],"updatePoint":{"line":198,"column":34},"line":198,"code":"  it(`converts to PNG if requested`, () => {\n    const data = generateImageData({ ...args, formats: [`png`] })\n    expect(data?.images?.fallback?.src).toEqual(\n      `https://example.com/afile.jpg/400/300/image.png`\n    )\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"does not include sources if only jpg or png format is specified","suites":["the image data helper"],"updatePoint":{"line":205,"column":69},"line":205,"code":"  it(`does not include sources if only jpg or png format is specified`, () => {\n    let data = generateImageData({ ...args, formats: [`auto`] })\n    expect(data.images?.sources?.length).toBe(0)\n\n    data = generateImageData({ ...args, formats: [`png`] })\n    expect(data.images?.sources?.length).toBe(0)\n\n    data = generateImageData({ ...args, formats: [`jpg`] })\n    expect(data.images?.sources?.length).toBe(0)\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"does not include fallback if only webp format is specified","suites":["the image data helper"],"updatePoint":{"line":216,"column":64},"line":216,"code":"  it(`does not include fallback if only webp format is specified`, () => {\n    const data = generateImageData({ ...args, formats: [`webp`] })\n    expect(data.images?.sources?.length).toBe(1)\n    expect(data.images?.fallback).toBeUndefined()\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"does not include fallback if only avif format is specified","suites":["the image data helper"],"updatePoint":{"line":222,"column":64},"line":222,"code":"  it(`does not include fallback if only avif format is specified`, () => {\n    const data = generateImageData({ ...args, formats: [`avif`] })\n    expect(data.images?.sources?.length).toBe(1)\n    expect(data.images?.fallback).toBeUndefined()\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"includes a placeholder image if a URL is provided","suites":["the image data helper"],"updatePoint":{"line":228,"column":55},"line":228,"code":"  it(`includes a placeholder image if a URL is provided`, () => {\n    const data = generateImageData({\n      ...args,\n      placeholderURL: `data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD`,\n    })\n    expect(data.placeholder?.fallback).toEqual(\n      `data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD`\n    )\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"generates the same output as the input format if output is auto","suites":["the image data helper"],"updatePoint":{"line":238,"column":69},"line":238,"code":"  it(`generates the same output as the input format if output is auto`, () => {\n    const sourceMetadata = {\n      width: 800,\n      height: 600,\n      format: `jpg`,\n    }\n\n    let data = generateImageData({ ...args, formats: [`auto`] })\n    expect(data?.images?.fallback?.src).toEqual(\n      `https://example.com/afile.jpg/400/300/image.jpg`\n    )\n    expect(data.images?.sources?.length).toBe(0)\n\n    data = generateImageData({\n      ...args,\n      sourceMetadata: { ...sourceMetadata, format: `png` },\n      formats: [`auto`],\n    })\n    expect(data?.images?.fallback?.src).toEqual(\n      `https://example.com/afile.jpg/400/300/image.png`\n    )\n    expect(data.images?.sources?.length).toBe(0)\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"treats empty formats or empty string as auto","suites":["the image data helper"],"updatePoint":{"line":262,"column":50},"line":262,"code":"  it(`treats empty formats or empty string as auto`, () => {\n    let data = generateImageData({ ...args, formats: [``] })\n    expect(data?.images?.fallback?.src).toEqual(\n      `https://example.com/afile.jpg/400/300/image.jpg`\n    )\n    expect(data.images?.sources?.length).toBe(0)\n\n    data = generateImageData({ ...args, formats: [] })\n    expect(data?.images?.fallback?.src).toEqual(\n      `https://example.com/afile.jpg/400/300/image.jpg`\n    )\n    expect(data.images?.sources?.length).toBe(0)\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"gets file format from filename","suites":["the helper utils"],"updatePoint":{"line":278,"column":36},"line":278,"code":"  it(`gets file format from filename`, () => {\n    const names = [\n      `filename.jpg`,\n      `filename.jpeg`,\n      `filename.png`,\n      `filename.heic`,\n      `filename.jp`,\n      `filename.jpgjpg`,\n      `file.name.jpg`,\n      `file.name.`,\n      `filenamejpg`,\n      `.jpg`,\n    ]\n    const expected = [\n      `jpg`,\n      `jpg`,\n      `png`,\n      `heic`,\n      undefined,\n      undefined,\n      `jpg`,\n      undefined,\n      undefined,\n      `jpg`,\n    ]\n    for (const idx in names) {\n      const ext = formatFromFilename(names[idx])\n      expect(ext).toBe(expected[idx])\n    }\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"gets a low-resolution image URL","suites":["the helper utils"],"updatePoint":{"line":309,"column":37},"line":309,"code":"  it(`gets a low-resolution image URL`, () => {\n    const url = getLowResolutionImageURL(args)\n    expect(url).toEqual(`https://example.com/afile.jpg/20/15/image.jpg`)\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"gets a low-resolution image URL when width and height are set","suites":["the helper utils"],"updatePoint":{"line":314,"column":67},"line":314,"code":"  it(`gets a low-resolution image URL when width and height are set`, () => {\n    const url = getLowResolutionImageURL({ ...args, width: 200, height: 200 })\n    expect(url).toEqual(`https://example.com/afile.jpg/20/20/image.jpg`)\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"gets a low-resolution image URL with correct aspect ratio","suites":["the helper utils"],"updatePoint":{"line":319,"column":63},"line":319,"code":"  it(`gets a low-resolution image URL with correct aspect ratio`, () => {\n    const url = getLowResolutionImageURL({\n      ...fullWidthArgs,\n      aspectRatio: 2 / 1,\n    })\n    expect(url).toEqual(`https://example.com/afile.jpg/20/10/image.jpg`)\n  })","file":"image-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-image/src/__tests__"},{"name":"Stage:  / ","suites":["gatsby-plugin-less"],"updatePoint":{"line":63,"column":36,"index":1583},"line":63,"code":"      it(`Stage: ${stage} / ${label}`, () => {\n        onCreateWebpackConfig({\n          actions,\n          loaders,\n          stage\n        }, options);\n        expect(actions.setWebpackConfig).toMatchSnapshot();\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-less/src/__tests__"},{"name":"includes all icon sizes","suites":["gatsby-plugin-manifest","defaultIcons"],"updatePoint":{"line":7,"column":31,"index":178},"line":7,"code":"    it(`includes all icon sizes`, () => {\n      expect(defaultIcons).toMatchSnapshot();\n    });","file":"common.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"returns unmodified path","suites":["gatsby-plugin-manifest","addDigestToPath"],"updatePoint":{"line":12,"column":31,"index":318},"line":12,"code":"    it(`returns unmodified path`, () => {\n      expect(addDigestToPath(`icons/icon-48x48.png`, `thisismydigest`, `none`)).toBe(`icons/icon-48x48.png`);\n    });","file":"common.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"returns query modified path","suites":["gatsby-plugin-manifest","addDigestToPath"],"updatePoint":{"line":15,"column":35,"index":482},"line":15,"code":"    it(`returns query modified path`, () => {\n      expect(addDigestToPath(`icons/icon-48x48.png`, `thisismydigest`, `query`)).toBe(`icons/icon-48x48.png?v=thisismydigest`);\n    });","file":"common.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"returns fileName modified path","suites":["gatsby-plugin-manifest","addDigestToPath"],"updatePoint":{"line":18,"column":38,"index":667},"line":18,"code":"    it(`returns fileName modified path`, () => {\n      expect(addDigestToPath(`icons/icon-48x48.png`, `thisismydigest`, `name`)).toBe(`icons/icon-48x48-thisismydigest.png`);\n    });","file":"common.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"has manifest in head","suites":["gatsby-plugin-manifest"],"updatePoint":{"line":24,"column":28,"index":615},"line":24,"code":"  test(`has manifest in head`, () => {\n    const location = {\n      pathname: `/`\n    };\n    onRouteUpdate({\n      location\n    }, pluginOptions);\n    expect(document.head).toMatchInlineSnapshot(`\n      <head>\n        <link\n          href=\"/manifest.webmanifest\"\n          rel=\"manifest\"\n        />\n      </head>\n    `);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"changes href of manifest if navigating to a localized app","suites":["gatsby-plugin-manifest"],"updatePoint":{"line":40,"column":65,"index":979},"line":40,"code":"  test(`changes href of manifest if navigating to a localized app`, () => {\n    const location = {\n      pathname: `/es/`\n    };\n    // add default lang\n    pluginOptions.lang = `en`;\n    onRouteUpdate({\n      location\n    }, pluginOptions);\n    expect(document.head).toMatchInlineSnapshot(`\n      <head>\n        <link\n          href=\"/manifest_es.webmanifest\"\n          rel=\"manifest\"\n        />\n      </head>\n    `);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"keeps default manifest if not navigating to a localized app","suites":["gatsby-plugin-manifest"],"updatePoint":{"line":58,"column":67,"index":1406},"line":58,"code":"  test(`keeps default manifest if not navigating to a localized app`, () => {\n    const location = {\n      pathname: `/random-path/`\n    };\n    // add default lang\n    pluginOptions.lang = `en`;\n    onRouteUpdate({\n      location\n    }, pluginOptions);\n    expect(document.head).toMatchInlineSnapshot(`\n      <head>\n        <link\n          href=\"/manifest.webmanifest\"\n          rel=\"manifest\"\n        />\n      </head>\n    `);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"use correct localized manifest when path prefix is used","suites":["gatsby-plugin-manifest"],"updatePoint":{"line":76,"column":63,"index":1835},"line":76,"code":"  test(`use correct localized manifest when path prefix is used`, () => {\n    global.__PATH_PREFIX__ = `/test`;\n    const location = {\n      pathname: `/test/es/`\n    };\n    // add default lang\n    pluginOptions.lang = `en`;\n    onRouteUpdate({\n      location\n    }, pluginOptions);\n    expect(document.head).toMatchInlineSnapshot(`\n      <head>\n        <link\n          href=\"/test/manifest_es.webmanifest\"\n          rel=\"manifest\"\n        />\n      </head>\n    `);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"correctly works with default parameters","suites":["Test plugin manifest options"],"updatePoint":{"line":101,"column":45,"index":2500},"line":101,"code":"  it(`correctly works with default parameters`, async () => {\n    await onPostBootstrap(apiArgs, {\n      name: `GatsbyJS`,\n      short_name: `GatsbyJS`,\n      start_url: `/`,\n      background_color: `#f7f0eb`,\n      theme_color: `#a2466c`,\n      display: `standalone`\n    });\n    const contents = fs.writeFileSync.mock.calls[0][1];\n    expect(fs.writeFileSync).toHaveBeenCalledWith(path.join(`public`, `manifest.webmanifest`), expect.anything());\n    expect(sharp).toHaveBeenCalledTimes(0);\n    expect(contents).toMatchSnapshot();\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"correctly works with multiple icon paths","suites":["Test plugin manifest options"],"updatePoint":{"line":115,"column":46,"index":3038},"line":115,"code":"  it(`correctly works with multiple icon paths`, async () => {\n    fs.existsSync.mockReturnValue(false);\n    const size = 48;\n    const pluginSpecificOptions = {\n      icons: [{\n        src: `icons/icon-48x48.png`,\n        sizes: `${size}x${size}`,\n        type: `image/png`\n      }, {\n        src: `other-icons/icon-48x48.png`,\n        sizes: `${size}x${size}`,\n        type: `image/png`\n      }]\n    };\n    await onPostBootstrap(apiArgs, {\n      ...manifestOptions,\n      ...pluginSpecificOptions\n    });\n    const firstIconPath = path.join(`public`, path.dirname(`icons/icon-48x48.png`));\n    const secondIconPath = path.join(`public`, path.dirname(`other-icons/icon-48x48.png`));\n\n    // No sharp calls because this is manual mode: user provides all icon sizes\n    // rather than the plugin generating them\n    expect(sharp).toHaveBeenCalledTimes(0);\n    expect(fs.mkdirSync).toHaveBeenNthCalledWith(1, firstIconPath, {\n      recursive: true\n    });\n    expect(fs.mkdirSync).toHaveBeenNthCalledWith(2, secondIconPath, {\n      recursive: true\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"invokes sharp if icon argument specified","suites":["Test plugin manifest options"],"updatePoint":{"line":146,"column":46,"index":4098},"line":146,"code":"  it(`invokes sharp if icon argument specified`, async () => {\n    fs.statSync.mockReturnValueOnce({\n      isFile: () => true\n    });\n    const icon = `pretend/this/exists.png`;\n    const size = 48;\n    const pluginSpecificOptions = {\n      icon: icon,\n      icons: [{\n        src: `icons/icon-48x48.png`,\n        sizes: `${size}x${size}`,\n        type: `image/png`\n      }]\n    };\n    await onPostBootstrap(apiArgs, {\n      ...manifestOptions,\n      ...pluginSpecificOptions\n    });\n\n    // One call to sharp to check the source icon is square\n    // + another for the favicon (enabled by default)\n    // + another for the single icon in the `icons` config\n    // => 3 total calls\n    expect(sharp).toHaveBeenCalledTimes(3);\n    expect(sharp).toHaveBeenCalledWith(icon, {\n      density: 32\n    }); // the default favicon\n    expect(sharp).toHaveBeenCalledWith(icon, {\n      density: size\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"skips favicon generation if \"include_favicon\" option is set to false","suites":["Test plugin manifest options"],"updatePoint":{"line":177,"column":74,"index":5029},"line":177,"code":"  it(`skips favicon generation if \"include_favicon\" option is set to false`, async () => {\n    fs.statSync.mockReturnValueOnce({\n      isFile: () => true\n    });\n    const icon = `pretend/this/exists.png`;\n    const size = 48;\n    const pluginSpecificOptions = {\n      icon: icon,\n      icons: [{\n        src: `icons/icon-48x48.png`,\n        sizes: `${size}x${size}`,\n        type: `image/png`\n      }],\n      include_favicon: false\n    };\n    await onPostBootstrap(apiArgs, {\n      ...manifestOptions,\n      ...pluginSpecificOptions\n    });\n\n    // Only two sharp calls here: one to check the source icon size,\n    // and another to generate the single icon in the config.\n    // By default, there would be a 3rd call for the favicon, but that's\n    // disabled by the `include_favicon` option.\n    expect(sharp).toHaveBeenCalledTimes(2);\n    expect(sharp).toHaveBeenCalledWith(icon, {\n      density: size\n    });\n    expect(fs.copyFileSync).toHaveBeenCalledTimes(0);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"fails on non existing icon","suites":["Test plugin manifest options"],"updatePoint":{"line":207,"column":32,"index":5962},"line":207,"code":"  it(`fails on non existing icon`, async () => {\n    fs.statSync.mockReturnValueOnce({\n      isFile: () => false\n    });\n    const pluginSpecificOptions = {\n      icon: `non/existing/path`\n    };\n    await expect(onPostBootstrap(apiArgs, {\n      ...manifestOptions,\n      ...pluginSpecificOptions\n    })).rejects.toThrow(`icon (non/existing/path) does not exist as defined in gatsby-config.js. Make sure the file exists relative to the root of the site.`);\n    expect(sharp).toHaveBeenCalledTimes(0);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"doesn't write extra properties to manifest","suites":["Test plugin manifest options"],"updatePoint":{"line":220,"column":48,"index":6485},"line":220,"code":"  it(`doesn't write extra properties to manifest`, async () => {\n    const pluginSpecificOptions = {\n      icon: undefined,\n      legacy: true,\n      plugins: [],\n      theme_color_in_head: false,\n      cache_busting_mode: `name`,\n      include_favicon: true,\n      crossOrigin: `anonymous`,\n      icon_options: {}\n    };\n    await onPostBootstrap(apiArgs, {\n      ...manifestOptions,\n      ...pluginSpecificOptions\n    });\n    expect(sharp).toHaveBeenCalledTimes(0);\n    expect(fs.writeFileSync).toHaveBeenCalledWith(expect.anything(), JSON.stringify(manifestOptions));\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"does file name based cache busting","suites":["Test plugin manifest options"],"updatePoint":{"line":238,"column":40,"index":7054},"line":238,"code":"  it(`does file name based cache busting`, async () => {\n    fs.statSync.mockReturnValueOnce({\n      isFile: () => true\n    });\n    const pluginSpecificOptions = {\n      icon: `images/gatsby-logo.png`,\n      legacy: true,\n      cache_busting_mode: `name`\n    };\n    await onPostBootstrap(apiArgs, {\n      ...manifestOptions,\n      ...pluginSpecificOptions\n    });\n\n    // Two icons in the config, plus a favicon, plus one call to check the\n    // source icon size => 4 total calls to sharp.\n    expect(sharp).toHaveBeenCalledTimes(4);\n\n    // Filenames in the manifest should be suffixed with the content digest\n    expect(fs.writeFileSync).toMatchSnapshot();\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"does not do cache cache busting","suites":["Test plugin manifest options"],"updatePoint":{"line":259,"column":37,"index":7717},"line":259,"code":"  it(`does not do cache cache busting`, async () => {\n    fs.statSync.mockReturnValueOnce({\n      isFile: () => true\n    });\n    const pluginSpecificOptions = {\n      icon: `images/gatsby-logo.png`,\n      legacy: true,\n      cache_busting_mode: `none`\n    };\n    await onPostBootstrap(apiArgs, {\n      ...manifestOptions,\n      ...pluginSpecificOptions\n    });\n\n    // Two icons in the config, plus a favicon, plus one call to check the\n    // source icon size => 4 total calls to sharp.\n    expect(sharp).toHaveBeenCalledTimes(4);\n    expect(fs.writeFileSync).toHaveBeenCalledWith(expect.anything(), JSON.stringify(manifestOptions));\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"icon options iterator adds options and the icon array take precedence","suites":["Test plugin manifest options"],"updatePoint":{"line":278,"column":75,"index":8396},"line":278,"code":"  it(`icon options iterator adds options and the icon array take precedence`, async () => {\n    fs.statSync.mockReturnValueOnce({\n      isFile: () => true\n    });\n    const pluginSpecificOptions = {\n      icon: `images/gatsby-logo.png`,\n      icon_options: {\n        purpose: `maskable`\n      }\n    };\n    await onPostBootstrap(apiArgs, {\n      ...manifestOptions,\n      ...pluginSpecificOptions\n    });\n\n    // Two icons in the config, plus a favicon, plus one call to check the\n    // source icon size => 4 total calls to sharp.\n    expect(sharp).toHaveBeenCalledTimes(4);\n    const content = JSON.parse(fs.writeFileSync.mock.calls[0][1]);\n    expect(content.icons[0].purpose).toEqual(`all`);\n    expect(content.icons[1].purpose).toEqual(`maskable`);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"correctly works with pathPrefix","suites":["Test plugin manifest options"],"updatePoint":{"line":300,"column":37,"index":9117},"line":300,"code":"  it(`correctly works with pathPrefix`, async () => {\n    await onPostBootstrap({\n      ...apiArgs,\n      basePath: `/blog`\n    }, {\n      name: `GatsbyJS`,\n      short_name: `GatsbyJS`,\n      start_url: `/`,\n      background_color: `#f7f0eb`,\n      theme_color: `#a2466c`,\n      display: `standalone`\n    });\n    const contents = fs.writeFileSync.mock.calls[0][1];\n    expect(fs.writeFileSync).toHaveBeenCalledWith(path.join(`public`, `manifest.webmanifest`), expect.anything());\n    expect(sharp).toHaveBeenCalledTimes(0);\n    expect(contents).toMatchSnapshot();\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"generates all language versions","suites":["Test plugin manifest options"],"updatePoint":{"line":317,"column":37,"index":9688},"line":317,"code":"  it(`generates all language versions`, async () => {\n    fs.statSync.mockReturnValueOnce({\n      isFile: () => true\n    });\n    const pluginSpecificOptions = {\n      ...manifestOptions,\n      localize: [{\n        ...manifestOptions,\n        start_url: `/de/`,\n        lang: `de`\n      }, {\n        ...manifestOptions,\n        start_url: `/es/`,\n        lang: `es`\n      }]\n    };\n    const {\n      localize,\n      ...manifest\n    } = pluginSpecificOptions;\n    const expectedResults = localize.concat(manifest).map(x => {\n      return {\n        ...manifest,\n        ...x\n      };\n    });\n    await onPostBootstrap(apiArgs, pluginSpecificOptions);\n    expect(fs.writeFileSync).toHaveBeenCalledWith(expect.anything(), JSON.stringify(expectedResults[0]));\n    expect(fs.writeFileSync).toHaveBeenCalledWith(expect.anything(), JSON.stringify(expectedResults[1]));\n    expect(fs.writeFileSync).toHaveBeenCalledWith(expect.anything(), JSON.stringify(expectedResults[2]));\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"generates all language versions with pathPrefix","suites":["Test plugin manifest options"],"updatePoint":{"line":348,"column":53,"index":10676},"line":348,"code":"  it(`generates all language versions with pathPrefix`, async () => {\n    fs.statSync.mockReturnValueOnce({\n      isFile: () => true\n    });\n    const pluginSpecificOptions = {\n      ...manifestOptions,\n      localize: [{\n        ...manifestOptions,\n        start_url: `/de/`,\n        lang: `de`\n      }, {\n        ...manifestOptions,\n        start_url: `/es/`,\n        lang: `es`\n      }]\n    };\n    const {\n      localize,\n      ...manifest\n    } = pluginSpecificOptions;\n    const expectedResults = [manifest].concat(localize).map(x => {\n      return {\n        ...manifest,\n        ...x,\n        start_url: path.posix.join(`/blog`, x.start_url),\n        icons: manifest.icons.map(icon => {\n          return {\n            ...icon,\n            src: path.posix.join(`/blog`, icon.src)\n          };\n        })\n      };\n    });\n    await onPostBootstrap({\n      ...apiArgs,\n      basePath: `/blog`\n    }, pluginSpecificOptions);\n    expect(fs.writeFileSync).toHaveBeenCalledWith(expect.anything(), JSON.stringify(expectedResults[0]));\n    expect(fs.writeFileSync).toHaveBeenCalledWith(expect.anything(), JSON.stringify(expectedResults[1]));\n    expect(fs.writeFileSync).toHaveBeenCalledWith(expect.anything(), JSON.stringify(expectedResults[2]));\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"merges default and language options","suites":["Test plugin manifest options"],"updatePoint":{"line":389,"column":41,"index":11915},"line":389,"code":"  it(`merges default and language options`, async () => {\n    fs.statSync.mockReturnValueOnce({\n      isFile: () => true\n    });\n    const pluginSpecificOptions = {\n      ...manifestOptions,\n      localize: [{\n        start_url: `/de/`,\n        lang: `de`\n      }, {\n        start_url: `/es/`,\n        lang: `es`\n      }]\n    };\n    const {\n      localize,\n      ...manifest\n    } = pluginSpecificOptions;\n    const expectedResults = localize.concat(manifest).map(({\n      language,\n      manifest\n    }) => {\n      return {\n        ...manifestOptions,\n        ...manifest\n      };\n    });\n    await onPostBootstrap(apiArgs, pluginSpecificOptions);\n    expect(fs.writeFileSync).toHaveBeenCalledWith(expect.anything(), JSON.stringify(expectedResults[0]));\n    expect(fs.writeFileSync).toHaveBeenCalledWith(expect.anything(), JSON.stringify(expectedResults[1]));\n    expect(fs.writeFileSync).toHaveBeenCalledWith(expect.anything(), JSON.stringify(expectedResults[2]));\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"writes SVG to public if src icon is SVG","suites":["Test plugin manifest options"],"updatePoint":{"line":421,"column":45,"index":12892},"line":421,"code":"  it(`writes SVG to public if src icon is SVG`, async () => {\n    sharp.mockReturnValueOnce({\n      metadata: () => {\n        return {\n          format: `svg`\n        };\n      }\n    });\n    const icon = `this/is/an/icon.svg`;\n    const specificOptions = {\n      ...manifestOptions,\n      icon: icon\n    };\n    await onPostBootstrap({\n      ...apiArgs\n    }, specificOptions);\n    expect(fs.copyFileSync).toHaveBeenCalledWith(expect.stringContaining(`icon.svg`), expect.stringContaining(`favicon.svg`));\n    expect(fs.copyFileSync).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"does not write SVG to public if src icon is PNG","suites":["Test plugin manifest options"],"updatePoint":{"line":440,"column":53,"index":13463},"line":440,"code":"  it(`does not write SVG to public if src icon is PNG`, async () => {\n    const specificOptions = {\n      ...manifestOptions,\n      icon: `this/is/an/icon.png`\n    };\n    await onPostBootstrap({\n      ...apiArgs\n    }, specificOptions);\n    expect(fs.copyFileSync).toHaveBeenCalledTimes(0);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"validates options correctly","suites":["pluginOptionsSchema"],"updatePoint":{"line":452,"column":33,"index":13784},"line":452,"code":"  it(`validates options correctly`, async () => {\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, manifestOptions);\n    expect(isValid).toBe(true);\n    expect(errors).toEqual([]);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Creates href attributes using full pathPrefix for non-webmanifest links","suites":["gatsby-plugin-manifest"],"updatePoint":{"line":30,"column":77,"index":840},"line":30,"code":"  it(`Creates href attributes using full pathPrefix for non-webmanifest links`, () => {\n    global.__BASE_PATH__ = `/base-path`;\n    global.__PATH_PREFIX__ = `http://path-prefix.com${global.__BASE_PATH__}`;\n    onRenderBody(ssrArgs, {\n      icon: defaultIcon,\n      theme_color: `#000000`\n    });\n    headComponents.filter(component => component.type === `link` && component.props.rel !== `manifest`).forEach(component => {\n      expect(component.props.href).toEqual(expect.stringMatching(new RegExp(`^${global.__PATH_PREFIX__}`)));\n    });\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Creates href attributes using pathPrefix without assetPrefix for the webmanifest link","suites":["gatsby-plugin-manifest"],"updatePoint":{"line":41,"column":91,"index":1401},"line":41,"code":"  it(`Creates href attributes using pathPrefix without assetPrefix for the webmanifest link`, () => {\n    global.__BASE_PATH__ = `/base-path`;\n    global.__PATH_PREFIX__ = `http://path-prefix.com${global.__BASE_PATH__}`;\n    onRenderBody(ssrArgs, {\n      icon: defaultIcon,\n      theme_color: `#000000`\n    });\n    const component = headComponents.find(component => component.type === `link` && component.props.rel === `manifest`);\n    expect(component.props.href).toEqual(expect.stringMatching(new RegExp(`^${global.__BASE_PATH__}`)));\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Adds a \"theme color\" meta tag to head if \"theme_color_in_head\" is not provided","suites":["gatsby-plugin-manifest","Manifest Link Generation"],"updatePoint":{"line":52,"column":86,"index":1986},"line":52,"code":"    it(`Adds a \"theme color\" meta tag to head if \"theme_color_in_head\" is not provided`, () => {\n      onRenderBody(ssrArgs, {\n        theme_color: `#000000`,\n        include_favicon: false,\n        cache_busting_mode: false,\n        legacy: false\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Add a \"theme color\" meta tag if \"theme_color_in_head\" is set to true","suites":["gatsby-plugin-manifest","Manifest Link Generation"],"updatePoint":{"line":61,"column":76,"index":2290},"line":61,"code":"    it(`Add a \"theme color\" meta tag if \"theme_color_in_head\" is set to true`, () => {\n      onRenderBody(ssrArgs, {\n        theme_color: `#000000`,\n        theme_color_in_head: true,\n        include_favicon: false,\n        cache_busting_mode: false,\n        legacy: false\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Does not add a \"theme color\" meta tag if \"theme_color_in_head\" is set to false","suites":["gatsby-plugin-manifest","Manifest Link Generation"],"updatePoint":{"line":71,"column":86,"index":2639},"line":71,"code":"    it(`Does not add a \"theme color\" meta tag if \"theme_color_in_head\" is set to false`, () => {\n      onRenderBody(ssrArgs, {\n        theme_color: `#000000`,\n        theme_color_in_head: false,\n        include_favicon: false,\n        cache_busting_mode: false,\n        legacy: false\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Does not add a \"theme_color\" meta tag to head if \"theme_color\" option is not provided.","suites":["gatsby-plugin-manifest","Manifest Link Generation"],"updatePoint":{"line":81,"column":94,"index":2997},"line":81,"code":"    it(`Does not add a \"theme_color\" meta tag to head if \"theme_color\" option is not provided.`, () => {\n      onRenderBody(ssrArgs, {\n        icon: defaultIcon,\n        include_favicon: false,\n        cache_busting_mode: false,\n        legacy: false\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Adds \"icon\" and \"manifest\" links and \"theme_color\" meta tag to head","suites":["gatsby-plugin-manifest","Manifest Link Generation"],"updatePoint":{"line":90,"column":75,"index":3295},"line":90,"code":"    it(`Adds \"icon\" and \"manifest\" links and \"theme_color\" meta tag to head`, () => {\n      onRenderBody(ssrArgs, {\n        icon: defaultIcon,\n        theme_color: `#000000`\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"if \"legacy\" not specified in automatic mode","suites":["gatsby-plugin-manifest","Legacy Icons","Does create legacy links"],"updatePoint":{"line":126,"column":53,"index":4250},"line":126,"code":"      it(`if \"legacy\" not specified in automatic mode`, () => {\n        onRenderBody(ssrArgs, {\n          icon: defaultIcon,\n          theme_color: `#000000`,\n          include_favicon: false,\n          cache_busting_mode: `none`,\n          theme_color_in_head: false\n        });\n        expect(headComponents).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"if \"legacy\" not specified in hybrid mode.","suites":["gatsby-plugin-manifest","Legacy Icons","Does create legacy links"],"updatePoint":{"line":136,"column":51,"index":4588},"line":136,"code":"      it(`if \"legacy\" not specified in hybrid mode.`, () => {\n        onRenderBody(ssrArgs, {\n          icon: defaultIcon,\n          theme_color: `#000000`,\n          icons: [{\n            src: `/favicons/android-chrome-48x48.png`,\n            sizes: `48x48`,\n            type: `image/png`\n          }, {\n            src: `/favicons/android-chrome-512x512.png`,\n            sizes: `512x512`,\n            type: `image/png`\n          }],\n          include_favicon: false,\n          cache_busting_mode: `none`,\n          theme_color_in_head: false\n        });\n        expect(headComponents).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"if \"legacy\" not specified in manual mode.","suites":["gatsby-plugin-manifest","Legacy Icons","Does create legacy links"],"updatePoint":{"line":155,"column":51,"index":5205},"line":155,"code":"      it(`if \"legacy\" not specified in manual mode.`, () => {\n        onRenderBody(ssrArgs, {\n          icons: [{\n            src: `/favicons/android-chrome-48x48.png`,\n            sizes: `48x48`,\n            type: `image/png`\n          }, {\n            src: `/favicons/android-chrome-512x512.png`,\n            sizes: `512x512`,\n            type: `image/png`\n          }]\n        });\n        expect(headComponents).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"If \"legacy\" options is false and in automatic","suites":["gatsby-plugin-manifest","Legacy Icons","Does not create legacy links"],"updatePoint":{"line":171,"column":55,"index":5714},"line":171,"code":"      it(`If \"legacy\" options is false and in automatic`, () => {\n        onRenderBody(ssrArgs, {\n          icon: defaultIcon,\n          legacy: false,\n          include_favicon: false,\n          cache_busting_mode: false\n        });\n        expect(headComponents).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"If \"legacy\" options is false and in manual mode","suites":["gatsby-plugin-manifest","Legacy Icons","Does not create legacy links"],"updatePoint":{"line":180,"column":57,"index":6010},"line":180,"code":"      it(`If \"legacy\" options is false and in manual mode`, () => {\n        onRenderBody(ssrArgs, {\n          theme_color: `#000000`,\n          legacy: false,\n          icons: [{\n            src: `/favicons/android-chrome-48x48.png`,\n            sizes: `48x48`,\n            type: `image/png`\n          }, {\n            src: `/favicons/android-chrome-512x512.png`,\n            sizes: `512x512`,\n            type: `image/png`\n          }]\n        });\n        expect(headComponents).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"If \"legacy\" options is false and in hybrid mode","suites":["gatsby-plugin-manifest","Legacy Icons","Does not create legacy links"],"updatePoint":{"line":196,"column":57,"index":6519},"line":196,"code":"      it(`If \"legacy\" options is false and in hybrid mode`, () => {\n        onRenderBody(ssrArgs, {\n          icon: defaultIcon,\n          legacy: false,\n          icons: [{\n            src: `/favicons/android-chrome-48x48.png`,\n            sizes: `48x48`,\n            type: `image/png`\n          }, {\n            src: `/favicons/android-chrome-512x512.png`,\n            sizes: `512x512`,\n            type: `image/png`\n          }],\n          include_favicon: false,\n          cache_busting_mode: false\n        });\n        expect(headComponents).toMatchSnapshot();\n      });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"doesn't add cache busting in manual mode","suites":["gatsby-plugin-manifest","Cache Busting"],"updatePoint":{"line":217,"column":48,"index":7135},"line":217,"code":"    it(`doesn't add cache busting in manual mode`, () => {\n      onRenderBody(ssrArgs, {\n        icons: [{\n          src: `/favicons/android-chrome-48x48.png`,\n          sizes: `48x48`,\n          type: `image/png`\n        }, {\n          src: `/favicons/android-chrome-512x512.png`,\n          sizes: `512x512`,\n          type: `image/png`\n        }],\n        cache_busting_mode: `name`\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"doesn't add cache busting if \"cache_busting_mode\" option is set to none","suites":["gatsby-plugin-manifest","Cache Busting"],"updatePoint":{"line":232,"column":79,"index":7617},"line":232,"code":"    it(`doesn't add cache busting if \"cache_busting_mode\" option is set to none`, () => {\n      onRenderBody(ssrArgs, {\n        icon: defaultIcon,\n        cache_busting_mode: `none`\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Does file name cache busting if \"cache_busting_mode\" option is set to name","suites":["gatsby-plugin-manifest","Cache Busting"],"updatePoint":{"line":239,"column":82,"index":7868},"line":239,"code":"    it(`Does file name cache busting if \"cache_busting_mode\" option is set to name`, () => {\n      onRenderBody(ssrArgs, {\n        icon: defaultIcon,\n        cache_busting_mode: `name`\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Does query cache busting if \"cache_busting_mode\" option is set to query","suites":["gatsby-plugin-manifest","Cache Busting"],"updatePoint":{"line":246,"column":79,"index":8116},"line":246,"code":"    it(`Does query cache busting if \"cache_busting_mode\" option is set to query`, () => {\n      onRenderBody(ssrArgs, {\n        icon: defaultIcon,\n        cache_busting_mode: `query`\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Does query cache busting if \"cache_busting_mode\" option is set to undefined","suites":["gatsby-plugin-manifest","Cache Busting"],"updatePoint":{"line":253,"column":83,"index":8369},"line":253,"code":"    it(`Does query cache busting if \"cache_busting_mode\" option is set to undefined`, () => {\n      onRenderBody(ssrArgs, {\n        icon: defaultIcon\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Adds link favicon tag if \"include_favicon\" is set to true","suites":["gatsby-plugin-manifest","Favicon"],"updatePoint":{"line":261,"column":65,"index":8603},"line":261,"code":"    it(`Adds link favicon tag if \"include_favicon\" is set to true`, () => {\n      onRenderBody(ssrArgs, {\n        icon: defaultIcon,\n        include_favicon: true,\n        legacy: false,\n        cache_busting_mode: `none`\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Does not add a link favicon if \"include_favicon\" option is set to false","suites":["gatsby-plugin-manifest","Favicon"],"updatePoint":{"line":270,"column":79,"index":8905},"line":270,"code":"    it(`Does not add a link favicon if \"include_favicon\" option is set to false`, () => {\n      onRenderBody(ssrArgs, {\n        icon: defaultIcon,\n        include_favicon: false,\n        legacy: false,\n        cache_busting_mode: `none`\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Does not add a link favicon if in manual mode","suites":["gatsby-plugin-manifest","Favicon"],"updatePoint":{"line":279,"column":53,"index":9182},"line":279,"code":"    it(`Does not add a link favicon if in manual mode`, () => {\n      onRenderBody(ssrArgs, {\n        icons: [{\n          src: `/favicons/android-chrome-48x48.png`,\n          sizes: `48x48`,\n          type: `image/png`\n        }, {\n          src: `/favicons/android-chrome-512x512.png`,\n          sizes: `512x512`,\n          type: `image/png`\n        }],\n        legacy: false,\n        cache_busting_mode: `none`\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Adds a crossOrigin attribute to manifest link tag if provided","suites":["gatsby-plugin-manifest","CORS Generation"],"updatePoint":{"line":297,"column":69,"index":9721},"line":297,"code":"    it(`Adds a crossOrigin attribute to manifest link tag if provided`, () => {\n      onRenderBody(ssrArgs, {\n        crossOrigin: `use-credentials`,\n        legacy: false,\n        include_favicon: false,\n        cache_busting_mode: `none`\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Add crossOrigin when 'crossOrigin' is anonymous","suites":["gatsby-plugin-manifest","CORS Generation"],"updatePoint":{"line":306,"column":55,"index":10013},"line":306,"code":"    it(`Add crossOrigin when 'crossOrigin' is anonymous`, () => {\n      onRenderBody(ssrArgs, {\n        icon: defaultIcon,\n        crossOrigin: `anonymous`,\n        legacy: false,\n        include_favicon: false,\n        cache_busting_mode: `none`\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"Does not add crossOrigin when 'crossOrigin' is blank","suites":["gatsby-plugin-manifest","CORS Generation"],"updatePoint":{"line":316,"column":60,"index":10331},"line":316,"code":"    it(`Does not add crossOrigin when 'crossOrigin' is blank`, () => {\n      onRenderBody(ssrArgs, {\n        icon: defaultIcon,\n        legacy: false,\n        include_favicon: false,\n        cache_busting_mode: `none`\n      });\n      expect(headComponents).toMatchSnapshot();\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"returns true if image exists on filesystem","suites":["gatsby-plugin-manifest","doesIconExist"],"updatePoint":{"line":7,"column":50,"index":216},"line":7,"code":"    it(`returns true if image exists on filesystem`, () => {\n      const iconSrc = path.resolve(__dirname, `./images/gatsby-logo.png`);\n      expect(doesIconExist(iconSrc)).toBeTruthy();\n    });","file":"node-helpers.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"returns false if image does not exist on filesystem","suites":["gatsby-plugin-manifest","doesIconExist"],"updatePoint":{"line":11,"column":59,"index":420},"line":11,"code":"    it(`returns false if image does not exist on filesystem`, () => {\n      const iconSrc = path.resolve(__dirname, `./images/non-existent-logo.png`);\n      expect(doesIconExist(iconSrc)).toBeFalsy();\n    });","file":"node-helpers.js","skipped":false,"dir":"packages/gatsby-plugin-manifest/src/__tests__"},{"name":"calls NProgress.configure with the correct styles","suites":["gatsby-plugin-nprogress","onClientEntry"],"updatePoint":{"line":9,"column":57,"index":342},"line":9,"code":"    it(`calls NProgress.configure with the correct styles`, () => {\n      const element = {};\n      const createElement = jest.spyOn(document, `createElement`);\n      const appendChild = jest.spyOn(document.head, `appendChild`);\n      createElement.mockReturnValue(element);\n      appendChild.mockReturnValue(true);\n      NProgress.configure = jest.fn();\n      onClientEntry(null, {\n        showSpinner: false\n      });\n      expect(element.id).toEqual(`nprogress-styles`);\n      expect(element.innerHTML).toMatchSnapshot();\n      expect(NProgress.configure).toHaveBeenCalledWith({\n        color: `#29d`,\n        showSpinner: false\n      });\n    });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-nprogress/src/__tests__"},{"name":"calls NProgress.start","suites":["gatsby-plugin-nprogress","onRouteUpdateDelayed"],"updatePoint":{"line":28,"column":29,"index":1013},"line":28,"code":"    it(`calls NProgress.start`, () => {\n      NProgress.start = jest.fn();\n      onRouteUpdateDelayed();\n      expect(NProgress.start).toHaveBeenCalledTimes(1);\n    });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-nprogress/src/__tests__"},{"name":"calls NProgress.done","suites":["gatsby-plugin-nprogress","onRouteUpdate"],"updatePoint":{"line":35,"column":28,"index":1223},"line":35,"code":"    it(`calls NProgress.done`, () => {\n      NProgress.done = jest.fn();\n      onRouteUpdate();\n      expect(NProgress.done).toHaveBeenCalledTimes(1);\n    });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-nprogress/src/__tests__"},{"name":"does not add prefetch for preconnect/prefetch/prerender","suites":[],"updatePoint":{"line":8,"column":59,"index":162},"line":8,"code":"it(`does not add prefetch for preconnect/prefetch/prerender`, () => {\n  const addHeadElement = (tagName, attributes) => {\n    const el = document.createElement(tagName);\n    for (const key in attributes) {\n      el.setAttribute(key, attributes[key]);\n    }\n    document.head.appendChild(el);\n    return el;\n  };\n\n  // Should not be prefetched\n  addHeadElement(`link`, {\n    rel: `preconnect`,\n    href: `https://gatsbyjs.com`\n  });\n  addHeadElement(`link`, {\n    rel: `prefetch`,\n    href: `https://gatsbyjs.com`\n  });\n  addHeadElement(`link`, {\n    rel: `prerender`,\n    href: `https://gatsbyjs.com`\n  });\n  addHeadElement(`script`, {\n    src: `https://gats.by/script.js`\n  });\n  addHeadElement(`style`, {\n    \"data-href\": `https://gats.by/lazy.css`\n  });\n  addHeadElement(`link`, {\n    rel: `stylesheet`,\n    href: `https://gats.by/style.css`\n  });\n  addHeadElement(`link`, {\n    rel: `preconnect dns-prefetch`,\n    href: `https://www.google-analytics.com`\n  });\n  onServiceWorkerActive({\n    getResourceURLsForPathname: () => [],\n    serviceWorker: {\n      active: {}\n    }\n  });\n\n  // First five link elements should be the actual resources added above\n  // The remaining link elements should be the one added by gatsby-browser as prefetch\n  const links = [].slice.call(document.querySelectorAll(`head > link`));\n\n  // Should add prefetch for stylesheets, scripts and lazy-loaded styles\n  expect(links[5].href).toBe(`https://gats.by/script.js`);\n  expect(links[5].rel).toBe(`prefetch`);\n  expect(links[6].href).toBe(`https://gats.by/lazy.css`);\n  expect(links[6].rel).toBe(`prefetch`);\n  expect(links[7].href).toBe(`https://gats.by/style.css`);\n  expect(links[7].rel).toBe(`prefetch`);\n});","file":"gatsby-browser.test.js","skipped":false,"dir":"packages/gatsby-plugin-offline/src/__tests__"},{"name":"will create a basic query from the route","suites":["collectionExtractQueryString"],"updatePoint":{"line":25,"column":46},"line":25,"code":"  it(`will create a basic query from the route`, async () => {\n    // @ts-ignore\n    patchReadFileSync(`\n      import { graphql } from \"gatsby\"\n      export const pageQuery = graphql\\`\n        { allThings(filter: { name: { nin: [\"stuff\"] }}) { nodes, id } }\n      \\`\n      `)\n\n    const query = await collectionExtractQueryString(\n      createPath(`src/pages/{Product.name}`),\n      reporter\n    )\n\n    expect(query).toMatchInlineSnapshot(\n      `\"{allProduct{nodes{name,id,internal{contentFilePath}}}}\"`\n    )\n  })","file":"collection-extract-query-string.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"will create a basic query from the route with minimal length","suites":["collectionExtractQueryString"],"updatePoint":{"line":44,"column":66},"line":44,"code":"  it(`will create a basic query from the route with minimal length`, async () => {\n    // @ts-ignore\n    patchReadFileSync(`\n      import { graphql } from \"gatsby\"\n      export const pageQuery = graphql\\`\n        { allThings(filter: { name: { nin: [\"stuff\"] }}) { nodes, id } }\n      \\`\n      `)\n\n    const query = await collectionExtractQueryString(\n      createPath(`src/pages/{P.n}`),\n      reporter\n    )\n\n    expect(query).toMatchInlineSnapshot(\n      `\"{allP{nodes{n,id,internal{contentFilePath}}}}\"`\n    )\n  })","file":"collection-extract-query-string.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"will create a basic query from the route with a prefix variant 1","suites":["collectionExtractQueryString"],"updatePoint":{"line":63,"column":70},"line":63,"code":"  it(`will create a basic query from the route with a prefix variant 1`, async () => {\n    // @ts-ignore\n    patchReadFileSync(`\n      import { graphql } from \"gatsby\"\n      export const pageQuery = graphql\\`\n        { allThings(filter: { name: { nin: [\"stuff\"] }}) { nodes, id } }\n      \\`\n      `)\n\n    const query = await collectionExtractQueryString(\n      createPath(`src/pages/prefix-{Product.name}`),\n      reporter\n    )\n\n    expect(query).toMatchInlineSnapshot(\n      `\"{allProduct{nodes{name,id,internal{contentFilePath}}}}\"`\n    )\n  })","file":"collection-extract-query-string.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"will create a basic query from the route with a prefix variant 2","suites":["collectionExtractQueryString"],"updatePoint":{"line":82,"column":70},"line":82,"code":"  it(`will create a basic query from the route with a prefix variant 2`, async () => {\n    // @ts-ignore\n    patchReadFileSync(`\n      import { graphql } from \"gatsby\"\n      export const pageQuery = graphql\\`\n        { allThings(filter: { name: { nin: [\"stuff\"] }}) { nodes, id } }\n      \\`\n      `)\n\n    const query = await collectionExtractQueryString(\n      createPath(`src/pages/prefix_{Product.name}`),\n      reporter\n    )\n\n    expect(query).toMatchInlineSnapshot(\n      `\"{allProduct{nodes{name,id,internal{contentFilePath}}}}\"`\n    )\n  })","file":"collection-extract-query-string.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"will create a basic query from the route with a prefix variant 3","suites":["collectionExtractQueryString"],"updatePoint":{"line":101,"column":70},"line":101,"code":"  it(`will create a basic query from the route with a prefix variant 3`, async () => {\n    // @ts-ignore\n    patchReadFileSync(`\n      import { graphql } from \"gatsby\"\n      export const pageQuery = graphql\\`\n        { allThings(filter: { name: { nin: [\"stuff\"] }}) { nodes, id } }\n      \\`\n      `)\n\n    const query = await collectionExtractQueryString(\n      createPath(`src/pages/prefix{Product.name}`),\n      reporter\n    )\n\n    expect(query).toMatchInlineSnapshot(\n      `\"{allProduct{nodes{name,id,internal{contentFilePath}}}}\"`\n    )\n  })","file":"collection-extract-query-string.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"will create a basic query from the route with a postfix","suites":["collectionExtractQueryString"],"updatePoint":{"line":120,"column":61},"line":120,"code":"  it(`will create a basic query from the route with a postfix`, async () => {\n    // @ts-ignore\n    patchReadFileSync(`\n      import { graphql } from \"gatsby\"\n      export const pageQuery = graphql\\`\n        { allThings(filter: { name: { nin: [\"stuff\"] }}) { nodes, id } }\n      \\`\n      `)\n\n    const query = await collectionExtractQueryString(\n      createPath(`src/pages/{Product.name}postfix`),\n      reporter\n    )\n\n    expect(query).toMatchInlineSnapshot(\n      `\"{allProduct{nodes{name,id,internal{contentFilePath}}}}\"`\n    )\n  })","file":"collection-extract-query-string.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"will create a basic query with multiple entries","suites":["collectionExtractQueryString"],"updatePoint":{"line":139,"column":53},"line":139,"code":"  it(`will create a basic query with multiple entries`, async () => {\n    // @ts-ignore\n    patchReadFileSync(`\n      import { graphql } from \"gatsby\"\n      export const pageQuery = graphql\\`\n        { allThings(filter: { name: { nin: [\"stuff\"] }}) { nodes, id } }\n      \\`\n      `)\n\n    const query = await collectionExtractQueryString(\n      createPath(`src/pages/{Product.name}-{Product.color}`),\n      reporter\n    )\n\n    expect(query).toMatchInlineSnapshot(\n      `\"{allProduct{nodes{name,color,id,internal{contentFilePath}}}}\"`\n    )\n  })","file":"collection-extract-query-string.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"will create a basic query with multiple entries and different delimiters variant 1","suites":["collectionExtractQueryString"],"updatePoint":{"line":158,"column":88},"line":158,"code":"  it(`will create a basic query with multiple entries and different delimiters variant 1`, async () => {\n    // @ts-ignore\n    patchReadFileSync(`\n      import { graphql } from \"gatsby\"\n      export const pageQuery = graphql\\`\n        { allThings(filter: { name: { nin: [\"stuff\"] }}) { nodes, id } }\n      \\`\n      `)\n\n    const query = await collectionExtractQueryString(\n      createPath(`src/pages/{Product.name}_{Product.color}`),\n      reporter\n    )\n\n    expect(query).toMatchInlineSnapshot(\n      `\"{allProduct{nodes{name,color,id,internal{contentFilePath}}}}\"`\n    )\n  })","file":"collection-extract-query-string.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"will create a basic query with multiple entries and different delimiters variant 1","suites":["collectionExtractQueryString"],"updatePoint":{"line":177,"column":88},"line":177,"code":"  it(`will create a basic query with multiple entries and different delimiters variant 1`, async () => {\n    // @ts-ignore\n    patchReadFileSync(`\n      import { graphql } from \"gatsby\"\n      export const pageQuery = graphql\\`\n        { allThings(filter: { name: { nin: [\"stuff\"] }}) { nodes, id } }\n      \\`\n      `)\n\n    const query = await collectionExtractQueryString(\n      createPath(`src/pages/{Product.name}.{Product.color}`),\n      reporter\n    )\n\n    expect(query).toMatchInlineSnapshot(\n      `\"{allProduct{nodes{name,color,id,internal{contentFilePath}}}}\"`\n    )\n  })","file":"collection-extract-query-string.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"will create a basic query with multiple entries and different delimiters variant 1","suites":["collectionExtractQueryString"],"updatePoint":{"line":196,"column":88},"line":196,"code":"  it(`will create a basic query with multiple entries and different delimiters variant 1`, async () => {\n    // @ts-ignore\n    patchReadFileSync(`\n      import { graphql } from \"gatsby\"\n      export const pageQuery = graphql\\`\n        { allThings(filter: { name: { nin: [\"stuff\"] }}) { nodes, id } }\n      \\`\n      `)\n\n    const query = await collectionExtractQueryString(\n      createPath(`src/pages/{Product.name}__{Product.color}`),\n      reporter\n    )\n\n    expect(query).toMatchInlineSnapshot(\n      `\"{allProduct{nodes{name,color,id,internal{contentFilePath}}}}\"`\n    )\n  })","file":"collection-extract-query-string.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"has basic support","suites":["derive-path"],"updatePoint":{"line":5,"column":23},"line":5,"code":"  it(`has basic support`, async () => {\n    const { derivedPath: one } = await derivePath(\n      `product/{Product.id}`,\n      { id: `1` },\n      reporter\n    )\n    expect(one).toEqual(`product/1`)\n    const { derivedPath: two } = await derivePath(\n      `product/{product.id}`,\n      { id: `2` },\n      reporter\n    )\n    expect(two).toEqual(`product/2`)\n    const { derivedPath: three } = await derivePath(\n      `product/{p.d}`,\n      { d: `3` },\n      reporter\n    )\n    expect(three).toEqual(`product/3`)\n    const { derivedPath: four } = await derivePath(\n      `product/{p123_foo.d123_a}`,\n      { d123_a: `4` },\n      reporter\n    )\n    expect(four).toEqual(`product/4`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"converts number to string in URL","suites":["derive-path"],"updatePoint":{"line":32,"column":38},"line":32,"code":"  it(`converts number to string in URL`, async () => {\n    const { derivedPath } = await derivePath(\n      `product/{Product.id}`,\n      { id: 1 },\n      reporter\n    )\n    expect(derivedPath).toEqual(`product/1`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"has nested value support","suites":["derive-path"],"updatePoint":{"line":41,"column":30},"line":41,"code":"  it(`has nested value support`, async () => {\n    const { derivedPath } = await derivePath(\n      `product/{Product.field__id}`,\n      { field: { id: `1` } },\n      reporter\n    )\n    expect(derivedPath).toEqual(`product/1`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"has support for nested collections","suites":["derive-path"],"updatePoint":{"line":50,"column":40},"line":50,"code":"  it(`has support for nested collections`, async () => {\n    const { derivedPath: one } = await derivePath(\n      `product/{Product.id}/{Product.field__name}`,\n      { id: 1, field: { name: `foo` } },\n      reporter\n    )\n    expect(one).toEqual(`product/1/foo`)\n    const { derivedPath: two } = await derivePath(\n      `product/{Product.id}-{Product.field__name}`,\n      { id: 2, field: { name: `foo` } },\n      reporter\n    )\n    expect(two).toEqual(`product/2-foo`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"has support for nested collections with same field","suites":["derive-path"],"updatePoint":{"line":65,"column":56},"line":65,"code":"  it(`has support for nested collections with same field`, async () => {\n    const { derivedPath: one } = await derivePath(\n      `product/{Product.field__name}/{Product.field__category}`,\n      { field: { name: `foo`, category: `bar` } },\n      reporter\n    )\n    expect(one).toEqual(`product/foo/bar`)\n    const { derivedPath: two } = await derivePath(\n      `product/{Product.field__name}-{Product.field__category}`,\n      { field: { name: `foo`, category: `bar` } },\n      reporter\n    )\n    expect(two).toEqual(`product/foo-bar`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"has union support","suites":["derive-path"],"updatePoint":{"line":80,"column":23},"line":80,"code":"  it(`has union support`, async () => {\n    const { derivedPath: one } = await derivePath(\n      `product/{Product.field__(File)__id}`,\n      {\n        field: { id: `1` },\n      },\n      reporter\n    )\n    expect(one).toEqual(`product/1`)\n    const { derivedPath: two } = await derivePath(\n      `product/{Product.field__(File)__id}-{Product.field__(File)__foo}`,\n      {\n        field: { id: `2`, foo: `123` },\n      },\n      reporter\n    )\n    expect(two).toEqual(`product/2-123`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"doesnt remove '/' from slug","suites":["derive-path"],"updatePoint":{"line":99,"column":33},"line":99,"code":"  it(`doesnt remove '/' from slug`, async () => {\n    const { derivedPath } = await derivePath(\n      `product/{Product.slug}`,\n      {\n        slug: `bar/baz`,\n      },\n      reporter\n    )\n    expect(derivedPath).toEqual(`product/bar/baz`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"slugify's periods properly","suites":["derive-path"],"updatePoint":{"line":110,"column":32},"line":110,"code":"  it(`slugify's periods properly`, async () => {\n    const { derivedPath: one } = await derivePath(\n      `film/{Movie.title}`,\n      {\n        title: `Mrs. Doubtfire`,\n      },\n      reporter\n    )\n    expect(one).toEqual(`film/mrs-doubtfire`)\n    const { derivedPath: two } = await derivePath(\n      `film/{Movie.title}-{Movie.actor}`,\n      {\n        title: `Mrs. Doubtfire`,\n        actor: `Mr. Gatsby`,\n      },\n      reporter\n    )\n    expect(two).toEqual(`film/mrs-doubtfire-mr-gatsby`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"supports prefixes","suites":["derive-path"],"updatePoint":{"line":130,"column":23},"line":130,"code":"  it(`supports prefixes`, async () => {\n    const { derivedPath } = await derivePath(\n      `foo/prefix-{Model.name}`,\n      {\n        name: `dolores`,\n      },\n      reporter\n    )\n    expect(derivedPath).toEqual(`foo/prefix-dolores`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"supports prefixes with nested collections","suites":["derive-path"],"updatePoint":{"line":141,"column":47},"line":141,"code":"  it(`supports prefixes with nested collections`, async () => {\n    const { derivedPath } = await derivePath(\n      `foo/prefix{Model.name}/another-prefix_{Model.trait}`,\n      {\n        name: `dolores`,\n        trait: `awesome`,\n      },\n      reporter\n    )\n    expect(derivedPath).toEqual(`foo/prefixdolores/another-prefix_awesome`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"supports postfixes","suites":["derive-path"],"updatePoint":{"line":153,"column":24},"line":153,"code":"  it(`supports postfixes`, async () => {\n    const { derivedPath } = await derivePath(\n      `foo/{Model.name}-postfix`,\n      {\n        name: `dolores`,\n      },\n      reporter\n    )\n    expect(derivedPath).toEqual(`foo/dolores-postfix`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"supports postfixes with nested collections","suites":["derive-path"],"updatePoint":{"line":164,"column":48},"line":164,"code":"  it(`supports postfixes with nested collections`, async () => {\n    const { derivedPath } = await derivePath(\n      `foo/{Model.name}postfix/{Model.trait}_another-postfix`,\n      {\n        name: `dolores`,\n        trait: `awesome`,\n      },\n      reporter\n    )\n    expect(derivedPath).toEqual(`foo/dolorespostfix/awesome_another-postfix`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"supports nesting, characters in between, weird slugs, unions all in one","suites":["derive-path"],"updatePoint":{"line":176,"column":77},"line":176,"code":"  it(`supports nesting, characters in between, weird slugs, unions all in one`, async () => {\n    const { derivedPath } = await derivePath(\n      `blog/prefix-{M.name}.middle.{M.field__(Union)__color}_postfix/{M.director}--{M.s}`,\n      {\n        name: `Mr. Gatsby`,\n        director: `doug_judy`,\n        field: { color: `purple` },\n        s: `/magic/wonderful`,\n      },\n      reporter\n    )\n    expect(derivedPath).toEqual(\n      `blog/prefix-mr-gatsby.middle.purple_postfix/doug-judy--/magic/wonderful`\n    )\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"keeps existing slashes around and handles possible double forward slashes","suites":["derive-path"],"updatePoint":{"line":192,"column":79},"line":192,"code":"  it(`keeps existing slashes around and handles possible double forward slashes`, async () => {\n    // This tests two things\n    // 1) There shouldn't be a double forward slash in the final URL => blog//fire-and-powder/\n    // 2) If the slug is supposed to be a URL (e.g. foo/bar) it should keep that\n    const { derivedPath: one } = await derivePath(\n      `blog/{MarkdownRemark.fields__slug}`,\n      {\n        fields: {\n          slug: `/fire-and-powder/`,\n        },\n      },\n      reporter\n    )\n    expect(one).toEqual(`blog/fire-and-powder/`)\n    const { derivedPath: two } = await derivePath(\n      `blog/{MarkdownRemark.fields__slug}`,\n      {\n        fields: {\n          slug: `/fire-and-powder/and-water`,\n        },\n      },\n      reporter\n    )\n    expect(two).toEqual(`blog/fire-and-powder/and-water`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"supports file extension","suites":["derive-path"],"updatePoint":{"line":218,"column":29},"line":218,"code":"  it(`supports file extension`, async () => {\n    const { derivedPath } = await derivePath(\n      `foo/{Model.name}.js`,\n      {\n        name: `dolores`,\n      },\n      reporter\n    )\n    expect(derivedPath).toEqual(`foo/dolores`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"supports file extension with existing slashes around","suites":["derive-path"],"updatePoint":{"line":229,"column":58},"line":229,"code":"  it(`supports file extension with existing slashes around`, async () => {\n    const { derivedPath: one } = await derivePath(\n      `foo/{Model.name}.js`,\n      {\n        name: `/dolores/`,\n      },\n      reporter\n    )\n    expect(one).toEqual(`foo/dolores/`)\n    const { derivedPath: two } = await derivePath(\n      `foo/{Model.name}/template.js`,\n      {\n        name: `/dolores/`,\n      },\n      reporter\n    )\n    expect(two).toEqual(`foo/dolores/template`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"supports mixed collection and client-only route","suites":["derive-path"],"updatePoint":{"line":248,"column":53},"line":248,"code":"  it(`supports mixed collection and client-only route`, async () => {\n    const { derivedPath: one } = await derivePath(\n      `foo/{Model.name}/[...name]`,\n      {\n        name: `dolores`,\n      },\n      reporter\n    )\n    expect(one).toEqual(`foo/dolores/[...name]`)\n    const { derivedPath: two } = await derivePath(\n      `{Model.name}/[...name]`,\n      {\n        name: `dolores`,\n      },\n      reporter\n    )\n    expect(two).toEqual(`dolores/[...name]`)\n    const { derivedPath: three } = await derivePath(\n      `{Model.name}/[name]`,\n      {\n        name: `dolores`,\n      },\n      reporter\n    )\n    expect(three).toEqual(`dolores/[name]`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"supports index paths","suites":["derive-path"],"updatePoint":{"line":275,"column":26},"line":275,"code":"  it(`supports index paths`, async () => {\n    const { derivedPath: one } = await derivePath(\n      `{Page.path}`,\n      {\n        path: `/`,\n      },\n      reporter\n    )\n    expect(one).toEqual(`index`)\n    const { derivedPath: two } = await derivePath(\n      `{Page.path}.js`,\n      {\n        path: `/`,\n      },\n      reporter\n    )\n    expect(two).toEqual(`index`)\n    const { derivedPath: three } = await derivePath(\n      `foo/{Page.path}`,\n      {\n        path: `/`,\n      },\n      reporter\n    )\n    expect(three).toEqual(`foo/`)\n    const { derivedPath: four } = await derivePath(\n      `foo/{Page.path}/bar`,\n      {\n        path: `/`,\n      },\n      reporter\n    )\n    expect(four).toEqual(`foo/bar`)\n    const { derivedPath: five } = await derivePath(\n      `foo/{Page.path}/bar/`,\n      {\n        path: `/`,\n      },\n      reporter\n    )\n    expect(five).toEqual(`foo/bar/`)\n    const { derivedPath: six } = await derivePath(\n      `foo/{Page.pathOne}/{Page.pathTwo}`,\n      {\n        pathOne: `/`,\n        pathTwo: `bar`,\n      },\n      reporter\n    )\n    expect(six).toEqual(`foo/bar`)\n    const { derivedPath: seven } = await derivePath(\n      `foo/{Page.pathOne}/{Page.pathTwo}`,\n      {\n        pathOne: `/`,\n        pathTwo: `/bar`,\n      },\n      reporter\n    )\n    expect(seven).toEqual(`foo/bar`)\n    const { derivedPath: eight } = await derivePath(\n      `foo/{Page.pathOne}/{Page.pathTwo}`,\n      {\n        pathOne: `/`,\n        pathTwo: `/bar/`,\n      },\n      reporter\n    )\n    expect(eight).toEqual(`foo/bar/`)\n    const { derivedPath: nine } = await derivePath(\n      `foo/{Page.path}/[...name]`,\n      {\n        path: `/`,\n      },\n      reporter\n    )\n    expect(nine).toEqual(`foo/[...name]`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"handles special chars","suites":["derive-path"],"updatePoint":{"line":353,"column":27},"line":353,"code":"  it(`handles special chars`, async () => {\n    const { derivedPath: one } = await derivePath(\n      `foo/{Model.name}`,\n      {\n        name: `I  Dogs`,\n      },\n      reporter\n    )\n    expect(one).toEqual(`foo/i-love-dogs`)\n    const { derivedPath: two } = await derivePath(\n      `foo/{Model.name}`,\n      {\n        name: `  Dj Vu!  `,\n      },\n      reporter\n    )\n    expect(two).toEqual(`foo/deja-vu`)\n    const { derivedPath: three } = await derivePath(\n      `foo/{Model.name}`,\n      {\n        name: `fooBar 123 $#%`,\n      },\n      reporter\n    )\n    expect(three).toEqual(`foo/foo-bar-123`)\n    const { derivedPath: four } = await derivePath(\n      `foo/{Model.name}`,\n      {\n        name: `  `,\n      },\n      reporter\n    )\n    expect(four).toEqual(`foo/ya-lyublyu-edinorogov`)\n    const { derivedPath: five } = await derivePath(\n      `foo/{Model.name}`,\n      {\n        name: `Mnchner Weiwrstchen`,\n      },\n      reporter\n    )\n    expect(five).toEqual(`foo/muenchner-weisswuerstchen`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"supports custom slugify options","suites":["derive-path"],"updatePoint":{"line":396,"column":37},"line":396,"code":"  it(`supports custom slugify options`, async () => {\n    const { derivedPath: one } = await derivePath(\n      `foo/{Model.name}`,\n      {\n        name: `BAR and baz`,\n      },\n      reporter,\n      { separator: `_` }\n    )\n    expect(one).toEqual(`foo/bar_and_baz`)\n    const { derivedPath: two } = await derivePath(\n      `foo/{Model.name}`,\n      {\n        name: `Dj Vu!`,\n      },\n      reporter,\n      { lowercase: false }\n    )\n    expect(two).toEqual(`foo/Deja-Vu`)\n    const { derivedPath: three } = await derivePath(\n      `foo/{Model.name}`,\n      {\n        name: `fooBar`,\n      },\n      reporter,\n      { decamelize: false }\n    )\n    expect(three).toEqual(`foo/foobar`)\n    const { derivedPath: four } = await derivePath(\n      `foo/{Model.name}`,\n      {\n        name: `this-is`,\n      },\n      reporter,\n      { customReplacements: [[`this-is`, `the-way`]] }\n    )\n    expect(four).toEqual(`foo/the-way`)\n    const { derivedPath: five } = await derivePath(\n      `foo/{Model.name}`,\n      {\n        name: `_foo_bar`,\n      },\n      reporter,\n      { preserveLeadingUnderscore: true }\n    )\n    expect(five).toEqual(`foo/_foo-bar`)\n  })","file":"derive-path.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"basic example","suites":["extract query","root query string"],"updatePoint":{"line":12,"column":21},"line":12,"code":"    it(`basic example`, () => {\n      expect(\n        generateQueryFromString(\n          `Thing`,\n          compatiblePath(`/foo/bar/{Thing.id}.js`)\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allThing{nodes{id,internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"handles lowercased model name","suites":["extract query","root query string"],"updatePoint":{"line":23,"column":37},"line":23,"code":"    it(`handles lowercased model name`, () => {\n      expect(\n        generateQueryFromString(\n          `contentfulType`,\n          compatiblePath(`/foo/{contentfulType.id}.js`)\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allContentfulType{nodes{id,internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"handles model name with underscore","suites":["extract query","root query string"],"updatePoint":{"line":34,"column":42},"line":34,"code":"    it(`handles model name with underscore`, () => {\n      expect(\n        generateQueryFromString(\n          `_customType`,\n          compatiblePath(`/foo/{_customType.id}.js`)\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allCustomType{nodes{id,internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"handles model name with number","suites":["extract query","root query string"],"updatePoint":{"line":45,"column":38},"line":45,"code":"    it(`handles model name with number`, () => {\n      expect(\n        generateQueryFromString(\n          `Type123`,\n          compatiblePath(`/foo/{Type123.id}.js`)\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allType123{nodes{id,internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"handles fields with number or underscore","suites":["extract query","root query string"],"updatePoint":{"line":56,"column":48},"line":56,"code":"    it(`handles fields with number or underscore`, () => {\n      expect(\n        generateQueryFromString(\n          `_type123`,\n          compatiblePath(`/foo/{_type123.field123}.js`)\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allType123{nodes{field123,id,internal{contentFilePath}}}}\"`\n      )\n      expect(\n        generateQueryFromString(\n          `_type123`,\n          compatiblePath(`/foo/{_type123._field123}.js`)\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allType123{nodes{_field123,id,internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"works with different file extensions","suites":["extract query","root query string"],"updatePoint":{"line":75,"column":44},"line":75,"code":"    it(`works with different file extensions`, () => {\n      expect(\n        generateQueryFromString(\n          `Thing`,\n          compatiblePath(`/foo/bar/{Thing.id}.tsx`)\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allThing{nodes{id,internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"basic example","suites":["extract query","filepath resolution"],"updatePoint":{"line":88,"column":21},"line":88,"code":"    it(`basic example`, () => {\n      expect(\n        generateQueryFromString(\n          `Thing`,\n          compatiblePath(`/foo/bar/{Thing.id}.js`)\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allThing{nodes{id,internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"always queries id","suites":["extract query","filepath resolution"],"updatePoint":{"line":99,"column":25},"line":99,"code":"    it(`always queries id`, () => {\n      expect(\n        generateQueryFromString(\n          `Thing`,\n          compatiblePath(`/foo/bar/{Thing.baz}.js`)\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allThing{nodes{baz,id,internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"multiple nodes","suites":["extract query","filepath resolution"],"updatePoint":{"line":110,"column":22},"line":110,"code":"    it(`multiple nodes`, () => {\n      expect(\n        generateQueryFromString(\n          `Thing`,\n          compatiblePath(`/foo/bar/{Thing.id}/{Thing.name}.js`)\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allThing{nodes{id,name,internal{contentFilePath}}}}\"`\n      )\n      expect(\n        generateQueryFromString(\n          `Thing`,\n          compatiblePath(`/foo/bar/{Thing.id}-{Thing.name}.js`)\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allThing{nodes{id,name,internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"nested nodes","suites":["extract query","filepath resolution"],"updatePoint":{"line":129,"column":20},"line":129,"code":"    it(`nested nodes`, () => {\n      expect(\n        generateQueryFromString(\n          `Thing`,\n          compatiblePath(`/foo/bar/{Thing.id}/{Thing.fields__name}.js`)\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allThing{nodes{id,fields{name},internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"multiple nested nodes","suites":["extract query","filepath resolution"],"updatePoint":{"line":140,"column":29},"line":140,"code":"    it(`multiple nested nodes`, () => {\n      expect(\n        generateQueryFromString(\n          `thing`,\n          compatiblePath(\n            `/foo/bar/{thing.fields__name}/{thing.fields__description}.js`\n          )\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allThing{nodes{fields{name},fields{description},id,internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"deeply nested nodes","suites":["extract query","filepath resolution"],"updatePoint":{"line":153,"column":27},"line":153,"code":"    it(`deeply nested nodes`, () => {\n      expect(\n        generateQueryFromString(\n          `Thing`,\n          compatiblePath(`/foo/bar/{Thing.id}/{Thing.fields__name__thing}.js`)\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allThing{nodes{id,fields{name{thing}},internal{contentFilePath}}}}\"`\n      )\n      expect(\n        generateQueryFromString(\n          `customType`,\n          compatiblePath(\n            `/foo/bar/{customType.id}/{customType.fields__name__thing}.js`\n          )\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allCustomType{nodes{id,fields{name{thing}},internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"deeply nested nodes with prefixes","suites":["extract query","filepath resolution"],"updatePoint":{"line":174,"column":41},"line":174,"code":"    it(`deeply nested nodes with prefixes`, () => {\n      expect(\n        generateQueryFromString(\n          `Thing`,\n          compatiblePath(\n            `/foo/bar/prefix-{Thing.id}/another-prefix_{Thing.fields__name__thing}.js`\n          )\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allThing{nodes{id,fields{name{thing}},internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"deeply nested nodes with postfixes","suites":["extract query","filepath resolution"],"updatePoint":{"line":187,"column":42},"line":187,"code":"    it(`deeply nested nodes with postfixes`, () => {\n      expect(\n        generateQueryFromString(\n          `Thing`,\n          compatiblePath(\n            `/foo/bar/{Thing.id}-postfix/{Thing.fields__name__thing}_another-postfix.js`\n          )\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allThing{nodes{id,fields{name{thing}},internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"supports graphql unions","suites":["extract query","filepath resolution"],"updatePoint":{"line":200,"column":31},"line":200,"code":"    it(`supports graphql unions`, () => {\n      expect(\n        generateQueryFromString(\n          `UnionQuery`,\n          compatiblePath(\n            `/foo/bar/{UnionQuery.id}/{UnionQuery.parent__(File)__relativePath}.js`\n          )\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allUnionQuery{nodes{id,parent{... on File{relativePath}},internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"supports nested graphql unions","suites":["extract query","filepath resolution"],"updatePoint":{"line":213,"column":38},"line":213,"code":"    it(`supports nested graphql unions`, () => {\n      expect(\n        generateQueryFromString(\n          `UnionQuery`,\n          compatiblePath(\n            `/foo/bar/{UnionQuery.id}/{UnionQuery.parent__(File)__parent__(Bar)__relativePath}.js`\n          )\n        )\n      ).toMatchInlineSnapshot(\n        `\"{allUnionQuery{nodes{id,parent{... on File{parent{... on Bar{relativePath}}}},internal{contentFilePath}}}}\"`\n      )\n    })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"supports limiting collection query to specified node ids if provided","suites":["extract query","filepath resolution"],"updatePoint":{"line":227,"column":74},"line":227,"code":"  it(`supports limiting collection query to specified node ids if provided`, () => {\n    expect(\n      generateQueryFromString(\n        `Thing`,\n        compatiblePath(`/foo/bar/{Thing.id}/{Thing.fields__name}.js`),\n        [`id-1`, `id-2`]\n      )\n    ).toMatchInlineSnapshot(\n      `\"{allThing(filter: { id: { in: [\\\\\"id-1\\\\\",\\\\\"id-2\\\\\"] } }){nodes{id,fields{name},internal{contentFilePath}}}}\"`\n    )\n  })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"handles single depth items","suites":["reverseLookupParams"],"updatePoint":{"line":241,"column":32},"line":241,"code":"  it(`handles single depth items`, () => {\n    expect(\n      reverseLookupParams(\n        { id: `foo`, otherProp: `bar` },\n        compatiblePath(`/{Model.id}.js`)\n      )\n    ).toEqual({\n      id: `foo`,\n    })\n    expect(\n      reverseLookupParams(\n        { id: `foo`, otherProp: `bar` },\n        compatiblePath(`/{model.id}.js`)\n      )\n    ).toEqual({\n      id: `foo`,\n    })\n  })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"handles multiple depth items","suites":["reverseLookupParams"],"updatePoint":{"line":260,"column":34},"line":260,"code":"  it(`handles multiple depth items`, () => {\n    expect(\n      reverseLookupParams(\n        { fields: { name: `foo` } },\n        compatiblePath(`/{Model.fields__name}.js`)\n      )\n    ).toEqual({\n      // eslint-disable-next-line @typescript-eslint/naming-convention\n      fields__name: `foo`,\n    })\n    expect(\n      reverseLookupParams(\n        { fields: { name: `foo` } },\n        compatiblePath(`/{_model.fields__name}.js`)\n      )\n    ).toEqual({\n      // eslint-disable-next-line @typescript-eslint/naming-convention\n      fields__name: `foo`,\n    })\n  })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"handles graphql unions","suites":["reverseLookupParams"],"updatePoint":{"line":281,"column":28},"line":281,"code":"  it(`handles graphql unions`, () => {\n    expect(\n      reverseLookupParams(\n        // Unions are not present in the resulting structure\n        { parent: { relativePath: `foo` } },\n        compatiblePath(`/{Model.parent__(File)__relativePath}.js`)\n      )\n    ).toEqual({\n      // eslint-disable-next-line @typescript-eslint/naming-convention\n      parent__relativePath: `foo`,\n    })\n    expect(\n      reverseLookupParams(\n        // Unions are not present in the resulting structure\n        { parent: { relativePath: `foo` } },\n        compatiblePath(`/{model123.parent__(File)__relativePath}.js`)\n      )\n    ).toEqual({\n      // eslint-disable-next-line @typescript-eslint/naming-convention\n      parent__relativePath: `foo`,\n    })\n  })","file":"extract-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"gets params out of middle of url","suites":["getCollectionRouteParams"],"updatePoint":{"line":4,"column":38},"line":4,"code":"  it(`gets params out of middle of url`, () => {\n    const filePath = `/products/{Product.id}/product.js`\n    const urlPath = `/products/1234/product`\n\n    expect(getCollectionRouteParams(filePath, urlPath).id).toEqual(`1234`)\n  })","file":"get-collection-route-params.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"gets multiple params out of url","suites":["getCollectionRouteParams"],"updatePoint":{"line":11,"column":37},"line":11,"code":"  it(`gets multiple params out of url`, () => {\n    const filePath = `/{Product.name}/{Product.id}.js`\n    const urlPath = `/burger/1234`\n\n    const params = getCollectionRouteParams(filePath, urlPath)\n\n    expect(params.id).toEqual(`1234`)\n    expect(params.name).toEqual(`burger`)\n  })","file":"get-collection-route-params.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"gets multiple params out of url in same part","suites":["getCollectionRouteParams"],"updatePoint":{"line":21,"column":50},"line":21,"code":"  it(`gets multiple params out of url in same part`, () => {\n    const filePath = `/{Product.name}-{Product.id}_{Product.desc}.{Product.number}.js`\n    const urlPath = `/burger-1234_foo.bar`\n\n    const params = getCollectionRouteParams(filePath, urlPath)\n\n    expect(params.id).toEqual(`1234`)\n    expect(params.name).toEqual(`burger`)\n    expect(params.desc).toEqual(`foo`)\n    expect(params.number).toEqual(`bar`)\n  })","file":"get-collection-route-params.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"gets multiple params out of url with prefixes","suites":["getCollectionRouteParams"],"updatePoint":{"line":33,"column":51},"line":33,"code":"  it(`gets multiple params out of url with prefixes`, () => {\n    const filePath = `/products/prefix-{Product.id}/another-prefix_{Product.name}/product.js`\n    const urlPath = `/products/prefix-1234/another-prefix_burger/product`\n\n    const params = getCollectionRouteParams(filePath, urlPath)\n\n    expect(params.id).toEqual(`1234`)\n    expect(params.name).toEqual(`burger`)\n  })","file":"get-collection-route-params.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"gets multiple params out of url with postfixes","suites":["getCollectionRouteParams"],"updatePoint":{"line":43,"column":52},"line":43,"code":"  it(`gets multiple params out of url with postfixes`, () => {\n    const filePath = `/products/{Product.id}-postfix/{Product.name}_another-postfix/product.js`\n    const urlPath = `/products/1234-postfix/burger_another-postfix/product`\n\n    const params = getCollectionRouteParams(filePath, urlPath)\n\n    expect(params.id).toEqual(`1234`)\n    expect(params.name).toEqual(`burger`)\n  })","file":"get-collection-route-params.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"outputs empty object for no matches","suites":["getCollectionRouteParams"],"updatePoint":{"line":53,"column":41},"line":53,"code":"  it(`outputs empty object for no matches`, () => {\n    const filePath = `/products/{Product.id}-test.js`\n    const urlPath = `/products/1234`\n\n    const params = getCollectionRouteParams(filePath, urlPath)\n\n    expect(params).toEqual({})\n  })","file":"get-collection-route-params.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"%o passes","suites":["isValidCollectionPathImplementation"],"line":18,"code":"  it.each([\n    `{Model.bar}/{Model.bar}.js`,\n    `{Model.bar__(Union)__field}.js`,\n    `{model.bar}.js`,\n    `{model.bar__field}.js`,\n    `{model.bar__(Union)__field}.js`,\n    `{_model123.bar}.js`,\n    `/products/{model.bar123}.js`,\n    `/products/{model.bar123}/{model.foo}.js`,\n    `/products/{model.bar123}/test/{model.foo}.js`,\n    `/products/{model.bar123}/{model.foo}/template.js`,\n    `{model.bar_123}.js`,\n    `{model.bar__field123}.js`,\n    `/products/{model.bar__(Union)__field123}.js`,\n    `/products/prefix-{Model.id}.js`,\n    `/products/prefix_{Model.id}.js`,\n    `/products/prefix{Model.id}.js`,\n    `/products/{Model.id}postfix.js`,\n    `/products/{Model.bar}/[name].js`,\n    `/products/{Model.bar}/[...name].js`,\n    `/products/{M.id}.js`,\n    `/products/{M.i}.js`,\n    `/products/{Model.id}-{Model.foo}.js`,\n    `/products/prefix-{Model.id}-{Model.foo}.js`,\n    `/products/{Model.id}-{Model.foo}-postfix.js`,\n    `/products/{Model.id}_{Model.foo}.js`,\n    `/products/{Model.id}.{Model.foo}.js`,\n  ])(`%o passes`, path => {\n    expect(() =>\n      isValidCollectionPathImplementation(compatiblePath(path), reporter)\n    ).not.toThrow()\n    const isValid = isValidCollectionPathImplementation(\n      compatiblePath(path),\n      reporter\n    )\n    expect(isValid).toBe(true)\n  })","file":"is-valid-collection-path-implementation.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"%o throws as expected","suites":["isValidCollectionPathImplementation"],"line":57,"code":"  it.each([\n    `/products/{bar}.js`,\n    `/products/{Model.}.js`,\n    `/products/{Model:bar}.js`,\n    `/products/{Model.bar.js`,\n    `/products/{Model_bar}.js`,\n    `/products/{123Model.bar}.js`,\n    `/products/{Model.123bar}.js`,\n    `/produts/Model}.js`,\n    `/products/{Model.js`,\n    `/products/{Model.foo.bar}.js`,\n    `/products/prefix-{Model.foo.bar}.js`,\n    `/products/prefix-{Model.foo.bar__baz}.js`,\n    `/products/prefix-{Model.foo.bar.baz}.js`,\n    `/{Model.test}/{Model.id.js`,\n    `/{Model.test}/Model.id}.js`,\n    `/products/{Model.id}-{Model.}.js`,\n    `/products/{Model.id}-{Model_foo}.js`,\n    `/products/{Model.id}-Model.id}.js`,\n    `/products/Model.id}-{Model.id}.js`,\n    `/products/Model.id}-Model.id}.js`,\n    `/products/{Model.id-{Model.id.js`,\n    `/products/{Model.id-Model.id.js`,\n    `/products/Model.id}-Model.id.js`,\n    `/products/Model.id-{Model.id.js`,\n    `/products/Model.id-Model.id}.js`,\n  ])(`%o throws as expected`, path => {\n    const part = path.split(`/`)[2]\n\n    const isValid = isValidCollectionPathImplementation(\n      compatiblePath(path),\n      reporter\n    )\n    expect(isValid).toBe(false)\n    expect(reporter.panicOnBuild).toBeCalledWith({\n      context: {\n        sourceMessage: `Collection page builder encountered an error parsing the filepath. To use collection paths the schema to follow is {Model.field__subfield}. The problematic part is: ${part}.`,\n      },\n      filePath: compatiblePath(path),\n      id: `gatsby-plugin-page-creator_12105`,\n    })\n  })","file":"is-valid-collection-path-implementation.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"%o throws as expected","suites":["isValidCollectionPathImplementation"],"line":101,"code":"  it.each([\n    `/Model.test}/{Model.id}.js`,\n    `/{Model.test/{Model.id}.js`,\n    `/{Model_test}/{Model.id}.js`,\n    `/{Model:test}/{Model.id}.js`,\n    `/{Model.}/{Model.id}.js`,\n    `/{123Model.test}/{Model.id}.js`,\n    `/{bar}/{Model.id}.js`,\n    `/{Model.123bar}/{Model.id}.js`,\n    `/Model}/{Model.id}.js`,\n    `/{Model./{Model.id}js`,\n    `/{Model.foo.bar}/{Model.id}.js`,\n    `/prefix-{Model.foo.bar}/{Model.id}.js`,\n    `/prefix-{Model.foo.bar__baz}/{Model.id}.js`,\n    `/prefix-{Model.foo.bar.baz}/{Model.id}.js`,\n  ])(`%o throws as expected`, path => {\n    const part = path.split(`/`)[1]\n\n    const isValid = isValidCollectionPathImplementation(\n      compatiblePath(path),\n      reporter\n    )\n    expect(isValid).toBe(false)\n    expect(reporter.panicOnBuild).toBeCalledWith({\n      context: {\n        sourceMessage: `Collection page builder encountered an error parsing the filepath. To use collection paths the schema to follow is {Model.field__subfield}. The problematic part is: ${part}.`,\n      },\n      filePath: compatiblePath(path),\n      id: `gatsby-plugin-page-creator_12105`,\n    })\n  })","file":"is-valid-collection-path-implementation.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"will find all and only the collection routes in a fixture","suites":["findCollectionPageFiles"],"updatePoint":{"line":5,"column":63},"line":5,"code":"  it(`will find all and only the collection routes in a fixture`, async () => {\n    expect(\n      await findCollectionPageFiles(\n        path.join(__dirname, `fixtures`, `page-utils`, `collection-routes`)\n      )\n    ).toMatchInlineSnapshot(`\n      Array [\n        \"{Other.extension}.js\",\n        \"{RootItem.name}.tsx\",\n        \"nested/{NestedItem.name}.tsx\",\n        \"nested/{NestedDirectoryOnlyItem}/edit.tsx\",\n        \"nested/{NestedDirectoryOnlyItem}/index.tsx\",\n      ]\n    `)\n  })","file":"path-utils.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"throws on missing starting /","suites":["validatePathQuery"],"updatePoint":{"line":6,"column":34},"line":6,"code":"  it(`throws on missing starting /`, () => {\n    expect(() => {\n      validatePathQuery(`foo/{bar}`, [])\n    }).toThrowErrorMatchingInlineSnapshot(`\n\"PageCreator: To query node \\\\\"gatsbyPath\\\\\" the \\\\\"filePath\\\\\" argument must be an absolute path, starting with a /\nPlease change this to: \\\\\"/foo/{bar}\\\\\"\"\n`)\n  })","file":"validate-path-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"throws error if you include the extension","suites":["validatePathQuery"],"updatePoint":{"line":15,"column":47},"line":15,"code":"  it(`throws error if you include the extension`, () => {\n    expect(() => {\n      validatePathQuery(`/foo/{bar}.js`, [])\n    }).toThrowErrorMatchingInlineSnapshot(`\n\"PageCreator: To query node \\\\\"gatsbyPath\\\\\" the \\\\\"filePath\\\\\" argument must omit the file extension\nPlease change /foo/{bar}.js to \\\\\"/foo/{bar}\\\\\"\"\n`)\n  })","file":"validate-path-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"throws error if you include src/pages","suites":["validatePathQuery"],"updatePoint":{"line":24,"column":43},"line":24,"code":"  it(`throws error if you include src/pages`, () => {\n    expect(() => {\n      validatePathQuery(`/src/pages/foo/{bar}`, [])\n    }).toThrowErrorMatchingInlineSnapshot(`\n\"PageCreator: To query node \\\\\"gatsbyPath\\\\\" the \\\\\"filePath\\\\\" argument must omit the src/pages prefix.\nPlease change this to: \\\\\"foo/{bar}\\\\\"\"\n`)\n  })","file":"validate-path-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"throws error if you include index","suites":["validatePathQuery"],"updatePoint":{"line":33,"column":39},"line":33,"code":"  it(`throws error if you include index`, () => {\n    expect(() => {\n      validatePathQuery(`/foo/{bar}/index`, [])\n    }).toThrowErrorMatchingInlineSnapshot(`\n\"PageCreator: To query node \\\\\"gatsbyPath\\\\\" the \\\\\"filePath\\\\\" argument must omit index.\nPlease change this to: \\\\\"/foo/{bar}/\\\\\"\"\n`)\n  })","file":"validate-path-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"throws error if the file does not exist","suites":["validatePathQuery"],"updatePoint":{"line":42,"column":45},"line":42,"code":"  it(`throws error if the file does not exist`, () => {\n    expect(() => {\n      validatePathQuery(`/foo/{bar}`, [`.js`, `.ts`, `.mjs`])\n    }).toThrowErrorMatchingInlineSnapshot(`\n\"PageCreator: To query node \\\\\"gatsbyPath\\\\\" the \\\\\"filePath\\\\\" argument must represent a file that exists.\nUnable to find a file at: \\\\\"<PROJECT_ROOT>/src/pages/foo/{bar}\\\\\"\"\n`)\n  })","file":"validate-path-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"works if all the above predicates pass","suites":["validatePathQuery"],"updatePoint":{"line":51,"column":44},"line":51,"code":"  it(`works if all the above predicates pass`, async () => {\n    const filePath = `/baz/{bar}`\n    const absolutePath = systemPath.join(\n      process.cwd(),\n      `src/pages`,\n      `${filePath}.js`\n    )\n    await fs.createFile(absolutePath)\n\n    expect(() => {\n      validatePathQuery(filePath, [`.js`, `.ts`, `.mjs`])\n    }).not.toThrow()\n\n    await fs.remove(systemPath.join(process.cwd(), `src/pages`))\n  })","file":"validate-path-query.ts","skipped":false,"dir":"packages/gatsby-plugin-page-creator/src/__tests__"},{"name":"Stage:  / ","suites":["gatsby-plugin-postcss"],"updatePoint":{"line":109,"column":36,"index":2838},"line":109,"code":"      it(`Stage: ${stage} / ${label}`, () => {\n        const getConfig = tests.configs[label];\n        const action = tests.actions[label];\n        onCreateWebpackConfig({\n          actions,\n          loaders,\n          stage,\n          getConfig\n        }, options);\n        expect(action).toMatchSnapshot();\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-postcss/src/__tests__"},{"name":"sets the correct webpack config in development","suites":["gatsby-plugin-preact"],"updatePoint":{"line":10,"column":52,"index":551},"line":10,"code":"  it(`sets the correct webpack config in development`, () => {\n    const getConfig = jest.fn(() => {\n      return {\n        entry: {\n          commons: []\n        },\n        plugins: [new ReactRefreshWebpackPlugin()]\n      };\n    });\n    const actions = {\n      setWebpackConfig: jest.fn(),\n      setBabelPlugin: jest.fn(),\n      replaceWebpackConfig: jest.fn()\n    };\n    onCreateBabelConfig({\n      stage: `develop`,\n      actions\n    });\n    onCreateBabelConfig({\n      stage: `develop-html`,\n      actions\n    });\n    onCreateWebpackConfig({\n      stage: `develop`,\n      actions,\n      getConfig\n    });\n    onCreateWebpackConfig({\n      stage: `develop-html`,\n      actions,\n      getConfig\n    });\n    expect(actions.setWebpackConfig).toHaveBeenCalledTimes(2);\n    expect(actions.setWebpackConfig).toHaveBeenCalledWith({\n      plugins: expect.arrayContaining([expect.any(PreactRefreshPlugin)]),\n      resolve: {\n        alias: {\n          react: `preact/compat`,\n          \"react-dom/test-utils\": `preact/test-utils`,\n          \"react-dom\": `preact/compat`,\n          \"react/jsx-runtime\": `preact/jsx-runtime`\n        }\n      }\n    });\n    expect(getConfig).toHaveBeenCalledTimes(2);\n    expect(actions.setBabelPlugin).toHaveBeenCalledTimes(1);\n    expect(actions.setBabelPlugin).toHaveBeenCalledWith({\n      name: `@prefresh/babel-plugin`,\n      stage: `develop`\n    });\n    expect(actions.replaceWebpackConfig).toHaveBeenCalledTimes(2);\n    expect(actions.replaceWebpackConfig).toHaveBeenCalledWith({\n      plugins: [],\n      entry: {\n        commons: [`@gatsbyjs/webpack-hot-middleware/client`]\n      }\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-preact/src/__tests__"},{"name":"sets the correct webpack config in production","suites":["gatsby-plugin-preact"],"updatePoint":{"line":68,"column":51,"index":2177},"line":68,"code":"  it(`sets the correct webpack config in production`, () => {\n    const getConfig = jest.fn(() => {\n      return {\n        optimization: {\n          splitChunks: {\n            chunks: `all`,\n            cacheGroups: {\n              default: false,\n              vendors: false,\n              framework: {\n                chunks: `all`,\n                name: `framework`,\n                // Mirrors what we have in gatsby/../webpack.config.js\n                test: module => {\n                  if (module?.rawRequest === `react-dom/server` || module?.rawRequest?.includes(`/react-dom-server`)) {\n                    return false;\n                  }\n                  return FRAMEWORK_BUNDLES_REGEX_GATSBY.test(module.nameForCondition());\n                },\n                priority: 40,\n                enforce: true\n              }\n            }\n          }\n        }\n      };\n    });\n    const actions = {\n      setWebpackConfig: jest.fn(),\n      setBabelPlugin: jest.fn(),\n      replaceWebpackConfig: jest.fn()\n    };\n    onCreateBabelConfig({\n      stage: `build-javascript`,\n      actions\n    });\n    onCreateBabelConfig({\n      stage: `build-html`,\n      actions\n    });\n    onCreateWebpackConfig({\n      stage: `build-javascript`,\n      actions,\n      getConfig\n    });\n    onCreateWebpackConfig({\n      stage: `build-html`,\n      actions,\n      getConfig\n    });\n    expect(actions.setWebpackConfig).toHaveBeenCalledTimes(2);\n    expect(actions.setWebpackConfig).toHaveBeenCalledWith({\n      plugins: [],\n      resolve: {\n        alias: {\n          react: `preact/compat`,\n          \"react-dom/test-utils\": `preact/test-utils`,\n          \"react-dom\": `preact/compat`,\n          \"react/jsx-runtime\": `preact/jsx-runtime`\n        }\n      }\n    });\n    expect(getConfig).toHaveBeenCalledTimes(2);\n    expect(actions.setBabelPlugin).toHaveBeenCalledTimes(0);\n    expect(actions.replaceWebpackConfig).toHaveBeenCalledTimes(2);\n    expect(actions.replaceWebpackConfig).toMatchInlineSnapshot(`\n      [MockFunction] {\n        \"calls\": Array [\n          Array [\n            Object {\n              \"optimization\": Object {\n                \"splitChunks\": Object {\n                  \"cacheGroups\": Object {\n                    \"default\": false,\n                    \"framework\": Object {\n                      \"chunks\": \"all\",\n                      \"enforce\": true,\n                      \"name\": \"framework\",\n                      \"priority\": 40,\n                      \"test\": /\\\\(\\\\?<!node_modules\\\\.\\\\*\\\\)\\\\[\\\\\\\\\\\\\\\\/\\\\]node_modules\\\\[\\\\\\\\\\\\\\\\/\\\\]\\\\(preact\\\\|react\\\\|react-dom\\\\|scheduler\\\\|prop-types\\\\)\\\\[\\\\\\\\\\\\\\\\/\\\\]/,\n                    },\n                    \"vendors\": false,\n                  },\n                  \"chunks\": \"all\",\n                },\n              },\n            },\n          ],\n          Array [\n            Object {\n              \"optimization\": Object {\n                \"splitChunks\": Object {\n                  \"cacheGroups\": Object {\n                    \"default\": false,\n                    \"framework\": Object {\n                      \"chunks\": \"all\",\n                      \"enforce\": true,\n                      \"name\": \"framework\",\n                      \"priority\": 40,\n                      \"test\": [Function],\n                    },\n                    \"vendors\": false,\n                  },\n                  \"chunks\": \"all\",\n                },\n              },\n            },\n          ],\n        ],\n        \"results\": Array [\n          Object {\n            \"type\": \"return\",\n            \"value\": undefined,\n          },\n          Object {\n            \"type\": \"return\",\n            \"value\": undefined,\n          },\n        ],\n      }\n    `);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-preact/src/__tests__"},{"name":"returns default cache on first run","suites":["cache"],"updatePoint":{"line":35,"column":40,"index":782},"line":35,"code":"  it(`returns default cache on first run`, () => {\n    expect(load()).toMatchObject(defaultCache);\n  });","file":"cache.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"loads cache from memory if its already been read from disk","suites":["cache"],"updatePoint":{"line":38,"column":64,"index":911},"line":38,"code":"  it(`loads cache from memory if its already been read from disk`, () => {\n    save({\n      from: `memory`\n    });\n    expect(load()).toMatchObject({\n      from: `memory`\n    });\n  });","file":"cache.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"returns default cache if reading from disk fails","suites":["cache"],"updatePoint":{"line":46,"column":54,"index":1086},"line":46,"code":"  it(`returns default cache if reading from disk fails`, () => {\n    readFileSync.mockImplementationOnce(() => {\n      throw new Error(`file doesn't exist`);\n    }).mockImplementationOnce(() => `malformed json`);\n    expect(load()).toMatchObject(defaultCache);\n    expect(load()).toMatchObject(defaultCache);\n  });","file":"cache.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"persists cache to disk","suites":["cache"],"updatePoint":{"line":53,"column":28,"index":1375},"line":53,"code":"  it(`persists cache to disk`, () => {\n    save({\n      some: `cache`\n    });\n    expect(writeFileSync).toHaveBeenCalledWith(join(`/project/root`, `font-preload-cache.json`), `{\"some\":\"cache\"}`, `utf-8`);\n  });","file":"cache.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"exits if writing to disk fails","suites":["cache"],"updatePoint":{"line":59,"column":36,"index":1594},"line":59,"code":"  it(`exits if writing to disk fails`, () => {\n    writeFileSync.mockImplementationOnce(() => {\n      throw new Error(`file not writable`);\n    });\n    save({\n      some: `cache`\n    });\n    expect(mockExit).toHaveBeenCalledWith(1);\n  });","file":"cache.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"doesn't throw when no routes are present","suites":["fetch-routes"],"updatePoint":{"line":28,"column":46,"index":655},"line":28,"code":"  it(`doesn't throw when no routes are present`, async () => {\n    expect.assertions(2);\n    request.mockImplementationOnce(() => {\n      return {\n        allSitePage: {\n          nodes: []\n        }\n      };\n    });\n    const routes = await fetchRoutes({\n      logger,\n      endpoint,\n      cache\n    });\n    expect(request).toHaveBeenCalled();\n    expect(routes).toEqual([]);\n  });","file":"fetch-routes.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"generates an array of routes","suites":["fetch-routes"],"updatePoint":{"line":45,"column":34,"index":1027},"line":45,"code":"  it(`generates an array of routes`, async () => {\n    expect.assertions(1);\n    request.mockImplementationOnce(() => {\n      return {\n        allSitePage: {\n          nodes: [{\n            path: `/foo`\n          }, {\n            path: `/bar`\n          }, {\n            path: `/baz`\n          }]\n        }\n      };\n    });\n    const routes = await fetchRoutes({\n      logger,\n      endpoint,\n      cache\n    });\n    expect(routes).toEqual([`/foo`, `/bar`, `/baz`]);\n  });","file":"fetch-routes.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"prompts the user when the list of routes has not changed since last run","suites":["fetch-routes"],"updatePoint":{"line":67,"column":77,"index":1542},"line":67,"code":"  it(`prompts the user when the list of routes has not changed since last run`, async () => {\n    expect.assertions(1);\n    request.mockImplementationOnce(() => {\n      return {\n        allSitePage: {\n          nodes: [{\n            path: `/foo`\n          }, {\n            path: `/bar`\n          }, {\n            path: `/baz`\n          }]\n        }\n      };\n    });\n    // don't crawl routes\n    logger.confirm.mockImplementationOnce(() => Promise.resolve(false));\n    createContentDigest.mockReturnValueOnce(cache.hash);\n    await expect(fetchRoutes({\n      logger,\n      endpoint,\n      cache\n    })).resolves.toEqual([]);\n  });","file":"fetch-routes.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"doesn't prompt the user when the list of routes has not changed since last run if run in CI","suites":["fetch-routes"],"updatePoint":{"line":91,"column":97,"index":2193},"line":91,"code":"  it(`doesn't prompt the user when the list of routes has not changed since last run if run in CI`, async () => {\n    expect.assertions(1);\n    request.mockImplementationOnce(() => {\n      return {\n        allSitePage: {\n          nodes: [{\n            path: `/foo`\n          }, {\n            path: `/bar`\n          }, {\n            path: `/baz`\n          }]\n        }\n      };\n    });\n    cache.hash = `09f5b092fb87d859e0ac53dbae299a9e`;\n    createContentDigest.mockReturnValueOnce(cache.hash);\n    isCI.mockReturnValueOnce(true);\n    await expect(fetchRoutes({\n      logger,\n      endpoint,\n      cache\n    })).resolves.toEqual([]);\n  });","file":"fetch-routes.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"does nothing if the pathname has no cached assets","suites":["gatsby-ssr"],"updatePoint":{"line":24,"column":55,"index":526},"line":24,"code":"  it(`does nothing if the pathname has no cached assets`, () => {\n    setCachedAssets({});\n    onRenderBody({\n      setHeadComponents,\n      pathname: `/foo`\n    }, {});\n    expect(setHeadComponents).not.toHaveBeenCalled();\n  });","file":"gatsby-ssr.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"generates a <link> tag for each asset","suites":["gatsby-ssr"],"updatePoint":{"line":32,"column":43,"index":744},"line":32,"code":"  it(`generates a <link> tag for each asset`, () => {\n    setCachedAssets({\n      [`/foo`]: {\n        [`/path/to/font.otf`]: true,\n        [`https://foo.bar/path/to/another.ttf`]: true,\n        [`https://foo.baz/path/to/another/font.woff`]: true\n      }\n    });\n    onRenderBody({\n      setHeadComponents,\n      pathname: `/foo`\n    }, {});\n    expect(setHeadComponents.mock.calls[0][0]).toMatchSnapshot();\n  });","file":"gatsby-ssr.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"accepts string \\`crossOrigin\\` in plugin config","suites":["gatsby-ssr","generates <link> tags with \\`crossorigin\\` prop for external fonts"],"updatePoint":{"line":47,"column":55,"index":1258},"line":47,"code":"    it(`accepts string \\`crossOrigin\\` in plugin config`, () => {\n      setCachedAssets({\n        [`/foo`]: {\n          [`https://foo.bar/path/to/font.otf`]: true\n        }\n      });\n      onRenderBody({\n        setHeadComponents,\n        pathname: `/foo`\n      }, {\n        crossOrigin: `use-credentials`\n      });\n      expect(setHeadComponents.mock.calls[0][0]).toMatchSnapshot();\n    });","file":"gatsby-ssr.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"accepts function \\`crossOrigin\\` in plugin config","suites":["gatsby-ssr","generates <link> tags with \\`crossorigin\\` prop for external fonts"],"updatePoint":{"line":61,"column":57,"index":1652},"line":61,"code":"    it(`accepts function \\`crossOrigin\\` in plugin config`, () => {\n      const config = {\n        crossOrigin: path => path === `/foo` ? false : `use-credentials`\n      };\n      setCachedAssets({\n        [`/foo`]: {\n          [`https://foo.bar/path/to/font.otf`]: true\n        }\n      });\n      onRenderBody({\n        setHeadComponents,\n        pathname: `/foo`\n      }, config);\n      setCachedAssets({\n        [`/bar`]: {\n          [`https://foo.bar/path/to/another.woff`]: true\n        }\n      });\n      onRenderBody({\n        setHeadComponents,\n        pathname: `/bar`\n      }, config);\n      expect(setHeadComponents.mock.calls[0][0]).toMatchSnapshot();\n      expect(setHeadComponents.mock.calls[1][0]).toMatchSnapshot();\n    });","file":"gatsby-ssr.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"generates <link> tags with \\`crossorigin\\` \\`anonymous\\` prop for self-hosted fonts","suites":["gatsby-ssr","generates <link> tags with \\`crossorigin\\` prop for external fonts"],"updatePoint":{"line":87,"column":89,"index":2427},"line":87,"code":"  it(`generates <link> tags with \\`crossorigin\\` \\`anonymous\\` prop for self-hosted fonts`, () => {\n    setCachedAssets({\n      [`/foo`]: {\n        [`/font.otf`]: true\n      }\n    });\n    onRenderBody({\n      setHeadComponents,\n      pathname: `/foo`\n    });\n    expect(setHeadComponents.mock.calls[0][0]).toMatchSnapshot();\n  });","file":"gatsby-ssr.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"visits each provided route","suites":["prepare"],"updatePoint":{"line":68,"column":32,"index":1710},"line":68,"code":"  it(`visits each provided route`, async () => {\n    expect.assertions(1);\n    fetchRoutes.mockImplementationOnce(() => [`/foo`, `/bar`, `/baz`]);\n    mockPageRequests({\n      [`/foo`]: [createMockRequest(`/path/to/font.otf`), createMockRequest(`https://foo.bar/path/to/font.otf`)],\n      [`/bar`]: [createMockRequest(`/path/to/another.ttf`), createMockRequest(`https://foo.bar/path/to/a/font.woff`)],\n      [`/baz`]: [createMockRequest(`/another/font.woff2`), createMockRequest(`/some/external/font.ttf`), createMockRequest(`https://foo.bar/another/font.ttf`)]\n    });\n    await main();\n    expect(save.mock.calls[0][0]).toMatchSnapshot({\n      timestamp: expect.any(Number)\n    });\n  });","file":"index.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"logs all levels when logLevel = info","suites":["logger"],"updatePoint":{"line":23,"column":42,"index":687},"line":23,"code":"  it(`logs all levels when logLevel = info`, () => {\n    const logger = createLogger(`info`);\n    logger.info(`blah`);\n    logger.debug(`blah`);\n    logger.warn(`blah`);\n    logger.error(`blah`);\n    expect(consoleSpy).toHaveBeenCalledTimes(4);\n  });","file":"logger.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"disables output when logLevel = silent","suites":["logger"],"updatePoint":{"line":31,"column":44,"index":940},"line":31,"code":"  it(`disables output when logLevel = silent`, () => {\n    const logger = createLogger(`silent`);\n    logger.info(`blah`);\n    logger.debug(`blah`);\n    logger.warn(`blah`);\n    logger.error(`blah`);\n    expect(consoleSpy).toHaveBeenCalledTimes(0);\n  });","file":"logger.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"uses provided adapter","suites":["logger"],"updatePoint":{"line":39,"column":27,"index":1178},"line":39,"code":"  it(`uses provided adapter`, () => {\n    const logger = createLogger(`info`);\n    const adapter = jest.fn();\n    logger.setAdapter(adapter);\n    logger.info(`foo`);\n    logger.resetAdapter();\n    logger.info(`bar`);\n    expect(adapter).toHaveBeenCalledWith(expect.stringContaining(`[info]`), `foo`);\n    expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining(`[info]`), `bar`);\n  });","file":"logger.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"prompts the user for confirmation","suites":["logger"],"updatePoint":{"line":49,"column":39,"index":1584},"line":49,"code":"  it(`prompts the user for confirmation`, async () => {\n    global.process.stdout.isTTY = true;\n    expect.assertions(5);\n    const logger = createLogger(`info`);\n\n    // preemptively answer each call to `confirm` so the `await` won't hang forever\n    answer(``);\n    answer(`blah`);\n    answer(`yes`);\n    expect(await logger.confirm(`are you sure?`)).toBe(true);\n    answer(`y`);\n    expect(await logger.confirm(`are you sure?`)).toBe(true);\n    answer(`no`);\n    expect(await logger.confirm(`are you sure?`)).toBe(false);\n    answer(`n`);\n    expect(await logger.confirm(`are you sure?`)).toBe(false);\n    expect(getReadlineInterface().question).toHaveBeenCalledTimes(6);\n    delete global.process.stdout.isTTY;\n  });","file":"logger.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"does nothing to text under max length","suites":["utils","ellipses"],"updatePoint":{"line":6,"column":45,"index":155},"line":6,"code":"    it(`does nothing to text under max length`, () => {\n      expect(ellipses(`some text`, 10)).toBe(`some text`);\n    });","file":"utils.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"does nothing to text at max length","suites":["utils","ellipses"],"updatePoint":{"line":9,"column":42,"index":275},"line":9,"code":"    it(`does nothing to text at max length`, () => {\n      expect(ellipses(`some text`, 9)).toBe(`some text`);\n    });","file":"utils.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"truncates text over max length with \\`...\\`","suites":["utils","ellipses"],"updatePoint":{"line":12,"column":51,"index":403},"line":12,"code":"    it(`truncates text over max length with \\`...\\``, () => {\n      expect(ellipses(`some text`, 4)).toBe(`some...`);\n    });","file":"utils.test.js","skipped":false,"dir":"packages/gatsby-plugin-preload-fonts/src/__tests__"},{"name":"should add babel-plugin-react-css-modules plugin to babel config","suites":["gatsby-plugin-react-css-modules"],"updatePoint":{"line":16,"column":70,"index":363},"line":16,"code":"  it(`should add babel-plugin-react-css-modules plugin to babel config`, () => {\n    expect(actions.setBabelPlugin.mock.calls[0]).toMatchSnapshot();\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-react-css-modules/src/__tests__"},{"name":"should not pass plugins to babel plugin config","suites":["gatsby-plugin-react-css-modules"],"updatePoint":{"line":19,"column":52,"index":500},"line":19,"code":"  it(`should not pass plugins to babel plugin config`, () => {\n    expect(actions.setBabelPlugin.mock.calls[0].plugins).not.toBeDefined();\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-react-css-modules/src/__tests__"},{"name":"sets head components","suites":["gatsby-plugin-react-helmet","onRenderBody"],"updatePoint":{"line":12,"column":28,"index":330},"line":12,"code":"    it(`sets head components`, () => {\n      const actions = getActions();\n      onRenderBody(actions);\n      const titleComponent = Helmet.renderStatic().title.toComponent();\n      expect(actions.setHeadComponents).toHaveBeenCalledTimes(1);\n      expect(actions.setHeadComponents).toHaveBeenCalledWith([titleComponent, `link-component`, `meta-component`, `noscript-component`, `script-component`, `style-component`, `base-component`]);\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-react-helmet/src/__tests__"},{"name":"sets html attributes","suites":["gatsby-plugin-react-helmet","onRenderBody"],"updatePoint":{"line":19,"column":28,"index":775},"line":19,"code":"    it(`sets html attributes`, () => {\n      const actions = getActions({\n        setHtmlAttributes: jest.fn()\n      });\n      onRenderBody(actions);\n      expect(actions.setHeadComponents).toHaveBeenCalledTimes(1);\n      expect(actions.setHtmlAttributes).toHaveBeenCalledWith(`html-attributes-component`);\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-react-helmet/src/__tests__"},{"name":"sets body attributes","suites":["gatsby-plugin-react-helmet","onRenderBody"],"updatePoint":{"line":27,"column":28,"index":1090},"line":27,"code":"    it(`sets body attributes`, () => {\n      const actions = getActions({\n        setBodyAttributes: jest.fn()\n      });\n      onRenderBody(actions);\n      expect(actions.setBodyAttributes).toHaveBeenCalledTimes(1);\n      expect(actions.setBodyAttributes).toHaveBeenCalledWith(`body-attributes-component`);\n    });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-react-helmet/src/__tests__"},{"name":"Stage:  / ","suites":["gatsby-plugin-sass"],"updatePoint":{"line":59,"column":38,"index":1643},"line":59,"code":"        it(`Stage: ${stage} / ${label}`, () => {\n          onCreateWebpackConfig({\n            actions,\n            loaders,\n            stage\n          }, options);\n          expect(actions.setWebpackConfig).toMatchSnapshot();\n        });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-sass/src/__tests__"},{"name":"should provide meaningful errors when fields are invalid","suites":["pluginOptionsSchema"],"updatePoint":{"line":72,"column":62,"index":1971},"line":72,"code":"  it(`should provide meaningful errors when fields are invalid`, async () => {\n    const expectedErrors = [`\"implementation\" must be of type object`, `\"additionalData\" must be one of [string, object]`, `\"cssLoaderOptions\" must be of type object`, `\"postCssPlugins\" must be an array`, `\"sassRuleTest\" must be of type object`, `\"sassRuleModulesTest\" must be of type object`, `\"useResolveUrlLoader\" must be one of [boolean, object]`, `\"sassOptions.file\" must be a string`, `\"sassOptions.data\" must be a string`, `\"sassOptions.importer\" must be of type function`, `\"sassOptions.functions\" must be of type object`, `\"sassOptions.includePaths\" must be an array`, `\"sassOptions.indentedSyntax\" must be a boolean`, `\"sassOptions.indentType\" must be a string`, `\"sassOptions.indentWidth\" must be less than or equal to 10`, `\"sassOptions.linefeed\" must be one of [cr, crlf, lf, lfcr]`, `\"sassOptions.omitSourceMapUrl\" must be a boolean`, `\"sassOptions.outFile\" must be a string`, `\"sassOptions.outputStyle\" must be one of [nested, expanded, compact, compressed]`, `\"sassOptions.precision\" must be a number`, `\"sassOptions.sourceComments\" must be a boolean`, `\"sassOptions.sourceMap\" must be one of [boolean, string]`, `\"sassOptions.sourceMapContents\" must be a boolean`, `\"sassOptions.sourceMapEmbed\" must be a boolean`, `\"sassOptions.sourceMapRoot\" must be a string`];\n    const {\n      errors,\n      isValid\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      additionalData: 123,\n      implementation: `This should be a require() thing`,\n      postCssPlugins: `This should be an array of postCss plugins`,\n      cssLoaderOptions: `This should be an object of css-loader options`,\n      sassRuleTest: `This should be a regexp`,\n      sassRuleModulesTest: `This should be a regexp`,\n      useResolveUrlLoader: `This should be a boolean`,\n      sassOptions: {\n        file: 123,\n        // should be a string\n        data: 123,\n        // should be a string\n        importer: `This should be a function`,\n        functions: `This should be an object of { string: function }`,\n        includePaths: 123,\n        // should be an array of string\n        indentedSyntax: `\"useResolveUrlLoader\" must be a boolean`,\n        indentType: 123,\n        // this should be a string\n        indentWidth: 40,\n        linefeed: `This should be cr, crlf, lf or lfcr`,\n        omitSourceMapUrl: `This should be a boolean`,\n        outFile: 123,\n        // This should be a string\n        outputStyle: `This should be nested, expanded, compact or compressed`,\n        precision: `This should be a number`,\n        sourceComments: `This should be a boolean`,\n        sourceMap: 123,\n        // This should be a string or a boolean\n        sourceMapContents: `This should be a boolean`,\n        sourceMapEmbed: `This should be a boolean`,\n        sourceMapRoot: 123 // This should be a string\n      }\n    });\n\n    expect(isValid).toBe(false);\n    expect(errors).toEqual(expectedErrors);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-sass/src/__tests__"},{"name":"should validate the schema","suites":["pluginOptionsSchema"],"updatePoint":{"line":116,"column":32,"index":4919},"line":116,"code":"  it(`should validate the schema`, async () => {\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      additionalData: `$test: #000;`,\n      implementation: require(`../gatsby-node.js`),\n      cssLoaderOptions: {\n        camelCase: false\n      },\n      postCssPlugins: [require(`autoprefixer`)],\n      sassRuleTest: /\\.global\\.s(a|c)ss$/,\n      sassRuleModulesTest: /\\.mod\\.s(a|c)ss$/,\n      useResolveUrlLoader: false,\n      sassOptions: {\n        file: `../path-to-file`,\n        data: `{ some: data }`,\n        importer: function () {\n          return {\n            file: `path-to-file`,\n            contents: `data`\n          };\n        },\n        functions: {\n          \"headings($from: 0, $to: 6)\": function () {\n            return [];\n          }\n        },\n        includePaths: [`some`, `path`],\n        indentedSyntax: true,\n        indentType: `tabs`,\n        indentWidth: 7,\n        linefeed: `crlf`,\n        omitSourceMapUrl: true,\n        outFile: `somewhere-around.css`,\n        outputStyle: `expanded`,\n        precision: 12,\n        sourceComments: true,\n        sourceMap: true,\n        sourceMapContents: true,\n        sourceMapEmbed: true,\n        sourceMapRoot: `some-source-map-root`\n      }\n    });\n    expect(isValid).toBe(true);\n    expect(errors).toEqual([]);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-sass/src/__tests__"},{"name":"should allow unknown options","suites":["pluginOptionsSchema"],"updatePoint":{"line":163,"column":34,"index":6266},"line":163,"code":"  it(`should allow unknown options`, async () => {\n    const {\n      isValid,\n      hasWarnings\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      webpackImporter: `unknown option`\n    });\n    expect(isValid).toBe(true);\n    expect(hasWarnings).toBe(true);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-sass/src/__tests__"},{"name":"should call processFile with the right arguments","suites":["worker"],"updatePoint":{"line":12,"column":54},"line":12,"code":"  it(`should call processFile with the right arguments`, async () => {\n    processFile.mockImplementation((file, transforms) =>\n      transforms.map(transform => Promise.resolve(transform))\n    )\n    const job = {\n      inputPaths: [\n        {\n          path: `inputpath/file.jpg`,\n          contentDigest: `1234`,\n        },\n      ],\n      outputDir: `/public/static/`,\n      args: {\n        operations: [\n          {\n            outputPath: `myoutputpath/1234/file.jpg`,\n            args: {\n              width: 100,\n              height: 100,\n            },\n          },\n        ],\n        pluginOptions: {},\n      },\n    }\n\n    await worker(job)\n\n    expect(processFile).toHaveBeenCalledTimes(1)\n    expect(processFile).toHaveBeenCalledWith(\n      job.inputPaths[0].path,\n      [\n        {\n          ...job.args.operations[0],\n          outputPath: path.join(\n            job.outputDir,\n            job.args.operations[0].outputPath\n          ),\n        },\n      ],\n      job.args.pluginOptions\n    )\n  })","file":"gatsby-worker.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should fail a promise when image processing fails","suites":["worker"],"updatePoint":{"line":56,"column":55},"line":56,"code":"  it(`should fail a promise when image processing fails`, async () => {\n    processFile.mockImplementation(() =>\n      Promise.reject(new Error(`transform failed`))\n    )\n\n    const job = {\n      inputPaths: [\n        {\n          path: `inputpath/file.jpg`,\n          contentDigest: `1234`,\n        },\n      ],\n      outputDir: `/public/static/`,\n      args: {\n        operations: [\n          {\n            outputPath: `myoutputpath/1234/file.jpg`,\n            args: {\n              width: 100,\n              height: 100,\n            },\n          },\n        ],\n        pluginOptions: {},\n      },\n    }\n\n    expect.assertions(1)\n    try {\n      await worker(job)\n    } catch (err) {\n      expect(err.message).toEqual(`transform failed`)\n    }\n  })","file":"gatsby-worker.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should round height when auto-calculated createJobV2","suites":["gatsby-plugin-sharp","queueImageResizing"],"updatePoint":{"line":79,"column":60},"line":79,"code":"    it(`should round height when auto-calculated createJobV2`, () => {\n      // Resize 144-density.png (281x136) with a 3px width\n      const result = queueImageResizing({\n        file: getFileObject(path.join(__dirname, `images/144-density.png`)),\n        args: { width: 3 },\n      })\n\n      // Width should be: w = (3 * 136) / 281 = 1.451957295\n      // We expect value to be rounded to 1\n      expect(result.height).toBe(1)\n      expect(actions.createJobV2).toHaveBeenCalledTimes(1)\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"file name works with spaces & special characters createJobV2","suites":["gatsby-plugin-sharp","queueImageResizing"],"updatePoint":{"line":93,"column":68},"line":93,"code":"    it(`file name works with spaces & special characters createJobV2`, async () => {\n      // test name encoding with various characters\n      const testName = `spaces and '\"@#$%^&,`\n\n      const queueResult = queueImageResizing({\n        file: getFileObject(\n          path.join(__dirname, `images/144-density.png`),\n          testName\n        ),\n        args: { width: 3 },\n      })\n\n      const queueResultName = path.parse(queueResult.src).name\n\n      // decoding to check for outputting same name\n      expect(decodeURIComponent(queueResultName)).toBe(testName)\n\n      // regex for special characters above and spaces\n      // testname should match, the queue result should not\n      expect(testName.match(/[!@#$^&,\" ]/)).not.toBe(false)\n      expect(queueResultName.match(/[!@#$^&,\" ]/)).not.toBe(true)\n      expect(actions.createJobV2).toHaveBeenCalledTimes(1)\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should process immediately when asked","suites":["gatsby-plugin-sharp","queueImageResizing"],"line":119,"code":"    it.skip(`should process immediately when asked`, async () => {","file":"index.js","skipped":true,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"includes responsive image properties, e.g. sizes, srcset, etc.","suites":["gatsby-plugin-sharp","fluid"],"updatePoint":{"line":138,"column":70},"line":138,"code":"    it(`includes responsive image properties, e.g. sizes, srcset, etc.`, async () => {\n      const result = await fluid({ file })\n\n      expect(actions.createJobV2).toHaveBeenCalledTimes(1)\n      expect(result).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"adds pathPrefix if defined","suites":["gatsby-plugin-sharp","fluid"],"updatePoint":{"line":145,"column":34},"line":145,"code":"    it(`adds pathPrefix if defined`, async () => {\n      const pathPrefix = `/blog`\n      const result = await fluid({\n        file,\n        args: {\n          pathPrefix,\n        },\n      })\n\n      expect(result.src.indexOf(pathPrefix)).toBe(0)\n      expect(result.srcSet.indexOf(pathPrefix)).toBe(0)\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"keeps original file name","suites":["gatsby-plugin-sharp","fluid"],"updatePoint":{"line":159,"column":32},"line":159,"code":"    it(`keeps original file name`, async () => {\n      const result = await fluid({\n        file,\n      })\n\n      expect(path.parse(result.src).name).toBe(file.name)\n      expect(path.parse(result.srcSet).name).toBe(file.name)\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"does not change the arguments object it is given","suites":["gatsby-plugin-sharp","fluid"],"updatePoint":{"line":169,"column":56},"line":169,"code":"    it(`does not change the arguments object it is given`, async () => {\n      const args = { maxWidth: 400 }\n      await fluid({\n        file,\n        args,\n      })\n\n      expect(args).toEqual({ maxWidth: 400 })\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"infers the maxWidth if only maxHeight is given","suites":["gatsby-plugin-sharp","fluid"],"updatePoint":{"line":180,"column":54},"line":180,"code":"    it(`infers the maxWidth if only maxHeight is given`, async () => {\n      const args = { maxHeight: 20 }\n      const result = await fluid({\n        file: getFileObject(path.join(__dirname, `images/144-density.png`)),\n        args,\n      })\n\n      expect(result.presentationWidth).toEqual(41)\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"calculate height based on width when maxWidth & maxHeight are present","suites":["gatsby-plugin-sharp","fluid"],"updatePoint":{"line":191,"column":77},"line":191,"code":"    it(`calculate height based on width when maxWidth & maxHeight are present`, async () => {\n      const testsCases = [\n        { args: { maxWidth: 20, maxHeight: 20 }, result: [20, 20] },\n        {\n          args: { maxWidth: 20, maxHeight: 20, fit: sharp.fit.fill },\n          result: [20, 20],\n        },\n        {\n          args: { maxWidth: 20, maxHeight: 20, fit: sharp.fit.inside },\n          result: [20, 10],\n        },\n        {\n          args: { maxWidth: 20, maxHeight: 20, fit: sharp.fit.outside },\n          result: [41, 20],\n        },\n        { args: { maxWidth: 200, maxHeight: 200 }, result: [200, 200] },\n        {\n          args: { maxWidth: 200, maxHeight: 200, fit: sharp.fit.fill },\n          result: [200, 200],\n        },\n        {\n          args: { maxWidth: 200, maxHeight: 200, fit: sharp.fit.inside },\n          result: [200, 97],\n        },\n        {\n          args: { maxWidth: 200, maxHeight: 200, fit: sharp.fit.outside },\n          result: [413, 200],\n        },\n      ]\n      const fileObject = getFileObject(\n        path.join(__dirname, `images/144-density.png`)\n      )\n\n      for (const testCase of testsCases) {\n        actions.createJobV2.mockClear()\n        const result = await fluid({\n          file: fileObject,\n          args: testCase.args,\n        })\n\n        expect(actions.createJobV2.mock.calls).toMatchSnapshot()\n        expect(result.presentationWidth).toEqual(testCase.result[0])\n        expect(result.presentationHeight).toEqual(testCase.result[1])\n      }\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should throw if maxWidth is less than 1","suites":["gatsby-plugin-sharp","fluid"],"updatePoint":{"line":237,"column":47},"line":237,"code":"    it(`should throw if maxWidth is less than 1`, async () => {\n      const args = { maxWidth: 0 }\n      const result = fluid({\n        file: getFileObject(path.join(__dirname, `images/144-density.png`)),\n        args,\n      })\n\n      await expect(result).rejects.toThrow()\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"accepts srcSet breakpoints","suites":["gatsby-plugin-sharp","fluid"],"updatePoint":{"line":248,"column":34},"line":248,"code":"    it(`accepts srcSet breakpoints`, async () => {\n      const srcSetBreakpoints = [50, 70, 150, 250]\n      const args = { srcSetBreakpoints }\n      const result = await fluid({\n        file: getFileObject(path.join(__dirname, `images/144-density.png`)),\n        args,\n      })\n\n      // width of the image tested\n      const originalWidth = 281\n      const expected = srcSetBreakpoints.map(size => `${size}w`)\n      // add the original size of `144-density.png`\n      expected.push(`${originalWidth}w`)\n\n      const actual = findAllBreakpoints(result.srcSet)\n      // should contain all requested sizes as well as the original size\n      expect(actual).toEqual(expect.arrayContaining(expected))\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should throw on srcSet breakpoints less than 1","suites":["gatsby-plugin-sharp","fluid"],"updatePoint":{"line":268,"column":54},"line":268,"code":"    it(`should throw on srcSet breakpoints less than 1`, async () => {\n      const srcSetBreakpoints = [50, 0]\n      const args = { srcSetBreakpoints }\n      const result = fluid({\n        file: getFileObject(path.join(__dirname, `images/144-density.png`)),\n        args,\n      })\n\n      await expect(result).rejects.toThrow()\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"ensure maxWidth is in srcSet breakpoints","suites":["gatsby-plugin-sharp","fluid"],"updatePoint":{"line":280,"column":48},"line":280,"code":"    it(`ensure maxWidth is in srcSet breakpoints`, async () => {\n      const srcSetBreakpoints = [50, 70, 150]\n      const maxWidth = 200\n      const args = {\n        maxWidth,\n        srcSetBreakpoints,\n      }\n      const result = await fluid({\n        file: getFileObject(path.join(__dirname, `images/144-density.png`)),\n        args,\n      })\n\n      expect(result.srcSet).toEqual(expect.stringContaining(`${maxWidth}w`))\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"reject any breakpoints larger than the original width","suites":["gatsby-plugin-sharp","fluid"],"updatePoint":{"line":296,"column":61},"line":296,"code":"    it(`reject any breakpoints larger than the original width`, async () => {\n      const srcSetBreakpoints = [\n        50,\n        70,\n        150,\n        250,\n        300, // this shouldn't be in the output as it's wider than the original\n      ]\n      const maxWidth = 500 // this also shouldn't be in the output\n      const args = {\n        maxWidth,\n        srcSetBreakpoints,\n      }\n      const result = await fluid({\n        file: getFileObject(path.join(__dirname, `images/144-density.png`)),\n        args,\n      })\n\n      // width of the image tested\n      const originalWidth = 281\n      const expected = srcSetBreakpoints\n        // filter out the widths that are larger than the source image width\n        .filter(size => size < originalWidth)\n        .map(size => `${size}w`)\n      // add the original size of `144-density.png`\n      expected.push(`${originalWidth}w`)\n\n      const actual = findAllBreakpoints(result.srcSet)\n      // should contain all requested sizes as well as the original size\n      expect(actual).toEqual(expect.arrayContaining(expected))\n      // should contain no other sizes\n      expect(actual.length).toEqual(expected.length)\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"prevents duplicate breakpoints","suites":["gatsby-plugin-sharp","fluid"],"updatePoint":{"line":331,"column":38},"line":331,"code":"    it(`prevents duplicate breakpoints`, async () => {\n      const srcSetBreakpoints = [50, 50, 100, 100, 100, 250, 250]\n      const maxWidth = 100\n      const args = {\n        maxWidth,\n        srcSetBreakpoints,\n      }\n      const result = await fluid({\n        file: getFileObject(path.join(__dirname, `images/144-density.png`)),\n        args,\n      })\n\n      const originalWidth = 281\n      const expected = [`50w`, `100w`, `250w`, `${originalWidth}w`]\n\n      const actual = findAllBreakpoints(result.srcSet)\n      expect(actual).toEqual(expect.arrayContaining(expected))\n      expect(actual.length).toEqual(expected.length)\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"does not warn when the requested width is equal to the image width","suites":["gatsby-plugin-sharp","fixed"],"updatePoint":{"line":361,"column":74},"line":361,"code":"    it(`does not warn when the requested width is equal to the image width`, async () => {\n      const args = { width: 1 }\n\n      const result = await fixed({\n        file,\n        args,\n      })\n\n      expect(result.width).toEqual(1)\n      expect(console.warn).toHaveBeenCalledTimes(0)\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"warns when the requested width is greater than the image width","suites":["gatsby-plugin-sharp","fixed"],"updatePoint":{"line":374,"column":70},"line":374,"code":"    it(`warns when the requested width is greater than the image width`, async () => {\n      const { width } = await sharp(file.absolutePath).metadata()\n      const args = { width: width * 2 }\n\n      const result = await fixed({\n        file,\n        args,\n      })\n\n      expect(result.width).toEqual(width)\n      expect(console.warn).toHaveBeenCalledTimes(1)\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"correctly infers the width when only the height is given","suites":["gatsby-plugin-sharp","fixed"],"updatePoint":{"line":388,"column":64},"line":388,"code":"    it(`correctly infers the width when only the height is given`, async () => {\n      const args = { height: 10 }\n\n      const result = await fixed({\n        file: getFileObject(path.join(__dirname, `images/144-density.png`)),\n        args,\n      })\n\n      expect(result.width).toEqual(21)\n      expect(actions.createJobV2).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"converts image to base64","suites":["gatsby-plugin-sharp","base64"],"updatePoint":{"line":402,"column":32},"line":402,"code":"    it(`converts image to base64`, async () => {\n      const result = await base64({\n        file,\n        args,\n      })\n\n      expect(result).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should cache same image","suites":["gatsby-plugin-sharp","base64"],"updatePoint":{"line":411,"column":31},"line":411,"code":"    it(`should cache same image`, async () => {\n      const file1 = getFileObject(absolutePath)\n      const file2 = getFileObject(absolutePath)\n      const file3 = getFileObject(absolutePath, `test`, `new-image`)\n      // change file of file3\n      file3.base = path.join(__dirname, `images/144-density.png`)\n\n      const result = await base64({\n        file: file1,\n        args,\n      })\n      const result2 = await base64({\n        file: file2,\n        args,\n      })\n      const result3 = await base64({\n        file: file3,\n        args,\n      })\n\n      // I would like to test sharp being executed but I don't really know how to mock that beast :p\n      expect(result).toEqual(result2)\n      expect(result).not.toEqual(result3)\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should support option: 'background'","suites":["gatsby-plugin-sharp","base64"],"updatePoint":{"line":438,"column":43},"line":438,"code":"    it(`should support option: 'background'`, async () => {\n      const result = await generateBase64({\n        file: getFileObject(path.join(__dirname, `images/alphatest.png`)),\n        args: {\n          background: `#ff0000`,\n          toFormatBase64: `jpg`,\n        },\n      })\n\n      expect(result).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should support a configurable width","suites":["gatsby-plugin-sharp","base64","should support option: 'base64Width'"],"updatePoint":{"line":452,"column":45},"line":452,"code":"      it(`should support a configurable width`, async () => {\n        const result = await generateBase64({\n          file,\n          args: { base64Width: 42 },\n        })\n\n        expect(result.width).toEqual(42)\n      })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should support a configurable default width","suites":["gatsby-plugin-sharp","base64","should support option: 'base64Width'"],"updatePoint":{"line":461,"column":53},"line":461,"code":"      it(`should support a configurable default width`, async () => {\n        setPluginOptions({ base64Width: 32 })\n\n        const result = await generateBase64({\n          file,\n          args,\n        })\n\n        expect(result.width).toEqual(32)\n        setPluginOptions(getPluginOptionsDefaults())\n      })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"width via arg overrides global default","suites":["gatsby-plugin-sharp","base64","should support option: 'base64Width'"],"updatePoint":{"line":473,"column":48},"line":473,"code":"      it(`width via arg overrides global default`, async () => {\n        setPluginOptions({ base64Width: 32 })\n\n        const result = await generateBase64({\n          file,\n          args: { base64Width: 42 },\n        })\n\n        expect(result.width).toEqual(42)\n        setPluginOptions(getPluginOptionsDefaults())\n      })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should support a different image format for base64","suites":["gatsby-plugin-sharp","base64","should support options: 'toFormatBase64' and 'forceBase64Format'"],"updatePoint":{"line":487,"column":60},"line":487,"code":"      it(`should support a different image format for base64`, async () => {\n        const result = await generateBase64({\n          file,\n          args: { toFormatBase64: `webp` },\n        })\n\n        expect(result.src).toEqual(\n          expect.stringMatching(/^data:image\\/webp;base64/)\n        )\n      })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should support a configurable default base64 image format","suites":["gatsby-plugin-sharp","base64","should support options: 'toFormatBase64' and 'forceBase64Format'"],"updatePoint":{"line":498,"column":67},"line":498,"code":"      it(`should support a configurable default base64 image format`, async () => {\n        setPluginOptions({ forceBase64Format: `webp` })\n        const result = await generateBase64({\n          file,\n          args,\n        })\n\n        expect(result.src).toEqual(\n          expect.stringMatching(/^data:image\\/webp;base64/)\n        )\n        setPluginOptions(getPluginOptionsDefaults())\n      })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"image format via arg overrides global default","suites":["gatsby-plugin-sharp","base64","should support options: 'toFormatBase64' and 'forceBase64Format'"],"updatePoint":{"line":511,"column":55},"line":511,"code":"      it(`image format via arg overrides global default`, async () => {\n        setPluginOptions({ forceBase64Format: `png` })\n        const result = await generateBase64({\n          file,\n          args: { toFormatBase64: `webp` },\n        })\n\n        expect(result.src).toEqual(\n          expect.stringMatching(/^data:image\\/webp;base64/)\n        )\n        setPluginOptions(getPluginOptionsDefaults())\n      })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"handles padding bytes correctly","suites":["gatsby-plugin-sharp","image quirks"],"updatePoint":{"line":528,"column":39},"line":528,"code":"    it(`handles padding bytes correctly`, () => {\n      const result = getImageSize(\n        getFileObject(path.join(__dirname, `images/padding-bytes.jpg`))\n      )\n\n      expect(result).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"handles padding bytes correctly in async version","suites":["gatsby-plugin-sharp","image quirks"],"updatePoint":{"line":536,"column":56},"line":536,"code":"    it(`handles padding bytes correctly in async version`, async () => {\n      const result = await getImageSizeAsync(\n        getFileObject(path.join(__dirname, `images/padding-bytes.jpg`))\n      )\n\n      expect(result).toMatchInlineSnapshot(`\n        Object {\n          \"hUnits\": \"px\",\n          \"height\": 1000,\n          \"mime\": \"image/jpeg\",\n          \"type\": \"jpg\",\n          \"wUnits\": \"px\",\n          \"width\": 746,\n        }\n      `)\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"handles really wide aspect ratios for blurred placeholder","suites":["gatsby-plugin-sharp","image quirks"],"updatePoint":{"line":553,"column":65},"line":553,"code":"    it(`handles really wide aspect ratios for blurred placeholder`, async () => {\n      const result = await base64({\n        file: getFileObject(\n          path.join(__dirname, `images/wide-aspect-ratio.png`),\n          `wide-aspect-ratio`,\n          `1000x10`\n        ),\n        args,\n      })\n\n      expect(result.width).toEqual(20)\n      expect(result.height).toEqual(1)\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"doesn't always run","suites":["gatsby-plugin-sharp","tracedSVG"],"updatePoint":{"line":569,"column":26},"line":569,"code":"    it(`doesn't always run`, async () => {\n      const args = {\n        maxWidth: 100,\n        width: 100,\n        tracedSVG: { color: `#FF0000` },\n      }\n\n      let result = await fixed({\n        file,\n        args,\n      })\n\n      expect(result.tracedSVG).toBeUndefined()\n\n      result = await fluid({\n        file,\n        args,\n      })\n\n      expect(result.tracedSVG).toBeUndefined()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"runs on demand (and falls back to blurred)","suites":["gatsby-plugin-sharp","tracedSVG"],"updatePoint":{"line":591,"column":50},"line":591,"code":"    it(`runs on demand (and falls back to blurred)`, async () => {\n      const args = {\n        maxWidth: 100,\n        width: 100,\n        generateTracedSVG: true,\n        tracedSVG: { color: `#FF0000` },\n        base64: false,\n      }\n\n      const fixedSvg = await fixed({\n        file,\n        args,\n      })\n\n      expect(fixedSvg).toMatchSnapshot(`fixed`)\n\n      expect(fixedSvg.tracedSVG).toMatch(`data:image/png;base64`)\n      expect(fixedSvg.tracedSVG).not.toMatch(`data:image/svg+xml`)\n\n      const fluidSvg = await fluid({\n        file,\n        args,\n      })\n\n      expect(fluidSvg).toMatchSnapshot(`fluid`)\n\n      expect(fluidSvg.tracedSVG).toMatch(`data:image/png;base64`)\n      expect(fluidSvg.tracedSVG).not.toMatch(`data:image/svg+xml`)\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"fixed","suites":["gatsby-plugin-sharp","duotone"],"updatePoint":{"line":629,"column":13},"line":629,"code":"    it(`fixed`, async () => {\n      const result = await fixed({ file, args })\n      expect(result).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"fluid","suites":["gatsby-plugin-sharp","duotone"],"updatePoint":{"line":634,"column":13},"line":634,"code":"    it(`fluid`, async () => {\n      const result = await fluid({ file, args })\n      expect(result).toMatchSnapshot()\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"creates two different images for different duotone settings","suites":["gatsby-plugin-sharp","duotone"],"updatePoint":{"line":639,"column":67},"line":639,"code":"    it(`creates two different images for different duotone settings`, async () => {\n      const testName = `duotone-digest-test`\n      const firstImage = await fluid({\n        file: getFileObject(path.join(__dirname, `images/test.png`), testName),\n        args: {\n          maxWidth: 100,\n          width: 100,\n          duotone: { highlight: `#BBFFE6`, shadow: `#51758D` },\n        },\n      })\n      const secondImage = await fluid({\n        file: getFileObject(path.join(__dirname, `images/test.png`), testName),\n        args: {\n          maxWidth: 100,\n          width: 100,\n          duotone: { highlight: `#F1D283`, shadow: `#000000` },\n        },\n      })\n\n      expect(firstImage.src).not.toEqual(secondImage.src)\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"determines if the image is transparent, based on the presence and use of alpha channel","suites":["gatsby-plugin-sharp","stats"],"updatePoint":{"line":663,"column":94},"line":663,"code":"    it(`determines if the image is transparent, based on the presence and use of alpha channel`, async () => {\n      const result = await stats({ file, args })\n      expect(result).toMatchSnapshot()\n      expect(result.isTransparent).toEqual(false)\n\n      const alphaResult = await stats({\n        file: getFileObject(path.join(__dirname, `images/alphatest.png`)),\n        args,\n      })\n      expect(alphaResult).toMatchSnapshot()\n      expect(alphaResult.isTransparent).toEqual(true)\n    })","file":"index.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should reject incorrect options","suites":["pluginOptionsSchema"],"updatePoint":{"line":20,"column":37},"line":20,"code":"  it(`should reject incorrect options`, async () => {\n    const options = {\n      defaults: {\n        formats: [`gif`, `webp`],\n        placeholder: `base64`,\n        quality: `great`,\n        breakpoints: [`mobile`],\n        backgroundColor: 0,\n        tracedSVGOptions: null,\n        transformOptions: false,\n        blurredOptions: 1,\n        jpgOptions: `none`,\n        pngOptions: [{}],\n        webpOptions: /a/,\n        avifOptions: 1,\n      },\n    }\n    const expectedErrors = [\n      `\"defaults.formats[0]\" must be one of [auto, png, jpg, webp, avif]`,\n      `\"defaults.placeholder\" must be one of [tracedSVG, dominantColor, blurred, none]`,\n      `\"defaults.quality\" must be a number`,\n      `\"defaults.breakpoints[0]\" must be a number`,\n      `\"defaults.backgroundColor\" must be a string`,\n      `\"defaults.transformOptions\" must be of type object`,\n      `\"defaults.tracedSVGOptions\" must be of type object`,\n      `\"defaults.blurredOptions\" must be of type object`,\n      `\"defaults.jpgOptions\" must be of type object`,\n      `\"defaults.pngOptions\" must be of type object`,\n      `\"defaults.avifOptions\" must be of type object`,\n    ]\n\n    const { isValid, errors } = await testPluginOptionsSchema(\n      pluginOptionsSchema,\n      options\n    )\n\n    expect(isValid).toBe(false)\n    expect(errors).toEqual(expectedErrors)\n  })","file":"plugin-options.ts","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should accept correct options","suites":["pluginOptionsSchema"],"updatePoint":{"line":60,"column":35},"line":60,"code":"  it(`should accept correct options`, async () => {\n    const options = { defaults }\n    const { isValid, errors } = await testPluginOptionsSchema(\n      pluginOptionsSchema,\n      options\n    )\n    expect(isValid).toBe(true)\n    expect(errors).toEqual([])\n  })","file":"plugin-options.ts","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"uses defaults","suites":["plugin defaults"],"updatePoint":{"line":72,"column":19},"line":72,"code":"  it(`uses defaults`, () => {\n    const output = doMergeDefaults({}, defaults)\n    expect(output).toMatchInlineSnapshot(`\n      Object {\n        \"avifOptions\": Object {\n          \"quality\": 20,\n        },\n        \"backgroundColor\": \"rebeccapurple\",\n        \"blurredOptions\": Object {\n          \"width\": 20,\n        },\n        \"breakpoints\": Array [\n          100,\n          200,\n        ],\n        \"formats\": Array [\n          \"auto\",\n          \"webp\",\n        ],\n        \"jpgOptions\": Object {\n          \"quality\": 20,\n        },\n        \"placeholder\": \"dominantColor\",\n        \"pngOptions\": Object {\n          \"quality\": 20,\n        },\n        \"quality\": 50,\n        \"tracedSVGOptions\": Object {},\n        \"webpOptions\": Object {\n          \"quality\": 20,\n        },\n      }\n    `)\n  })","file":"plugin-options.ts","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"allows overrides","suites":["plugin defaults"],"updatePoint":{"line":107,"column":22},"line":107,"code":"  it(`allows overrides`, () => {\n    const output = doMergeDefaults({ backgroundColor: `papayawhip` }, defaults)\n    expect(output.backgroundColor).toEqual(`papayawhip`)\n    expect(output.quality).toEqual(50)\n  })","file":"plugin-options.ts","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"allows overrides of arrays","suites":["plugin defaults"],"updatePoint":{"line":113,"column":32},"line":113,"code":"  it(`allows overrides of arrays`, () => {\n    const output = doMergeDefaults({ formats: [`auto`, `avif`] }, defaults)\n    expect(output.formats).toEqual([`auto`, `avif`])\n    expect(output.breakpoints).toEqual([100, 200])\n  })","file":"plugin-options.ts","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"allows override of deep objects","suites":["plugin defaults"],"updatePoint":{"line":119,"column":37},"line":119,"code":"  it(`allows override of deep objects`, () => {\n    const output = doMergeDefaults({ avifOptions: { quality: 50 } }, defaults)\n    expect(output.avifOptions).toEqual({ quality: 50 })\n  })","file":"plugin-options.ts","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"allows extra keys in objects","suites":["plugin defaults"],"updatePoint":{"line":124,"column":34},"line":124,"code":"  it(`allows extra keys in objects`, () => {\n    const output = doMergeDefaults({ avifOptions: { speed: 50 } }, defaults)\n    expect(output.avifOptions).toEqual({ quality: 20, speed: 50 })\n  })","file":"plugin-options.ts","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should throw if width is less than 1","suites":["calculateImageSizes (fixed)"],"updatePoint":{"line":15,"column":42},"line":15,"code":"  it(`should throw if width is less than 1`, () => {\n    const args = {\n      layout: `fixed`,\n      width: 0,\n      file,\n      imgDimensions,\n    }\n    const getSizes = () => calculateImageSizes(args)\n    expect(getSizes).toThrow()\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should throw if height is less than 1","suites":["calculateImageSizes (fixed)"],"updatePoint":{"line":26,"column":43},"line":26,"code":"  it(`should throw if height is less than 1`, () => {\n    const args = {\n      layout: `fixed`,\n      height: -50,\n      file,\n      imgDimensions,\n    }\n    const getSizes = () => calculateImageSizes(args)\n    expect(getSizes).toThrow()\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should return the original width of the image when only width is provided","suites":["calculateImageSizes (fixed)"],"updatePoint":{"line":37,"column":79},"line":37,"code":"  it(`should return the original width of the image when only width is provided`, () => {\n    const args = {\n      layout: `fixed`,\n      width: 600,\n      file,\n      imgDimensions,\n    }\n    const { sizes } = calculateImageSizes(args)\n    expect(sizes).toContain(600)\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should return the original width of the image when only height is provided","suites":["calculateImageSizes (fixed)"],"updatePoint":{"line":48,"column":80},"line":48,"code":"  it(`should return the original width of the image when only height is provided`, () => {\n    const args = {\n      layout: `fixed`,\n      height: 500,\n      file,\n      imgDimensions,\n    }\n    const { sizes } = calculateImageSizes(args)\n    expect(sizes).toContain(500 * (imgDimensions.width / imgDimensions.height))\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should create images of different sizes based on pixel densities with a given width","suites":["calculateImageSizes (fixed)"],"updatePoint":{"line":59,"column":89},"line":59,"code":"  it(`should create images of different sizes based on pixel densities with a given width`, () => {\n    const args = {\n      layout: `fixed`,\n      width: 120,\n      file,\n      imgDimensions,\n    }\n    const { sizes } = calculateImageSizes(args)\n    expect(sizes).toEqual([120, 240])\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should create images of different sizes based on pixel densities with a given height","suites":["calculateImageSizes (fixed)"],"updatePoint":{"line":70,"column":90},"line":70,"code":"  it(`should create images of different sizes based on pixel densities with a given height`, () => {\n    const args = {\n      layout: `fixed`,\n      height: 80,\n      file,\n      imgDimensions,\n    }\n    const { sizes } = calculateImageSizes(args)\n    expect(sizes).toEqual([120, 240])\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should throw if width is less than 1","suites":["calculateImageSizes (fullWidth & constrained)"],"updatePoint":{"line":83,"column":42},"line":83,"code":"  it(`should throw if width is less than 1`, () => {\n    const args = {\n      layout: `constrained`,\n      width: 0,\n      file,\n      imgDimensions,\n    }\n    const getSizes = () => calculateImageSizes(args)\n    expect(getSizes).toThrow()\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should throw if height is less than 1","suites":["calculateImageSizes (fullWidth & constrained)"],"updatePoint":{"line":94,"column":43},"line":94,"code":"  it(`should throw if height is less than 1`, () => {\n    const args = {\n      layout: `constrained`,\n      height: -50,\n      file,\n      imgDimensions,\n    }\n    const getSizes = () => calculateImageSizes(args)\n    expect(getSizes).toThrow()\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should include the original size of the image when width is passed","suites":["calculateImageSizes (fullWidth & constrained)"],"updatePoint":{"line":105,"column":72},"line":105,"code":"  it(`should include the original size of the image when width is passed`, () => {\n    const args = {\n      layout: `constrained`,\n      width: 400,\n      file,\n      imgDimensions,\n      reporter,\n    }\n    const { sizes } = calculateImageSizes(args)\n    expect(sizes).toContain(400)\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should include the original size of the image when height is passed","suites":["calculateImageSizes (fullWidth & constrained)"],"updatePoint":{"line":117,"column":73},"line":117,"code":"  it(`should include the original size of the image when height is passed`, () => {\n    const args = {\n      layout: `fullWidth`,\n      height: 300,\n      file,\n      imgDimensions,\n    }\n    const { sizes } = calculateImageSizes(args)\n    expect(sizes).toContain(450)\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should create images of different sizes (0.25x, 0.5x, 1x, 2x) from a width","suites":["calculateImageSizes (fullWidth & constrained)"],"updatePoint":{"line":128,"column":80},"line":128,"code":"  it(`should create images of different sizes (0.25x, 0.5x, 1x, 2x) from a width`, () => {\n    const args = {\n      layout: `fullWidth`,\n      width: 320,\n      file,\n      imgDimensions,\n    }\n    const { sizes } = calculateImageSizes(args)\n    expect(sizes).toEqual([80, 160, 320, 640])\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should create images of different sizes (0.25x, 0.5x, 1x) without any defined size provided","suites":["calculateImageSizes (fullWidth & constrained)"],"updatePoint":{"line":139,"column":97},"line":139,"code":"  it(`should create images of different sizes (0.25x, 0.5x, 1x) without any defined size provided`, () => {\n    const args = {\n      layout: `fullWidth`,\n      file,\n      imgDimensions,\n    }\n    const { sizes } = calculateImageSizes(args)\n    expect(sizes).toEqual([200, 400, 800])\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should return sizes of provided breakpoints in fullWidth","suites":["calculateImageSizes (fullWidth & constrained)"],"updatePoint":{"line":149,"column":62},"line":149,"code":"  it(`should return sizes of provided breakpoints in fullWidth`, () => {\n    const breakpoints = [50, 70, 150, 250, 300]\n    const width = 500\n    const args = {\n      layout: `fullWidth`,\n      width,\n      breakpoints,\n      file,\n      imgDimensions,\n      reporter,\n    }\n\n    const { sizes } = calculateImageSizes(args)\n    expect(sizes).toEqual([50, 70, 150, 250, 300])\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should include provided width along with breakpoints in constrained","suites":["calculateImageSizes (fullWidth & constrained)"],"updatePoint":{"line":165,"column":73},"line":165,"code":"  it(`should include provided width along with breakpoints in constrained`, () => {\n    const breakpoints = [50, 70, 150, 250, 300]\n    const width = 500\n    const args = {\n      layout: `constrained`,\n      width,\n      breakpoints,\n      file,\n      imgDimensions,\n      reporter,\n    }\n\n    const { sizes } = calculateImageSizes(args)\n    expect(sizes).toEqual([50, 70, 150, 250, 300, 500])\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should reject any breakpoints larger than the original width","suites":["calculateImageSizes (fullWidth & constrained)"],"updatePoint":{"line":181,"column":66},"line":181,"code":"  it(`should reject any breakpoints larger than the original width`, () => {\n    const breakpoints = [\n      50,\n      70,\n      150,\n      250,\n      1200,\n      1800, // shouldn't be included, larger than original width\n    ]\n    const width = 1500 // also shouldn't be included\n    const args = {\n      layout: `fullWidth`,\n      width,\n      breakpoints,\n      file,\n      imgDimensions,\n      reporter,\n    }\n\n    const { sizes } = calculateImageSizes(args)\n    expect(sizes).toEqual([50, 70, 150, 250, 1200])\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should add the original width instead of larger breakpoints","suites":["calculateImageSizes (fullWidth & constrained)"],"updatePoint":{"line":204,"column":65},"line":204,"code":"  it(`should add the original width instead of larger breakpoints`, () => {\n    const breakpoints = [\n      50,\n      70,\n      150,\n      250,\n      1800, // shouldn't be included, larger than original width\n    ]\n    const width = 1300\n    const args = {\n      layout: `fullWidth`,\n      width,\n      breakpoints,\n      file,\n      imgDimensions,\n      reporter,\n    }\n\n    const { sizes } = calculateImageSizes(args)\n    expect(sizes).toEqual([50, 70, 150, 250, 1200])\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should ignore outputPixelDensities when breakpoints are passed in","suites":["calculateImageSizes (fullWidth & constrained)"],"updatePoint":{"line":226,"column":71},"line":226,"code":"  it(`should ignore outputPixelDensities when breakpoints are passed in`, () => {\n    const breakpoints = [400, 800] // should find these\n    const width = 500\n    const args = {\n      layout: `fullWidth`,\n      width,\n      outputPixelDensities: [2, 4], // and ignore these, ie [1000, 2000]\n      breakpoints,\n      file,\n      imgDimensions,\n      reporter,\n    }\n\n    const { sizes } = calculateImageSizes(args)\n    expect(sizes).toEqual([400, 800])\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should adjust fullWidth sizes according to fit type","suites":["calculateImageSizes (fullWidth & constrained)"],"updatePoint":{"line":243,"column":57},"line":243,"code":"  it(`should adjust fullWidth sizes according to fit type`, () => {\n    const imgDimensions = {\n      width: 2810,\n      height: 1360,\n    }\n\n    const outputPixelDensities = [1]\n\n    const testsCases = [\n      { args: { width: 20, height: 20 }, result: [20, 20] },\n      {\n        args: {\n          width: 20,\n          height: 20,\n          transformOptions: { fit: sharp.fit.fill },\n        },\n        result: [20, 20],\n      },\n      {\n        args: {\n          width: 20,\n          height: 20,\n          transformOptions: { fit: sharp.fit.inside },\n        },\n        result: [20, 10],\n      },\n      {\n        args: {\n          width: 20,\n          height: 20,\n          transformOptions: { fit: sharp.fit.outside },\n        },\n        result: [41, 20],\n      },\n      { args: { width: 200, height: 200 }, result: [200, 200] },\n      {\n        args: {\n          width: 200,\n          height: 200,\n          transformOptions: { fit: sharp.fit.fill },\n        },\n        result: [200, 200],\n      },\n      {\n        args: {\n          width: 200,\n          height: 200,\n          transformOptions: { fit: sharp.fit.inside },\n        },\n        result: [200, 97],\n      },\n      {\n        args: {\n          width: 200,\n          height: 200,\n          transformOptions: { fit: sharp.fit.outside },\n        },\n        result: [413, 200],\n      },\n    ]\n    testsCases.forEach(({ args, result }) => {\n      const { presentationWidth, presentationHeight } = calculateImageSizes({\n        ...args,\n        file,\n        outputPixelDensities,\n        reporter,\n        imgDimensions,\n        layout: `fullWidth`,\n      })\n      expect([presentationWidth, presentationHeight]).toEqual(result)\n    })\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should adjust fixed sizes according to fit type","suites":["calculateImageSizes (fullWidth & constrained)"],"updatePoint":{"line":316,"column":53},"line":316,"code":"  it(`should adjust fixed sizes according to fit type`, () => {\n    const imgDimensions = {\n      width: 2810,\n      height: 1360,\n    }\n\n    const outputPixelDensities = [1]\n\n    const testsCases = [\n      { args: { width: 20, height: 20 }, result: [20, 20] },\n      {\n        args: {\n          width: 20,\n          height: 20,\n          transformOptions: { fit: sharp.fit.fill },\n        },\n        result: [20, 20],\n      },\n      {\n        args: {\n          width: 20,\n          height: 20,\n          transformOptions: { fit: sharp.fit.inside },\n        },\n        result: [20, 10],\n      },\n      {\n        args: {\n          width: 20,\n          height: 20,\n          transformOptions: { fit: sharp.fit.outside },\n        },\n        result: [41, 20],\n      },\n      { args: { width: 200, height: 200 }, result: [200, 200] },\n      {\n        args: {\n          width: 200,\n          height: 200,\n          transformOptions: { fit: sharp.fit.fill },\n        },\n        result: [200, 200],\n      },\n      {\n        args: {\n          width: 200,\n          height: 200,\n          transformOptions: { fit: sharp.fit.inside },\n        },\n        result: [200, 97],\n      },\n      {\n        args: {\n          width: 200,\n          height: 200,\n          transformOptions: { fit: sharp.fit.outside },\n        },\n        result: [413, 200],\n      },\n    ]\n    testsCases.forEach(({ args, result }) => {\n      const { presentationWidth, presentationHeight } = calculateImageSizes({\n        ...args,\n        file,\n        outputPixelDensities,\n        reporter,\n        imgDimensions,\n        layout: `fixed`,\n      })\n      expect([presentationWidth, presentationHeight]).toEqual(result)\n    })\n  })","file":"utils.js","skipped":false,"dir":"packages/gatsby-plugin-sharp/src/__tests__"},{"name":"should succeed with default options","suites":["gatsby-plugin-sitemap Node API"],"updatePoint":{"line":24,"column":41,"index":617},"line":24,"code":"  it(`should succeed with default options`, async () => {\n    const graphql = jest.fn();\n    graphql.mockResolvedValue({\n      data: {\n        site: {\n          siteMetadata: {\n            siteUrl: `http://dummy.url`\n          }\n        },\n        allSitePage: {\n          nodes: [{\n            path: `/page-1`\n          }, {\n            path: `/page-2`\n          }]\n        }\n      }\n    });\n    await onPostBuild({\n      graphql,\n      pathPrefix,\n      reporter\n    }, await schema.validateAsync({}));\n    const {\n      destinationDir,\n      sourceData\n    } = sitemap.simpleSitemapAndIndex.mock.calls[0][0];\n    expect(destinationDir).toEqual(path.join(`public`, `/`));\n    expect(sourceData).toMatchSnapshot();\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"should accept a custom query","suites":["gatsby-plugin-sitemap Node API"],"updatePoint":{"line":54,"column":34,"index":1332},"line":54,"code":"  it(`should accept a custom query`, async () => {\n    const graphql = jest.fn();\n    const siteUrl = `http://dummy.url`;\n    graphql.mockResolvedValue({\n      data: {\n        allSitePage: {\n          edges: [{\n            node: {\n              path: `/page-1`\n            }\n          }, {\n            node: {\n              path: `/post/exclude-page`\n            }\n          }]\n        }\n      }\n    });\n    const customQuery = `\n      {\n        allSitePage {\n          edges {\n            node {\n              path\n            }\n          }\n        }\n    }`;\n    const options = {\n      output: `custom-folder`,\n      resolveSiteUrl: () => siteUrl,\n      resolvePages: data => data.allSitePage.edges.map(edge => edge.node),\n      serialize: (page, {\n        resolvePagePath\n      }) => {\n        return {\n          url: resolvePagePath(page),\n          changefreq: `weekly`,\n          priority: 0.8\n        };\n      },\n      excludes: [`/post/exclude-page`],\n      query: customQuery\n    };\n    await onPostBuild({\n      graphql,\n      pathPrefix,\n      reporter\n    }, await schema.validateAsync(options));\n    const {\n      destinationDir,\n      sourceData\n    } = sitemap.simpleSitemapAndIndex.mock.calls[0][0];\n    expect(destinationDir).toEqual(path.join(`public`, `custom-folder`));\n    expect(sourceData).toMatchSnapshot();\n    expect(graphql).toBeCalledWith(customQuery);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"should include path prefix when creating creating index sitemap","suites":["gatsby-plugin-sitemap Node API"],"updatePoint":{"line":111,"column":69,"index":2754},"line":111,"code":"  it(`should include path prefix when creating creating index sitemap`, async () => {\n    const graphql = jest.fn();\n    graphql.mockResolvedValue({\n      data: {\n        site: {\n          siteMetadata: {\n            siteUrl: `http://dummy.url`\n          }\n        },\n        allSitePage: {\n          nodes: [{\n            path: `/page-1`\n          }, {\n            path: `/page-2`\n          }]\n        }\n      }\n    });\n    const options = {\n      entryLimit: 1\n    };\n    const assetPrefix = `https://cdn.example.com`;\n    const prefix = `/test`;\n    await onPostBuild({\n      graphql,\n      basePath: prefix,\n      pathPrefix: `${assetPrefix}${prefix}`,\n      reporter\n    }, await schema.validateAsync(options));\n    const {\n      sourceData\n    } = sitemap.simpleSitemapAndIndex.mock.calls[0][0];\n    sourceData.forEach(page => {\n      expect(page.url).toEqual(expect.stringContaining(prefix));\n      expect(page.url).not.toEqual(expect.stringContaining(assetPrefix));\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"should output modified paths to sitemap","suites":["gatsby-plugin-sitemap Node API"],"updatePoint":{"line":148,"column":45,"index":3718},"line":148,"code":"  it(`should output modified paths to sitemap`, async () => {\n    const graphql = jest.fn();\n    graphql.mockResolvedValue({\n      data: {\n        site: {\n          siteMetadata: {\n            siteUrl: `http://dummy.url`\n          }\n        },\n        allSitePage: {\n          nodes: [{\n            path: `/page-1`\n          }, {\n            path: `/page-2`\n          }]\n        }\n      }\n    });\n    const prefix = `/test`;\n    const subdir = `/subdir`;\n    const options = {\n      output: subdir\n    };\n    await onPostBuild({\n      graphql,\n      pathPrefix: prefix,\n      reporter\n    }, await schema.validateAsync(options));\n    expect(sitemap.simpleSitemapAndIndex.mock.calls[0][0].publicBasePath).toBe(path.posix.join(prefix, subdir));\n    expect(sitemap.simpleSitemapAndIndex.mock.calls[0][0].destinationDir).toBe(path.join(`public`, subdir));\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"should create a Link if createLinkInHead is true","suites":["gatsby-plugin-sitemap SSR API"],"updatePoint":{"line":12,"column":54,"index":342},"line":12,"code":"  it(`should create a Link if createLinkInHead is true`, async () => {\n    const pluginOptions = {\n      createLinkInHead: true,\n      output: `test-folder`\n    };\n    const setHeadComponents = jest.fn();\n    await onRenderBody({\n      setHeadComponents\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"should create a Link in root when output is \"/\"","suites":["gatsby-plugin-sitemap SSR API"],"updatePoint":{"line":24,"column":53,"index":729},"line":24,"code":"  it(`should create a Link in root when output is \"/\"`, async () => {\n    const pluginOptions = {\n      createLinkInHead: true,\n      output: `/`\n    };\n    const setHeadComponents = jest.fn();\n    await onRenderBody({\n      setHeadComponents\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"should not create Link if createLinkInHead is false","suites":["gatsby-plugin-sitemap SSR API"],"updatePoint":{"line":36,"column":57,"index":1110},"line":36,"code":"  it(`should not create Link if createLinkInHead is false`, async () => {\n    const pluginOptions = {\n      createLinkInHead: false,\n      output: `test-folder`\n    };\n    const setHeadComponents = jest.fn();\n    await onRenderBody({\n      setHeadComponents\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(0);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"creates Link href with path prefix when __PATH_PREFIX__ sets","suites":["gatsby-plugin-sitemap SSR API"],"updatePoint":{"line":48,"column":66,"index":1511},"line":48,"code":"  it(`creates Link href with path prefix when __PATH_PREFIX__ sets`, async () => {\n    global.__PATH_PREFIX__ = `/hogwarts`;\n    const pluginOptions = {\n      createLinkInHead: true,\n      output: `test-folder`\n    };\n    const setHeadComponents = jest.fn();\n    await onRenderBody({\n      setHeadComponents\n    }, pluginOptions);\n    expect(setHeadComponents).toMatchSnapshot();\n    expect(setHeadComponents).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"withoutTrailingSlash should correct paths without final slash","suites":["gatsby-plugin-sitemap internals tests"],"updatePoint":{"line":18,"column":67,"index":467},"line":18,"code":"  it(`withoutTrailingSlash should correct paths without final slash`, () => {\n    const result = withoutTrailingSlash(`/`);\n    expect(result).toEqual(`/`);\n    const result2 = withoutTrailingSlash(TestPath);\n    expect(result2).toStrictEqual(`/test/path`);\n  });","file":"internals.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"prefixPath should correctly concatonate path","suites":["gatsby-plugin-sitemap internals tests"],"updatePoint":{"line":24,"column":50,"index":714},"line":24,"code":"  it(`prefixPath should correctly concatonate path`, () => {\n    const result = prefixPath({\n      url: TestPath,\n      siteUrl: SiteUrl,\n      pathPrefix: `/root`\n    });\n    expect(result).toStrictEqual(`https://example.net/root/test/path/`);\n  });","file":"internals.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"resolveSiteUrl should return SiteUrl","suites":["gatsby-plugin-sitemap internals tests"],"updatePoint":{"line":32,"column":42,"index":957},"line":32,"code":"  it(`resolveSiteUrl should return SiteUrl`, () => {\n    const result = resolveSiteUrl({\n      site: {\n        siteMetadata: {\n          siteUrl: SiteUrl\n        }\n      }\n    });\n    expect(result).toStrictEqual(SiteUrl);\n  });","file":"internals.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"resolvePagePath should return TestPath","suites":["gatsby-plugin-sitemap internals tests"],"updatePoint":{"line":42,"column":44,"index":1188},"line":42,"code":"  it(`resolvePagePath should return TestPath`, () => {\n    const result = resolvePagePath({\n      path: TestPath\n    });\n    expect(result).toStrictEqual(TestPath);\n  });","file":"internals.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"resolvePages should return sample pages","suites":["gatsby-plugin-sitemap internals tests"],"updatePoint":{"line":48,"column":45,"index":1360},"line":48,"code":"  it(`resolvePages should return sample pages`, () => {\n    const pages = [{\n      path: `/page-1/`\n    }, {\n      path: `/page-2/`\n    }];\n    const result = resolvePages({\n      allSitePage: {\n        nodes: pages\n      }\n    });\n    expect(result).toEqual(pages);\n  });","file":"internals.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"defaultFilterPages correctly detects path","suites":["gatsby-plugin-sitemap internals tests"],"updatePoint":{"line":61,"column":47,"index":1635},"line":61,"code":"  it(`defaultFilterPages correctly detects path`, () => {\n    const page = {\n      path: TestPath\n    };\n    const result = defaultFilterPages(page, `/another/path/`, {\n      resolvePagePath,\n      minimatch,\n      withoutTrailingSlash\n    });\n    expect(result).toStrictEqual(false);\n    const result2 = defaultFilterPages(page, TestPath, {\n      resolvePagePath,\n      minimatch,\n      withoutTrailingSlash\n    });\n    expect(result2).toStrictEqual(true);\n  });","file":"internals.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"serialize should create expected object","suites":["gatsby-plugin-sitemap internals tests"],"updatePoint":{"line":78,"column":45,"index":2097},"line":78,"code":"  it(`serialize should create expected object`, () => {\n    const page = {\n      path: TestPath\n    };\n    const result = serialize(page, {\n      resolvePagePath\n    });\n    expect(result).toEqual({\n      url: TestPath,\n      changefreq: `daily`,\n      priority: 0.7\n    });\n  });","file":"internals.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"pageFilter should filter correctly","suites":["gatsby-plugin-sitemap internals tests"],"updatePoint":{"line":91,"column":40,"index":2373},"line":91,"code":"  it(`pageFilter should filter correctly`, () => {\n    const {\n      filteredPages: results\n    } = pageFilter({\n      allPages: [{\n        path: `/404.html`\n      }, {\n        path: `/to/be/removed`\n      }, {\n        path: `/to/keep/1`\n      }, {\n        path: `/to/keep/2`\n      }],\n      filterPages: defaultFilterPages,\n      excludes: [`/to/be/removed/`]\n    });\n    expect(results).toMatchSnapshot();\n  });","file":"internals.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"pageFilter should filter correctly on consecutive runs","suites":["gatsby-plugin-sitemap internals tests"],"updatePoint":{"line":109,"column":60,"index":2807},"line":109,"code":"  it(`pageFilter should filter correctly on consecutive runs`, () => {\n    const allPages = [{\n      path: `/to/keep/1`\n    }, {\n      path: `/to/keep/2`\n    }, {\n      path: `/404.html`\n    }];\n    const filterPages = jest.fn();\n    const {\n      filteredPages\n    } = pageFilter({\n      allPages,\n      filterPages,\n      excludes: []\n    });\n    expect(filteredPages).toHaveLength(2);\n    expect(filteredPages).not.toContainEqual({\n      path: `/404.html`\n    });\n    const {\n      filteredPages: filteredPages2\n    } = pageFilter({\n      allPages,\n      filterPages,\n      excludes: []\n    });\n    expect(filteredPages2).toHaveLength(2);\n    expect(filteredPages2).not.toContainEqual({\n      path: `/404.html`\n    });\n  });","file":"internals.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"should provide meaningful errors when fields are invalid","suites":["pluginOptionsSchema"],"updatePoint":{"line":4,"column":62,"index":232},"line":4,"code":"  it(`should provide meaningful errors when fields are invalid`, async () => {\n    const expectedErrors = [`\"output\" must be a string`];\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      output: 123\n    });\n    expect(isValid).toBe(false);\n    expect(errors).toEqual(expectedErrors);\n  });","file":"options-validation.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"should provide warning for deprecated \"exclude\" option","suites":["pluginOptionsSchema"],"updatePoint":{"line":15,"column":60,"index":577},"line":15,"code":"  it(`should provide warning for deprecated \"exclude\" option`, async () => {\n    const expectedWarnings = [`\"exclude\" is not allowed`];\n    const {\n      warnings,\n      hasWarnings\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      exclude: [`test`]\n    });\n    expect(hasWarnings).toBe(true);\n    expect(warnings).toEqual(expectedWarnings);\n  });","file":"options-validation.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"creates correct defaults","suites":["pluginOptionsSchema"],"updatePoint":{"line":26,"column":30,"index":912},"line":26,"code":"  it(`creates correct defaults`, async () => {\n    const pluginOptions = await pluginOptionsSchema({\n      Joi\n    }).validateAsync({});\n    expect(pluginOptions).toMatchInlineSnapshot(`\n      Object {\n        \"createLinkInHead\": true,\n        \"entryLimit\": 45000,\n        \"excludes\": Array [],\n        \"filterPages\": [Function],\n        \"output\": \"/\",\n        \"query\": \"{ site { siteMetadata { siteUrl } } allSitePage { nodes { path } } }\",\n        \"resolvePagePath\": [Function],\n        \"resolvePages\": [Function],\n        \"resolveSiteUrl\": [Function],\n        \"serialize\": [Function],\n      }\n    `);\n  });","file":"options-validation.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"should validate the schema: $options","suites":["pluginOptionsSchema"],"line":45,"code":"  it.each`\n    options\n    ${undefined}\n    ${{}}\n  `(`should validate the schema: $options`, async ({\n    options\n  }) => {\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, options);\n    expect(isValid).toBe(true);\n  });","file":"options-validation.js","skipped":false,"dir":"packages/gatsby-plugin-sitemap/src/__tests__"},{"name":"Stage:  / ","suites":["gatsby-plugin-stylus"],"updatePoint":{"line":48,"column":36,"index":1302},"line":48,"code":"      it(`Stage: ${stage} / ${label}`, () => {\n        onCreateWebpackConfig({\n          actions,\n          loaders,\n          stage\n        }, options);\n        expect(actions.setWebpackConfig).toMatchSnapshot();\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-stylus/src/__tests__"},{"name":"injects the twitter script if it hasn't already been injected","suites":["gatsby-plugin-twitter","onRouteUpdate"],"updatePoint":{"line":10,"column":69,"index":242},"line":10,"code":"    it(`injects the twitter script if it hasn't already been injected`, () => {\n      const querySelector = jest.spyOn(document, `querySelector`);\n      const createElement = jest.spyOn(document, `createElement`);\n      const getElementsByTagName = jest.spyOn(document, `getElementsByTagName`);\n      const element = {};\n      querySelector.mockReturnValue(true);\n      createElement.mockReturnValueOnce(element);\n      getElementsByTagName.mockReturnValue([{\n        appendChild: jest.fn()\n      }]);\n      global.twttr = {\n        widgets: {\n          load: jest.fn()\n        }\n      };\n      onRouteUpdate();\n      onRouteUpdate();\n      expect(element).toMatchSnapshot();\n      expect(createElement).toHaveBeenCalledTimes(1);\n      expect(global.twttr.widgets.load).toHaveBeenCalledTimes(2);\n    });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-twitter/src/__tests__"},{"name":"only injects the twitter script if there is an embedded tweet","suites":["gatsby-plugin-twitter","onRouteUpdate"],"updatePoint":{"line":31,"column":69,"index":1046},"line":31,"code":"    it(`only injects the twitter script if there is an embedded tweet`, () => {\n      const querySelector = jest.spyOn(document, `querySelector`);\n      querySelector.mockReturnValue(null);\n      global.twttr = {\n        widgets: {\n          load: jest.fn()\n        }\n      };\n      onRouteUpdate();\n      expect(global.twttr.widgets.load).not.toHaveBeenCalled();\n    });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-twitter/src/__tests__"},{"name":"should provide meaningful errors when fields are invalid","suites":[],"updatePoint":{"line":3,"column":60,"index":178},"line":3,"code":"it(`should provide meaningful errors when fields are invalid`, async () => {\n  const expectedWarnings = [`\"optionA\" is not allowed`];\n  const {\n    warnings,\n    isValid,\n    hasWarnings\n  } = await testPluginOptionsSchema(pluginOptionsSchema, {\n    optionA: `This options shouldn't exist`\n  });\n  expect(isValid).toBe(true);\n  expect(hasWarnings).toBe(true);\n  expect(warnings).toEqual(expectedWarnings);\n});","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-twitter/src/__tests__"},{"name":"should validate the schema: $options","suites":[],"line":16,"code":"it.each`\n  options\n  ${undefined}\n  ${{}}\n`(`should validate the schema: $options`, async ({\n  options\n}) => {\n  const {\n    isValid,\n    errors\n  } = await testPluginOptionsSchema(pluginOptionsSchema, options);\n  expect(isValid).toBe(true);\n  expect(errors).toEqual([]);\n});","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-twitter/src/__tests__"},{"name":"returns the correct resolvable extensions","suites":["gatsby-plugin-typescript","resolvableExtensions"],"updatePoint":{"line":15,"column":49,"index":409},"line":15,"code":"    it(`returns the correct resolvable extensions`, () => {\n      expect(resolvableExtensions()).toEqual([`.ts`, `.tsx`]);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-typescript/src/__tests__"},{"name":"sets the correct babel preset and plugin","suites":["gatsby-plugin-typescript","onCreateBabelConfig"],"updatePoint":{"line":20,"column":48,"index":587},"line":20,"code":"    it(`sets the correct babel preset and plugin`, () => {\n      const actions = {\n        setBabelPreset: jest.fn(),\n        setBabelPlugin: jest.fn()\n      };\n      const options = {\n        isTSX: true,\n        jsxPragma: `jsx`,\n        allExtensions: true\n      };\n      onCreateBabelConfig({\n        actions\n      }, options);\n      expect(actions.setBabelPreset).toHaveBeenCalledWith({\n        name: expect.stringContaining(path.join(`@babel`, `preset-typescript`)),\n        options\n      });\n      expect(actions.setBabelPlugin).toHaveBeenCalledTimes(3);\n      expect(actions.setBabelPlugin).toHaveBeenCalledWith({\n        name: expect.stringContaining(path.join(`@babel`, `plugin-proposal-optional-chaining`))\n      });\n      expect(actions.setBabelPlugin).toHaveBeenCalledWith({\n        name: expect.stringContaining(path.join(`@babel`, `plugin-proposal-nullish-coalescing-operator`))\n      });\n      expect(actions.setBabelPlugin).toHaveBeenCalledWith({\n        name: expect.stringContaining(path.join(`@babel`, `plugin-proposal-numeric-separator`))\n      });\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-typescript/src/__tests__"},{"name":"sets the correct webpack config","suites":["gatsby-plugin-typescript","onCreateWebpackConfig"],"updatePoint":{"line":50,"column":39,"index":1706},"line":50,"code":"    it(`sets the correct webpack config`, () => {\n      const actions = {\n        setWebpackConfig: jest.fn()\n      };\n      const loaders = {\n        js: jest.fn(() => {})\n      };\n      onCreateWebpackConfig({\n        actions,\n        loaders\n      });\n      expect(actions.setWebpackConfig).toHaveBeenCalledWith({\n        module: {\n          rules: [{\n            test: /\\.tsx?$/,\n            use: expect.toBeFunction()\n          }]\n        }\n      });\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-typescript/src/__tests__"},{"name":"does not set the webpack config if there isn't a js loader","suites":["gatsby-plugin-typescript","onCreateWebpackConfig"],"updatePoint":{"line":70,"column":66,"index":2197},"line":70,"code":"    it(`does not set the webpack config if there isn't a js loader`, () => {\n      const actions = {\n        setWebpackConfig: jest.fn()\n      };\n      const loaders = {\n        js: undefined\n      };\n      onCreateWebpackConfig({\n        actions,\n        loaders\n      });\n      expect(actions.setWebpackConfig).not.toHaveBeenCalled();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-typescript/src/__tests__"},{"name":"should provide meaningful errors when fields are invalid","suites":["gatsby-plugin-typescript","plugin schema"],"updatePoint":{"line":85,"column":64,"index":2582},"line":85,"code":"    it(`should provide meaningful errors when fields are invalid`, async () => {\n      const expectedErrors = [`\"isTSX\" must be a boolean`, `\"jsxPragma\" must be a string`, `\"allExtensions\" must be a boolean`];\n      const {\n        isValid,\n        errors\n      } = await testPluginOptionsSchema(pluginOptionsSchema, {\n        isTSX: `this should be a boolean`,\n        jsxPragma: 123,\n        allExtensions: `this should be a boolean`\n      });\n      expect(isValid).toBe(false);\n      expect(errors).toEqual(expectedErrors);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-typescript/src/__tests__"},{"name":"should validate the schema","suites":["gatsby-plugin-typescript","plugin schema"],"updatePoint":{"line":98,"column":34,"index":3087},"line":98,"code":"    it(`should validate the schema`, async () => {\n      const {\n        isValid,\n        errors\n      } = await testPluginOptionsSchema(pluginOptionsSchema, {\n        isTSX: false,\n        jsxPragma: `ReactFunction`,\n        allExtensions: false,\n        allowNamespaces: false,\n        allowDeclareFields: false,\n        onlyRemoveTypeImports: false\n      });\n      expect(isValid).toBe(true);\n      expect(errors).toEqual([]);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-typescript/src/__tests__"},{"name":"should break when isTSX doesn't match allExtensions","suites":["gatsby-plugin-typescript","plugin schema"],"updatePoint":{"line":113,"column":59,"index":3550},"line":113,"code":"    it(`should break when isTSX doesn't match allExtensions`, async () => {\n      const expectedErrors = [`\"allExtensions\" must be [true]`];\n      const {\n        isValid,\n        errors\n      } = await testPluginOptionsSchema(pluginOptionsSchema, {\n        isTSX: true,\n        jsxPragma: `ReactFunction`,\n        allExtensions: false\n      });\n      expect(isValid).toBe(false);\n      expect(errors).toEqual(expectedErrors);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-plugin-typescript/src/__tests__"},{"name":"should render googlefonts","suites":["gatsby-plugin-typography"],"updatePoint":{"line":36,"column":31,"index":851},"line":36,"code":"  it(`should render googlefonts`, () => {\n    const onClientEntry = require(`../gatsby-browser`).onClientEntry;\n    onClientEntry(null, {});\n    const link = document.querySelector(`[data-gatsby-typography]`);\n    expect(link).toBeTruthy();\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-typography/src/__tests__"},{"name":"shouldn't render googlefonts when omitGoogleFonts is true","suites":["gatsby-plugin-typography"],"updatePoint":{"line":42,"column":63,"index":1130},"line":42,"code":"  it(`shouldn't render googlefonts when omitGoogleFonts is true`, () => {\n    const onClientEntry = require(`../gatsby-browser`).onClientEntry;\n    onClientEntry(null, {\n      omitGoogleFont: true\n    });\n    const link = document.querySelector(`[data-gatsby-typography]`);\n    expect(link).toBeNull();\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-typography/src/__tests__"},{"name":"shouldn't render googlefonts when no fonts are set","suites":["gatsby-plugin-typography"],"updatePoint":{"line":50,"column":56,"index":1432},"line":50,"code":"  it(`shouldn't render googlefonts when no fonts are set`, () => {\n    mockTypographyCache([]);\n    const onClientEntry = require(`../gatsby-browser`).onClientEntry;\n    onClientEntry(null, {});\n    const link = document.querySelector(`[data-gatsby-typography]`);\n    expect(link).toBeNull();\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-plugin-typography/src/__tests__"},{"name":"invokes setHeadComponents with array of typography components","suites":["onRenderBody"],"updatePoint":{"line":20,"column":67,"index":597},"line":20,"code":"  it(`invokes setHeadComponents with array of typography components`, () => {\n    const api = setup();\n    expect(api.setHeadComponents).toHaveBeenCalledWith([expect.objectContaining({\n      key: `TypographyStyle`\n    }), expect.objectContaining({\n      key: `GoogleFont`\n    })]);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-typography/src/__tests__"},{"name":"does not add google font if omitGoogleFont is passed","suites":["onRenderBody"],"updatePoint":{"line":28,"column":58,"index":876},"line":28,"code":"  it(`does not add google font if omitGoogleFont is passed`, () => {\n    const api = setup({\n      omitGoogleFont: true\n    });\n    expect(api.setHeadComponents).toHaveBeenCalledWith([expect.objectContaining({\n      key: `TypographyStyle`\n    })]);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-typography/src/__tests__"},{"name":"reorders typography-js first","suites":["onPreRenderHTML"],"updatePoint":{"line":46,"column":34,"index":1349},"line":46,"code":"  it(`reorders typography-js first`, () => {\n    const spies = setup([{\n      key: `link-1234`\n    }, {\n      key: `link-preload`\n    }, {\n      key: `TypographyStyle`\n    }]);\n    expect(spies.replaceHeadComponents).toHaveBeenCalledTimes(1);\n    expect(spies.replaceHeadComponents).toHaveBeenCalledWith(expect.arrayContaining([{\n      key: `TypographyStyle`\n    }]));\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-typography/src/__tests__"},{"name":"leaves non-typography head components as-is","suites":["onPreRenderHTML"],"updatePoint":{"line":59,"column":49,"index":1739},"line":59,"code":"  it(`leaves non-typography head components as-is`, () => {\n    const components = [{\n      key: `link-1234`\n    }, {\n      key: `link-preload`\n    }, {\n      key: `_____01234_____`\n    }];\n    const spies = setup(clone(components));\n    expect(spies.replaceHeadComponents).toHaveBeenCalledWith(components);\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-typography/src/__tests__"},{"name":"does not fail when head components include null","suites":["onPreRenderHTML"],"updatePoint":{"line":70,"column":53,"index":2057},"line":70,"code":"  it(`does not fail when head components include null`, () => {\n    const components = [{\n      key: `link-1234`\n    }, {\n      key: `link-preload`\n    }, {\n      key: `_____01234_____`\n    }, null];\n    const spies = setup(clone(components));\n    expect(spies.replaceHeadComponents).toHaveBeenCalledWith(components);\n    expect(spies.replaceHeadComponents).toHaveReturned();\n  });","file":"gatsby-ssr.js","skipped":false,"dir":"packages/gatsby-plugin-typography/src/__tests__"},{"name":"should return true if gatsby has the feature","suites":["hasFeature"],"updatePoint":{"line":9,"column":50},"line":9,"code":"  it(`should return true if gatsby has the feature`, () => {\n    apis.features = [`image-service`]\n    expect(hasFeature(`image-service`)).toBe(true)\n  })","file":"has-feature.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"should return false if the feature has a typo","suites":["hasFeature"],"updatePoint":{"line":13,"column":51},"line":13,"code":"  it(`should return false if the feature has a typo`, () => {\n    apis.features = [`image-service`]\n    expect(hasFeature(`image-services`)).toBe(false)\n  })","file":"has-feature.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"should return false if gatsby doesn't have the feature","suites":["hasFeature"],"updatePoint":{"line":18,"column":60},"line":18,"code":"  it(`should return false if gatsby doesn't have the feature`, () => {\n    apis.features = []\n    expect(hasFeature(`image-service`)).toBe(false)\n  })","file":"has-feature.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"should return false if gatsby doesn't support features section yet","suites":["hasFeature"],"updatePoint":{"line":23,"column":72},"line":23,"code":"  it(`should return false if gatsby doesn't support features section yet`, () => {\n    // @ts-ignore - we want to test old versions too\n    delete apis.features\n    expect(hasFeature(`image-service`)).toBe(false)\n  })","file":"has-feature.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"validates a basic schema","suites":[],"updatePoint":{"line":5,"column":28},"line":5,"code":"it(`validates a basic schema`, async () => {\n  const pluginSchema = Joi.object({\n    str: Joi.string(),\n  })\n\n  const validOptions = {\n    str: `is a string`,\n  }\n\n  const { value } = await validateOptionsSchema(pluginSchema, validOptions)\n  expect(value).toEqual(validOptions)\n\n  const invalid = () =>\n    validateOptionsSchema(pluginSchema, {\n      str: 43,\n    })\n\n  expect(invalid()).rejects.toThrowErrorMatchingInlineSnapshot(\n    `\"\\\\\"str\\\\\" must be a string\"`\n  )\n})","file":"index.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"asynchronously validates the external validation rules","suites":[],"updatePoint":{"line":27,"column":58},"line":27,"code":"it(`asynchronously validates the external validation rules`, () => {\n  const failingAsyncValidationRule = async () => {\n    throw new Error(`This failed for some unknown reason.`)\n  }\n\n  const schema = Joi.object({}).external(failingAsyncValidationRule)\n\n  const invalid = () => validateOptionsSchema(schema, {})\n\n  expect(invalid()).rejects.toThrowErrorMatchingInlineSnapshot(\n    `\"This failed for some unknown reason. (value)\"`\n  )\n})","file":"index.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"does not validate async external validation rules when validateExternalRules is set to false","suites":[],"updatePoint":{"line":41,"column":96},"line":41,"code":"it(`does not validate async external validation rules when validateExternalRules is set to false`, async () => {\n  const failingAsyncValidationRule = async () => {\n    throw new Error(`This failed for some unknown reason.`)\n  }\n\n  const schema = Joi.object({}).external(failingAsyncValidationRule)\n\n  const invalid = () =>\n    validateOptionsSchema(\n      schema,\n      {},\n      {\n        validateExternalRules: false,\n      }\n    )\n\n  expect(invalid).not.toThrowError()\n})","file":"index.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"throws an warning on unknown values","suites":[],"updatePoint":{"line":60,"column":39},"line":60,"code":"it(`throws an warning on unknown values`, async () => {\n  const schema = Joi.object({\n    str: Joi.string(),\n  })\n\n  const validWarnings = [`\"notInSchema\" is not allowed`]\n\n  const { hasWarnings, warnings } = await testPluginOptionsSchema(\n    () => schema,\n    {\n      str: `bla`,\n      notInSchema: true,\n    }\n  )\n\n  expect(hasWarnings).toBe(true)\n  expect(warnings).toEqual(validWarnings)\n})","file":"index.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"populates default values","suites":[],"updatePoint":{"line":79,"column":28},"line":79,"code":"it(`populates default values`, async () => {\n  const pluginSchema = Joi.object({\n    str: Joi.string(),\n    default: Joi.string().default(`default`),\n  })\n\n  const validOptions = {\n    str: `is a string`,\n  }\n\n  const { value } = await validateOptionsSchema(pluginSchema, validOptions)\n  expect(value).toEqual({\n    ...validOptions,\n    default: `default`,\n  })\n})","file":"index.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"returns true for supported API (createSchemaCustomization)","suites":["isGatsbyNodeLifecycleSupported"],"updatePoint":{"line":4,"column":64},"line":4,"code":"  it(`returns true for supported API (createSchemaCustomization)`, () => {\n    expect(isGatsbyNodeLifecycleSupported(`createSchemaCustomization`)).toEqual(\n      true\n    )\n  })","file":"node-api-is-supported.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"returns false for unsupported API (thisIsNotSupported)","suites":["isGatsbyNodeLifecycleSupported"],"updatePoint":{"line":10,"column":60},"line":10,"code":"  it(`returns false for unsupported API (thisIsNotSupported)`, () => {\n    expect(isGatsbyNodeLifecycleSupported(`thisIsNotSupported`)).toEqual(false)\n  })","file":"node-api-is-supported.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"should partially validate one value of a schema","suites":["testPluginOptionsSchema"],"updatePoint":{"line":5,"column":53},"line":5,"code":"  it(`should partially validate one value of a schema`, async () => {\n    const pluginSchema = ({ Joi }): ObjectSchema =>\n      Joi.object({\n        str: Joi.string(),\n        nb: Joi.number(),\n        toVerify: Joi.boolean(),\n      })\n    const expectedErrors = [`\"toVerify\" must be a boolean`]\n\n    const { isValid, errors } = await testPluginOptionsSchema(pluginSchema, {\n      toVerify: `abcd`,\n    })\n\n    expect(isValid).toBe(false)\n    expect(errors).toEqual(expectedErrors)\n  })","file":"test-plugin-options-schema.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"should partially validate multiples value of a schema","suites":["testPluginOptionsSchema"],"updatePoint":{"line":22,"column":59},"line":22,"code":"  it(`should partially validate multiples value of a schema`, async () => {\n    const pluginSchema = ({ Joi }): ObjectSchema =>\n      Joi.object({\n        str: Joi.string(),\n        nb: Joi.number(),\n        toVerify: Joi.boolean(),\n      })\n    const expectedErrors = [\n      `\"nb\" must be a number`,\n      `\"toVerify\" must be a boolean`,\n    ]\n\n    const { isValid, errors } = await testPluginOptionsSchema(pluginSchema, {\n      toVerify: `abcd`,\n      nb: `invalid value`,\n    })\n\n    expect(isValid).toBe(false)\n    expect(errors).toEqual(expectedErrors)\n  })","file":"test-plugin-options-schema.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"should validate half of a real world plugin schema","suites":["testPluginOptionsSchema"],"updatePoint":{"line":43,"column":56},"line":43,"code":"  it(`should validate half of a real world plugin schema`, async () => {\n    const pluginSchema = ({ Joi }): ObjectSchema =>\n      Joi.object({\n        trackingId: Joi.string()\n          .required()\n          .description(\n            `The property ID; the tracking code won't be generated without it`\n          ),\n        head: Joi.boolean()\n          .default(false)\n          .description(\n            `Defines where to place the tracking script - \\`true\\` in the head and \\`false\\` in the body`\n          ),\n        anonymize: Joi.boolean().default(false),\n        respectDNT: Joi.boolean().default(false),\n        exclude: Joi.array()\n          .items(Joi.string())\n          .default([])\n          .description(`Avoids sending pageview hits from custom paths`),\n        pageTransitionDelay: Joi.number()\n          .default(0)\n          .description(\n            `Delays sending pageview hits on route update (in milliseconds)`\n          ),\n        optimizeId: Joi.string().description(\n          `Enables Google Optimize using your container Id`\n        ),\n        experimentId: Joi.string().description(\n          `Enables Google Optimize Experiment ID`\n        ),\n        variationId: Joi.string().description(\n          `Set Variation ID. 0 for original 1,2,3....`\n        ),\n        defer: Joi.boolean().description(\n          `Defers execution of google analytics script after page load`\n        ),\n        sampleRate: Joi.number(),\n        siteSpeedSampleRate: Joi.number(),\n        cookieDomain: Joi.string(),\n      })\n    const expectedErrors = [\n      `\"trackingId\" is required`,\n      `\"head\" must be a boolean`,\n      `\"anonymize\" must be a boolean`,\n      `\"respectDNT\" must be a boolean`,\n      `\"exclude[0]\" must be a string`,\n      `\"exclude[1]\" must be a string`,\n      `\"exclude[2]\" must be a string`,\n    ]\n\n    const { isValid, errors } = await testPluginOptionsSchema(pluginSchema, {\n      trackingId: undefined,\n      head: `invalid boolean value`,\n      anonymize: `invalid boolean value`,\n      respectDNT: `invalid boolean value`,\n      exclude: [0, 1, 2],\n    })\n\n    expect(isValid).toBe(false)\n    expect(errors).toEqual(expectedErrors)\n  })","file":"test-plugin-options-schema.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"should validate an entire real world plugin schema","suites":["testPluginOptionsSchema"],"updatePoint":{"line":105,"column":56},"line":105,"code":"  it(`should validate an entire real world plugin schema`, async () => {\n    const pluginSchema = ({ Joi }): ObjectSchema =>\n      Joi.object({\n        trackingId: Joi.string()\n          .required()\n          .description(\n            `The property ID; the tracking code won't be generated without it`\n          ),\n        head: Joi.boolean()\n          .default(false)\n          .description(\n            `Defines where to place the tracking script - \\`true\\` in the head and \\`false\\` in the body`\n          ),\n        anonymize: Joi.boolean().default(false),\n        respectDNT: Joi.boolean().default(false),\n        exclude: Joi.array()\n          .items(Joi.string())\n          .default([])\n          .description(`Avoids sending pageview hits from custom paths`),\n        pageTransitionDelay: Joi.number()\n          .default(0)\n          .description(\n            `Delays sending pageview hits on route update (in milliseconds)`\n          ),\n        optimizeId: Joi.string().description(\n          `Enables Google Optimize using your container Id`\n        ),\n        experimentId: Joi.string().description(\n          `Enables Google Optimize Experiment ID`\n        ),\n        variationId: Joi.string().description(\n          `Set Variation ID. 0 for original 1,2,3....`\n        ),\n        defer: Joi.boolean().description(\n          `Defers execution of google analytics script after page load`\n        ),\n        sampleRate: Joi.number(),\n        siteSpeedSampleRate: Joi.number(),\n        cookieDomain: Joi.string(),\n      })\n    const expectedErrors = [\n      `\"trackingId\" is required`,\n      `\"head\" must be a boolean`,\n      `\"anonymize\" must be a boolean`,\n      `\"respectDNT\" must be a boolean`,\n      `\"exclude[0]\" must be a string`,\n      `\"exclude[1]\" must be a string`,\n      `\"exclude[2]\" must be a string`,\n      `\"pageTransitionDelay\" must be a number`,\n      `\"optimizeId\" must be a string`,\n      `\"experimentId\" must be a string`,\n      `\"variationId\" must be a string`,\n      `\"defer\" must be a boolean`,\n      `\"sampleRate\" must be a number`,\n      `\"siteSpeedSampleRate\" must be a number`,\n      `\"cookieDomain\" must be a string`,\n    ]\n\n    const { isValid, errors } = await testPluginOptionsSchema(pluginSchema, {\n      trackingId: undefined,\n      head: `invalid boolean value`,\n      anonymize: `invalid boolean value`,\n      respectDNT: `invalid boolean value`,\n      exclude: [0, 1, 2],\n      pageTransitionDelay: `invalid number value`,\n      optimizeId: 123,\n      experimentId: 456,\n      variationId: 789,\n      defer: `invalid boolean value`,\n      sampleRate: `invalid number value`,\n      siteSpeedSampleRate: `invalid number value`,\n      cookieDomain: 9797,\n    })\n\n    expect(isValid).toBe(false)\n    expect(errors).toEqual(expectedErrors)\n  })","file":"test-plugin-options-schema.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"should check the validity of a schema","suites":["testPluginOptionsSchema"],"updatePoint":{"line":183,"column":43},"line":183,"code":"  it(`should check the validity of a schema`, async () => {\n    const pluginSchema = ({ Joi }): ObjectSchema =>\n      Joi.object({\n        toVerify: Joi.boolean(),\n      })\n\n    const { isValid, errors } = await testPluginOptionsSchema(pluginSchema, {\n      toVerify: false,\n    })\n\n    expect(isValid).toBe(true)\n    expect(errors).toEqual([])\n  })","file":"test-plugin-options-schema.ts","skipped":false,"dir":"packages/gatsby-plugin-utils/src/__tests__"},{"name":"Handles different scroll positions on pages with key of \\`initial\\`","suites":["SessionStorage"],"updatePoint":{"line":9,"column":73},"line":9,"code":"  it(`Handles different scroll positions on pages with key of \\`initial\\``, () => {\n    const inst = new SessionStorage()\n    const key = `initial`\n    const fooLocation = parsePath(`/foo`)\n    const barLocation = parsePath(`/bar`)\n    inst.save(\n      {\n        ...fooLocation,\n        hash: ``,\n        search: ``,\n      } as Path,\n      key,\n      100\n    )\n    inst.save(\n      {\n        ...barLocation,\n        hash: ``,\n        search: ``,\n      } as Path,\n      key,\n      0\n    )\n    expect(inst.read(fooLocation as Path, key)).toBe(100)\n    expect(inst.read(barLocation as Path, key)).toBe(0)\n  })","file":"session-storage.ts","skipped":false,"dir":"packages/gatsby-react-router-scroll/src/__tests__"},{"name":"should validate a valid config","suites":["pluginOptionsSchema"],"updatePoint":{"line":8,"column":36,"index":208},"line":8,"code":"  it(`should validate a valid config`, async () => {\n    // Only the \"toVerify\" key of the schema will be verified in this test\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      offsetY: 100,\n      icon: `<svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>`,\n      className: `custom-class`,\n      maintainCase: true,\n      removeAccents: true,\n      isIconAfterHeader: true,\n      elements: [`h1`, `h4`]\n    });\n    expect(isValid).toBe(true);\n    expect(errors).toEqual([]);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"should validate a boolean icon","suites":["pluginOptionsSchema"],"updatePoint":{"line":25,"column":36,"index":1155},"line":25,"code":"  it(`should validate a boolean icon`, async () => {\n    // Only the \"toVerify\" key of the schema will be verified in this test\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      icon: false\n    });\n    expect(isValid).toBe(true);\n    expect(errors).toEqual([]);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"should invalidate an invalid config","suites":["pluginOptionsSchema"],"updatePoint":{"line":36,"column":41,"index":1485},"line":36,"code":"  it(`should invalidate an invalid config`, async () => {\n    const expectedErrors = [`\"offsetY\" must be a number`, `\"icon\" must be one of [string, boolean]`, `\"className\" must be a string`, `\"maintainCase\" must be a boolean`, `\"removeAccents\" must be a boolean`, `\"isIconAfterHeader\" must be a boolean`, `\"elements[0]\" must be a string`, `\"elements[1]\" must be a string`];\n\n    // Only the \"toVerify\" key of the schema will be verified in this test\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      offsetY: `string`,\n      icon: 1000,\n      className: true,\n      maintainCase: `bla`,\n      removeAccents: `yes`,\n      isIconAfterHeader: `yes`,\n      elements: [1, 2]\n    });\n    expect(isValid).toBe(false);\n    expect(errors).toEqual(expectedErrors);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"adds id to a markdown header","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":11,"column":34,"index":351},"line":11,"code":"  it(`adds id to a markdown header`, () => {\n    const markdownAST = remark.parse(`# Heading Uno`);\n    const transformed = plugin({\n      markdownAST\n    }, {});\n    visit(transformed, `heading`, node => {\n      expect(node.data.id).toBeDefined();\n      expect(node).toMatchSnapshot();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"adds ids to each markdown header","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":21,"column":38,"index":656},"line":21,"code":"  it(`adds ids to each markdown header`, () => {\n    const markdownAST = remark.parse(`\n# Heading One\n\n## Heading Two\n\n### Heading Three\n    `);\n    const transformed = plugin({\n      markdownAST\n    }, {});\n    visit(transformed, `heading`, node => {\n      expect(node.data.id).toBeDefined();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"adds id to a markdown header with custom svg icon","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":36,"column":55,"index":981},"line":36,"code":"  it(`adds id to a markdown header with custom svg icon`, () => {\n    const markdownAST = remark.parse(`# Heading Uno`);\n    const icon = `<svg width=\"400\" height=\"110\"><rect width=\"300\" height=\"100\" /></svg>`;\n    const transformed = plugin({\n      markdownAST\n    }, {\n      icon\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data.id).toBeDefined();\n      expect(node).toMatchSnapshot();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"adds ids to each markdown header with custom svg icon","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":49,"column":59,"index":1413},"line":49,"code":"  it(`adds ids to each markdown header with custom svg icon`, () => {\n    const markdownAST = remark.parse(`\n# Heading One\n\n## Heading Two\n\n### Heading Three\n    `);\n    const icon = `<svg width=\"400\" height=\"110\"><rect width=\"300\" height=\"100\" /></svg>`;\n    const transformed = plugin({\n      markdownAST\n    }, {\n      icon\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data.id).toBeDefined();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"adds id to a markdown header with custom class","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":67,"column":52,"index":1841},"line":67,"code":"  it(`adds id to a markdown header with custom class`, () => {\n    const markdownAST = remark.parse(`# Heading Uno`);\n    const className = `custom-class`;\n    const transformed = plugin({\n      markdownAST\n    }, {\n      className\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data.id).toBeDefined();\n      expect(node).toMatchSnapshot();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"adds ids to each markdown header with custom class","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":80,"column":56,"index":2223},"line":80,"code":"  it(`adds ids to each markdown header with custom class`, () => {\n    const markdownAST = remark.parse(`\n# Heading One\n\n## Heading Two\n\n### Heading Three\n    `);\n    const className = `custom-class`;\n    const transformed = plugin({\n      markdownAST\n    }, {\n      className\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data.id).toBeDefined();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"adds id to a markdown header with no icon","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":98,"column":47,"index":2599},"line":98,"code":"  it(`adds id to a markdown header with no icon`, () => {\n    const markdownAST = remark.parse(`# Heading Uno`);\n    const icon = false;\n    const transformed = plugin({\n      markdownAST\n    }, {\n      icon\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data.id).toBeDefined();\n      expect(node).toMatchSnapshot();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"adds ids to each markdown header with no icon","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":111,"column":51,"index":2957},"line":111,"code":"  it(`adds ids to each markdown header with no icon`, () => {\n    const markdownAST = remark.parse(`\n# Heading One\n\n## Heading Two\n\n### Heading Three\n    `);\n    const icon = false;\n    const transformed = plugin({\n      markdownAST\n    }, {\n      icon\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data.id).toBeDefined();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"maintain case of markdown header for id","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":129,"column":45,"index":3312},"line":129,"code":"  it(`maintain case of markdown header for id`, () => {\n    const markdownAST = remark.parse(`\n# Heading One\n\n## Heading Two\n\n### Heading Three\n    `);\n    const maintainCase = true;\n    const transformed = plugin({\n      markdownAST\n    }, {\n      maintainCase\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data.id).toBeDefined();\n      expect(node).toMatchSnapshot();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"keeps accents by default","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":148,"column":30,"index":3705},"line":148,"code":"  it(`keeps accents by default`, () => {\n    const markdownAST = remark.parse(`\n# Hading One\n\n## Hading Two\n\n### Hading Three\n    `);\n    const removeAccents = false;\n    const transformed = plugin({\n      markdownAST\n    }, {\n      removeAccents\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data.id).toBeDefined();\n      expect(node.data.id).toEqual(expect.stringMatching(/^hading/));\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"remove accents if removeAccents is passed","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":167,"column":47,"index":4151},"line":167,"code":"  it(`remove accents if removeAccents is passed`, () => {\n    const markdownAST = remark.parse(`\n# Hading One\n\n## Hading Two\n\n### Hading Three\n    `);\n    const removeAccents = true;\n    const transformed = plugin({\n      markdownAST\n    }, {\n      removeAccents\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data.id).toBeDefined();\n      expect(node.data.id).toEqual(expect.stringMatching(/^heading/));\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"extracts custom id","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":186,"column":24,"index":4573},"line":186,"code":"  it(`extracts custom id`, () => {\n    const markdownAST = remark.parse(`\n# Heading One {#custom_h1}\n\n## Heading Two {#custom-heading-two}\n\n# With *Bold* {#custom-withbold}\n\n# Not italic {#not_italic_here}\n\n# No custom ID\n\n# {#id-only}\n\n# {#text-after} custom ID\n    `);\n    const enableCustomId = true;\n    const transformed = plugin({\n      markdownAST\n    }, {\n      enableCustomId\n    });\n    const headers = [];\n    visit(transformed, `heading`, node => {\n      headers.push({\n        text: toString(node),\n        id: node.data.id\n      });\n    });\n    expect(headers).toEqual([{\n      id: `custom_h1`,\n      text: `Heading One`\n    }, {\n      id: `custom-heading-two`,\n      text: `Heading Two`\n    }, {\n      id: `custom-withbold`,\n      text: `With Bold`\n    }, {\n      id: `not_italic_here`,\n      text: `Not italic`\n    }, {\n      id: `no-custom-id`,\n      text: `No custom ID`\n    }, {\n      id: `id-only`,\n      text: `{#id-only}`\n    }, {\n      id: `text-after-custom-id`,\n      text: `{#text-after} custom ID`\n    }]);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"adds places anchor after header when isIconAfterHeader prop is passed","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":238,"column":75,"index":5664},"line":238,"code":"  it(`adds places anchor after header when isIconAfterHeader prop is passed`, () => {\n    const markdownAST = remark.parse(`# Heading Uno`);\n    const isIconAfterHeader = true;\n    const transformed = plugin({\n      markdownAST\n    }, {\n      isIconAfterHeader\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data.hProperties.style).toContain(`position:relative`);\n      expect(node.children).toHaveLength(2);\n      expect(node.children[1].data.hProperties.class).toContain(`after`);\n      expect(node).toMatchSnapshot();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"adds id to a markdown heading when elements prop is passed with matching heading type","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":253,"column":91,"index":6238},"line":253,"code":"  it(`adds id to a markdown heading when elements prop is passed with matching heading type`, () => {\n    const markdownAST = remark.parse(`# Heading Uno`);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      elements: [`h1`]\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data.id).toBeDefined();\n      expect(node).toMatchSnapshot();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"does not add data to a markdown heading when elements prop is passed with no matching heading type","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":265,"column":104,"index":6637},"line":265,"code":"  it(`does not add data to a markdown heading when elements prop is passed with no matching heading type`, () => {\n    const markdownAST = remark.parse(`# Heading Uno`);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      elements: [`h2`]\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data).not.toBeDefined();\n      expect(node).toMatchSnapshot();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"does not add data to a markdown heading with custom id when elements prop is passed with no matching heading type","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":277,"column":119,"index":7052},"line":277,"code":"  it(`does not add data to a markdown heading with custom id when elements prop is passed with no matching heading type`, () => {\n    const markdownAST = remark.parse(`# Heading Uno {#custom_h1}`);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      elements: [`h2`]\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data).not.toBeDefined();\n      expect(node).toMatchSnapshot();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"only adds ids to markdown headings whose heading type is included in the passed elements prop","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":289,"column":99,"index":7460},"line":289,"code":"  it(`only adds ids to markdown headings whose heading type is included in the passed elements prop`, () => {\n    const markdownAST = remark.parse(`\n    # Heading One\n\n    ## Heading Two\n\n    ### Heading Three\n        `);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      elements: [`h2`]\n    });\n    visit(transformed, `heading`, node => {\n      if (node.depth === 2) {\n        expect(node.data.id).toBeDefined();\n      } else {\n        expect(node.data).not.toBeDefined();\n      }\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"does not add data to markdown headings when an empty array elements prop is passed","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":310,"column":88,"index":7962},"line":310,"code":"  it(`does not add data to markdown headings when an empty array elements prop is passed`, () => {\n    const markdownAST = remark.parse(`\n    # Heading One\n\n    ## Heading Two\n\n    ### Heading Three\n        `);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      elements: []\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data).not.toBeDefined();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"allows all six heading depths to be passed in the elements prop","suites":["gatsby-remark-autolink-headers"],"updatePoint":{"line":327,"column":69,"index":8342},"line":327,"code":"  it(`allows all six heading depths to be passed in the elements prop`, () => {\n    const markdownAST = remark.parse(`\n    # Heading One\n\n    ## Heading Two\n\n    ### Heading Three\n\n    #### Heading Four\n\n    ##### Heading Five\n\n    ###### Heading Six\n        `);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      elements: [`h1`, `h2`, `h3`, `h4`, `h5`, `h6`]\n    });\n    visit(transformed, `heading`, node => {\n      expect(node.data.id).toBeDefined();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-autolink-headers/src/__tests__"},{"name":"should iterate over all JavaScript files in the examples directory","suites":["gatsby-remark-code-repls","gatsby-node"],"updatePoint":{"line":47,"column":74,"index":1245},"line":47,"code":"    it(`should iterate over all JavaScript files in the examples directory`, async () => {\n      readdir.mockResolvedValue([`root-file.js`, `path/to/nested/file.jsx`]);\n      await createPages(createPagesParams);\n      expect(fs.readFileSync).toHaveBeenCalledTimes(2);\n      expect(fs.readFileSync).toHaveBeenCalledWith(`root-file.js`, `utf8`);\n      expect(fs.readFileSync).toHaveBeenCalledWith(`path/to/nested/file.jsx`, `utf8`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should ignore non JavaScript files in the examples directory","suites":["gatsby-remark-code-repls","gatsby-node"],"updatePoint":{"line":54,"column":68,"index":1679},"line":54,"code":"    it(`should ignore non JavaScript files in the examples directory`, async () => {\n      readdir.mockResolvedValue([`javascript.js`, `not-javascript.html`]);\n      await createPages(createPagesParams);\n      expect(fs.readFileSync).toHaveBeenCalledTimes(1);\n      expect(fs.readFileSync).toHaveBeenCalledWith(`javascript.js`, `utf8`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should error if provided an invalid examples directory","suites":["gatsby-remark-code-repls","gatsby-node"],"updatePoint":{"line":60,"column":62,"index":2018},"line":60,"code":"    it(`should error if provided an invalid examples directory`, async () => {\n      fs.existsSync.mockReturnValue(false);\n      try {\n        await createPages(createPagesParams);\n      } catch (err) {\n        expect(err).toEqual(Error(`Invalid REPL directory specified: \"REPL/\"`));\n      }\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should warn about an empty examples directory","suites":["gatsby-remark-code-repls","gatsby-node"],"updatePoint":{"line":68,"column":53,"index":2309},"line":68,"code":"    it(`should warn about an empty examples directory`, async () => {\n      readdir.mockResolvedValue([]);\n      jest.spyOn(console, `warn`); // eslint-disable-line no-undef\n\n      await createPages(createPagesParams);\n      expect(console.warn).toHaveBeenCalledWith(`Specified REPL directory \"REPL/\" contains no files`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should create redirect pages for the code in each example file","suites":["gatsby-remark-code-repls","gatsby-node"],"updatePoint":{"line":75,"column":70,"index":2656},"line":75,"code":"    it(`should create redirect pages for the code in each example file`, async () => {\n      readdir.mockResolvedValue([`root-file.js`, `path/to/nested/file/file.jsx`]);\n      await createPages(createPagesParams);\n      expect(createPage).toHaveBeenCalledTimes(2);\n      expect(createPage.mock.calls[0][0].path).toContain(`root-file`);\n      expect(createPage.mock.calls[1][0].path).toContain(`path/to/nested/file`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should use a default redirect template","suites":["gatsby-remark-code-repls","gatsby-node"],"updatePoint":{"line":82,"column":46,"index":3057},"line":82,"code":"    it(`should use a default redirect template`, async () => {\n      readdir.mockImplementation(dir => [nodePath.resolve(dir, `file.js`)]);\n      await createPages(createPagesParams);\n      expect(createPage).toHaveBeenCalledTimes(1);\n      expect(createPage.mock.calls[0][0].component).toContain(OPTION_DEFAULT_CODEPEN.redirectTemplate);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should propagate any Error from recursive-readdir","suites":["gatsby-remark-code-repls","gatsby-node"],"updatePoint":{"line":88,"column":57,"index":3415},"line":88,"code":"    it(`should propagate any Error from recursive-readdir`, async () => {\n      const error = TypeError(`glob pattern string required`);\n      readdir.mockRejectedValue(error);\n      try {\n        await createPages(createPagesParams);\n      } catch (err) {\n        expect(err).toBe(error);\n      }\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should not load any external packages by default","suites":["gatsby-remark-code-repls","gatsby-node"],"updatePoint":{"line":97,"column":56,"index":3720},"line":97,"code":"    it(`should not load any external packages by default`, async () => {\n      readdir.mockImplementation(dir => [nodePath.resolve(dir, `file.js`)]);\n      await createPages(createPagesParams);\n      const {\n        js_external\n      } = JSON.parse(createPage.mock.calls[0][0].context.payload);\n      expect(js_external).toBe(``);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should use a specified redirect template override","suites":["gatsby-remark-code-repls","gatsby-node","codepen specific"],"updatePoint":{"line":106,"column":59,"index":4103},"line":106,"code":"      it(`should use a specified redirect template override`, async () => {\n        readdir.mockImplementation(dir => [nodePath.resolve(dir, `file.js`)]);\n        await createPages(createPagesParams, {\n          codepen: {\n            redirectTemplate: `foo/bar.js`\n          }\n        });\n        expect(createPage).toHaveBeenCalledTimes(1);\n        expect(createPage.mock.calls[0][0].component).toContain(`foo/bar.js`);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should error if an invalid redirect template is specified","suites":["gatsby-remark-code-repls","gatsby-node","codepen specific"],"updatePoint":{"line":116,"column":67,"index":4543},"line":116,"code":"      it(`should error if an invalid redirect template is specified`, async () => {\n        fs.existsSync.mockImplementation(path => path !== `foo/bar.js`);\n        try {\n          await createPages(createPagesParams, {\n            codepen: {\n              redirectTemplate: `foo/bar.js`\n            }\n          });\n        } catch (err) {\n          expect(err).toEqual(Error(`Invalid REPL redirectTemplate specified: \"foo/bar.js\"`));\n        }\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should load custom externals if specified","suites":["gatsby-remark-code-repls","gatsby-node","codepen specific"],"updatePoint":{"line":128,"column":51,"index":4982},"line":128,"code":"      it(`should load custom externals if specified`, async () => {\n        readdir.mockImplementation(dir => [nodePath.resolve(dir, `file.js`)]);\n        await createPages(createPagesParams, {\n          codepen: {\n            externals: [`foo.js`, `bar.js`]\n          }\n        });\n        const {\n          js_external\n        } = JSON.parse(createPage.mock.calls[0][0].context.payload);\n        expect(js_external).toContain(`foo.js`);\n        expect(js_external).toContain(`bar.js`);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should support custom, user-defined HTML for index page","suites":["gatsby-remark-code-repls","gatsby-node","codepen specific"],"updatePoint":{"line":141,"column":65,"index":5494},"line":141,"code":"      it(`should support custom, user-defined HTML for index page`, async () => {\n        readdir.mockImplementation(dir => [nodePath.resolve(dir, `file.js`)]);\n        await createPages(createPagesParams, {\n          codepen: {\n            html: `<span id=\"foo\"></span>`\n          }\n        });\n        const {\n          html\n        } = JSON.parse(createPage.mock.calls[0][0].context.payload);\n        expect(html).toBe(`<span id=\"foo\"></span>`);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should support includeMatchingCSS = \"true\" when matching file exists","suites":["gatsby-remark-code-repls","gatsby-node","codepen specific"],"updatePoint":{"line":153,"column":78,"index":5966},"line":153,"code":"      it(`should support includeMatchingCSS = \"true\" when matching file exists`, async () => {\n        readdir.mockImplementation(dir => [nodePath.resolve(dir, `file.js`), nodePath.resolve(dir, `file.css`)]);\n        fs.readFileSync.mockReset();\n        fs.readFileSync.mockImplementation((path, options) => {\n          if (path === nodePath.resolve(OPTION_DEFAULT_REPL_DIRECTORY, `file.js`)) {\n            return `const foo = \"bar\";`;\n          } else if (path === nodePath.resolve(OPTION_DEFAULT_REPL_DIRECTORY, `file.css`)) {\n            return `html { color: red; }`;\n          } else {\n            throwFileNotFoundErr(path);\n          }\n          return null;\n        });\n        await createPages(createPagesParams, {\n          codepen: {\n            includeMatchingCSS: true\n          }\n        });\n        const {\n          css,\n          js\n        } = JSON.parse(createPage.mock.calls[0][0].context.payload);\n        expect(js).toBe(`const foo = \"bar\";`);\n        expect(css).toBe(`html { color: red; }`);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should support includeMatchingCSS = \"false\" when matching file exists","suites":["gatsby-remark-code-repls","gatsby-node","codepen specific"],"updatePoint":{"line":178,"column":79,"index":6994},"line":178,"code":"      it(`should support includeMatchingCSS = \"false\" when matching file exists`, async () => {\n        readdir.mockImplementation(dir => [nodePath.resolve(dir, `file.js`), nodePath.resolve(dir, `file.css`)]);\n        fs.readFileSync.mockReset();\n        fs.readFileSync.mockImplementation((path, options) => {\n          if (path === nodePath.resolve(OPTION_DEFAULT_REPL_DIRECTORY, `file.js`)) {\n            return `const foo = \"bar\";`;\n          } else if (path === nodePath.resolve(OPTION_DEFAULT_REPL_DIRECTORY, `file.css`)) {\n            return `html { color: red; }`;\n          } else {\n            throwFileNotFoundErr(path);\n          }\n          return null;\n        });\n        await createPages(createPagesParams, {\n          codepen: {\n            includeMatchingCSS: false\n          }\n        });\n        const {\n          css,\n          js\n        } = JSON.parse(createPage.mock.calls[0][0].context.payload);\n        expect(js).toBe(`const foo = \"bar\";`);\n        expect(css).toBe(undefined);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should support includeMatchingCSS = \"true\" when matching file doesn't exist","suites":["gatsby-remark-code-repls","gatsby-node","codepen specific"],"updatePoint":{"line":203,"column":85,"index":8016},"line":203,"code":"      it(`should support includeMatchingCSS = \"true\" when matching file doesn't exist`, async () => {\n        readdir.mockImplementation(dir => [nodePath.resolve(dir, `file.js`)]);\n        fs.readFileSync.mockReset();\n        fs.readFileSync.mockImplementation((path, options) => {\n          if (path === nodePath.resolve(OPTION_DEFAULT_REPL_DIRECTORY, `file.js`)) {\n            return `const foo = \"bar\";`;\n          } else {\n            throwFileNotFoundErr(path);\n          }\n          return null;\n        });\n        await createPages(createPagesParams, {\n          codepen: {\n            includeMatchingCSS: true\n          }\n        });\n        const {\n          css,\n          js\n        } = JSON.parse(createPage.mock.calls[0][0].context.payload);\n        expect(js).toBe(`const foo = \"bar\";`);\n        expect(css).toBe(undefined);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should support includeMatchingCSS = \"false\" when matching file doesn't exist","suites":["gatsby-remark-code-repls","gatsby-node","codepen specific"],"updatePoint":{"line":226,"column":86,"index":8867},"line":226,"code":"      it(`should support includeMatchingCSS = \"false\" when matching file doesn't exist`, async () => {\n        readdir.mockImplementation(dir => [nodePath.resolve(dir, `file.js`)]);\n        fs.readFileSync.mockReset();\n        fs.readFileSync.mockImplementation((path, options) => {\n          if (path === nodePath.resolve(OPTION_DEFAULT_REPL_DIRECTORY, `file.js`)) {\n            return `const foo = \"bar\";`;\n          } else {\n            throwFileNotFoundErr(path);\n          }\n          return null;\n        });\n        await createPages(createPagesParams, {\n          codepen: {\n            includeMatchingCSS: false\n          }\n        });\n        const {\n          css,\n          js\n        } = JSON.parse(createPage.mock.calls[0][0].context.payload);\n        expect(js).toBe(`const foo = \"bar\";`);\n        expect(css).toBe(undefined);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should support custom, user-defined HTML for index page","suites":["gatsby-remark-code-repls","gatsby-node","codesandbox specific"],"updatePoint":{"line":260,"column":65,"index":10106},"line":260,"code":"      it(`should support custom, user-defined HTML for index page`, async () => {\n        readdir.mockImplementation(dir => [nodePath.resolve(dir, `file.js`)]);\n        await createPages(createPagesParams, {\n          codepen: {\n            html: `<span id=\"foo\"></span>`\n          }\n        });\n        const {\n          html\n        } = JSON.parse(createPage.mock.calls[0][0].context.payload);\n        expect(html).toBe(`<span id=\"foo\"></span>`);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should inject the required prop-types for the Codepen prefill API","suites":["gatsby-remark-code-repls","gatsby-node","codesandbox specific"],"updatePoint":{"line":273,"column":73,"index":10581},"line":273,"code":"    it(`should inject the required prop-types for the Codepen prefill API`, async () => {\n      readdir.mockImplementation(dir => [nodePath.resolve(dir, `file.js`)]);\n      await createPages(createPagesParams);\n      const {\n        action,\n        payload\n      } = createPage.mock.calls[0][0].context;\n      expect(action).toBeTruthy();\n      expect(payload).toBeTruthy();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"should render default HTML for index page if no override specified","suites":["gatsby-remark-code-repls","gatsby-node","codesandbox specific"],"updatePoint":{"line":283,"column":74,"index":10965},"line":283,"code":"    it(`should render default HTML for index page if no override specified`, async () => {\n      readdir.mockImplementation(dir => [nodePath.resolve(dir, `file.js`)]);\n      await createPages(createPagesParams, {});\n      const {\n        html\n      } = JSON.parse(createPage.mock.calls[0][0].context.payload);\n      expect(html).toBe(OPTION_DEFAULT_CODEPEN.html);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"generates a link for the specified example file","suites":["gatsby-remark-code-repls"," remark transform"],"updatePoint":{"line":35,"column":57,"index":1005},"line":35,"code":"      it(`generates a link for the specified example file`, async () => {\n        const markdownAST = remark.parse(`[](${protocol}file.js)`);\n        const transformed = plugin({\n          markdownAST\n        }, {\n          directory: `examples`\n        });\n        expect(transformed).toMatchSnapshot();\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"generates a link with the specified target","suites":["gatsby-remark-code-repls"," remark transform"],"updatePoint":{"line":44,"column":52,"index":1315},"line":44,"code":"      it(`generates a link with the specified target`, async () => {\n        const markdownAST = remark.parse(`[](${protocol}file.js)`);\n        const transformed = plugin({\n          markdownAST\n        }, {\n          directory: `examples`,\n          target: `_blank`\n        });\n        expect(transformed).toMatchSnapshot();\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"generates a link for files in nested directories","suites":["gatsby-remark-code-repls"," remark transform"],"updatePoint":{"line":54,"column":58,"index":1659},"line":54,"code":"      it(`generates a link for files in nested directories`, async () => {\n        const markdownAST = remark.parse(`[](${protocol}path/to/nested/file.js)`);\n        const transformed = plugin({\n          markdownAST\n        }, {\n          directory: `examples`\n        });\n        expect(transformed).toMatchSnapshot();\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"generates a link with the specified default text","suites":["gatsby-remark-code-repls"," remark transform"],"updatePoint":{"line":63,"column":58,"index":1990},"line":63,"code":"      it(`generates a link with the specified default text`, () => {\n        const markdownAST = remark.parse(`[](${protocol}file.js)`);\n        const transformed = plugin({\n          markdownAST\n        }, {\n          directory: `examples`,\n          defaultText: `Click me`\n        });\n        expect(transformed).toMatchSnapshot();\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"generates a link with the specified inline text even if default text is specified","suites":["gatsby-remark-code-repls"," remark transform"],"updatePoint":{"line":73,"column":91,"index":2368},"line":73,"code":"      it(`generates a link with the specified inline text even if default text is specified`, () => {\n        const markdownAST = remark.parse(`[Custom link text](${protocol}file.js)`);\n        const transformed = plugin({\n          markdownAST\n        }, {\n          defaultText: `Click me`,\n          directory: `examples`\n        });\n        expect(transformed).toMatchSnapshot();\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"verifies example files relative to the specified directory","suites":["gatsby-remark-code-repls"," remark transform"],"updatePoint":{"line":83,"column":68,"index":2739},"line":83,"code":"      it(`verifies example files relative to the specified directory`, () => {\n        const markdownAST = remark.parse(`[](${protocol}path/to/nested/file.js)`);\n        plugin({\n          markdownAST\n        }, {\n          directory: `examples`\n        });\n        expect(fs.existsSync).toHaveBeenCalledWith(`examples/path/to/nested/file.js`);\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"errors if you do not provide a directory parameter","suites":["gatsby-remark-code-repls"," remark transform"],"updatePoint":{"line":92,"column":60,"index":3086},"line":92,"code":"      it(`errors if you do not provide a directory parameter`, () => {\n        const markdownAST = remark.parse(`[](${protocol}file.js)`);\n        expect(() => plugin({\n          markdownAST\n        })).toThrow(`Required REPL option \"directory\" not specified`);\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"errors if you provide an invalid directory parameter","suites":["gatsby-remark-code-repls"," remark transform"],"updatePoint":{"line":98,"column":62,"index":3360},"line":98,"code":"      it(`errors if you provide an invalid directory parameter`, () => {\n        fs.existsSync.mockReturnValue(false);\n        const markdownAST = remark.parse(`[](${protocol}file.js)`);\n        expect(() => plugin({\n          markdownAST\n        }, {\n          directory: `fake`\n        })).toThrow(`Invalid REPL directory specified \"fake\"`);\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"errors if you provide multiple files in non-codesandbox examples","suites":["gatsby-remark-code-repls"," remark transform"],"updatePoint":{"line":107,"column":74,"index":3726},"line":107,"code":"      it(`errors if you provide multiple files in non-codesandbox examples`, () => {\n        const markdownAST = remark.parse(`[](${protocol}path/to/nested/file.js,path/to/nested/anotherFile.js,path/to/nested/file.css)`);\n        const runPlugin = () => plugin({\n          markdownAST\n        }, {\n          directory: `examples`\n        });\n        if (protocol !== PROTOCOL_CODE_SANDBOX) {\n          expect(runPlugin).toThrow(`Code example path should only contain a single file, but found more than one: ` + `path/to/nested/file.js,path/to/nested/anotherFile.js,path/to/nested/file.css. ` + `Only CodeSandbox REPL supports multiple files entries, the protocol prefix of which starts with codesandbox://`);\n        } else {\n          expect(runPlugin).not.toThrow();\n        }\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"supports includeMatchingCSS","suites":["gatsby-remark-code-repls"," remark transform"],"updatePoint":{"line":120,"column":37,"index":4478},"line":120,"code":"      it(`supports includeMatchingCSS`, () => {\n        const markdownAST = remark.parse(`[](${protocol}path/to/nested/file.js)`);\n        const runPlugin = () => plugin({\n          markdownAST\n        }, {\n          directory: `examples`,\n          codepen: {\n            includeMatchingCSS: true\n          }\n        });\n        expect(runPlugin).not.toThrow();\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"supports custom html config option for index html","suites":["gatsby-remark-code-repls"," remark transform"],"updatePoint":{"line":133,"column":61,"index":4923},"line":133,"code":"        it(`supports custom html config option for index html`, () => {\n          const markdownAST = remark.parse(`[](${protocol}path/to/nested/file.js)`);\n          const transformed = plugin({\n            markdownAST\n          }, {\n            directory: `examples`,\n            codesandbox: {\n              html: `<span id=\"foo\"></span>`\n            }\n          });\n          expect(transformed).toMatchSnapshot();\n        });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"supports custom dependencies config option for NPM module dependencies","suites":["gatsby-remark-code-repls"," remark transform"],"updatePoint":{"line":145,"column":82,"index":5375},"line":145,"code":"        it(`supports custom dependencies config option for NPM module dependencies`, () => {\n          const markdownAST = remark.parse(`[](${protocol}path/to/nested/file.js)`);\n          const transformed = plugin({\n            markdownAST\n          }, {\n            codesandbox: {\n              dependencies: [`react`, `react-dom@next`, `prop-types@15.5`, `@babel/core@7.4.0`]\n            },\n            directory: `examples`\n          });\n          expect(JSONstringifySpy).toHaveBeenCalledWith(expect.objectContaining({\n            files: expect.objectContaining({\n              \"package.json\": expect.objectContaining({\n                content: expect.objectContaining({\n                  dependencies: expect.objectContaining({\n                    react: `latest`,\n                    \"react-dom\": `next`,\n                    \"prop-types\": `15.5`,\n                    \"@babel/core\": `7.4.0`\n                  })\n                })\n              })\n            })\n          }));\n          expect(transformed).toMatchSnapshot();\n        });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"supports importing multiple files","suites":["gatsby-remark-code-repls"," remark transform"],"updatePoint":{"line":171,"column":45,"index":6383},"line":171,"code":"        it(`supports importing multiple files`, () => {\n          const markdownAST = remark.parse(`[](${protocol}path/to/nested/file.js,path/to/nested/anotherFile.js,path/to/nested/file.css)`);\n          const transformed = plugin({\n            markdownAST\n          }, {\n            directory: `examples`\n          });\n          expect(transformed).toMatchSnapshot();\n        });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-code-repls/src/__tests__"},{"name":"can copy .","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":48,"column":32,"index":1175},"line":48,"code":"      it(`can copy .${extension}`, async () => {\n        const path = `images/sample-image.${extension}`;\n        const markdownAST = remark.parse(`![some image](${path})`);\n        await plugin({\n          files: getFiles(path),\n          markdownAST,\n          markdownNode,\n          getNode\n        });\n        expect(fsExtra.copy).toHaveBeenCalledWith(expect.any(String), expect.any(String));\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"ignores images with .","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":61,"column":43,"index":1652},"line":61,"code":"      it(`ignores images with .${extension}`, async () => {\n        const path = `images/sample-image.${extension}`;\n        const markdownAST = remark.parse(`![some image](${path})`);\n        await plugin({\n          files: getFiles(path),\n          markdownAST,\n          markdownNode,\n          getNode\n        });\n        expect(fsExtra.copy).not.toHaveBeenCalled();\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"can copy reference-style images","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":74,"column":37,"index":2041},"line":74,"code":"  it(`can copy reference-style images`, async () => {\n    const path = `images/sample-image.gif`;\n    const markdownAST = remark.parse(`![sample][1]\\n\\n[1]: ${path}`);\n    await plugin({\n      files: getFiles(path),\n      markdownAST,\n      markdownNode,\n      getNode\n    });\n    expect(fsExtra.copy).toHaveBeenCalled();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"can copy file links","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":85,"column":25,"index":2357},"line":85,"code":"  it(`can copy file links`, async () => {\n    const path = `files/sample-file.txt`;\n    const markdownAST = remark.parse(`[path to file](${path})`);\n    await plugin({\n      files: getFiles(path),\n      markdownAST,\n      markdownNode,\n      getNode\n    });\n    expect(fsExtra.copy).toHaveBeenCalled();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"can copy HTML file links","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":96,"column":30,"index":2671},"line":96,"code":"  it(`can copy HTML file links`, async () => {\n    const path = `files/sample-file.txt`;\n    const markdownAST = remark.parse(`<a href=\"${path}\">link to file</a>`);\n    await plugin({\n      files: getFiles(path),\n      markdownAST,\n      markdownNode,\n      getNode\n    });\n    expect(fsExtra.copy).toHaveBeenCalled();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"can copy HTML images","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":107,"column":26,"index":2992},"line":107,"code":"  it(`can copy HTML images`, async () => {\n    const path = `images/sample-image.gif`;\n    const markdownAST = remark.parse(`<img src=\"${path}\">`);\n    await plugin({\n      files: getFiles(path),\n      markdownAST,\n      markdownNode,\n      getNode\n    });\n    expect(fsExtra.copy).toHaveBeenCalled();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"can copy JSX images","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":118,"column":25,"index":3299},"line":118,"code":"  it(`can copy JSX images`, async () => {\n    const mdx = require(`remark-mdx`);\n    const path = `images/sample-image.gif`;\n    const markdownAST = remark().use(mdx).parse(`<img src=\"${path}\" />`);\n    await plugin({\n      files: getFiles(path),\n      markdownAST,\n      markdownNode,\n      getNode\n    });\n    expect(fsExtra.copy).toHaveBeenCalled();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"can copy HTML multiple images","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":130,"column":35,"index":3668},"line":130,"code":"  it(`can copy HTML multiple images`, async () => {\n    const path1 = `images/sample-image.gif`;\n    const path2 = `images/another-sample-image.gif`;\n    const markdownAST = remark.parse(`<div><img src=\"${path1}\"><img src=\"${path2}\"></div>`);\n    await plugin({\n      files: [...getFiles(path1), ...getFiles(path2)],\n      markdownAST,\n      markdownNode,\n      getNode\n    });\n    expect(fsExtra.copy).toHaveBeenCalledTimes(2);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"can copy HTML multiple images when some are in ignore extensions","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":142,"column":70,"index":4138},"line":142,"code":"  it(`can copy HTML multiple images when some are in ignore extensions`, async () => {\n    const path1 = `images/sample-image.jpg`;\n    const path2 = `images/another-sample-image.gif`;\n    const markdownAST = remark.parse(`<div><img src=\"${path1}\"><img src=\"${path2}\"></div>`);\n    await plugin({\n      files: [...getFiles(path1), ...getFiles(path2)],\n      markdownAST,\n      markdownNode,\n      getNode\n    });\n    expect(fsExtra.copy).toHaveBeenCalledTimes(1);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"can copy HTML videos","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":154,"column":26,"index":4564},"line":154,"code":"  it(`can copy HTML videos`, async () => {\n    const path = `videos/sample-video.mp4`;\n    const markdownAST = remark.parse(`<video controls=\"controls\" autoplay=\"true\" loop=\"true\">\\n<source type=\"video/mp4\" src=\"${path}\"></source>\\n<p>Your browser does not support the video element.</p>\\n</video>`);\n    await plugin({\n      files: getFiles(path),\n      markdownAST,\n      markdownNode,\n      getNode\n    });\n    expect(fsExtra.copy).toHaveBeenCalled();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"can copy HTML videos from video elements with the src attribute","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":165,"column":69,"index":5068},"line":165,"code":"  it(`can copy HTML videos from video elements with the src attribute`, async () => {\n    const path = `videos/sample-video.mp4`;\n    const markdownAST = remark.parse(`<video controls=\"controls\" autoplay=\"true\" src=\"${path}\">\\n<p>Your browser does not support the video element.</p>\\n</video>`);\n    await plugin({\n      files: getFiles(path),\n      markdownAST,\n      markdownNode,\n      getNode\n    });\n    expect(fsExtra.copy).toHaveBeenCalled();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"can copy HTML images from video elements with the poster attribute ","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":176,"column":73,"index":5528},"line":176,"code":"  it(`can copy HTML images from video elements with the poster attribute `, async () => {\n    const videoPath = `videos/sample-video.mp4`;\n    const posterPath = `images/sample-image.jpg`;\n    const markdownAST = remark.parse(`<video controls=\"controls\" autoplay=\"true\" src=\"${videoPath}\" poster=\"${posterPath}\">\\n<p>Your browser does not support the video element.</p>\\n</video>`);\n    await plugin({\n      files: [...getFiles(videoPath), ...getFiles(posterPath)],\n      markdownAST,\n      markdownNode,\n      getNode\n    });\n    expect(fsExtra.copy).toHaveBeenCalledTimes(2);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"can copy flash from object elements with the value attribute","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":188,"column":66,"index":6105},"line":188,"code":"  it(`can copy flash from object elements with the value attribute`, async () => {\n    const path = `myMovie.swf`;\n    const markdownAST = remark.parse(`<object type=\"application/x-shockwave-flash\">\\n<param name=\"movie\" value=\"${path}\" />\\n</object>`);\n    await plugin({\n      files: getFiles(path),\n      markdownAST,\n      markdownNode,\n      getNode\n    });\n    expect(fsExtra.copy).toHaveBeenCalled();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"can copy HTML videos when some siblings are in ignore extensions","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":199,"column":70,"index":6522},"line":199,"code":"  it(`can copy HTML videos when some siblings are in ignore extensions`, async () => {\n    const path = `videos/sample-video.mp4`;\n    const path1 = `images/sample-image.jpg`;\n    const markdownAST = remark.parse(`<div><img src=\"${path1}\"><video controls=\"controls\" autoplay=\"true\" loop=\"true\">\\n<source type=\"video/mp4\" src=\"${path}\"></source>\\n<p>Your browser does not support the video element.</p>\\n</video></div>`);\n    await plugin({\n      files: getFiles(path),\n      markdownAST,\n      markdownNode,\n      getNode\n    });\n    expect(fsExtra.copy).toHaveBeenCalled();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"leaves HTML nodes alone","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":211,"column":29,"index":7062},"line":211,"code":"  it(`leaves HTML nodes alone`, async () => {\n    const openingTag = `<a href=\"http://example.com/\">`;\n    const markdownAST = remark.parse(`${openingTag}Link to example.com</a>`);\n    await plugin({\n      markdownAST,\n      markdownNode,\n      getNode\n    }).then(() => {\n      // we expect the resulting markdownAST to consist\n      // of a paragraph with three children:\n      // openingTag, text, and closing tag\n      expect(markdownAST.children[0].children[0].value).toBe(openingTag);\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"leaves absolute file paths alone","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":225,"column":38,"index":7576},"line":225,"code":"  it(`leaves absolute file paths alone`, async () => {\n    const path = `https://google.com/images/sample-image.gif`;\n    const markdownAST = remark.parse(`![some absolute image](${path})`);\n    await plugin({\n      files: getFiles(path),\n      markdownAST,\n      markdownNode,\n      getNode\n    });\n    expect(fsExtra.copy).not.toHaveBeenCalled();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"do nothing if dir is not found","suites":["gatsby-remark-copy-linked-files","images"],"updatePoint":{"line":236,"column":36,"index":7929},"line":236,"code":"  it(`do nothing if dir is not found`, async () => {\n    const getNode = () => {\n      return {\n        internal: {\n          type: `Node`\n        }\n      };\n    };\n    const path = `images/sample-image.gif`;\n    const markdownAST = remark.parse(`![sample][1]\\n\\n[1]: ${path}`);\n    await plugin({\n      files: getFiles(path),\n      markdownAST,\n      markdownNode,\n      getNode\n    });\n    expect(fsExtra.copy).not.toHaveBeenCalled();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"relative pathPrefix (no assetPrefix)","suites":["gatsby-remark-copy-linked-files","respects pathPrefix"],"updatePoint":{"line":260,"column":44,"index":8650},"line":260,"code":"    it(`relative pathPrefix (no assetPrefix)`, async () => {\n      const pathPrefix = `/path-prefix`;\n      const markdownAST = remark.parse(`![some image](${imageRelativePath})`);\n      const expectedNewPath = path.posix.join(process.cwd(), `public`, `some-hash`, `sample-image.svg`);\n      await plugin({\n        files: getFiles(imagePath),\n        markdownAST,\n        markdownNode,\n        getNode,\n        pathPrefix\n      });\n      expect(imageURL(markdownAST)).toEqual(`/path-prefix/some-hash/sample-image.svg`);\n      expect(fsExtra.copy).toHaveBeenCalledWith(imagePath, expectedNewPath);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"absolute pathPrefix (with assetPrefix, empty base path prefix)","suites":["gatsby-remark-copy-linked-files","respects pathPrefix"],"updatePoint":{"line":274,"column":70,"index":9281},"line":274,"code":"    it(`absolute pathPrefix (with assetPrefix, empty base path prefix)`, async () => {\n      const pathPrefix = `https://cdn.mysiteassets.com`;\n      const markdownAST = remark.parse(`![some image](${imageRelativePath})`);\n      const expectedNewPath = path.posix.join(process.cwd(), `public`, `some-hash`, `sample-image.svg`);\n      await plugin({\n        files: getFiles(imagePath),\n        markdownAST,\n        markdownNode,\n        getNode,\n        pathPrefix\n      });\n      expect(imageURL(markdownAST)).toEqual(`https://cdn.mysiteassets.com/some-hash/sample-image.svg`);\n      expect(fsExtra.copy).toHaveBeenCalledWith(imagePath, expectedNewPath);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"absolute pathPrefix (with assetPrefix, and non-empty base path prefix)","suites":["gatsby-remark-copy-linked-files","respects pathPrefix"],"updatePoint":{"line":288,"column":78,"index":9952},"line":288,"code":"    it(`absolute pathPrefix (with assetPrefix, and non-empty base path prefix)`, async () => {\n      const pathPrefix = `https://cdn.mysiteassets.com/path-prefix`;\n      const markdownAST = remark.parse(`![some image](${imageRelativePath})`);\n      const expectedNewPath = path.posix.join(process.cwd(), `public`, `some-hash`, `sample-image.svg`);\n      await plugin({\n        files: getFiles(imagePath),\n        markdownAST,\n        markdownNode,\n        getNode,\n        pathPrefix\n      });\n      expect(imageURL(markdownAST)).toEqual(`https://cdn.mysiteassets.com/path-prefix/some-hash/sample-image.svg`);\n      expect(fsExtra.copy).toHaveBeenCalledWith(imagePath, expectedNewPath);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"throws an error if the destination supplied by destinationDir points outside of the root dir","suites":["gatsby-remark-copy-linked-files","options.destinationDir"],"updatePoint":{"line":307,"column":100,"index":10868},"line":307,"code":"    it(`throws an error if the destination supplied by destinationDir points outside of the root dir`, async () => {\n      const markdownAST = remark.parse(`![some absolute image](${imageRelativePath})`);\n      const invalidDestinationDir = `../destination`;\n      expect.assertions(2);\n      return plugin({\n        files: getFiles(imagePath),\n        markdownAST,\n        markdownNode,\n        getNode\n      }, {\n        destinationDir: invalidDestinationDir\n      }).catch(e => {\n        expect(e).toEqual(expect.stringContaining(invalidDestinationDir));\n        expect(fsExtra.copy).not.toHaveBeenCalled();\n      });\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"throws an error if the destination supplied by the destinationDir function points outside of the root dir","suites":["gatsby-remark-copy-linked-files","options.destinationDir"],"updatePoint":{"line":323,"column":113,"index":11510},"line":323,"code":"    it(`throws an error if the destination supplied by the destinationDir function points outside of the root dir`, async () => {\n      const markdownAST = remark.parse(`![some absolute image](${imageRelativePath})`);\n      const invalidDestinationDir = `../destination`;\n      const customDestinationDir = f => `../destination/${f.hash}/${f.name}/${f.notexist}`;\n      expect.assertions(2);\n      return plugin({\n        files: getFiles(imagePath),\n        markdownAST,\n        markdownNode,\n        getNode\n      }, {\n        destinationDir: customDestinationDir\n      }).catch(e => {\n        expect(e).toEqual(expect.stringContaining(invalidDestinationDir));\n        expect(fsExtra.copy).not.toHaveBeenCalled();\n      });\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"copies file to the destination supplied by destinationDir","suites":["gatsby-remark-copy-linked-files","options.destinationDir"],"updatePoint":{"line":340,"column":65,"index":12195},"line":340,"code":"    it(`copies file to the destination supplied by destinationDir`, async () => {\n      const markdownAST = remark.parse(`![some absolute image](${imageRelativePath})`);\n      const validDestinationDir = `path/to/dir`;\n      const fileLocationPart = `some-hash/${imageName}.gif`;\n      const expectedNewPath = path.posix.join(process.cwd(), `public`, validDestinationDir, fileLocationPart);\n      expect.assertions(3);\n      await plugin({\n        files: getFiles(imagePath),\n        markdownAST,\n        markdownNode,\n        getNode\n      }, {\n        destinationDir: validDestinationDir\n      }).then(v => {\n        expect(v).toBeDefined();\n        expect(fsExtra.copy).toHaveBeenCalledWith(imagePath, expectedNewPath);\n        expect(imageURL(markdownAST)).toEqual(`/path/to/dir/${fileLocationPart}`);\n      });\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"copies file to the destination supplied by the destinationDir function","suites":["gatsby-remark-copy-linked-files","options.destinationDir"],"updatePoint":{"line":359,"column":78,"index":13032},"line":359,"code":"    it(`copies file to the destination supplied by the destinationDir function`, async () => {\n      const markdownAST = remark.parse(`![some absolute image](${imageRelativePath})`);\n      const customDestinationDir = f => `foo/${f.hash}--bar`;\n      const expectedDestination = `foo/some-hash--bar.gif`;\n      expect.assertions(3);\n      await plugin({\n        files: getFiles(imagePath),\n        markdownAST,\n        markdownNode,\n        getNode\n      }, {\n        destinationDir: customDestinationDir\n      }).then(v => {\n        const expectedNewPath = path.posix.join(...[process.cwd(), `public`, expectedDestination]);\n        expect(v).toBeDefined();\n        expect(fsExtra.copy).toHaveBeenCalledWith(imagePath, expectedNewPath);\n        expect(imageURL(markdownAST)).toEqual(`/${expectedDestination}`);\n      });\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"copies file to the destination supplied by destinationDir (with pathPrefix)","suites":["gatsby-remark-copy-linked-files","options.destinationDir"],"updatePoint":{"line":378,"column":83,"index":13867},"line":378,"code":"    it(`copies file to the destination supplied by destinationDir (with pathPrefix)`, async () => {\n      const markdownAST = remark.parse(`![some absolute image](${imageRelativePath})`);\n      const pathPrefix = `/blog`;\n      const validDestinationDir = `path/to/dir`;\n      const fileLocationPart = `some-hash/${imageName}.gif`;\n      const expectedNewPath = path.posix.join(process.cwd(), `public`, validDestinationDir, fileLocationPart);\n      expect.assertions(3);\n      await plugin({\n        files: getFiles(imagePath),\n        markdownAST,\n        markdownNode,\n        pathPrefix,\n        getNode\n      }, {\n        destinationDir: validDestinationDir\n      }).then(v => {\n        expect(v).toBeDefined();\n        expect(fsExtra.copy).toHaveBeenCalledWith(imagePath, expectedNewPath);\n        expect(imageURL(markdownAST)).toEqual(`${pathPrefix}/path/to/dir/${fileLocationPart}`);\n      });\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"copies file to the destination supplied by the destinationDir function (with pathPrefix)","suites":["gatsby-remark-copy-linked-files","options.destinationDir"],"updatePoint":{"line":399,"column":96,"index":14789},"line":399,"code":"    it(`copies file to the destination supplied by the destinationDir function (with pathPrefix)`, async () => {\n      const markdownAST = remark.parse(`![some absolute image](${imageRelativePath})`);\n      const pathPrefix = `/blog`;\n      const customDestinationDir = f => `hello${f.name}123`;\n      const expectedDestination = `hello${imageName}123.gif`;\n      expect.assertions(3);\n      await plugin({\n        files: getFiles(imagePath),\n        markdownAST,\n        markdownNode,\n        pathPrefix,\n        getNode\n      }, {\n        destinationDir: customDestinationDir\n      }).then(v => {\n        const expectedNewPath = path.posix.join(...[process.cwd(), `public`, expectedDestination]);\n        expect(v).toBeDefined();\n        expect(fsExtra.copy).toHaveBeenCalledWith(imagePath, expectedNewPath);\n        expect(imageURL(markdownAST)).toEqual(`${pathPrefix}/${expectedDestination}`);\n      });\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"copies file to the destination supplied by the destinationDir function (using returned absolutePath)","suites":["gatsby-remark-copy-linked-files","options.destinationDir"],"updatePoint":{"line":420,"column":108,"index":15717},"line":420,"code":"    it(`copies file to the destination supplied by the destinationDir function (using returned absolutePath)`, async () => {\n      const imgName = `sample-image`;\n      const imgRelPath = `images/nested-dir/${imgName}.gif`;\n      const imgPath = parentDir + imgRelPath;\n      const markdownAST = remark.parse(`![some absolute image](${imgRelPath})`);\n      const customDestinationDir = f => `${path.dirname(f.absolutePath)}/${f.name}`;\n      const expectedDestination = `images/nested-dir/sample-image.gif`;\n      expect.assertions(3);\n      await plugin({\n        files: getFiles(imgPath),\n        markdownAST,\n        markdownNode,\n        getNode\n      }, {\n        destinationDir: customDestinationDir\n      }).then(v => {\n        const expectedNewPath = path.posix.join(...[process.cwd(), `public`, expectedDestination]);\n        expect(v).toBeDefined();\n        expect(fsExtra.copy).toHaveBeenCalledWith(imgPath, expectedNewPath);\n        expect(imageURL(markdownAST)).toEqual(`/${expectedDestination}`);\n      });\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"copies file to the root dir when destinationDir is not supplied","suites":["gatsby-remark-copy-linked-files","options.destinationDir"],"updatePoint":{"line":442,"column":71,"index":16709},"line":442,"code":"    it(`copies file to the root dir when destinationDir is not supplied`, async () => {\n      const markdownAST = remark.parse(`![some absolute image](${imageRelativePath})`);\n      const expectedNewPath = path.posix.join(process.cwd(), `public`, `/some-hash/${imageName}.gif`);\n      expect.assertions(3);\n      await plugin({\n        files: getFiles(imagePath),\n        markdownAST,\n        markdownNode,\n        getNode\n      }).then(v => {\n        expect(v).toBeDefined();\n        expect(fsExtra.copy).toHaveBeenCalledWith(imagePath, expectedNewPath);\n        expect(imageURL(markdownAST)).toEqual(`/some-hash/${imageName}.gif`);\n      });\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"optionally copies PNG, JPG/JPEG, BPM and TIFF files","suites":["gatsby-remark-copy-linked-files","options.ignoreFileExtensions"],"updatePoint":{"line":464,"column":59,"index":17670},"line":464,"code":"    it(`optionally copies PNG, JPG/JPEG, BPM and TIFF files`, async () => {\n      const markdownAST = remark.parse(`![PNG](${pngImagePath}) ![JPG](${jpgImagePath}) ![JPEG](${jpegImagePath}) ![BPM](${bmpImagePath}) ![TIFF](${tiffImagePath})`);\n      await plugin({\n        files: [...getFiles(pngImagePath), ...getFiles(jpgImagePath), ...getFiles(jpegImagePath), ...getFiles(bmpImagePath), ...getFiles(tiffImagePath)],\n        markdownAST,\n        markdownNode,\n        getNode\n      }, {\n        ignoreFileExtensions: []\n      });\n      expect(fsExtra.copy).toHaveBeenCalledTimes(5);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-copy-linked-files/src/__tests__"},{"name":"errors if missing required plugin options","suites":["gatsby-remark-custom-blocks"],"updatePoint":{"line":11,"column":47,"index":367},"line":11,"code":"  it(`errors if missing required plugin options`, () => {\n    expect(plugin.setParserPlugins).toThrow(`missing required \"blocks\" option`);\n  });","file":"index.js","skipped":true,"dir":"packages/gatsby-remark-custom-blocks/src/__tests__"},{"name":"creates nodes of blocks given in options","suites":["gatsby-remark-custom-blocks"],"updatePoint":{"line":14,"column":46,"index":511},"line":14,"code":"  it(`creates nodes of blocks given in options`, () => {\n    const parserPlugins = plugin.setParserPlugins({\n      blocks: {\n        someType: `test`,\n        anotherType: `another`\n      }\n    });\n    const [parser, options] = parserPlugins[0];\n    remark.use(parser, options);\n    const markdownAST = remark.parse(`\n[[someType]]\n| content\n[[anotherType]]\n| content`);\n    expect(find(markdownAST, {\n      type: `someTypeCustomBlock`\n    })).toBeTruthy();\n    expect(find(markdownAST, {\n      type: `anotherTypeCustomBlock`\n    })).toBeTruthy();\n  });","file":"index.js","skipped":true,"dir":"packages/gatsby-remark-custom-blocks/src/__tests__"},{"name":"should not error if missing optional config options","suites":["gatsby-remark-embed-snippet"],"updatePoint":{"line":18,"column":57,"index":521},"line":18,"code":"  it(`should not error if missing optional config options`, () => {\n    const markdownAST = remark.parse(`\\`embed:hello-world.js\\``);\n    expect(() => plugin({\n      markdownAST\n    })).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should error if the specified directory does not exist","suites":["gatsby-remark-embed-snippet"],"updatePoint":{"line":24,"column":60,"index":735},"line":24,"code":"  it(`should error if the specified directory does not exist`, () => {\n    fs.existsSync.mockReturnValue(false);\n    const markdownAST = remark.parse(`\\`embed:hello-world.js\\``);\n    expect(() => plugin({\n      markdownAST\n    }, {\n      directory: `invalid`\n    })).toThrow(`Invalid directory specified \"invalid\"`);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should display a code block of a single line","suites":["gatsby-remark-embed-snippet"],"updatePoint":{"line":33,"column":50,"index":1048},"line":33,"code":"  it(`should display a code block of a single line`, () => {\n    const codeBlockValue = `  console.log('hello world')`;\n    fs.readFileSync.mockReturnValue(`function test() {\n${codeBlockValue}\n}`);\n    const markdownAST = remark.parse(`\\`embed:hello-world.js#L2\\``);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      directory: `examples`\n    });\n    const codeBlock = transformed.children[0].children[0];\n    expect(codeBlock.value).toEqual(codeBlockValue);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should display a code block of a range of lines","suites":["gatsby-remark-embed-snippet"],"updatePoint":{"line":47,"column":53,"index":1532},"line":47,"code":"  it(`should display a code block of a range of lines`, () => {\n    const codeBlockValue = `  if (window.location.search.indexOf('query') > -1) {\n  console.log('The user is searching')\n}`;\n    fs.readFileSync.mockReturnValue(`function test() {\n${codeBlockValue}\n}`);\n    const markdownAST = remark.parse(`\\`embed:hello-world.js#L2-4\\``);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      directory: `examples`\n    });\n    const codeBlock = transformed.children[0].children[0];\n    expect(codeBlock.value).toEqual(codeBlockValue);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should display a code block of a range of non-consecutive lines","suites":["gatsby-remark-embed-snippet"],"updatePoint":{"line":63,"column":69,"index":2100},"line":63,"code":"  it(`should display a code block of a range of non-consecutive lines`, () => {\n    const notInSnippet = `lineShouldNotBeInSnippet();`;\n    fs.readFileSync.mockReturnValue(`function test() {\n  if (window.location.search.indexOf('query') > -1) {\n    console.log('The user is searching')\n  }\n}\n${notInSnippet}\nwindow.addEventListener('resize', () => {\n  test();\n})`);\n    const markdownAST = remark.parse(`\\`embed:hello-world.js#L2-4,7-9\\``);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      directory: `examples`\n    });\n    const codeBlock = transformed.children[0].children[0];\n    expect(codeBlock.value).not.toContain(notInSnippet);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should display a code block between start-snippet and end-snippet","suites":["gatsby-remark-embed-snippet"],"updatePoint":{"line":83,"column":71,"index":2761},"line":83,"code":"  it(`should display a code block between start-snippet and end-snippet`, () => {\n    const codeBlockValue = `  if (window.location.search.indexOf('query') > -1) {\n  console.log('The user is searching')\n}`;\n    fs.readFileSync.mockReturnValue(`function test() {\n// start-snippet{foo}\n${codeBlockValue}\n// end-snippet{foo}\nconsole.log('finish up')\n}`);\n    const markdownAST = remark.parse(`\\`embed:hello-world.js{snippet: \"foo\"}\\``);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      directory: `examples`\n    });\n    const codeBlock = transformed.children[0].children[0];\n    expect(codeBlock.value).toEqual(codeBlockValue);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should display a code block from start-snippet to end of file","suites":["gatsby-remark-embed-snippet"],"updatePoint":{"line":102,"column":67,"index":3405},"line":102,"code":"  it(`should display a code block from start-snippet to end of file`, () => {\n    const codeBlockValue = `  if (window.location.search.indexOf('query') > -1) {\n  console.log('The user is searching')\n}`;\n    fs.readFileSync.mockReturnValue(`function test() {\n// start-snippet{foo}\n${codeBlockValue}\n`);\n    const markdownAST = remark.parse(`\\`embed:hello-world.js{snippet: \"foo\"}\\``);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      directory: `examples`\n    });\n    const codeBlock = transformed.children[0].children[0];\n    expect(codeBlock.value).toEqual(codeBlockValue);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should display a code block from the correct snippet","suites":["gatsby-remark-embed-snippet"],"updatePoint":{"line":119,"column":58,"index":3994},"line":119,"code":"  it(`should display a code block from the correct snippet`, () => {\n    const codeBlockValue = `  if (window.location.search.indexOf('query') > -1) {\n  console.log('The user is searching')\n}`;\n    fs.readFileSync.mockReturnValue(`function test() {\n// start-snippet{bar}\nconsole.log('Do not stop here!')\n// end-snippet{bar}\nconsole.log('Or here')\n// start-snippet{foo}\n${codeBlockValue}\n// end-snippet{foo}\n`);\n    const markdownAST = remark.parse(`\\`embed:hello-world.js{snippet: \"foo\"}\\``);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      directory: `examples`\n    });\n    const codeBlock = transformed.children[0].children[0];\n    expect(codeBlock.value).toEqual(codeBlockValue);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should handle missing snippet name","suites":["gatsby-remark-embed-snippet"],"updatePoint":{"line":141,"column":40,"index":4683},"line":141,"code":"  it(`should handle missing snippet name`, () => {\n    fs.readFileSync.mockReturnValue(`function test() {\n  // start-snippet{goo}\n  nothing_to_do();\n  // end-snippet{goo}\n  stuff();\n}`);\n    const markdownAST = remark.parse(`\\`embed:hello-world.js{snippet: \"foo\"}\\``);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      directory: `examples`\n    });\n    const codeBlock = transformed.children[0].children[0];\n    expect(codeBlock.value).toEqual(``);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should ignore improperly formatted embed options","suites":["gatsby-remark-embed-snippet"],"updatePoint":{"line":157,"column":54,"index":5168},"line":157,"code":"  it(`should ignore improperly formatted embed options`, () => {\n    fs.readFileSync.mockReturnValue(`function test() {\n  // start-snippet{goo}\n  nothing_to_do();\n  // end-snippet{goo}\n  stuff();\n}`);\n    const optStr = `{snoopet: \"foo\"}`;\n    const markdownAST = remark.parse(`\\`embed:hello-world.js${optStr}\\``);\n    expect(() => plugin({\n      markdownAST\n    }, {\n      directory: `examples`\n    })).toThrow(`Invalid snippet options specified: ${optStr}`);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should error if an invalid file path is specified","suites":["gatsby-remark-embed-snippet"],"updatePoint":{"line":172,"column":55,"index":5636},"line":172,"code":"  it(`should error if an invalid file path is specified`, () => {\n    fs.existsSync.mockImplementation(path => path !== `examples/hello-world.js`);\n    const markdownAST = remark.parse(`\\`embed:hello-world.js\\``);\n    expect(() => plugin({\n      markdownAST\n    }, {\n      directory: `examples`\n    })).toThrow(`Invalid snippet specified; no such file \"examples/hello-world.js\"`);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should not modify non-embed inlineCode nodes","suites":["gatsby-remark-embed-snippet"],"updatePoint":{"line":181,"column":50,"index":6018},"line":181,"code":"  it(`should not modify non-embed inlineCode nodes`, () => {\n    const markdownAST = remark.parse(`\\`console.log(\"hi\")\\``);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      directory: `examples`\n    });\n    expect(transformed).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should convert embed inlineCode nodes to Prism code blocks","suites":["gatsby-remark-embed-snippet"],"updatePoint":{"line":190,"column":64,"index":6301},"line":190,"code":"  it(`should convert embed inlineCode nodes to Prism code blocks`, () => {\n    const markdownAST = remark.parse(`\\`embed:hello-world.js\\``);\n    const transformed = plugin({\n      markdownAST\n    }, {\n      directory: `examples`\n    });\n    expect(transformed).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should set the correct Prism language for CSS files","suites":["gatsby-remark-embed-snippet","Language detection"],"updatePoint":{"line":200,"column":59,"index":6623},"line":200,"code":"    it(`should set the correct Prism language for CSS files`, () => {\n      fs.readFileSync.mockReturnValue(`html { height: 100%; }`);\n      const markdownAST = remark.parse(`\\`embed:hello-world.css\\``);\n      const transformed = plugin({\n        markdownAST\n      }, {\n        directory: `examples`\n      });\n      expect(transformed).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should set the correct Prism language for HTML files","suites":["gatsby-remark-embed-snippet","Language detection"],"updatePoint":{"line":210,"column":60,"index":6987},"line":210,"code":"    it(`should set the correct Prism language for HTML files`, () => {\n      fs.readFileSync.mockReturnValue(`<html></html>`);\n      const markdownAST = remark.parse(`\\`embed:hello-world.html\\``);\n      const transformed = plugin({\n        markdownAST\n      }, {\n        directory: `examples`\n      });\n      expect(transformed).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should set the correct Prism language for JavaScript files","suites":["gatsby-remark-embed-snippet","Language detection"],"updatePoint":{"line":220,"column":66,"index":7349},"line":220,"code":"    it(`should set the correct Prism language for JavaScript files`, () => {\n      fs.readFileSync.mockReturnValue(`const foo = \"bar\";`);\n      const markdownAST = remark.parse(`\\`embed:hello-world.js\\``);\n      const transformed = plugin({\n        markdownAST\n      }, {\n        directory: `examples`\n      });\n      expect(transformed).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should set the correct Prism language for Markdown files","suites":["gatsby-remark-embed-snippet","Language detection"],"updatePoint":{"line":230,"column":64,"index":7712},"line":230,"code":"    it(`should set the correct Prism language for Markdown files`, () => {\n      fs.readFileSync.mockReturnValue(`# Hi`);\n      const markdownAST = remark.parse(`\\`embed:hello-world.md\\``);\n      const transformed = plugin({\n        markdownAST\n      }, {\n        directory: `examples`\n      });\n      expect(transformed).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should set the correct Prism language for shell scripts","suites":["gatsby-remark-embed-snippet","Language detection"],"updatePoint":{"line":240,"column":63,"index":8060},"line":240,"code":"    it(`should set the correct Prism language for shell scripts`, () => {\n      fs.readFileSync.mockReturnValue(`pwd`);\n      const markdownAST = remark.parse(`\\`embed:hello-world.sh\\``);\n      const transformed = plugin({\n        markdownAST\n      }, {\n        directory: `examples`\n      });\n      expect(transformed).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should set the correct Prism language for YAML files","suites":["gatsby-remark-embed-snippet","Language detection"],"updatePoint":{"line":250,"column":60,"index":8404},"line":250,"code":"    it(`should set the correct Prism language for YAML files`, () => {\n      fs.readFileSync.mockReturnValue(`name: Brian Vaughn`);\n      const markdownAST = remark.parse(`\\`embed:hello-world.yaml\\``);\n      const transformed = plugin({\n        markdownAST\n      }, {\n        directory: `examples`\n      });\n      expect(transformed).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should set the correct Prism language for Rust files","suites":["gatsby-remark-embed-snippet","Language detection"],"updatePoint":{"line":260,"column":60,"index":8765},"line":260,"code":"    it(`should set the correct Prism language for Rust files`, () => {\n      fs.readFileSync.mockReturnValue(`extern crate lazy_static;`);\n      const markdownAST = remark.parse(`\\`embed:hello-world.rs\\``);\n      const transformed = plugin({\n        markdownAST\n      }, {\n        directory: `examples`\n      });\n      expect(transformed).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"should set the default Prism language for unknown file extensions","suites":["gatsby-remark-embed-snippet","Language detection"],"updatePoint":{"line":270,"column":73,"index":9144},"line":270,"code":"    it(`should set the default Prism language for unknown file extensions`, () => {\n      const markdownAST = remark.parse(`\\`embed:hello-world\\``);\n      const transformed = plugin({\n        markdownAST\n      }, {\n        directory: `examples`\n      });\n      expect(transformed).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-embed-snippet/src/__tests__"},{"name":"dot","suites":["gatsby-remark-graphviz","handles valid graph languages"],"updatePoint":{"line":26,"column":11,"index":690},"line":26,"code":"    it(`dot`, async () => {\n      const test = await run(`\n\\`\\`\\`dot\n  digraph graphname {\n    a -> b;\n    b -> c;\n    a -> c;\n  }\n\\`\\`\\``);\n      const $ = cheerio.load(test);\n      expect($(`svg`).length).toBe(1);\n      expect($(`pre`).length).toBe(0);\n      expect($(`code`).length).toBe(0);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-graphviz/src/__tests__"},{"name":"circo","suites":["gatsby-remark-graphviz","handles valid graph languages"],"updatePoint":{"line":40,"column":13,"index":995},"line":40,"code":"    it(`circo`, async () => {\n      const test = await run(`\n\\`\\`\\`circo\n  digraph graphname {\n    a -> b;\n    b -> c;\n    a -> c;\n  }\n\\`\\`\\``);\n      const $ = cheerio.load(test);\n      expect($(`svg`).length).toBe(1);\n      expect($(`pre`).length).toBe(0);\n      expect($(`code`).length).toBe(0);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-graphviz/src/__tests__"},{"name":"handles unknown graph lang","suites":["gatsby-remark-graphviz","handles valid graph languages"],"updatePoint":{"line":55,"column":32,"index":1327},"line":55,"code":"  it(`handles unknown graph lang`, async () => {\n    const test = await run(`\n\\`\\`\\`pieh-format\ndigraph graphname {\n  a :heart: b;\n}\n\\`\\`\\``);\n    const $ = cheerio.load(test);\n    expect($(`svg`).length).toBe(0);\n    expect($(`pre`).length).toBe(1);\n    expect($(`code`).length).toBe(1);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-graphviz/src/__tests__"},{"name":"handles additional attributes","suites":["gatsby-remark-graphviz","handles valid graph languages"],"updatePoint":{"line":67,"column":35,"index":1625},"line":67,"code":"  it(`handles additional attributes`, async () => {\n    const test = await run(`\n\\`\\`\\`dot id=\"my-test-id\" class=\"my-test-class\"\n  digraph graphname {\n    a -> b;\n    b -> c;\n    a -> c;\n  }\n\\`\\`\\``);\n    const $ = cheerio.load(test);\n    expect($(`svg`).attr(`id`)).toBe(`my-test-id`);\n    expect($(`svg`).attr(`class`)).toBe(`my-test-class`);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-graphviz/src/__tests__"},{"name":"it returns empty array when 0 images","suites":[],"updatePoint":{"line":102,"column":42,"index":2332},"line":102,"code":"test(`it returns empty array when 0 images`, async () => {\n  const content = `\n# hello world\nLook ma, no images\n  `.trim();\n  const result = await plugin(createPluginOptions(content));\n  expect(result).toEqual([]);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images-contentful/src/__tests__"},{"name":"it leaves relative images alone","suites":[],"updatePoint":{"line":110,"column":37,"index":2546},"line":110,"code":"test(`it leaves relative images alone`, async () => {\n  const imagePath = `images/an-image.jpeg`;\n  const content = `\n![asdf](${imagePath})\n  `.trim();\n  const result = await plugin(createPluginOptions(content, imagePath));\n  expect(result).toEqual([]);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images-contentful/src/__tests__"},{"name":"it leaves non-contentful images alone","suites":[],"updatePoint":{"line":118,"column":43,"index":2810},"line":118,"code":"test(`it leaves non-contentful images alone`, async () => {\n  const imagePath = `//google.com/images/an-image.jpeg`;\n  const content = `\n![asdf](${imagePath})\n  `.trim();\n  const result = await plugin(createPluginOptions(content, imagePath));\n  expect(result).toEqual([]);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images-contentful/src/__tests__"},{"name":"it transforms images in markdown","suites":[],"updatePoint":{"line":126,"column":38,"index":3082},"line":126,"code":"test(`it transforms images in markdown`, async () => {\n  const imagePath = `//images.ctfassets.net/rocybtov1ozk/wtrHxeu3zEoEce2MokCSi/73dce36715f16e27cf5ff0d2d97d7dff/quwowooybuqbl6ntboz3.jpg`;\n  const content = `\n![image](${imagePath})\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath));\n  expect(nodes.length).toBe(1);\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images-contentful/src/__tests__"},{"name":"it transforms images with a https scheme in markdown","suites":[],"updatePoint":{"line":138,"column":58,"index":3604},"line":138,"code":"test(`it transforms images with a https scheme in markdown`, async () => {\n  const imagePath = `https://images.ctfassets.net/rocybtov1ozk/wtrHxeu3zEoEce2MokCSi/73dce36715f16e27cf5ff0d2d97d7dff/quwowooybuqbl6ntboz3.jpg`;\n  const content = `\n![image](${imagePath})\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath));\n  expect(nodes.length).toBe(1);\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images-contentful/src/__tests__"},{"name":"it throws specific error if the image is not found","suites":[],"updatePoint":{"line":150,"column":56,"index":4130},"line":150,"code":"test(`it throws specific error if the image is not found`, async () => {\n  axios.mockImplementationOnce(() => Promise.reject(new Error(`oh no`)));\n  const reporter = {\n    panic: jest.fn()\n  };\n  const imagePath = `https://images.ctfassets.net/rocybtov1ozk/wtrHxeu3zEoEce2MokCSi/73dce36715f16e27cf5ff0d2d97d7dff/doesnotexist.jpg`;\n  const content = `\n![image](${imagePath})\n  `.trim();\n  await plugin(createPluginOptions(content, imagePath, {\n    reporter\n  }));\n  expect(reporter.panic).toHaveBeenCalledTimes(1);\n  expect(reporter.panic).toHaveBeenCalledWith(`Image downloading failed for ${imagePath}, please check if the image still exists on contentful`, expect.any(Error));\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images-contentful/src/__tests__"},{"name":"it transforms multiple images in markdown","suites":[],"updatePoint":{"line":165,"column":47,"index":4804},"line":165,"code":"test(`it transforms multiple images in markdown`, async () => {\n  const imagePaths = [`//images.ctfassets.net/rocybtov1ozk/wtrHxeu3zEoEce2MokCSi/73dce36715f16e27cf5ff0d2d97d7dff/quwowooybuqbl6ntboz3.jpg`, `//images.ctfassets.net/rocybtov1ozk/wtrHxeu3zEoEce2MokCSi/73dce36715f16e27cf5ff0d2d97d7dff/quwowooybuqbl6ntboz3.jpg`];\n  const content = `\n![image 1](${imagePaths[0]})\n![image 2](${imagePaths[1]})\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePaths));\n  expect(nodes.length).toBe(imagePaths.length);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images-contentful/src/__tests__"},{"name":"it transforms HTML img tags","suites":[],"updatePoint":{"line":174,"column":33,"index":5329},"line":174,"code":"test(`it transforms HTML img tags`, async () => {\n  const imagePath = `//images.ctfassets.net/rocybtov1ozk/wtrHxeu3zEoEce2MokCSi/73dce36715f16e27cf5ff0d2d97d7dff/quwowooybuqbl6ntboz3.jpg`;\n  const content = `\n<img src=\"${imagePath}\">\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath));\n  expect(nodes.length).toBe(1);\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images-contentful/src/__tests__"},{"name":"it leaves relative HTML img tags alone","suites":[],"updatePoint":{"line":186,"column":44,"index":5839},"line":186,"code":"test(`it leaves relative HTML img tags alone`, async () => {\n  const imagePath = `images/this-was-an-image.jpeg`;\n  const content = `\n<img src=\"${imagePath}\">\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath));\n  expect(nodes[0].value).toBe(content);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images-contentful/src/__tests__"},{"name":"it transforms images in markdown with webp srcSets if option is enabled","suites":[],"updatePoint":{"line":194,"column":77,"index":6158},"line":194,"code":"test(`it transforms images in markdown with webp srcSets if option is enabled`, async () => {\n  const imagePath = `//images.ctfassets.net/rocybtov1ozk/wtrHxeu3zEoEce2MokCSi/73dce36715f16e27cf5ff0d2d97d7dff/quwowooybuqbl6ntboz3.jpg`;\n  const content = `\n![image](${imagePath})\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath), {\n    withWebp: true\n  });\n  expect(nodes.length).toBe(1);\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images-contentful/src/__tests__"},{"name":"it shows an useful error message when the file is not a valid image","suites":[],"updatePoint":{"line":208,"column":73,"index":6721},"line":208,"code":"test(`it shows an useful error message when the file is not a valid image`, async () => {\n  mockSharpFailure();\n  const imagePath = `//images.ctfassets.net/k8iqpp6u0ior/752jwCIe9dwtfi9mLbp9m2/bc588ee25cf8299bc33a56ca32f8677b/Gatsby-Logos.zip`;\n  const content = `\n![image](${imagePath})\n  `.trim();\n  const reporter = {\n    panic: jest.fn()\n  };\n  await plugin(createPluginOptions(content, imagePath, {\n    reporter\n  }));\n  expect(reporter.panic).toHaveBeenCalledTimes(1);\n  expect(reporter.panic).toHaveBeenCalledWith(`The image \"${imagePath}\" (with alt text: \"image\") doesn't appear to be a supported image format.`, expect.any(Error));\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images-contentful/src/__tests__"},{"name":"proberly calculates responsive values","suites":["builds responsive sizes"],"updatePoint":{"line":24,"column":45,"index":686},"line":24,"code":"  test(`proberly calculates responsive values`, async () => {\n    const result = await buildResponsiveSizes({\n      metadata,\n      imageUrl,\n      options\n    }, reporterMock);\n    expect(result).toMatchSnapshot();\n  });","file":"utils/index.js","skipped":false,"dir":"packages/gatsby-remark-images-contentful/src/__tests__"},{"name":"does not remove search parameters","suites":["builds responsive sizes"],"updatePoint":{"line":32,"column":41,"index":904},"line":32,"code":"  test(`does not remove search parameters`, async () => {\n    const result = await buildResponsiveSizes({\n      metadata,\n      imageUrl: `${imageUrl}?q=70`,\n      options\n    }, reporterMock);\n    expect(result.src).toContain(`q=70`);\n    expect(result.srcSet).toContain(`q=70`);\n    expect(result.webpSrcSet).toContain(`q=70`);\n  });","file":"utils/index.js","skipped":false,"dir":"packages/gatsby-remark-images-contentful/src/__tests__"},{"name":"it sets the default box-shadow on img element","suites":[],"updatePoint":{"line":24,"column":51,"index":633},"line":24,"code":"test(`it sets the default box-shadow on img element`, () => {\n  const pluginOptions = {};\n  const imageElement = createImageElement();\n  onRouteUpdate({}, pluginOptions);\n  imageElement.dispatchEvent(new Event(`load`));\n  expect(imageElement.style[`box-shadow`]).toBe(defaultImageBoxShadowStyle);\n  expect(window.getComputedStyle(imageElement).getPropertyValue(`box-shadow`)).toBe(defaultImageBoxShadowStyle);\n});","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it sets box-shadow color to '' on img when backgroundColor is set to ''","suites":[],"updatePoint":{"line":34,"column":87,"index":1307},"line":34,"code":"  test(`it sets box-shadow color to '${c}' on img when backgroundColor is set to '${c}'`, () => {\n    const pluginOptions = {\n      backgroundColor: `${c}`\n    };\n    const imageElement = createImageElement();\n    onRouteUpdate({}, pluginOptions);\n    imageElement.dispatchEvent(new Event(`load`));\n    expect(imageElement.style[`box-shadow`]).toBe(`inset 0px 0px 0px 400px ${c}`);\n    expect(window.getComputedStyle(imageElement).getPropertyValue(`box-shadow`)).toBe(`inset 0px 0px 0px 400px ${c}`);\n  });","file":"gatsby-browser.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"should provide meaningful errors when fields are invalid","suites":["pluginOptionsSchema"],"updatePoint":{"line":10,"column":62,"index":363},"line":10,"code":"  it(`should provide meaningful errors when fields are invalid`, async () => {\n    const expectedErrors = [`\"maxWidth\" must be a number`, `\"linkImagesToOriginal\" must be a boolean`, `\"showCaptions\" must be one of [boolean, array]`, `\"markdownCaptions\" must be a boolean`, `\"wrapperStyle\" must be one of [object, string]`, `\"backgroundColor\" must be a string`, `\"quality\" must be a number`, `\"withWebp\" must be one of [object, boolean]`, `\"withAvif\" must be one of [object, boolean]`, `\"tracedSVG\" must be one of [boolean, object]`, `\"loading\" must be one of [lazy, eager, auto]`, `\"decoding\" must be one of [async, sync, auto]`, `\"disableBgImageOnAlpha\" must be a boolean`, `\"disableBgImage\" must be a boolean`, `\"srcSetBreakpoints\" must be an array`];\n    const {\n      errors,\n      isValid\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      maxWidth: `This should be a number`,\n      linkImagesToOriginal: `This should be a boolean`,\n      showCaptions: `This should be a boolean`,\n      markdownCaptions: `This should be a boolean`,\n      wrapperStyle: true,\n      backgroundColor: 123,\n      quality: `This should be a number`,\n      withWebp: `This should be a boolean or an object`,\n      withAvif: `This should be a boolean or an object`,\n      tracedSVG: `This should be a boolean`,\n      loading: `This should be lazy, eager or auto`,\n      decoding: `This should be async, sync or auto`,\n      disableBgImageOnAlpha: `This should be a boolean`,\n      disableBgImage: `This should be a boolean`,\n      srcSetBreakpoints: `This should be an array`\n    });\n    expect(isValid).toBe(false);\n    expect(errors).toEqual(expectedErrors);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"should validate the schema","suites":["pluginOptionsSchema"],"updatePoint":{"line":35,"column":32,"index":1997},"line":35,"code":"  it(`should validate the schema`, async () => {\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      maxWidth: 700,\n      linkImagesToOriginal: false,\n      showCaptions: true,\n      markdownCaptions: true,\n      wrapperStyle: {\n        marginTop: `1rem`,\n        padding: `1.5rem`,\n        color: `blue`\n      },\n      backgroundColor: `red`,\n      quality: 77,\n      withWebp: true,\n      withAvif: true,\n      tracedSVG: true,\n      loading: `eager`,\n      decoding: `async`,\n      disableBgImageOnAlpha: true,\n      disableBgImage: true,\n      srcSetBreakpoints: [400, 600, 800]\n    });\n    expect(isValid).toBe(true);\n    expect(warnSpy).toBeCalledWith(`\"tracedSVG\" plugin option for \"gatsby-remark-images\" is no longer supported. Blurred placeholder will be used. See https://gatsby.dev/tracesvg-removal/`);\n    expect(errors).toEqual([]);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"should validate the withWebp prop","suites":["pluginOptionsSchema"],"updatePoint":{"line":64,"column":39,"index":2911},"line":64,"code":"  it(`should validate the withWebp prop`, async () => {\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      withWebp: {\n        quality: 100\n      }\n    });\n    expect(isValid).toBe(true);\n    expect(errors).toEqual([]);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"should validate the withAvif prop","suites":["pluginOptionsSchema"],"updatePoint":{"line":76,"column":39,"index":3193},"line":76,"code":"  it(`should validate the withAvif prop`, async () => {\n    const {\n      isValid\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      withAvif: {\n        quality: 100\n      }\n    });\n    expect(isValid).toBe(true);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"[\"title\", \"alt\"]","suites":["pluginOptionsSchema","allow to use array of valid strings for \"showCaptions\""],"updatePoint":{"line":87,"column":24,"index":3491},"line":87,"code":"    it(`[\"title\", \"alt\"]`, async () => {\n      const {\n        isValid,\n        errors\n      } = await testPluginOptionsSchema(pluginOptionsSchema, {\n        showCaptions: [`title`, `alt`]\n      });\n      expect(isValid).toBe(true);\n      expect(errors).toEqual([]);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"[\"title\"]","suites":["pluginOptionsSchema","allow to use array of valid strings for \"showCaptions\""],"updatePoint":{"line":97,"column":17,"index":3759},"line":97,"code":"    it(`[\"title\"]`, async () => {\n      const {\n        isValid,\n        errors\n      } = await testPluginOptionsSchema(pluginOptionsSchema, {\n        showCaptions: [`title`]\n      });\n      expect(isValid).toBe(true);\n      expect(errors).toEqual([]);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"[\"alt\"]","suites":["pluginOptionsSchema","allow to use array of valid strings for \"showCaptions\""],"updatePoint":{"line":107,"column":15,"index":4018},"line":107,"code":"    it(`[\"alt\"]`, async () => {\n      const {\n        isValid,\n        errors\n      } = await testPluginOptionsSchema(pluginOptionsSchema, {\n        showCaptions: [`alt`]\n      });\n      expect(isValid).toBe(true);\n      expect(errors).toEqual([]);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"[\"not valid\"] (should fail validation)","suites":["pluginOptionsSchema","allow to use array of valid strings for \"showCaptions\""],"updatePoint":{"line":117,"column":46,"index":4306},"line":117,"code":"    it(`[\"not valid\"] (should fail validation)`, async () => {\n      const expectedErrors = [`\"showCaptions[0]\" does not match any of the allowed types`];\n      const {\n        isValid,\n        errors\n      } = await testPluginOptionsSchema(pluginOptionsSchema, {\n        showCaptions: [`not valid`]\n      });\n      expect(isValid).toBe(false);\n      expect(errors).toEqual(expectedErrors);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"%s","suites":["pluginOptionsSchema","allow different variants of \"tracedSVG\" option","supports boolean variant"],"line":131,"code":"      it.each([[`true`, true], [`false`, false]])(`%s`, async (_title, booleanValue) => {\n        const {\n          isValid,\n          errors\n        } = await testPluginOptionsSchema(pluginOptionsSchema, {\n          tracedSVG: booleanValue\n        });\n        expect(isValid).toBe(true);\n        if (booleanValue) {\n          expect(warnSpy).toBeCalledWith(`\"tracedSVG\" plugin option for \"gatsby-remark-images\" is no longer supported. Blurred placeholder will be used. See https://gatsby.dev/tracesvg-removal/`);\n        }\n        expect(errors).toEqual([]);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"should validate when all fields are set","suites":["pluginOptionsSchema","allow different variants of \"tracedSVG\" option","supports object notation"],"updatePoint":{"line":146,"column":49,"index":5459},"line":146,"code":"      it(`should validate when all fields are set`, async () => {\n        const {\n          isValid,\n          errors\n        } = await testPluginOptionsSchema(pluginOptionsSchema, {\n          tracedSVG: {\n            turnPolicy: `TURNPOLICY_RIGHT`,\n            turdSize: 50,\n            alphaMax: 0.5,\n            optCurve: false,\n            optTolerance: 0.9,\n            threshold: 230,\n            blackOnWhite: false,\n            color: `red`,\n            background: `green`\n          }\n        });\n        expect(isValid).toBe(true);\n        expect(warnSpy).toBeCalledWith(`\"tracedSVG\" plugin option for \"gatsby-remark-images\" is no longer supported. Blurred placeholder will be used. See https://gatsby.dev/tracesvg-removal/`);\n        expect(errors).toEqual([]);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"should validate when some fields are set","suites":["pluginOptionsSchema","allow different variants of \"tracedSVG\" option","supports object notation"],"updatePoint":{"line":167,"column":50,"index":6243},"line":167,"code":"      it(`should validate when some fields are set`, async () => {\n        const {\n          isValid,\n          errors\n        } = await testPluginOptionsSchema(pluginOptionsSchema, {\n          tracedSVG: {\n            turnPolicy: `TURNPOLICY_RIGHT`,\n            turdSize: 50,\n            // alphaMax: 0.5,\n            // optCurve: 0.2,\n            // optTolerance: 0.9,\n            // threshold: 230,\n            // blackOnWhite: false,\n            color: `red`,\n            background: `green`\n          }\n        });\n        expect(isValid).toBe(true);\n        expect(warnSpy).toBeCalledWith(`\"tracedSVG\" plugin option for \"gatsby-remark-images\" is no longer supported. Blurred placeholder will be used. See https://gatsby.dev/tracesvg-removal/`);\n        expect(errors).toEqual([]);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"should fail validation when unknown fields are set","suites":["pluginOptionsSchema","allow different variants of \"tracedSVG\" option","supports object notation"],"updatePoint":{"line":188,"column":60,"index":7050},"line":188,"code":"      it(`should fail validation when unknown fields are set`, async () => {\n        const expectedErrors = [`\"tracedSVG.foo\" is not allowed`];\n        const {\n          isValid,\n          errors\n        } = await testPluginOptionsSchema(pluginOptionsSchema, {\n          tracedSVG: {\n            foo: `bar`\n          }\n        });\n        expect(isValid).toBe(false);\n        expect(errors).toEqual(expectedErrors);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"supports setting by policy name (%s)","suites":["pluginOptionsSchema","allow different variants of \"tracedSVG\" option","supports object notation","turnPolicy variants"],"line":202,"code":"        it.each([`TURNPOLICY_BLACK`, `TURNPOLICY_WHITE`, `TURNPOLICY_LEFT`, `TURNPOLICY_RIGHT`, `TURNPOLICY_MINORITY`, `TURNPOLICY_MAJORITY`])(`supports setting by policy name (%s)`, async name => {\n          const {\n            isValid,\n            errors\n          } = await testPluginOptionsSchema(pluginOptionsSchema, {\n            tracedSVG: {\n              turnPolicy: name\n            }\n          });\n          expect(isValid).toBe(true);\n          expect(warnSpy).toBeCalledWith(`\"tracedSVG\" plugin option for \"gatsby-remark-images\" is no longer supported. Blurred placeholder will be used. See https://gatsby.dev/tracesvg-removal/`);\n          expect(errors).toEqual([]);\n        });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"supports setting by policy value (%s)","suites":["pluginOptionsSchema","allow different variants of \"tracedSVG\" option","supports object notation","turnPolicy variants"],"line":215,"code":"        it.each([`black`, `white`, `left`, `TURNPOLICY_RIGHT`, `minority`, `majority`])(`supports setting by policy value (%s)`, async value => {\n          const {\n            isValid,\n            errors\n          } = await testPluginOptionsSchema(pluginOptionsSchema, {\n            tracedSVG: {\n              turnPolicy: value\n            }\n          });\n          expect(isValid).toBe(true);\n          expect(warnSpy).toBeCalledWith(`\"tracedSVG\" plugin option for \"gatsby-remark-images\" is no longer supported. Blurred placeholder will be used. See https://gatsby.dev/tracesvg-removal/`);\n          expect(errors).toEqual([]);\n        });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"Doesn't support arbitrary string values","suites":["pluginOptionsSchema","allow different variants of \"tracedSVG\" option","supports object notation","turnPolicy variants"],"updatePoint":{"line":228,"column":51,"index":8847},"line":228,"code":"        it(`Doesn't support arbitrary string values`, async () => {\n          const expectedErrors = [`\"tracedSVG.turnPolicy\" must be one of [TURNPOLICY_BLACK, TURNPOLICY_WHITE, TURNPOLICY_LEFT, TURNPOLICY_RIGHT, TURNPOLICY_MINORITY, TURNPOLICY_MAJORITY, black, white, left, right, minority, majority]`];\n          const {\n            isValid,\n            errors\n          } = await testPluginOptionsSchema(pluginOptionsSchema, {\n            tracedSVG: {\n              turnPolicy: `foo`\n            }\n          });\n          expect(isValid).toBe(false);\n          expect(errors).toEqual(expectedErrors);\n        });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"Allow setting %s","suites":["pluginOptionsSchema","allow different variants of \"tracedSVG\" option","supports object notation","threshold"],"line":244,"code":"        it.each([[`THRESHOLD_AUTO`, {\n          value: -1,\n          expectedIsValid: true\n        }], [0, {\n          expectedIsValid: true\n        }], [128, {\n          expectedIsValid: true\n        }], [255, {\n          expectedIsValid: true\n        }]])(`Allow setting %s`, async (titleAndMaybeValue, {\n          value\n        }) => {\n          if (typeof value === `undefined`) {\n            // if value wasn't explicitly set use title\n            value = titleAndMaybeValue;\n          }\n          const {\n            isValid,\n            errors\n          } = await testPluginOptionsSchema(pluginOptionsSchema, {\n            tracedSVG: {\n              threshold: value\n            }\n          });\n          expect(isValid).toBe(true);\n          expect(warnSpy).toBeCalledWith(`\"tracedSVG\" plugin option for \"gatsby-remark-images\" is no longer supported. Blurred placeholder will be used. See https://gatsby.dev/tracesvg-removal/`);\n          expect(errors).toEqual([]);\n        });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"Doesn't allow setting %s","suites":["pluginOptionsSchema","allow different variants of \"tracedSVG\" option","supports object notation","threshold"],"line":274,"code":"        it.each([[-5, {\n          expectedIsValid: false,\n          errorMessage: `\"tracedSVG.threshold\" must be greater than or equal to 0`\n        }], [256, {\n          expectedIsValid: false,\n          errorMessage: `\"tracedSVG.threshold\" must be less than or equal to 255`\n        }]])(`Doesn't allow setting %s`, async (titleAndMaybeValue, {\n          value,\n          errorMessage\n        }) => {\n          if (typeof value === `undefined`) {\n            // if value wasn't explicitly set use title\n            value = titleAndMaybeValue;\n          }\n          const {\n            isValid,\n            errors\n          } = await testPluginOptionsSchema(pluginOptionsSchema, {\n            tracedSVG: {\n              threshold: value\n            }\n          });\n          expect(isValid).toBe(false);\n          expect(errors[0]).toEqual(errorMessage);\n        });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it returns empty array when 0 images","suites":[],"updatePoint":{"line":118,"column":42,"index":3080},"line":118,"code":"test(`it returns empty array when 0 images`, async () => {\n  const content = `\n# hello world\n\nLook ma, no images\n  `.trim();\n  const result = await plugin(createPluginOptions(content));\n  expect(result).toEqual([]);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it leaves non-relative images alone","suites":[],"updatePoint":{"line":127,"column":41,"index":3299},"line":127,"code":"test(`it leaves non-relative images alone`, async () => {\n  const imagePath = `https://google.com/images/an-image.jpeg`;\n  const content = `\n![asdf](${imagePath})\n  `.trim();\n  const result = await plugin(createPluginOptions(content, imagePath));\n  expect(result).toEqual([]);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it leaves files with unsupported file extensions alone","suites":[],"updatePoint":{"line":135,"column":60,"index":3599},"line":135,"code":"test(`it leaves files with unsupported file extensions alone`, async () => {\n  const imagePath = `video/my-video.mp4`;\n  const content = `\n![video](./${imagePath})\n  `.trim();\n  const result = await plugin(createPluginOptions(content, imagePath));\n  expect(result).toEqual([]);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it transforms images in markdown and uses getRemarkFileDependency when given","suites":[],"updatePoint":{"line":143,"column":82,"index":3903},"line":143,"code":"test(`it transforms images in markdown and uses getRemarkFileDependency when given`, async () => {\n  const imagePath = `images/my-image.jpeg`;\n  const content = `\n\n![image](./${imagePath})\n  `.trim();\n  const pluginOptions = createPluginOptions(content, imagePath, true);\n  const nodes = await plugin(pluginOptions);\n  expect(nodes.length).toBe(1);\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n  expect(pluginOptions.getRemarkFileDependency.mock.calls.length).toBe(1);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it transforms images in markdown","suites":[],"updatePoint":{"line":158,"column":38,"index":4433},"line":158,"code":"test(`it transforms images in markdown`, async () => {\n  const imagePath = `images/my-image.jpeg`;\n  const content = `\n\n![image](./${imagePath})\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath));\n  expect(nodes.length).toBe(1);\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it transforms images in markdown in nested markdown node","suites":[],"updatePoint":{"line":171,"column":62,"index":4867},"line":171,"code":"test(`it transforms images in markdown in nested markdown node`, async () => {\n  const imagePath = `images/my-image.jpeg`;\n  const content = `\n\n![image](./${imagePath})\n  `.trim();\n  const nodes = await plugin(createRecursivePluginOptions(content, imagePath));\n  expect(nodes.length).toBe(1);\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it transforms images in markdown with the \"withWebp\" option","suites":[],"updatePoint":{"line":184,"column":65,"index":5313},"line":184,"code":"test(`it transforms images in markdown with the \"withWebp\" option`, async () => {\n  const imagePath = `images/my-image.jpeg`;\n  const content = `\n\n![image](./${imagePath})\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath), {\n    withWebp: true\n  });\n  expect(nodes.length).toBe(1);\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it transforms images in markdown with the \"withAvif\" option","suites":[],"updatePoint":{"line":199,"column":65,"index":5776},"line":199,"code":"test(`it transforms images in markdown with the \"withAvif\" option`, async () => {\n  const imagePath = `images/my-image.jpeg`;\n  const content = `\n\n![image](./${imagePath})\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath), {\n    withAvif: true\n  });\n  expect(nodes.length).toBe(1);\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it transforms multiple images in markdown","suites":[],"updatePoint":{"line":214,"column":47,"index":6221},"line":214,"code":"test(`it transforms multiple images in markdown`, async () => {\n  const imagePaths = [`images/my-image.jpeg`, `images/other-image.jpeg`];\n  const content = `\n![image 1](./${imagePaths[0]})\n![image 2](./${imagePaths[1]})\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePaths));\n  expect(nodes.length).toBe(imagePaths.length);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it transforms image references in markdown","suites":[],"updatePoint":{"line":223,"column":48,"index":6578},"line":223,"code":"test(`it transforms image references in markdown`, async () => {\n  const imagePath = `images/my-image.jpeg`;\n  const content = `\n[refImage1]: ./${imagePath} \"Ref Image Title\"\n![alt text][refImage1]\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath));\n  expect(nodes.length).toBe(1);\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it leaves orphan image references alone","suites":[],"updatePoint":{"line":236,"column":45,"index":7038},"line":236,"code":"test(`it leaves orphan image references alone`, async () => {\n  const imagePath = `images/my-image.jpeg`;\n  const content = `\n[refImage1]: ./${imagePath} \"Ref Image Title\"\n![image][refImage2]\n  `.trim();\n  const result = await plugin(createPluginOptions(content, imagePath));\n  expect(result).toEqual([]);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it transforms multiple image references in markdown","suites":[],"updatePoint":{"line":245,"column":57,"index":7360},"line":245,"code":"test(`it transforms multiple image references in markdown`, async () => {\n  const imagePaths = [`images/my-image.jpeg`, `images/other-image.jpeg`];\n  const content = `\n[refImage1]: ./${imagePaths[0]} \"Ref1 Image Title\"\n[refImage2]: ./${imagePaths[1]} \"Ref2 Image Title\"\n![image 1][refImage1]\n![image 2][refImage2]\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePaths));\n  expect(nodes.length).toBe(imagePaths.length);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it transforms multiple image links and image references in markdown","suites":[],"updatePoint":{"line":256,"column":73,"index":7826},"line":256,"code":"test(`it transforms multiple image links and image references in markdown`, async () => {\n  const imagePaths = [`images/my-image.jpeg`, `images/other-image.jpeg`];\n  const content = `\n[refImage1]: ./${imagePaths[0]} \"Ref1 Image Title\"\n[refImage2]: ./${imagePaths[1]} \"Ref2 Image Title\"\n![image 1][refImage1]\n![image 2][refImage2]\n![image 1](./${imagePaths[0]})\n![image 2](./${imagePaths[1]})\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePaths));\n  expect(nodes.length).toBe(imagePaths.length * 2);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it transforms HTML img tags","suites":[],"updatePoint":{"line":269,"column":33,"index":8318},"line":269,"code":"test(`it transforms HTML img tags`, async () => {\n  const imagePath = `image/my-image.jpeg`;\n  const content = `\n<img src=\"./${imagePath}\">\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath));\n  expect(nodes.length).toBe(1);\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it leaves non-relative HTML img tags alone","suites":[],"updatePoint":{"line":281,"column":48,"index":8738},"line":281,"code":"test(`it leaves non-relative HTML img tags alone`, async () => {\n  const imagePath = `https://google.com/images/this-was-an-image.jpeg`;\n  const content = `\n<img src=\"${imagePath}\">\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath));\n  expect(nodes[0].value).toBe(content);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it leaves images that are already linked alone","suites":[],"updatePoint":{"line":289,"column":52,"index":9051},"line":289,"code":"test(`it leaves images that are already linked alone`, async () => {\n  const imagePath = `image/my-image.jpg`;\n  const content = `\n[![img](./${imagePath})](https://google.com)\n`;\n  const nodes = await plugin(createPluginOptions(content, imagePath));\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it leaves linked HTML img tags alone","suites":[],"updatePoint":{"line":300,"column":42,"index":9441},"line":300,"code":"test(`it leaves linked HTML img tags alone`, async () => {\n  const imagePath = `images/this-image-already-has-a-link.jpeg`;\n  const content = `\n<a href=\"https://example.org\">\n  <img src=\"./${imagePath}\">\n</a>\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath));\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it leaves single-line linked HTML img tags alone","suites":[],"updatePoint":{"line":313,"column":54,"index":9895},"line":313,"code":"test(`it leaves single-line linked HTML img tags alone`, async () => {\n  const imagePath = `images/this-image-already-has-a-link.jpeg`;\n  const content = `\n<a href=\"https://example.org\"><img src=\"./${imagePath}\"></a>\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath));\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it handles goofy nesting properly","suites":[],"updatePoint":{"line":324,"column":39,"index":10330},"line":324,"code":"test(`it handles goofy nesting properly`, async () => {\n  const imagePath = `images/this-image-already-has-a-link.jpeg`;\n  const content = `\n  <a href=\"https://google.com\">**![test](./${imagePath})**</a>\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath));\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it transforms HTML img tags with query strings","suites":[],"updatePoint":{"line":335,"column":52,"index":10780},"line":335,"code":"test(`it transforms HTML img tags with query strings`, async () => {\n  const imagePath = `image/my-image.jpeg?query=string`;\n  const content = `\n<img src=\"./${imagePath}\">\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath));\n  expect(nodes.length).toBe(1);\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it transforms images in markdown with query strings","suites":[],"updatePoint":{"line":347,"column":57,"index":11222},"line":347,"code":"test(`it transforms images in markdown with query strings`, async () => {\n  const imagePath = `images/my-image.jpeg?query=string`;\n  const content = `\n\n![image](./${imagePath})\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath));\n  expect(nodes.length).toBe(1);\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"it doesn't use tracedSVG placeholder (deprecated and fallback to base64)","suites":[],"updatePoint":{"line":360,"column":78,"index":11685},"line":360,"code":"test(`it doesn't use tracedSVG placeholder (deprecated and fallback to base64)`, async () => {\n  const imagePath = `images/my-image.jpeg`;\n  const content = `\n![image](./${imagePath})\n  `.trim();\n  const nodes = await plugin(createPluginOptions(content, imagePath), {\n    tracedSVG: {\n      color: `COLOR_AUTO`,\n      turnPolicy: `TURNPOLICY_LEFT`\n    }\n  });\n  expect(nodes.length).toBe(1);\n  const node = nodes.pop();\n  expect(node.type).toBe(`html`);\n  expect(node.value).toMatchSnapshot();\n  expect(node.value).not.toMatch(`<html>`);\n  expect(mockTraceSVG).toBeCalledTimes(0);\n});","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"display title as caption when showCaptions === true","suites":["showCaptions"],"updatePoint":{"line":379,"column":57,"index":12282},"line":379,"code":"  it(`display title as caption when showCaptions === true`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: true\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).text()).toEqual(`some title`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"display nothing as caption when showCaptions === false","suites":["showCaptions"],"updatePoint":{"line":391,"column":60,"index":12786},"line":391,"code":"  it(`display nothing as caption when showCaptions === false`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: false\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).length).toBe(0);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"display nothing as caption when showCaptions === []","suites":["showCaptions"],"updatePoint":{"line":402,"column":57,"index":13232},"line":402,"code":"  it(`display nothing as caption when showCaptions === []`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: []\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).length).toBe(0);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"display alt as caption if title was not found and showCaptions === true","suites":["showCaptions"],"updatePoint":{"line":413,"column":77,"index":13695},"line":413,"code":"  it(`display alt as caption if title was not found and showCaptions === true`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath})`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: true\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).text()).toEqual(`some alt`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"display nothing as caption if no title or alt","suites":["showCaptions"],"updatePoint":{"line":425,"column":51,"index":14175},"line":425,"code":"  it(`display nothing as caption if no title or alt`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![](./${imagePath})`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: true\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).length).toBe(0);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"display alt as caption if specified first in showCaptions array","suites":["showCaptions"],"updatePoint":{"line":436,"column":69,"index":14611},"line":436,"code":"  it(`display alt as caption if specified first in showCaptions array`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: [`alt`, `title`]\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).text()).toEqual(`some alt`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"display title as caption if specified first in showCaptions array","suites":["showCaptions"],"updatePoint":{"line":448,"column":71,"index":15136},"line":448,"code":"  it(`display title as caption if specified first in showCaptions array`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: [`title`, `alt`]\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).text()).toEqual(`some title`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"display alt as caption if specified in showCaptions array","suites":["showCaptions"],"updatePoint":{"line":460,"column":63,"index":15655},"line":460,"code":"  it(`display alt as caption if specified in showCaptions array`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: [`alt`]\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).text()).toEqual(`some alt`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"display title as caption if specified in showCaptions array","suites":["showCaptions"],"updatePoint":{"line":472,"column":65,"index":16165},"line":472,"code":"  it(`display title as caption if specified in showCaptions array`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: [`title`]\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).text()).toEqual(`some title`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"fallback to alt as caption if specified second in showCaptions array","suites":["showCaptions"],"updatePoint":{"line":484,"column":74,"index":16688},"line":484,"code":"  it(`fallback to alt as caption if specified second in showCaptions array`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath})`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: [`title`, `alt`]\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).text()).toEqual(`some alt`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"fallback to title as caption if specified second in showCaptions array","suites":["showCaptions"],"updatePoint":{"line":496,"column":76,"index":17205},"line":496,"code":"  it(`fallback to title as caption if specified second in showCaptions array`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: [`alt`, `title`]\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).text()).toEqual(`some title`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"fallback to no caption if no match can be found","suites":["showCaptions"],"updatePoint":{"line":508,"column":53,"index":17706},"line":508,"code":"  it(`fallback to no caption if no match can be found`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath})`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: [`title`]\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).length).toBe(0);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"display alt as caption if specified in showCaptions array, even if it matches filename","suites":["showCaptions"],"updatePoint":{"line":519,"column":92,"index":18178},"line":519,"code":"  it(`display alt as caption if specified in showCaptions array, even if it matches filename`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![my image](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: [`alt`]\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).html()).toEqual(`my image`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"display title in markdown as caption when showCaptions === true && markdownCaptions === true","suites":["markdownCaptions"],"updatePoint":{"line":533,"column":98,"index":18762},"line":533,"code":"  it(`display title in markdown as caption when showCaptions === true && markdownCaptions === true`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath} \"some _title_\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: true,\n      markdownCaptions: true\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).html()).toEqual(`<p>some <em>title</em></p>`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"display title in text as caption when showCaptions === true && markdownCaptions === false","suites":["markdownCaptions"],"updatePoint":{"line":546,"column":95,"index":19349},"line":546,"code":"  it(`display title in text as caption when showCaptions === true && markdownCaptions === false`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath} \"some _title_\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: true,\n      markdownCaptions: false\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).html()).toEqual(`some _title_`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"display nothing as caption when showCaptions === false && markdownCaptions === true","suites":["markdownCaptions"],"updatePoint":{"line":559,"column":89,"index":19917},"line":559,"code":"  it(`display nothing as caption when showCaptions === false && markdownCaptions === true`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath} \"some _title_\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      showCaptions: false,\n      markdownCaptions: true\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`figcaption`).length).toBe(0);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"does not disable background image on transparent images when disableBgImageOnAlpha === false","suites":["disableBgImageOnAlpha"],"updatePoint":{"line":573,"column":98,"index":20482},"line":573,"code":"  it(`does not disable background image on transparent images when disableBgImageOnAlpha === false`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      disableBgImageOnAlpha: false\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    expect(node.type).toBe(`html`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"disables background image on transparent images when disableBgImageOnAlpha === true","suites":["disableBgImageOnAlpha"],"updatePoint":{"line":584,"column":89,"index":20963},"line":584,"code":"  it(`disables background image on transparent images when disableBgImageOnAlpha === true`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      disableBgImageOnAlpha: true\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    expect(node.type).toBe(`html`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"does not disable background image when disableBgImage === false","suites":["disableBgImage"],"updatePoint":{"line":597,"column":69,"index":21462},"line":597,"code":"  it(`does not disable background image when disableBgImage === false`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      disableBgImage: false\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    expect(node.type).toBe(`html`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"disables background image when disableBgImage === true","suites":["disableBgImage"],"updatePoint":{"line":608,"column":60,"index":21907},"line":608,"code":"  it(`disables background image when disableBgImage === true`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![some alt](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath), {\n      disableBgImage: true\n    });\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    expect(node.type).toBe(`html`);\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"should be generated correctly","suites":["image alt attribute"],"updatePoint":{"line":621,"column":35,"index":22370},"line":621,"code":"  it(`should be generated correctly`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![testing-if-alt-is-correct](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath));\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`img`).attr(`alt`)).toEqual(`testing-if-alt-is-correct`);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"should use escaped filename as fallback","suites":["image alt attribute"],"updatePoint":{"line":630,"column":45,"index":22813},"line":630,"code":"  it(`should use escaped filename as fallback`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath));\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`img`).attr(`alt`)).toEqual(`my image`);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"should be able to consider EMPTY_ALT","suites":["image alt attribute"],"updatePoint":{"line":639,"column":42,"index":23211},"line":639,"code":"  it(`should be able to consider EMPTY_ALT`, async () => {\n    const imagePath = `images/my-image.jpeg`;\n    const content = `![GATSBY_EMPTY_ALT](./${imagePath} \"some title\")`;\n    const nodes = await plugin(createPluginOptions(content, imagePath));\n    expect(nodes.length).toBe(1);\n    const node = nodes.pop();\n    const $ = cheerio.load(node.value);\n    expect($(`img`).attr(`alt`)).toEqual(``);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-images/src/__tests__"},{"name":"renders inlineMath node properly","suites":["remark katex plugin"],"updatePoint":{"line":4,"column":38,"index":149},"line":4,"code":"  it(`renders inlineMath node properly`, () => {\n    const equation = `$a^2 + b^2 = c^2$`;\n    let remark = new Remark();\n    for (const parserPlugins of plugin.setParserPlugins()) {\n      remark = remark.use(parserPlugins);\n    }\n    const markdownAST = remark.parse(equation);\n    plugin({\n      markdownAST\n    });\n    expect(markdownAST).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-katex/src/__tests__"},{"name":"renders double $ inlineMath node properly","suites":["remark katex plugin"],"updatePoint":{"line":16,"column":47,"index":525},"line":16,"code":"  it(`renders double $ inlineMath node properly`, () => {\n    const equation = `$$a^2 + b^2 = c^2$$`;\n    let remark = new Remark();\n    for (const parserPlugins of plugin.setParserPlugins()) {\n      remark = remark.use(parserPlugins);\n    }\n    const markdownAST = remark.parse(equation);\n    plugin({\n      markdownAST\n    });\n    expect(markdownAST).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-katex/src/__tests__"},{"name":"renders math node properly","suites":["remark katex plugin"],"updatePoint":{"line":28,"column":32,"index":888},"line":28,"code":"  it(`renders math node properly`, () => {\n    const equation = `$$\\na^2 + b^2 = c^2\\n$$`;\n    let remark = new Remark();\n    for (const parserPlugins of plugin.setParserPlugins()) {\n      remark = remark.use(parserPlugins);\n    }\n    const markdownAST = remark.parse(equation);\n    plugin({\n      markdownAST\n    });\n    expect(markdownAST).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-katex/src/__tests__"},{"name":"should return the <span> container with the right classes","suites":["returns the line numbers container"],"updatePoint":{"line":4,"column":63,"index":210},"line":4,"code":"  it(`should return the <span> container with the right classes`, () => {\n    expect(addLineNumbers(``)).toEqual(`<span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\">` + `</span>`);\n  });","file":"add-line-numbers.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should return return as many <span></span> children as there are code lines","suites":["returns the line numbers container"],"updatePoint":{"line":7,"column":81,"index":466},"line":7,"code":"  it(`should return return as many <span></span> children as there are code lines`, () => {\n    const basicCodeLines = `line1\\nline2\\nline3`;\n    const basicCodeLinesWithLineNumbers = addLineNumbers(basicCodeLines);\n    const $ = cheerio.load(basicCodeLinesWithLineNumbers);\n    const numberOfLineNumbers = $(`.line-numbers-rows > span`).length;\n    expect(numberOfLineNumbers).toEqual(3);\n  });","file":"add-line-numbers.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should return as many <span></span> children as there are code lines and highlight classes","suites":["returns the line numbers container"],"updatePoint":{"line":14,"column":96,"index":877},"line":14,"code":"  it(`should return as many <span></span> children as there are code lines and highlight classes`, () => {\n    // Expect 6 internal spans\n    const highlightedCode = `line1\\n` + `<span class=\\\\\"gatsby-highlight-code-line\\\\\"></span>` + `line2\\n` + ` <span class=\\\\\"gatsby-highlight-code-line\\\\\"></span>` + ` line3\\n` + `line4`;\n    const highlightedCodeWithLineNumbers = addLineNumbers(highlightedCode);\n    const $ = cheerio.load(highlightedCodeWithLineNumbers);\n    const numberOfLineNumbers = $(`.line-numbers-rows > span`).length;\n    expect(numberOfLineNumbers).toEqual(4 + 2);\n  });","file":"add-line-numbers.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should support hide markers in CSS","suites":["hiding lines"],"updatePoint":{"line":9,"column":40,"index":369},"line":9,"code":"  it(`should support hide markers in CSS`, () => {\n    const processed = highlightLineRange(fixtures.hideLineCss);\n    expect(processed).toMatchSnapshot();\n    expect(processed.length).toEqual(4);\n  });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should support hide markers in HTML","suites":["hiding lines"],"updatePoint":{"line":14,"column":41,"index":573},"line":14,"code":"  it(`should support hide markers in HTML`, () => {\n    const processed = highlightLineRange(fixtures.hideLineHtml);\n    expect(processed).toMatchSnapshot();\n    expect(processed.length).toEqual(10);\n  });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should support hide markers in JS","suites":["hiding lines"],"updatePoint":{"line":19,"column":39,"index":777},"line":19,"code":"  it(`should support hide markers in JS`, () => {\n    const processed = highlightLineRange(fixtures.hideLine);\n    expect(processed).toMatchSnapshot();\n    expect(processed.length).toEqual(14);\n  });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"strips directive","suites":["highlighting lines","highlight-line"],"updatePoint":{"line":27,"column":24,"index":1042},"line":27,"code":"    it(`strips directive`, () => {\n      const highlights = highlightLineRange(fixtures.highlightLine);\n      expect(output(highlights)).not.toContain(`highlight-line`);\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"highlights line","suites":["highlighting lines","highlight-line"],"updatePoint":{"line":31,"column":23,"index":1219},"line":31,"code":"    it(`highlights line`, () => {\n      const highlights = highlightLineRange(fixtures.highlightLine);\n      expect(output(getHighlighted(highlights))).toMatchSnapshot();\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"strips directive","suites":["highlighting lines","highlight-next-line"],"updatePoint":{"line":37,"column":24,"index":1447},"line":37,"code":"    it(`strips directive`, () => {\n      const highlights = highlightLineRange(fixtures.highlightNextLine);\n      expect(output(highlights)).not.toContain(`highlight-next-line`);\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"highlights correct line","suites":["highlighting lines","highlight-next-line"],"updatePoint":{"line":41,"column":31,"index":1641},"line":41,"code":"    it(`highlights correct line`, () => {\n      const highlights = highlightLineRange(fixtures.highlightNextLine);\n      expect(output(getHighlighted(highlights))).toMatchSnapshot();\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"strips directives","suites":["highlighting lines","highlight-start / highlight-end"],"updatePoint":{"line":47,"column":25,"index":1886},"line":47,"code":"    it(`strips directives`, () => {\n      const highlights = highlightLineRange(fixtures.highlightStartEnd);\n      const code = output(highlights);\n      [`highlight-start`, `highlight-end`].forEach(directive => {\n        expect(code).not.toContain(directive);\n      });\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"highlights correct lines","suites":["highlighting lines","highlight-start / highlight-end"],"updatePoint":{"line":54,"column":32,"index":2172},"line":54,"code":"    it(`highlights correct lines`, () => {\n      const highlights = highlightLineRange(fixtures.highlightStartEnd);\n      expect(output(getHighlighted(highlights))).toMatchSnapshot();\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"highlights without end directive","suites":["highlighting lines","highlight-start / highlight-end"],"updatePoint":{"line":58,"column":40,"index":2372},"line":58,"code":"    it(`highlights without end directive`, () => {\n      const highlights = highlightLineRange(fixtures.highlightStartWithoutEnd);\n      expect(output(getHighlighted(highlights))).toMatchSnapshot();\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"strips directives","suites":["highlighting lines","highlight-range"],"updatePoint":{"line":64,"column":25,"index":2608},"line":64,"code":"    it(`strips directives`, () => {\n      const highlights = highlightLineRange(fixtures.highlightRange);\n      expect(output(highlights)).not.toContain(`highlight-range`);\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"highlights correct lines","suites":["highlighting lines","highlight-range"],"updatePoint":{"line":68,"column":32,"index":2796},"line":68,"code":"    it(`highlights correct lines`, () => {\n      const highlights = highlightLineRange(fixtures.highlightRange);\n      expect(output(getHighlighted(highlights))).toMatchSnapshot();\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"does not highlight and warns if range is invalid","suites":["highlighting lines","highlight-range"],"updatePoint":{"line":72,"column":56,"index":3009},"line":72,"code":"    it(`does not highlight and warns if range is invalid`, () => {\n      jest.spyOn(console, `warn`);\n      const highlights = highlightLineRange(fixtures.highlightRangeInvalid);\n      expect(output(getHighlighted(highlights))).toMatchSnapshot();\n      expect(console.warn).toHaveBeenCalledWith(`Invalid match specified: \"// highlight-range\"`);\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"highlights until end of code block if ranges goes farther","suites":["highlighting lines","highlight-range"],"updatePoint":{"line":78,"column":65,"index":3371},"line":78,"code":"    it(`highlights until end of code block if ranges goes farther`, () => {\n      const highlights = highlightLineRange(fixtures.highlightRangeLongerThanCode);\n      expect(output(getHighlighted(highlights))).toMatchSnapshot();\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"removes directive","suites":["highlighting lines","jsx comment"],"updatePoint":{"line":84,"column":25,"index":3607},"line":84,"code":"    it(`removes directive`, () => {\n      const highlights = highlightLineRange(fixtures.highlightJsxComment);\n      expect(output(highlights)).not.toContain(`highlight-line`);\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"highlights comment line","suites":["highlighting lines","jsx comment"],"updatePoint":{"line":88,"column":31,"index":3798},"line":88,"code":"    it(`highlights comment line`, () => {\n      const highlights = highlightLineRange(fixtures.highlightJsxComment);\n      expect(output(getHighlighted(highlights))).toMatchSnapshot();\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"highlights comment line after Prism highlighting","suites":["highlighting lines","jsx comment"],"updatePoint":{"line":92,"column":56,"index":4016},"line":92,"code":"    it(`highlights comment line after Prism highlighting`, () => {\n      const highlights = highlightLineRange(fixtures.highlightJsxCommentAfterPrismHighlighting);\n      expect(output(getHighlighted(highlights))).toMatchSnapshot();\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"strips directive","suites":["highlighting lines","yaml"],"updatePoint":{"line":98,"column":24,"index":4257},"line":98,"code":"    it(`strips directive`, () => {\n      const highlights = highlightLineRange(fixtures.highlightYaml);\n      expect(highlights).not.toContain(`highlight-line`);\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"highlights yaml","suites":["highlighting lines","yaml"],"updatePoint":{"line":102,"column":23,"index":4426},"line":102,"code":"    it(`highlights yaml`, () => {\n      const highlights = highlightLineRange(fixtures.highlightYaml);\n      expect(output(getHighlighted(highlights))).toMatchSnapshot();\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"strips directives","suites":["highlighting lines","highlight kitchen sink"],"updatePoint":{"line":108,"column":25,"index":4658},"line":108,"code":"    it(`strips directives`, () => {\n      const highlights = highlightLineRange(fixtures.highlightKitchenSink);\n      const code = output(highlights);\n      [`highlight-line`, `highlight-next-line`, `highlight-range`, `highlight-start`, `highlight-end`].forEach(directive => {\n        expect(code).not.toContain(directive);\n      });\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"highlights multiple directives","suites":["highlighting lines","highlight kitchen sink"],"updatePoint":{"line":115,"column":38,"index":5013},"line":115,"code":"    it(`highlights multiple directives`, () => {\n      const highlights = highlightLineRange(fixtures.highlightKitchenSink);\n      expect(output(getHighlighted(highlights))).toMatchSnapshot();\n    });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should support mixed hide and highlight markers","suites":["mixed highlight and hide lines"],"updatePoint":{"line":147,"column":53,"index":7832},"line":147,"code":"  it(`should support mixed hide and highlight markers`, () => {\n    const processed = highlightLineRange(fixtures.hideAndHighlight);\n    expect(processed).toMatchSnapshot();\n    expect(processed.length).toEqual(11);\n    expect(output(getHighlighted(processed))).toMatchSnapshot();\n  });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should error when hidden and highlighted lines overlap","suites":["mixed highlight and hide lines"],"updatePoint":{"line":153,"column":60,"index":8126},"line":153,"code":"  it(`should error when hidden and highlighted lines overlap`, () => {\n    expect(() => highlightLineRange(fixtures.hideAndHighlightOverlap)).toThrow(`Line 8 has been marked as both hidden and highlighted.\\n  - Line 1: hide (\"hide-range{2-3,7}\")\\n  - Line 2: highlight (\"highlight-range{5-7,9}\")`);\n  });","file":"directives.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"escapes base html when no additional escapes are passed in","suites":["escaping html entities"],"updatePoint":{"line":3,"column":64,"index":154},"line":3,"code":"  it(`escapes base html when no additional escapes are passed in`, () => {\n    const code = `hello world&><\"'`;\n    expect(escapeHtml(code)).toBe(`hello world&amp;&gt;&lt;&quot;&#39;`);\n  });","file":"escape-html.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"escapes additional html entities when passed in","suites":["escaping html entities"],"updatePoint":{"line":7,"column":53,"index":335},"line":7,"code":"  it(`escapes additional html entities when passed in`, () => {\n    const code = `hello world{`;\n    const mapping = {\n      \"{\": `&#123;`\n    };\n    expect(escapeHtml(code, mapping)).toBe(`hello world&#123;`);\n  });","file":"escape-html.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"escapes base html entities and additional html entities","suites":["escaping html entities"],"updatePoint":{"line":14,"column":61,"index":560},"line":14,"code":"  it(`escapes base html entities and additional html entities`, () => {\n    const code = `hello world&><\"'{`;\n    const mapping = {\n      \"{\": `&#123;`\n    };\n    expect(escapeHtml(code, mapping)).toBe(`hello world&amp;&gt;&lt;&quot;&#39;&#123;`);\n  });","file":"escape-html.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"for language cpp","suites":["highlight code and lines with PrismJS"],"updatePoint":{"line":6,"column":22,"index":158},"line":6,"code":"  it(`for language cpp`, () => {\n    const highlightCode = require(`../highlight-code`);\n    const language = `cpp`;\n    const lineNumbersHighlight = [1, 2];\n    const code = `\nint sum(a, b) {\n  return a + b;\n}\n`;\n    expect(highlightCode(language, code, {}, lineNumbersHighlight)).toMatchSnapshot();\n  });","file":"highlight-code.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"for language jsx","suites":["highlight code and lines with PrismJS"],"updatePoint":{"line":17,"column":22,"index":465},"line":17,"code":"  it(`for language jsx`, () => {\n    const highlightCode = require(`../highlight-code`);\n    const language = `jsx`;\n    const lineNumbersHighlight = [12, 13, 15];\n    const code = `\nimport React from \"react\"\n\nclass Counter extends React.Component {\n  constructor() {\n    super()\n    this.state = { count: 0 }\n  }\n\n  render() {\n    return (\n      <div>\n        <h1>Counter</h1>\n        <p>current count: {this.state.count}</p>\n        <button onClick={() => this.setState({ count: this.state.count + 1 })}>\n          plus\n        </button>\n        <button onClick={() => this.setState({ count: this.state.count - 1 })}>\n          minus\n        </button>\n      </div>\n    )\n  }\n}\n\nexport default Counter\n`;\n    const processed = highlightCode(language, code, {}, lineNumbersHighlight);\n    expect(processed).toMatchSnapshot();\n    // expect spans to not contain \\n as it would break line highlighting\n    expect(/<span[^>]*>[^<]*\\n[^<]*<\\/span>/g.exec(processed)).not.toBeTruthy();\n  });","file":"highlight-code.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"for language diff-typescript","suites":["highlight code and lines with PrismJS"],"updatePoint":{"line":53,"column":34,"index":1464},"line":53,"code":"  it(`for language diff-typescript`, () => {\n    const highlightCode = require(`../highlight-code`);\n    const language = `diff`;\n    const diffLanguage = `typescript`;\n    const lineNumbersHighlight = [];\n    const code = `\n-    let foo = bar.baz([1, 2, 3]);\n-    foo = foo + 1;\n+    const foo = bar.baz([1, 2, 3]) + 1;\n     console.log(foo);\n`;\n    expect(highlightCode(language, code, {}, lineNumbersHighlight, false, diffLanguage)).toMatchSnapshot();\n  });","file":"highlight-code.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"escapes &, <, \" elements and warns","suites":["highlight code and lines with PrismJS","with language-text"],"updatePoint":{"line":67,"column":42,"index":1974},"line":67,"code":"    it(`escapes &, <, \" elements and warns`, () => {\n      jest.spyOn(console, `warn`);\n      const highlightCode = require(`../highlight-code`);\n      const language = `text`;\n      const code = `<button />`;\n      expect(highlightCode(language, code, {}, [], true)).toMatch(`&lt;button />`);\n    });","file":"highlight-code.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"can warn about languages missing from inline code","suites":["highlight code and lines with PrismJS","with language-text"],"updatePoint":{"line":74,"column":57,"index":2291},"line":74,"code":"    it(`can warn about languages missing from inline code`, () => {\n      jest.spyOn(console, `warn`);\n      const highlightCode = require(`../highlight-code`);\n      const language = `text`;\n      const code = `<button />`;\n      expect(highlightCode(language, code)).toMatch(`&lt;button />`);\n    });","file":"highlight-code.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"warns once per language","suites":["highlight code and lines with PrismJS","with language-text"],"updatePoint":{"line":81,"column":31,"index":2568},"line":81,"code":"    it(`warns once per language`, () => {\n      jest.spyOn(console, `warn`);\n      const highlightCode = require(`../highlight-code`);\n      const language1 = `text`;\n      const language2 = `raw`;\n      const code1 = `<button />`;\n      const code2 = `<form />`;\n      const code3 = `<input />`;\n      highlightCode(language1, code1);\n      highlightCode(language1, code2);\n      highlightCode(language2, code3);\n      expect(console.warn).toHaveBeenCalledTimes(1);\n      expect(console.warn).toHaveBeenNthCalledWith(1, `unable to find prism language 'raw' for highlighting.`, `applying generic code block`);\n    });","file":"highlight-code.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"does not escape its contents","suites":["highlight code and lines with PrismJS","with language-none"],"updatePoint":{"line":97,"column":36,"index":3238},"line":97,"code":"    it(`does not escape its contents`, () => {\n      const highlightCode = require(`../highlight-code`);\n      const language = `none`;\n      const code = `<guineapig />`;\n      expect(highlightCode(language, code)).toMatch(code);\n    });","file":"highlight-code.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"does not add trailing newlines","suites":["highlight code and lines with PrismJS","with non-highlight-lines"],"updatePoint":{"line":105,"column":38,"index":3532},"line":105,"code":"    it(`does not add trailing newlines`, () => {\n      const highlightCode = require(`../highlight-code`);\n      const language = `javascript`;\n      const code = `const a = 1\\nconst b = 2`;\n      expect(highlightCode(language, code)).not.toMatch(/\\n$/);\n    });","file":"highlight-code.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"a trailing newline is preserved","suites":["highlight code and lines with PrismJS","with non-highlight-lines"],"updatePoint":{"line":111,"column":39,"index":3796},"line":111,"code":"    it(`a trailing newline is preserved`, () => {\n      const highlightCode = require(`../highlight-code`);\n      const language = `javascript`;\n      const code = `const a = 1\\nconst b = 2\\n`;\n      expect(highlightCode(language, code)).toMatch(/[^\\n]\\n$/);\n    });","file":"highlight-code.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"does not add trailing newlines","suites":["highlight code and lines with PrismJS","with non-highlight-lines"],"updatePoint":{"line":119,"column":38,"index":4115},"line":119,"code":"    it(`does not add trailing newlines`, () => {\n      const highlightCode = require(`../highlight-code`);\n      const language = `javascript`;\n      const linesToHighlight = [1];\n      const code = `const a = 1\\nconst b = 2`;\n      expect(highlightCode(language, code, {}, linesToHighlight)).not.toMatch(/\\n$/);\n    });","file":"highlight-code.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"a trailing newline is preserved","suites":["highlight code and lines with PrismJS","with non-highlight-lines"],"updatePoint":{"line":126,"column":39,"index":4437},"line":126,"code":"    it(`a trailing newline is preserved`, () => {\n      const highlightCode = require(`../highlight-code`);\n      const language = `javascript`;\n      const linesToHighlight = [1];\n      const code = `const a = 1\\nconst b = 2\\n`;\n      expect(highlightCode(language, code, {}, linesToHighlight)).toMatch(/[^\\n]\\n$/);\n    });","file":"highlight-code.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"with class=\"language-*\" prefix by default","suites":["remark prism plugin","generates a <pre> tag"],"updatePoint":{"line":10,"column":49,"index":302},"line":10,"code":"    it(`with class=\"language-*\" prefix by default`, () => {\n      const code = `\\`\\`\\`js\\n// Fake\\n\\`\\`\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"with a custom class prefix if configured","suites":["remark prism plugin","generates a <pre> tag"],"updatePoint":{"line":18,"column":48,"index":553},"line":18,"code":"    it(`with a custom class prefix if configured`, () => {\n      const code = `\\`\\`\\`js\\n// Fake\\n\\`\\`\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      }, {\n        classPrefix: `custom-`\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"with aliases applied","suites":["remark prism plugin","generates a <pre> tag"],"updatePoint":{"line":28,"column":28,"index":826},"line":28,"code":"    it(`with aliases applied`, () => {\n      const code = `\\`\\`\\`foobar\\n// Fake\\n\\`\\`\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      }, {\n        aliases: {\n          foobar: `javascript`\n        }\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"with aliases that do not exist","suites":["remark prism plugin","generates a <pre> tag"],"updatePoint":{"line":40,"column":38,"index":1142},"line":40,"code":"    it(`with aliases that do not exist`, () => {\n      const code = `\\`\\`\\`foobar\\n// Fake\\n\\`\\`\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      }, {\n        aliases: {\n          baz: `javascript`\n        }\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"with highlighted lines","suites":["remark prism plugin","generates a <pre> tag"],"updatePoint":{"line":52,"column":30,"index":1447},"line":52,"code":"    it(`with highlighted lines`, () => {\n      const code = `\\`\\`\\`js{2}\\n// 1\\n// 2\\n// 3\\n\\`\\`\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"with class=\"language-*\" prefix by default","suites":["remark prism plugin","generates an inline <code> tag"],"updatePoint":{"line":62,"column":49,"index":1770},"line":62,"code":"    it(`with class=\"language-*\" prefix by default`, () => {\n      const code = `\\`foo bar\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"with a custom class prefix if configured","suites":["remark prism plugin","generates an inline <code> tag"],"updatePoint":{"line":70,"column":48,"index":2007},"line":70,"code":"    it(`with a custom class prefix if configured`, () => {\n      const code = `\\`foo bar\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      }, {\n        classPrefix: `custom-`\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"that handles language specifiers","suites":["remark prism plugin","generates an inline <code> tag"],"updatePoint":{"line":80,"column":40,"index":2278},"line":80,"code":"    it(`that handles language specifiers`, () => {\n      const code = `\\`css  .foo { color: red }\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      }, {\n        inlineCodeMarker: `  `\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"with aliases applied","suites":["remark prism plugin","generates an inline <code> tag"],"updatePoint":{"line":90,"column":28,"index":2558},"line":90,"code":"    it(`with aliases applied`, () => {\n      const code = `\\`foobar : Fake\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      }, {\n        inlineCodeMarker: ` : `,\n        aliases: {\n          foobar: `javascript`\n        }\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"does not handle inline code if noInlineHighlight: true","suites":["remark prism plugin","generates an inline <code> tag"],"updatePoint":{"line":104,"column":60,"index":2923},"line":104,"code":"  it(`does not handle inline code if noInlineHighlight: true`, () => {\n    const code = `some text \\`containing inline code\\``;\n    const markdownAST = remark.parse(code);\n    plugin({\n      markdownAST\n    }, {\n      noInlineHighlight: true\n    });\n    expect(markdownAST).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"adds prompts if promptUser set","suites":["remark prism plugin","promptUser/promptHost"],"updatePoint":{"line":115,"column":38,"index":3244},"line":115,"code":"    it(`adds prompts if promptUser set`, () => {\n      const code = `\\`\\`\\`bash{promptUser:alice}\\necho 'test'\\`\\`\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"adds prompts if promptHost set","suites":["remark prism plugin","promptUser/promptHost"],"updatePoint":{"line":123,"column":38,"index":3507},"line":123,"code":"    it(`adds prompts if promptHost set`, () => {\n      const code = `\\`\\`\\`bash{promptHost:server}\\necho 'test'\\`\\`\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"adds prompts if promptUser and promptHost set","suites":["remark prism plugin","promptUser/promptHost"],"updatePoint":{"line":131,"column":53,"index":3786},"line":131,"code":"    it(`adds prompts if promptUser and promptHost set`, () => {\n      const code = `\\`\\`\\`bash{promptUser:alice}{promptHost:server}\\necho 'test'\\`\\`\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"supports language specifier","suites":["remark prism plugin","diff"],"updatePoint":{"line":141,"column":37,"index":4100},"line":141,"code":"    test(`supports language specifier`, () => {\n      const code = `\\`\\`\\`diff-javascript\n-    let foo = bar.baz([1, 2, 3]);\n-    foo = foo + 1;\n+    const foo = bar.baz([1, 2, 3]) + 1;\n     console.log(foo);\n\\`\\`\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"adds line-number markup when necessary","suites":["remark prism plugin","numberLines"],"updatePoint":{"line":156,"column":46,"index":4511},"line":156,"code":"    it(`adds line-number markup when necessary`, () => {\n      const code = `\\`\\`\\`js{numberLines:5}\\n//.foo { \\ncolor: red;\\n }\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"adds line-number markup when configured globally","suites":["remark prism plugin","numberLines"],"updatePoint":{"line":164,"column":56,"index":4798},"line":164,"code":"    it(`adds line-number markup when configured globally`, () => {\n      const code = `\\`\\`\\`js\\n//.foo { \\ncolor: red;\\n }\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      }, {\n        showLineNumbers: true\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"correctly counts line-numbers for markup using highlight classes","suites":["remark prism plugin","numberLines"],"updatePoint":{"line":174,"column":72,"index":5127},"line":174,"code":"    it(`correctly counts line-numbers for markup using highlight classes`, () => {\n      const code = `\\`\\`\\`js\\n` + `function highlightTest() {\\n` + `// highlight-start\\n` + `return \"this is a highlight test\"\\n` + `// highlight-end\\n` + `}\\n` + `\\`\\`\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      }, {\n        showLineNumbers: true\n      });\n      const htmlResult = markdownAST.children[0].value;\n      const $ = cheerio.load(htmlResult);\n      const numberOfLineNumbers = $(`.line-numbers-rows > span`).length;\n      expect(numberOfLineNumbers).toEqual(3);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"does not add line-number markup when not configured globally","suites":["remark prism plugin","numberLines"],"updatePoint":{"line":187,"column":68,"index":5736},"line":187,"code":"    it(`does not add line-number markup when not configured globally`, () => {\n      const code = `\\`\\`\\`js\\n//.foo { \\ncolor: red;\\n }\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      });\n      expect(markdownAST).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should not wrap keywords with <span class=\"token extensionTokenName\"> if no extension given","suites":["remark prism plugin","numberLines"],"updatePoint":{"line":195,"column":99,"index":6051},"line":195,"code":"    it(`should not wrap keywords with <span class=\"token extensionTokenName\"> if no extension given`, () => {\n      const code = `\\`\\`\\`c\\naRandomTypeKeyword var = 32\\n\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      });\n      expect(markdownAST.children).toBeDefined();\n      expect(markdownAST.children).toHaveLength(1);\n      const htmlResult = markdownAST.children[0].value;\n      expect(htmlResult).not.toMatch(/<span class=\"token extended_keywords\">/);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should wrap keywords with <span class=\"token extensionTokenName\"> based on given extension","suites":["remark prism plugin","numberLines"],"updatePoint":{"line":206,"column":98,"index":6560},"line":206,"code":"    it(`should wrap keywords with <span class=\"token extensionTokenName\"> based on given extension`, () => {\n      const code = `\\`\\`\\`c\\naRandomTypeKeyword var = 32\\n\\``;\n      const markdownAST = remark.parse(code);\n      const config = {\n        languageExtensions: {\n          extend: `c`,\n          definition: {\n            extended_keywords: /(aRandomTypeKeyword)/\n          }\n        }\n      };\n      plugin({\n        markdownAST\n      }, config);\n      expect(markdownAST.children).toBeDefined();\n      expect(markdownAST.children).toHaveLength(1);\n      const htmlResult = markdownAST.children[0].value;\n      expect(htmlResult).toMatch(/<span class=\"token extended_keywords\">/);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"warns if the language doesn't exist","suites":["remark prism plugin","warnings"],"updatePoint":{"line":227,"column":43,"index":7240},"line":227,"code":"    it(`warns if the language doesn't exist`, () => {\n      jest.spyOn(console, `warn`);\n      const code = `\\`\\`\\`notexist\\n// Fake\\n\\`\\`\\``;\n      const markdownAST = remark.parse(code);\n      plugin({\n        markdownAST\n      }, {\n        noInlineHighlight: true\n      });\n      expect(console.warn).toHaveBeenCalledWith(`unable to find prism language 'notexist' for highlighting.`, `applying generic code block`);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should throw an error if the request is not an array or an object","suites":["extend/add prism language"],"updatePoint":{"line":4,"column":71,"index":227},"line":4,"code":"  it(`should throw an error if the request is not an array or an object`, () => {\n    let request = 4;\n    expect(() => loadLanguageExtension(request)).toThrow();\n    request = `A weird string value, instead of an object or array`;\n    expect(() => loadLanguageExtension(request)).toThrow();\n  });","file":"load-prism-language-extension.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should not throw an error if the request is an array","suites":["extend/add prism language"],"updatePoint":{"line":10,"column":58,"index":512},"line":10,"code":"  it(`should not throw an error if the request is an array`, () => {\n    const request = [];\n    expect(() => loadLanguageExtension(request)).not.toThrow();\n  });","file":"load-prism-language-extension.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should not throw an error if the request is a valid object (containing 'language' and 'definition')","suites":["extend/add prism language"],"updatePoint":{"line":14,"column":105,"index":722},"line":14,"code":"  it(`should not throw an error if the request is a valid object (containing 'language' and 'definition')`, () => {\n    const request = {\n      language: `aTypicalLanguage`,\n      definition: /aRegexp/\n    };\n    expect(() => loadLanguageExtension(request)).not.toThrow();\n  });","file":"load-prism-language-extension.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should throw an error if the request is not a valid object (containing 'language' and 'definition')","suites":["extend/add prism language"],"updatePoint":{"line":21,"column":105,"index":1001},"line":21,"code":"  it(`should throw an error if the request is not a valid object (containing 'language' and 'definition')`, () => {\n    const request = {};\n    expect(() => loadLanguageExtension(request)).toThrow();\n  });","file":"load-prism-language-extension.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should throw an error if the request is an array containing an invalid object (not containing 'language' and 'definition')","suites":["extend/add prism language"],"updatePoint":{"line":25,"column":128,"index":1230},"line":25,"code":"  it(`should throw an error if the request is an array containing an invalid object (not containing 'language' and 'definition')`, () => {\n    const request = [{\n      language: `aTypicalLanguage`,\n      definition: /aRegexp/\n    }, {}];\n    expect(() => loadLanguageExtension(request)).toThrow();\n  });","file":"load-prism-language-extension.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should extend pre-loaded language","suites":["extend/add prism language"],"updatePoint":{"line":32,"column":39,"index":1445},"line":32,"code":"  it(`should extend pre-loaded language`, () => {\n    const request = {\n      extend: `clike`,\n      definition: {\n        flexc_keyword: `(__cm|__circ|_lpp_indirect|__accum|__size_t|__ptrdiff_t|__wchar_t|__fixed|__abscall|__extcall|__stkcall|__sat|__i64_t|__i32_t|__i16_t|__r32_t|__r16_t|__u64_t|__u32_t|__u16_t|__a40_t|__a24_t)`\n      }\n    };\n    loadLanguageExtension(request);\n    expect(Prism.languages[request.extend]).toBeDefined();\n    expect(Prism.languages[request.extend]).toHaveProperty(`flexc_keyword`);\n    expect(Prism.languages[request.extend][`flexc_keyword`]).toEqual(request.definition.flexc_keyword);\n  });","file":"load-prism-language-extension.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should extend not pre-loaded language","suites":["extend/add prism language"],"updatePoint":{"line":44,"column":43,"index":2077},"line":44,"code":"  it(`should extend not pre-loaded language`, () => {\n    const request = {\n      extend: `c`,\n      definition: {\n        flexc_keyword: `(__cm|__circ|_lpp_indirect|__accum|__size_t|__ptrdiff_t|__wchar_t|__fixed|__abscall|__extcall|__stkcall|__sat|__i64_t|__i32_t|__i16_t|__r32_t|__r16_t|__u64_t|__u32_t|__u16_t|__a40_t|__a24_t)`\n      }\n    };\n    loadLanguageExtension(request);\n    expect(Prism.languages[request.extend]).toBeDefined();\n    expect(Prism.languages[request.extend]).toHaveProperty(`flexc_keyword`);\n    expect(Prism.languages[request.extend][`flexc_keyword`]).toEqual(request.definition.flexc_keyword);\n  });","file":"load-prism-language-extension.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should add new language from existing language","suites":["extend/add prism language"],"updatePoint":{"line":56,"column":52,"index":2714},"line":56,"code":"  it(`should add new language from existing language`, () => {\n    const request = {\n      language: `flexc`,\n      extend: `c`,\n      definition: {\n        flexc_keyword: `(__cm|__circ|_lpp_indirect|__accum|__size_t|__ptrdiff_t|__wchar_t|__fixed|__abscall|__extcall|__stkcall|__sat|__i64_t|__i32_t|__i16_t|__r32_t|__r16_t|__u64_t|__u32_t|__u16_t|__a40_t|__a24_t)`\n      }\n    };\n    const languagesBeforeLoaded = Object.keys(Prism.languages);\n    expect(Prism.languages).not.toHaveProperty(request.language);\n    loadLanguageExtension(request);\n    const languagesAfterLoaded = Object.keys(Prism.languages);\n    expect(Prism.languages).toHaveProperty(request.language);\n    expect(languagesAfterLoaded.length).toBe(languagesBeforeLoaded.length + 1);\n    expect(Prism.languages[request.language][`flexc_keyword`]).toEqual(request.definition.flexc_keyword);\n  });","file":"load-prism-language-extension.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should add new language","suites":["extend/add prism language"],"updatePoint":{"line":72,"column":29,"index":3554},"line":72,"code":"  it(`should add new language`, () => {\n    const request = {\n      language: `flexc2`,\n      // Check if it is possible to reset scope somehow, instead of giving a new name.\n      definition: {\n        flexc_keyword: `(__cm|__circ|_lpp_indirect|__accum|__size_t|__ptrdiff_t|__wchar_t|__fixed|__abscall|__extcall|__stkcall|__sat|__i64_t|__i32_t|__i16_t|__r32_t|__r16_t|__u64_t|__u32_t|__u16_t|__a40_t|__a24_t)`\n      }\n    };\n    const languagesBeforeLoaded = Object.keys(Prism.languages);\n    expect(Prism.languages).not.toHaveProperty(request.language);\n    loadLanguageExtension(request);\n    const languagesAfterLoaded = Object.keys(Prism.languages);\n    expect(Prism.languages).toHaveProperty(request.language);\n    expect(languagesAfterLoaded.length).toBe(languagesBeforeLoaded.length + 1);\n    expect(Prism.languages[request.language][`flexc_keyword`]).toEqual(request.definition.flexc_keyword);\n  });","file":"load-prism-language-extension.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should work to make two requests by sending an array","suites":["extend/add prism language"],"updatePoint":{"line":88,"column":58,"index":4492},"line":88,"code":"  it(`should work to make two requests by sending an array`, () => {\n    const request = [{\n      language: `flexc3`,\n      // Check if it is possible to reset scope somehow, instead of giving a new name.\n      definition: {\n        flexc_keyword: `(__cm|__circ|_lpp_indirect|__accum|__size_t|__ptrdiff_t|__wchar_t|__fixed|__abscall|__extcall|__stkcall|__sat|__i64_t|__i32_t|__i16_t|__r32_t|__r16_t|__u64_t|__u32_t|__u16_t|__a40_t|__a24_t)`\n      }\n    }, {\n      extend: `c`,\n      definition: {\n        new_token: `(__cm|__circ|_lpp_indirect|__accum|__size_t|__ptrdiff_t|__wchar_t|__fixed|__abscall|__extcall|__stkcall|__sat|__i64_t|__i32_t|__i16_t|__r32_t|__r16_t|__u64_t|__u32_t|__u16_t|__a40_t|__a24_t)`\n      }\n    }];\n    const languagesBeforeLoaded = Object.keys(Prism.languages);\n    expect(Prism.languages).not.toHaveProperty(`flexc3`);\n    expect(Prism.languages[`c`]).not.toHaveProperty(`new_token`);\n    loadLanguageExtension(request);\n    const languagesAfterLoaded = Object.keys(Prism.languages);\n    expect(Prism.languages).toHaveProperty(`flexc3`);\n    expect(languagesAfterLoaded.length).toBe(languagesBeforeLoaded.length + 1);\n    expect(Prism.languages[`c`]).toHaveProperty(`new_token`);\n  });","file":"load-prism-language-extension.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"throw if language not support","suites":["load prism language"],"updatePoint":{"line":9,"column":35,"index":241},"line":9,"code":"  it(`throw if language not support`, () => {\n    expect(() => loadPrismLanguage(`imnotalanguage`)).toThrow(`Prism doesn't support language 'imnotalanguage'.`);\n  });","file":"load-prism-language.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"load supported language","suites":["load prism language"],"updatePoint":{"line":12,"column":29,"index":402},"line":12,"code":"  it(`load supported language`, () => {\n    const language = `c`;\n    const Prism = require(`prismjs`);\n    const languagesBeforeLoaded = Object.keys(Prism.languages);\n    expect(Prism.languages).not.toHaveProperty(language);\n    loadPrismLanguage(language);\n    const languagesAfterLoaded = Object.keys(Prism.languages);\n    expect(Prism.languages).toHaveProperty(language);\n    expect(languagesAfterLoaded.length).toBe(languagesBeforeLoaded.length + 1);\n  });","file":"load-prism-language.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"also load the required language","suites":["load prism language"],"updatePoint":{"line":22,"column":37,"index":872},"line":22,"code":"  it(`also load the required language`, () => {\n    const language = `cpp`;\n    const requiredLanguage = `c`;\n    const Prism = require(`prismjs`);\n    const languagesBeforeLoaded = Object.keys(Prism.languages);\n    expect(Prism.languages).not.toHaveProperty(language);\n    expect(Prism.languages).not.toHaveProperty(requiredLanguage);\n    loadPrismLanguage(language);\n    const languagesAfterLoaded = Object.keys(Prism.languages);\n    expect(Prism.languages).toHaveProperty(language);\n    expect(Prism.languages).toHaveProperty(requiredLanguage);\n    expect(languagesAfterLoaded.length).toBe(languagesBeforeLoaded.length + 2);\n  });","file":"load-prism-language.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"returns undefined if language does not exist","suites":["load prism language","aliasing"],"updatePoint":{"line":36,"column":52,"index":1552},"line":36,"code":"    it(`returns undefined if language does not exist`, () => {\n      const baseLanguage = getBaseLanguageName(`suhdude`, {\n        languages: {\n          python: {}\n        }\n      });\n      expect(baseLanguage).toBe(undefined);\n    });","file":"load-prism-language.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"defaults to language, if exists in lookup","suites":["load prism language","aliasing"],"updatePoint":{"line":44,"column":49,"index":1786},"line":44,"code":"    it(`defaults to language, if exists in lookup`, () => {\n      const language = `python`;\n      const baseLanguage = getBaseLanguageName(language, {\n        languages: {\n          [language]: {}\n        }\n      });\n      expect(baseLanguage).toBe(language);\n    });","file":"load-prism-language.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"loads language that has a single alias","suites":["load prism language","aliasing"],"updatePoint":{"line":53,"column":46,"index":2052},"line":53,"code":"    it(`loads language that has a single alias`, () => {\n      const language = `python`;\n      const alias = `py`;\n      const baseLanguage = getBaseLanguageName(alias, {\n        languages: {\n          [language]: {\n            alias\n          }\n        }\n      });\n      expect(baseLanguage).toBe(language);\n    });","file":"load-prism-language.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"loads language that has an array of aliases","suites":["load prism language","aliasing"],"updatePoint":{"line":65,"column":51,"index":2375},"line":65,"code":"    it(`loads language that has an array of aliases`, () => {\n      const language = `lisp`;\n      const alias = `emacs-lisp`;\n      const baseLanguage = getBaseLanguageName(alias, {\n        languages: {\n          [language]: {\n            alias: [alias]\n          }\n        }\n      });\n      expect(baseLanguage).toBe(language);\n    });","file":"load-prism-language.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"parses numeric ranges from the languages variable","suites":["parses numeric ranges from the languages markdown code directive"],"updatePoint":{"line":3,"column":55,"index":191},"line":3,"code":"  it(`parses numeric ranges from the languages variable`, () => {\n    expect(parseOptions(`jsx{1,5,7-8}`).highlightLines).toEqual([1, 5, 7, 8]);\n    expect(parseOptions(`javascript{7-8}`).highlightLines).toEqual([7, 8]);\n    expect(parseOptions(`javascript{7..8}`).highlightLines).toEqual([7, 8]);\n    expect(parseOptions(`javascript{2}`).highlightLines).toEqual([2]);\n    expect(parseOptions(`javascript{2,4-5}`).highlightLines).toEqual([2, 4, 5]);\n  });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"ignores negative numbers","suites":["parses numeric ranges from the languages markdown code directive"],"updatePoint":{"line":10,"column":30,"index":622},"line":10,"code":"  it(`ignores negative numbers`, () => {\n    expect(parseOptions(`jsx{-1,1,5,7-8}`).highlightLines).toEqual([1, 5, 7, 8]);\n    expect(parseOptions(`jsx{-1..4}`).highlightLines).toEqual([1, 2, 3, 4]);\n  });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"parses the right line number start index from the languages variable","suites":["parses numeric ranges from the languages markdown code directive","parses line numbering options from the languages markdown code directive"],"updatePoint":{"line":15,"column":76,"index":969},"line":15,"code":"    it(`parses the right line number start index from the languages variable`, () => {\n      expect(parseOptions(`jsx{numberLines: true}`).showLineNumbersLocal).toEqual(true);\n      expect(parseOptions(`jsx{numberLines: true}`).numberLinesStartAt).toEqual(1);\n      expect(parseOptions(`jsx{numberLines: 3}`).showLineNumbersLocal).toEqual(true);\n      expect(parseOptions(`jsx{numberLines: 3}`).numberLinesStartAt).toEqual(3);\n    });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"parses the right line number start index without a specified language","suites":["parses numeric ranges from the languages markdown code directive","parses line numbering options from the languages markdown code directive"],"updatePoint":{"line":21,"column":77,"index":1405},"line":21,"code":"    it(`parses the right line number start index without a specified language`, () => {\n      expect(parseOptions(`{numberLines: true}`).showLineNumbersLocal).toEqual(true);\n      expect(parseOptions(`{numberLines: true}`).numberLinesStartAt).toEqual(1);\n      expect(parseOptions(`{numberLines: 3}`).showLineNumbersLocal).toEqual(true);\n      expect(parseOptions(`{numberLines: 3}`).numberLinesStartAt).toEqual(3);\n    });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"ignores non-true or non-number values","suites":["parses numeric ranges from the languages markdown code directive","parses line numbering options from the languages markdown code directive"],"updatePoint":{"line":27,"column":45,"index":1797},"line":27,"code":"    it(`ignores non-true or non-number values`, () => {\n      expect(parseOptions(`jsx{numberLines: false}`).showLineNumbersLocal).toEqual(false);\n      expect(parseOptions(`jsx{numberLines: NaN}`).showLineNumbersLocal).toEqual(false);\n    });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"casts decimals line number start into the nearest lower integer","suites":["parses numeric ranges from the languages markdown code directive","parses line numbering options from the languages markdown code directive"],"updatePoint":{"line":31,"column":71,"index":2067},"line":31,"code":"    it(`casts decimals line number start into the nearest lower integer`, () => {\n      expect(parseOptions(`jsx{numberLines: 1.2}`).numberLinesStartAt).toEqual(1);\n      expect(parseOptions(`jsx{numberLines: 1.8}`).numberLinesStartAt).toEqual(1);\n    });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"parses only promptUser option supplied","suites":["parses numeric ranges from the languages markdown code directive","parses both prompt user and host options"],"updatePoint":{"line":37,"column":46,"index":2367},"line":37,"code":"    it(`parses only promptUser option supplied`, () => {\n      expect(parseOptions(`bash{promptUser: pi}`).promptUserLocal).toEqual(`pi`);\n    });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"parses only promptHost option supplied","suites":["parses numeric ranges from the languages markdown code directive","parses both prompt user and host options"],"updatePoint":{"line":40,"column":46,"index":2514},"line":40,"code":"    it(`parses only promptHost option supplied`, () => {\n      expect(parseOptions(`bash{promptHost: dev.localhost}`).promptHostLocal).toEqual(`dev.localhost`);\n    });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"parses promptHost and promptUser options supplied together","suites":["parses numeric ranges from the languages markdown code directive","parses both prompt user and host options"],"updatePoint":{"line":43,"column":66,"index":2703},"line":43,"code":"    it(`parses promptHost and promptUser options supplied together`, () => {\n      expect(parseOptions(`bash{promptUser: pi}{promptHost: dev.localhost}`)).toMatchObject({\n        promptHostLocal: `dev.localhost`,\n        promptUserLocal: `pi`\n      });\n    });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"one line highlighted","suites":["parses numeric ranges from the languages markdown code directive","parses both line numbering and line highlighting options"],"updatePoint":{"line":51,"column":28,"index":3011},"line":51,"code":"    it(`one line highlighted`, () => {\n      expect(parseOptions(`jsx{1}{numberLines: 3}`)).toEqual({\n        splitLanguage: `jsx`,\n        highlightLines: [1],\n        showLineNumbersLocal: true,\n        numberLinesStartAt: 3,\n        outputLines: []\n      });\n    });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"multiple lines highlighted","suites":["parses numeric ranges from the languages markdown code directive","parses both line numbering and line highlighting options"],"updatePoint":{"line":60,"column":34,"index":3287},"line":60,"code":"    it(`multiple lines highlighted`, () => {\n      expect(parseOptions(`jsx{1,5,7-8}{numberLines: 3}`)).toEqual({\n        splitLanguage: `jsx`,\n        highlightLines: [1, 5, 7, 8],\n        showLineNumbersLocal: true,\n        numberLinesStartAt: 3,\n        outputLines: []\n      });\n    });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"numberLines: true","suites":["parses numeric ranges from the languages markdown code directive","parses both line numbering and line highlighting options"],"updatePoint":{"line":69,"column":25,"index":3569},"line":69,"code":"    it(`numberLines: true`, () => {\n      expect(parseOptions(`jsx{1,5,7-8}{numberLines: true}`)).toEqual({\n        splitLanguage: `jsx`,\n        highlightLines: [1, 5, 7, 8],\n        showLineNumbersLocal: true,\n        numberLinesStartAt: 1,\n        outputLines: []\n      });\n    });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"reverse ordering","suites":["parses numeric ranges from the languages markdown code directive","parses both line numbering and line highlighting options"],"updatePoint":{"line":78,"column":24,"index":3853},"line":78,"code":"    it(`reverse ordering`, () => {\n      expect(parseOptions(`jsx{numberLines: 4}{2}`)).toEqual({\n        splitLanguage: `jsx`,\n        highlightLines: [2],\n        showLineNumbersLocal: true,\n        numberLinesStartAt: 4,\n        outputLines: []\n      });\n    });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"handles bad inputs","suites":["parses numeric ranges from the languages markdown code directive","parses both line numbering and line highlighting options"],"updatePoint":{"line":88,"column":24,"index":4125},"line":88,"code":"  it(`handles bad inputs`, () => {\n    expect(parseOptions(`jsx{-1`).highlightLines).toEqual([]);\n    expect(parseOptions(`jsx{-1....`).highlightLines).toEqual([]);\n  });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"parses languages without ranges","suites":["parses numeric ranges from the languages markdown code directive","parses both line numbering and line highlighting options"],"updatePoint":{"line":92,"column":37,"index":4309},"line":92,"code":"  it(`parses languages without ranges`, () => {\n    expect(parseOptions(`jsx`).splitLanguage).toEqual(`jsx`);\n  });","file":"parse-options.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should export a function","suites":["prism-show-invisibles"],"updatePoint":{"line":3,"column":32,"index":155},"line":3,"code":"  test(`should export a function`, () => {\n    expect(typeof loadPrismShowInvisibles).toBe(`function`);\n  });","file":"plugins/prism-show-invisibles.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"should not return","suites":["prism-show-invisibles"],"updatePoint":{"line":6,"column":25,"index":258},"line":6,"code":"  test(`should not return`, () => {\n    expect(loadPrismShowInvisibles()).toBeUndefined();\n  });","file":"plugins/prism-show-invisibles.js","skipped":false,"dir":"packages/gatsby-remark-prismjs/src/__tests__"},{"name":"transforms an  with unitless width and height","suites":["gatsby-remark-responsive-iframe"],"updatePoint":{"line":15,"column":59,"index":574},"line":15,"code":"    it(`transforms an ${tag} with unitless width and height`, async () => {\n      const markdownAST = remark.parse(`\n<${tag} url=\"http://www.example.com/\" width=\"600\" height=\"400\"></${tag}>\n    `);\n      const transformed = await plugin({\n        markdownAST\n      });\n      const node = find(transformed, function (node) {\n        return node.type === `html`;\n      });\n      expect(node).toBeDefined();\n      expect(node.value).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-responsive-iframe/src/__tests__"},{"name":"transforms an  with pixel width and height","suites":["gatsby-remark-responsive-iframe"],"updatePoint":{"line":30,"column":56,"index":1074},"line":30,"code":"    it(`transforms an ${tag} with pixel width and height`, async () => {\n      const markdownAST = remark.parse(`\n<${tag} url=\"http://www.example.com/\" width=\"600px\" height=\"400px\"></${tag}>\n    `);\n      const transformed = await plugin({\n        markdownAST\n      });\n      const node = find(transformed, function (node) {\n        return node.type === `html`;\n      });\n      expect(node).toBeDefined();\n      expect(node.value).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-responsive-iframe/src/__tests__"},{"name":"transforms an  and maintains existing styles","suites":["gatsby-remark-responsive-iframe"],"updatePoint":{"line":43,"column":58,"index":1534},"line":43,"code":"    it(`transforms an ${tag} and maintains existing styles`, async () => {\n      const markdownAST = remark.parse(`\n<${tag} url=\"http://www.example.com/\" style=\"border:0\" width=\"600px\" height=\"400px\"></${tag}>\n    `);\n      const transformed = await plugin({\n        markdownAST\n      });\n      const node = find(transformed, function (node) {\n        return node.type === `html`;\n      });\n      expect(node).toBeDefined();\n      expect(node.value).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-responsive-iframe/src/__tests__"},{"name":"transforms an  and maintains existing styles when a semicolon exists","suites":["gatsby-remark-responsive-iframe"],"updatePoint":{"line":56,"column":82,"index":2035},"line":56,"code":"    it(`transforms an ${tag} and maintains existing styles when a semicolon exists`, async () => {\n      const markdownAST = remark.parse(`\n<${tag} url=\"http://www.example.com/\" style=\"border:0;\" width=\"600px\" height=\"400px\"></${tag}>\n    `);\n      const transformed = await plugin({\n        markdownAST\n      });\n      const node = find(transformed, function (node) {\n        return node.type === `html`;\n      });\n      expect(node).toBeDefined();\n      expect(node.value).toMatchSnapshot();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-responsive-iframe/src/__tests__"},{"name":"can copy JSX images","suites":["gatsby-remark-responsive-iframe"],"updatePoint":{"line":70,"column":25,"index":2486},"line":70,"code":"  it(`can copy JSX images`, async () => {\n    const mdx = require(`remark-mdx`);\n    const markdownAST = remark().use(mdx).parse(`\n<iframe url=\"http://www.example.com/\" style=\"border:0;\" width=\"600px\" height=\"400px\"></iframe>\n    `);\n    const transformed = await plugin({\n      markdownAST\n    });\n    const node = find(transformed, function (node) {\n      return node.type === `html`;\n    });\n    expect(node).toBeDefined();\n    expect(node.value).toMatchSnapshot();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-responsive-iframe/src/__tests__"},{"name":"doesn't transform an  with dimensions: '' ''","suites":["gatsby-remark-responsive-iframe"],"updatePoint":{"line":88,"column":77,"index":3215},"line":88,"code":"      it(`doesn't transform an ${tag} with dimensions: '${width}' '${height}'`, async () => {\n        const markdownAST = remark.parse(`\n  <${tag} url=\"http://www.example.com/\" width=\"${width}\" height=\"${height}\"></${tag}>\n      `);\n        const transformed = await plugin({\n          markdownAST\n        });\n        // Note: Remark treats iframes (block level) and object (inline) tags\n        // differently, wrapping an object tag in <p></p> tags. It also parses\n        // out the object tag into three separate nodes - one for the opening\n        // tag, one for the closing tag and one for a newline inside. So for any\n        // tests that receive untransformed node back from the plugin, we strip\n        // the p tags and combine the nodes into a single html string.\n        if (tag === `iframe`) {\n          const iframeHTML = extractIframeTag(transformed);\n          expect(iframeHTML).toBeDefined();\n          expect(iframeHTML).toMatchSnapshot();\n        } else {\n          const objectHTML = extractObjectTag(transformed);\n          expect(objectHTML).toBeDefined();\n          expect(objectHTML).toMatchSnapshot();\n        }\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-responsive-iframe/src/__tests__"},{"name":"applies smartypants to text nodes","suites":["gatsby-remark-smartypants"],"updatePoint":{"line":10,"column":39,"index":301},"line":10,"code":"  it(`applies smartypants to text nodes`, () => {\n    const sentence = `He said, \"A 'simple' english sentence. . .`;\n    const markdownAST = remark.parse(`\n${sentence}\n    `);\n    const transformed = plugin({\n      markdownAST\n    });\n    visit(transformed, `text`, node => {\n      expect(node.value).not.toBe(sentence);\n      expect(node.value).toMatchSnapshot();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-smartypants/src/__tests__"},{"name":"leaves other nodes alone","suites":["gatsby-remark-smartypants"],"updatePoint":{"line":23,"column":30,"index":671},"line":23,"code":"  it(`leaves other nodes alone`, () => {\n    const markdownAST = remark.parse(`\n# Hello World\n\na regular sentence\n\n- list item\n- other list item\n\n1. numbered\n1. other numbered\n    `);\n    const transformed = plugin({\n      markdownAST: Object.assign({}, markdownAST)\n    });\n    expect(transformed).toEqual(markdownAST);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-remark-smartypants/src/__tests__"},{"name":"derives unique cache key from node locale and id","suites":["downloadContentfulAssets"],"updatePoint":{"line":45,"column":54,"index":982},"line":45,"code":"  it(`derives unique cache key from node locale and id`, async () => {\n    const createNode = jest.fn(() => Promise.resolve());\n    const createNodeId = jest.fn(id => id);\n    const defaultLocale = `en-US`;\n    const locales = [{\n      code: `en-US`\n    }, {\n      code: `fr`,\n      fallbackCode: `en-US`\n    }];\n    const space = {\n      sys: {\n        id: `1234`\n      }\n    };\n    const cache = {\n      get: jest.fn(() => Promise.resolve(null)),\n      set: jest.fn(() => Promise.resolve(null))\n    };\n    const assetNodes = [];\n    for (const assetItem of fixtures) {\n      assetNodes.push(...(await createAssetNodes({\n        assetItem,\n        createNode,\n        createNodeId,\n        defaultLocale,\n        locales,\n        space,\n        pluginConfig\n      })));\n    }\n    await downloadContentfulAssets({\n      actions: {\n        touchNode: jest.fn()\n      },\n      assetNodes,\n      cache,\n      assetDownloadWorkers: 50,\n      reporter\n    });\n    assetNodes.forEach(n => {\n      expect(cache.get).toHaveBeenCalledWith(`contentful-asset-${n.contentful_id}-${n.node_locale}`);\n      expect(cache.set).toHaveBeenCalledWith(`contentful-asset-${n.contentful_id}-${n.node_locale}`, expect.anything());\n    });\n  });","file":"download-contentful-assets.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"backoffs page limit when limit is reached","suites":["fetch-backoff"],"updatePoint":{"line":45,"column":49,"index":970},"line":45,"code":"  test(`backoffs page limit when limit is reached`, async () => {\n    jest.setTimeout(30000);\n    const scope = nock(baseURI)\n    // Space\n    .get(`/spaces/${options.spaceId}/`).reply(200, {\n      items: []\n    })\n    // Locales\n    .get(`/spaces/${options.spaceId}/environments/master/locales`).reply(200, {\n      items: [{\n        code: `en`,\n        default: true\n      }]\n    })\n    // Sync with 1000 (to much)\n    .get(`/spaces/${options.spaceId}/environments/master/sync?initial=true&limit=1000`).times(1).reply(400, {\n      sys: {\n        type: `Error`,\n        id: `BadRequest`\n      },\n      message: `Response size too big. Maximum allowed response size: 512000B.`,\n      requestId: `12345`\n    })\n    // Sync with 666 (still to much)\n    .get(`/spaces/${options.spaceId}/environments/master/sync?initial=true&limit=666`).times(1).reply(400, {\n      sys: {\n        type: `Error`,\n        id: `BadRequest`\n      },\n      message: `Response size too big. Maximum allowed response size: 512000B.`,\n      requestId: `12345`\n    })\n    // Sync with 444\n    .get(`/spaces/${options.spaceId}/environments/master/sync?initial=true&limit=444`).reply(200, {\n      items: []\n    });\n    await fetchContent({\n      pluginConfig,\n      reporter,\n      syncToken: null\n    });\n    expect(reporter.panic).not.toBeCalled();\n    expect(reporter.warn.mock.calls).toMatchInlineSnapshot(`\n      Array [\n        Array [\n          \"The sync with Contentful failed using pageLimit 1000 as the reponse size limit of the API is exceeded.\n\n      Retrying sync with pageLimit of 666\",\n        ],\n        Array [\n          \"The sync with Contentful failed using pageLimit 666 as the reponse size limit of the API is exceeded.\n\n      Retrying sync with pageLimit of 444\",\n        ],\n        Array [\n          \"We recommend you to set your pageLimit in gatsby-config.js to 444 to avoid failed synchronizations.\",\n        ],\n      ]\n    `);\n    expect(scope.isDone()).toBeTruthy();\n  });","file":"fetch-backoff.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"does not backoff page limit when limit is not reached","suites":["fetch-backoff"],"updatePoint":{"line":106,"column":61,"index":2950},"line":106,"code":"  test(`does not backoff page limit when limit is not reached`, async () => {\n    jest.setTimeout(30000);\n    const scope = nock(baseURI)\n    // Space\n    .get(`/spaces/${options.spaceId}/`).reply(200, {\n      items: []\n    })\n    // Locales\n    .get(`/spaces/${options.spaceId}/environments/master/locales`).reply(200, {\n      items: [{\n        code: `en`,\n        default: true\n      }]\n    })\n    // Sync with 1000 (no limit exceeded)\n    .get(`/spaces/${options.spaceId}/environments/master/sync?initial=true&limit=1000`).reply(200, {\n      items: []\n    });\n    await fetchContent({\n      pluginConfig,\n      reporter,\n      syncToken: null\n    });\n    expect(reporter.panic).not.toBeCalled();\n    expect(reporter.warn).not.toBeCalled();\n    expect(scope.isDone()).toBeTruthy();\n  });","file":"fetch-backoff.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"request retries when network timeout happens","suites":["fetch-retry"],"updatePoint":{"line":44,"column":52,"index":947},"line":44,"code":"  test(`request retries when network timeout happens`, async () => {\n    const scope = nock(baseURI)\n    // Space\n    .get(`/spaces/${options.spaceId}/`).reply(200, {\n      items: []\n    })\n    // Locales\n    .get(`/spaces/${options.spaceId}/environments/master/locales`).reply(200, {\n      items: [{\n        code: `en`,\n        default: true\n      }]\n    })\n    // Sync\n    .get(`/spaces/${options.spaceId}/environments/master/sync?initial=true&limit=1000`).times(1).replyWithError({\n      code: `ETIMEDOUT`\n    }).get(`/spaces/${options.spaceId}/environments/master/sync?initial=true&limit=1000`).reply(200, {\n      items: []\n    });\n    await fetchContent({\n      pluginConfig,\n      reporter,\n      syncToken: null\n    });\n    expect(reporter.panic).not.toBeCalled();\n    expect(scope.isDone()).toBeTruthy();\n  });","file":"fetch-network-errors.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"request should fail after to many retries","suites":["fetch-retry"],"updatePoint":{"line":71,"column":49,"index":1763},"line":71,"code":"  test(`request should fail after to many retries`, async () => {\n    // Due to the retries, this can take up to 10 seconds\n    jest.setTimeout(10000);\n    const scope = nock(baseURI)\n    // Space\n    .get(`/spaces/${options.spaceId}/`).reply(200, {\n      items: []\n    })\n    // Locales\n    .get(`/spaces/${options.spaceId}/environments/master/locales`).reply(200, {\n      items: [{\n        code: `en`,\n        default: true\n      }]\n    })\n    // Sync\n    .get(`/spaces/${options.spaceId}/environments/master/sync?initial=true&limit=1000`).times(3).reply(500, {\n      sys: {\n        type: `Error`,\n        id: `MockedContentfulError`\n      },\n      message: `Mocked message of Contentful error`\n    }, {\n      [`x-contentful-request-id`]: `123abc`\n    });\n    try {\n      await fetchContent({\n        pluginConfig,\n        reporter,\n        syncToken: null\n      });\n      throw new Error(`fetchContent should throw an error`);\n    } catch (e) {\n      const msg = expect(e.context.sourceMessage);\n      msg.toEqual(expect.stringContaining(`Fetching contentful data failed: ERR_BAD_RESPONSE 500 MockedContentfulError`));\n      msg.toEqual(expect.stringContaining(`Request ID: 123abc`));\n      msg.toEqual(expect.stringContaining(`Attempts: 3`));\n    }\n    expect(reporter.panic).toBeCalled();\n    expect(scope.isDone()).toBeTruthy();\n  });","file":"fetch-network-errors.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"catches plain network error","suites":["fetch-network-errors"],"updatePoint":{"line":114,"column":35,"index":3135},"line":114,"code":"  test(`catches plain network error`, async () => {\n    const scope = nock(baseURI)\n    // Space\n    .get(`/spaces/${options.spaceId}/`).replyWithError({\n      code: `ECONNRESET`\n    });\n    try {\n      await fetchContent({\n        pluginConfig: createPluginConfig({\n          ...options,\n          contentfulClientConfig: {\n            retryOnError: false\n          }\n        }),\n        reporter,\n        syncToken: null\n      });\n      throw new Error(`fetchContent should throw an error`);\n    } catch (e) {\n      expect(e.context.sourceMessage).toEqual(expect.stringContaining(`Accessing your Contentful space failed: ECONNRESET`));\n    }\n    expect(reporter.panic).toBeCalled();\n    expect(scope.isDone()).toBeTruthy();\n  });","file":"fetch-network-errors.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"catches error with response object","suites":["fetch-network-errors"],"updatePoint":{"line":138,"column":42,"index":3874},"line":138,"code":"  test(`catches error with response object`, async () => {\n    const scope = nock(baseURI)\n    // Space\n    .get(`/spaces/${options.spaceId}/`).reply(429, {\n      sys: {\n        type: `Error`,\n        id: `MockedContentfulError`\n      },\n      message: `Mocked message of Contentful error`,\n      requestId: `123abc`\n    });\n    try {\n      await fetchContent({\n        pluginConfig: createPluginConfig({\n          ...options,\n          contentfulClientConfig: {\n            retryOnError: false\n          }\n        }),\n        reporter,\n        syncToken: null\n      });\n      throw new Error(`fetchContent should throw an error`);\n    } catch (e) {\n      const msg = expect(e.context.sourceMessage);\n      msg.toEqual(expect.stringContaining(`Accessing your Contentful space failed: MockedContentfulError`));\n      msg.toEqual(expect.stringContaining(`Mocked message of Contentful error`));\n      msg.toEqual(expect.stringContaining(`Request ID: 123abc`));\n    }\n    expect(reporter.panic).toBeCalled();\n    expect(scope.isDone()).toBeTruthy();\n  });","file":"fetch-network-errors.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"calls contentful.createClient with expected params","suites":[],"updatePoint":{"line":111,"column":54,"index":2383},"line":111,"code":"it(`calls contentful.createClient with expected params`, async () => {\n  await fetchContent({\n    pluginConfig,\n    reporter,\n    syncToken: null\n  });\n  expect(reporter.panic).not.toBeCalled();\n  expect(createClient).toBeCalledWith(expect.objectContaining({\n    accessToken: `6f35edf0db39085e9b9c19bd92943e4519c77e72c852d961968665f1324bfc94`,\n    environment: `env`,\n    host: `host`,\n    space: `rocybtov1ozk`,\n    proxy: proxyOption\n  }));\n});","file":"fetch.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"calls contentful.createClient with expected params and default fallbacks","suites":[],"updatePoint":{"line":126,"column":76,"index":2852},"line":126,"code":"it(`calls contentful.createClient with expected params and default fallbacks`, async () => {\n  await fetchContent({\n    pluginConfig: createPluginConfig({\n      accessToken: `6f35edf0db39085e9b9c19bd92943e4519c77e72c852d961968665f1324bfc94`,\n      spaceId: `rocybtov1ozk`\n    }),\n    reporter,\n    syncToken: null\n  });\n  expect(reporter.panic).not.toBeCalled();\n  expect(createClient).toBeCalledWith(expect.objectContaining({\n    accessToken: `6f35edf0db39085e9b9c19bd92943e4519c77e72c852d961968665f1324bfc94`,\n    environment: `master`,\n    host: `cdn.contentful.com`,\n    space: `rocybtov1ozk`\n  }));\n});","file":"fetch.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"calls contentful.getContentTypes with default page limit","suites":[],"updatePoint":{"line":143,"column":60,"index":3444},"line":143,"code":"it(`calls contentful.getContentTypes with default page limit`, async () => {\n  await fetchContentTypes({\n    pluginConfig: createPluginConfig({\n      accessToken: `6f35edf0db39085e9b9c19bd92943e4519c77e72c852d961968665f1324bfc94`,\n      spaceId: `rocybtov1ozk`\n    }),\n    reporter\n  });\n  expect(reporter.panic).not.toBeCalled();\n  expect(mockClient.getContentTypes).toHaveBeenCalledWith({\n    limit: 1000,\n    order: `sys.createdAt`,\n    skip: 0\n  });\n});","file":"fetch.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"calls contentful.getContentTypes with custom plugin option page limit","suites":[],"updatePoint":{"line":158,"column":73,"index":3915},"line":158,"code":"it(`calls contentful.getContentTypes with custom plugin option page limit`, async () => {\n  await fetchContentTypes({\n    pluginConfig: createPluginConfig({\n      accessToken: `6f35edf0db39085e9b9c19bd92943e4519c77e72c852d961968665f1324bfc94`,\n      spaceId: `rocybtov1ozk`,\n      pageLimit: 50\n    }),\n    reporter\n  });\n  expect(reporter.panic).not.toBeCalled();\n  expect(mockClient.getContentTypes).toHaveBeenCalledWith({\n    limit: 50,\n    order: `sys.createdAt`,\n    skip: 0\n  });\n});","file":"fetch.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"tags are disabled by default","suites":["Tags feature"],"updatePoint":{"line":175,"column":34,"index":4399},"line":175,"code":"  it(`tags are disabled by default`, async () => {\n    await fetchContent({\n      pluginConfig: createPluginConfig({\n        accessToken: `6f35edf0db39085e9b9c19bd92943e4519c77e72c852d961968665f1324bfc94`,\n        spaceId: `rocybtov1ozk`,\n        pageLimit: 50\n      }),\n      reporter,\n      syncToken: null\n    });\n    expect(reporter.panic).not.toBeCalled();\n    expect(mockClient.getTags).not.toBeCalled();\n  });","file":"fetch.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"calls contentful.getTags when enabled","suites":["Tags feature"],"updatePoint":{"line":188,"column":43,"index":4825},"line":188,"code":"  it(`calls contentful.getTags when enabled`, async () => {\n    await fetchContent({\n      pluginConfig: createPluginConfig({\n        accessToken: `6f35edf0db39085e9b9c19bd92943e4519c77e72c852d961968665f1324bfc94`,\n        spaceId: `rocybtov1ozk`,\n        pageLimit: 50,\n        enableTags: true\n      }),\n      reporter,\n      syncToken: null\n    });\n    expect(reporter.panic).not.toBeCalled();\n    expect(mockClient.getTags).toHaveBeenCalledWith({\n      limit: 50,\n      order: `sys.createdAt`,\n      skip: 0\n    });\n  });","file":"fetch.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"Generic fallback error","suites":["Displays troubleshooting tips and detailed plugin options on contentful client error"],"updatePoint":{"line":208,"column":28,"index":5445},"line":208,"code":"  it(`Generic fallback error`, async () => {\n    mockClient.getLocales.mockImplementation(() => {\n      throw new Error(`error`);\n    });\n    await fetchContent({\n      pluginConfig,\n      reporter,\n      syncToken: null\n    });\n    expect(reporter.panic).toBeCalledWith(expect.objectContaining({\n      context: {\n        sourceMessage: expect.stringContaining(`Accessing your Contentful space failed`)\n      }\n    }));\n    expect(reporter.panic).toBeCalledWith(expect.objectContaining({\n      context: {\n        sourceMessage: expect.stringContaining(`formatPluginOptionsForCLIMock`)\n      }\n    }));\n    expect(formatPluginOptionsForCLI).toBeCalledWith(expect.objectContaining({\n      ...options\n    }), undefined);\n  });","file":"fetch.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"Connection error","suites":["Displays troubleshooting tips and detailed plugin options on contentful client error"],"updatePoint":{"line":231,"column":22,"index":6163},"line":231,"code":"  it(`Connection error`, async () => {\n    mockClient.getLocales.mockImplementation(() => {\n      const err = new Error(`error`);\n      // @ts-ignore\n      err.code = `ENOTFOUND`;\n      throw err;\n    });\n    await fetchContent({\n      pluginConfig,\n      reporter,\n      syncToken: null\n    });\n    expect(reporter.panic).toBeCalledWith(expect.objectContaining({\n      context: {\n        sourceMessage: expect.stringContaining(`You seem to be offline`)\n      }\n    }));\n    expect(reporter.panic).toBeCalledWith(expect.objectContaining({\n      context: {\n        sourceMessage: expect.stringContaining(`formatPluginOptionsForCLIMock`)\n      }\n    }));\n    expect(formatPluginOptionsForCLI).toBeCalledWith(expect.objectContaining({\n      ...options\n    }), undefined);\n  });","file":"fetch.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"API 404 response handling","suites":["Displays troubleshooting tips and detailed plugin options on contentful client error"],"updatePoint":{"line":257,"column":31,"index":6947},"line":257,"code":"  it(`API 404 response handling`, async () => {\n    mockClient.getLocales.mockImplementation(() => {\n      const err = new Error(`error`);\n      // @ts-ignore\n      err.responseData = {\n        status: 404\n      };\n      throw err;\n    });\n    const masterOptions = {\n      ...options,\n      environment: `master`\n    };\n    const masterConfig = createPluginConfig(masterOptions);\n    await fetchContent({\n      pluginConfig: masterConfig,\n      reporter,\n      syncToken: null\n    });\n    expect(reporter.panic).toBeCalledWith(expect.objectContaining({\n      context: {\n        sourceMessage: expect.stringContaining(`Endpoint not found`)\n      }\n    }));\n    expect(reporter.panic).toBeCalledWith(expect.objectContaining({\n      context: {\n        sourceMessage: expect.stringContaining(`formatPluginOptionsForCLIMock`)\n      }\n    }));\n    expect(formatPluginOptionsForCLI).toBeCalledWith(expect.objectContaining({\n      ...masterOptions\n    }), {\n      host: `Check if setting is correct`,\n      spaceId: `Check if setting is correct`\n    });\n  });","file":"fetch.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"API 404 response handling with environment set","suites":["Displays troubleshooting tips and detailed plugin options on contentful client error"],"updatePoint":{"line":293,"column":52,"index":8021},"line":293,"code":"  it(`API 404 response handling with environment set`, async () => {\n    mockClient.getLocales.mockImplementation(() => {\n      const err = new Error(`error`);\n      // @ts-ignore\n      err.responseData = {\n        status: 404\n      };\n      throw err;\n    });\n    await fetchContent({\n      pluginConfig,\n      reporter,\n      syncToken: null\n    });\n    expect(reporter.panic).toBeCalledWith(expect.objectContaining({\n      context: {\n        sourceMessage: expect.stringContaining(`Unable to access your space.`)\n      }\n    }));\n    expect(reporter.panic).toBeCalledWith(expect.objectContaining({\n      context: {\n        sourceMessage: expect.stringContaining(`formatPluginOptionsForCLIMock`)\n      }\n    }));\n    expect(formatPluginOptionsForCLI).toBeCalledWith(expect.objectContaining({\n      ...options\n    }), {\n      accessToken: `Check if setting is correct`,\n      environment: `Check if setting is correct`\n    });\n  });","file":"fetch.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"API authorization error handling","suites":["Displays troubleshooting tips and detailed plugin options on contentful client error"],"updatePoint":{"line":324,"column":38,"index":8941},"line":324,"code":"  it(`API authorization error handling`, async () => {\n    mockClient.getLocales.mockImplementation(() => {\n      const err = new Error(`error`);\n      // @ts-ignore\n      err.responseData = {\n        status: 401\n      };\n      throw err;\n    });\n    await fetchContent({\n      pluginConfig,\n      reporter,\n      syncToken: null\n    });\n    expect(reporter.panic).toBeCalledWith(expect.objectContaining({\n      context: {\n        sourceMessage: expect.stringContaining(`Authorization error.`)\n      }\n    }));\n    expect(reporter.panic).toBeCalledWith(expect.objectContaining({\n      context: {\n        sourceMessage: expect.stringContaining(`formatPluginOptionsForCLIMock`)\n      }\n    }));\n    expect(formatPluginOptionsForCLI).toBeCalledWith(expect.objectContaining({\n      ...options\n    }), {\n      accessToken: `Check if setting is correct`,\n      environment: `Check if setting is correct`\n    });\n  });","file":"fetch.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"should pass when gatsby-plugin-image is installed and configured","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":352,"column":72,"index":11665},"line":352,"code":"    it(`should pass when gatsby-plugin-image is installed and configured`, async () => {\n      const reporter = {\n        panic: jest.fn(err => {\n          throw err;\n        })\n      };\n      await onPreInit({\n        store: {\n          getState: () => {\n            return {\n              flattenedPlugins: [{\n                name: `gatsby-plugin-image`\n              }]\n            };\n          }\n        },\n        reporter\n      });\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"should throw when gatsby-plugin-image is not installed","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":371,"column":62,"index":12101},"line":371,"code":"    it(`should throw when gatsby-plugin-image is not installed`, async () => {\n      const reporter = {\n        panic: jest.fn(err => {\n          throw err;\n        })\n      };\n      jest.doMock(`gatsby-plugin-image/graphql-utils`, () => {\n        if (hasImported) {\n          return jest.requireActual(`gatsby-plugin-image/graphql-utils`);\n        }\n\n        // only throw once\n        hasImported = true;\n        throw new Error(`not installed`);\n      });\n      expect.assertions(2);\n      try {\n        await onPreInit({\n          store: {},\n          reporter\n        });\n      } catch (err) {\n        console.log(err);\n        expect(err.id).toBe(`111005`);\n        expect(err.context).toMatchInlineSnapshot(`\n          Object {\n            \"sourceMessage\": \"gatsby-plugin-image is missing from your project.\n          Please install \\\\\"gatsby-plugin-image\\\\\".\",\n          }\n        `);\n      }\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"should throw when gatsby-plugin-image is not configured","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":403,"column":63,"index":13011},"line":403,"code":"    it(`should throw when gatsby-plugin-image is not configured`, async () => {\n      const reporter = {\n        panic: jest.fn(err => {\n          throw err;\n        })\n      };\n      expect.assertions(2);\n      try {\n        await onPreInit({\n          store: {\n            getState: () => {\n              return {\n                flattenedPlugins: []\n              };\n            }\n          },\n          reporter\n        });\n      } catch (err) {\n        console.log(err);\n        expect(err.id).toBe(`111005`);\n        expect(err.context).toMatchInlineSnapshot(`\n          Object {\n            \"sourceMessage\": \"gatsby-plugin-image is missing from your gatsby-config file.\n          Please add \\\\\"gatsby-plugin-image\\\\\" to your plugins array.\",\n          }\n        `);\n      }\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"should create nodes from initial payload","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":433,"column":46,"index":13789},"line":433,"code":"  it(`should create nodes from initial payload`, async () => {\n    // @ts-ignore\n    fetchContent.mockImplementationOnce(startersBlogFixture.initialSync);\n    const locales = [`en-US`, `nl`];\n    await simulateGatsbyBuild();\n    testIfContentTypesExists(startersBlogFixture.contentTypeItems());\n    testIfEntriesExists(startersBlogFixture.initialSync().currentSyncData.entries, startersBlogFixture.contentTypeItems(), locales);\n    testIfAssetsExistsAndMatch(startersBlogFixture.initialSync().currentSyncData.assets, locales);\n    expect(store.getState).toHaveBeenCalled();\n    expect(cache.get.mock.calls).toMatchInlineSnapshot(`\n      Array [\n        Array [\n          \"contentful-content-types-testSpaceId-master\",\n        ],\n        Array [\n          \"contentful-foreign-reference-map-state-testSpaceId-master\",\n        ],\n      ]\n    `);\n\n    // Stores sync token and raw/unparsed data to the cache\n    expect(actions.setPluginStatus).toHaveBeenCalledWith({\n      [`contentful-sync-token-testSpaceId-master`]: startersBlogFixture.initialSync().currentSyncData.nextSyncToken\n    });\n    expect(cache.set.mock.calls.map(v => v[0])).toMatchInlineSnapshot(`\n      Array [\n        \"contentful-content-types-testSpaceId-master\",\n        \"contentful-foreign-reference-map-state-testSpaceId-master\",\n      ]\n    `);\n    expect(actions.createNode).toHaveBeenCalledTimes(32);\n    expect(actions.deleteNode).toHaveBeenCalledTimes(0);\n    expect(actions.touchNode).toHaveBeenCalledTimes(0);\n    expect(reporter.info.mock.calls).toMatchInlineSnapshot(`\n      Array [\n        Array [\n          \"Contentful: 4 new entries\",\n        ],\n        Array [\n          \"Contentful: 0 updated entries\",\n        ],\n        Array [\n          \"Contentful: 0 deleted entries\",\n        ],\n        Array [\n          \"Contentful: 0 cached entries\",\n        ],\n        Array [\n          \"Contentful: 4 new assets\",\n        ],\n        Array [\n          \"Contentful: 0 updated assets\",\n        ],\n        Array [\n          \"Contentful: 0 cached assets\",\n        ],\n        Array [\n          \"Contentful: 0 deleted assets\",\n        ],\n        Array [\n          \"Creating 1 Contentful Person nodes\",\n        ],\n        Array [\n          \"Creating 3 Contentful Blog Post nodes\",\n        ],\n        Array [\n          \"Creating 4 Contentful asset nodes\",\n        ],\n      ]\n    `);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"should create nodes with custom prefix","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":504,"column":44,"index":16141},"line":504,"code":"  it(`should create nodes with custom prefix`, async () => {\n    // @ts-ignore\n    fetchContent.mockImplementationOnce(startersBlogFixture.initialSync);\n    schema.buildObjectType.mockClear();\n    // @ts-ignore\n    await simulateGatsbyBuild({\n      typePrefix: `CustomPrefix`\n    });\n    expect(schema.buildObjectType).toHaveBeenCalledTimes(3);\n    expect(schema.buildObjectType).toHaveBeenCalledWith(expect.objectContaining({\n      name: `CustomPrefixPerson`\n    }));\n    expect(schema.buildObjectType).toHaveBeenCalledWith(expect.objectContaining({\n      name: `CustomPrefixBlogPost`\n    }));\n    expect(schema.buildObjectType).toHaveBeenCalledWith(expect.objectContaining({\n      name: `CustomPrefixAsset`\n    }));\n    expect(schema.buildObjectType).not.toHaveBeenCalledWith(expect.objectContaining({\n      name: `ContentfulPerson`\n    }));\n    expect(schema.buildObjectType).not.toHaveBeenCalledWith(expect.objectContaining({\n      name: `ContentfulBlogPost`\n    }));\n    expect(schema.buildObjectType).not.toHaveBeenCalledWith(expect.objectContaining({\n      name: `ContentfulAsset`\n    }));\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"should add a new blogpost and update linkedNodes","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":532,"column":54,"index":17254},"line":532,"code":"  it(`should add a new blogpost and update linkedNodes`, async () => {\n    const locales = [`en-US`, `nl`];\n    fetchContent\n    // @ts-ignore\n    .mockImplementationOnce(startersBlogFixture.initialSync).mockImplementationOnce(startersBlogFixture.createBlogPost);\n    const createdBlogEntry = startersBlogFixture.createBlogPost().currentSyncData.entries[0];\n    const createdBlogEntryIds = locales.map(locale => makeId({\n      spaceId: createdBlogEntry.sys.space.sys.id,\n      currentLocale: locale,\n      defaultLocale: locales[0],\n      id: createdBlogEntry.sys.id,\n      type: createdBlogEntry.sys.type\n    }));\n\n    // initial sync\n    await simulateGatsbyBuild();\n\n    // check if blog posts do not exists\n    createdBlogEntryIds.forEach(entryId => {\n      expect(getNode(entryId)).toBeUndefined();\n    });\n\n    // add new blog post\n    reporter.info.mockClear();\n    await simulateGatsbyBuild();\n    testIfContentTypesExists(startersBlogFixture.contentTypeItems());\n    testIfEntriesExists(startersBlogFixture.createBlogPost().currentSyncData.entries, startersBlogFixture.contentTypeItems(), locales);\n    testIfAssetsExistsAndMatch(startersBlogFixture.createBlogPost().currentSyncData.assets, locales);\n    createdBlogEntryIds.forEach(blogEntryId => {\n      const blogEntry = getNode(blogEntryId);\n      expect(getNode(blogEntry[`author___NODE`])).toBeTruthy();\n    });\n    expect(actions.createNode).toHaveBeenCalledTimes(46);\n    expect(actions.deleteNode).toHaveBeenCalledTimes(0);\n    expect(actions.touchNode).toHaveBeenCalledTimes(0);\n    expect(reporter.info.mock.calls).toMatchInlineSnapshot(`\n      Array [\n        Array [\n          \"Contentful: 1 new entries\",\n        ],\n        Array [\n          \"Contentful: 0 updated entries\",\n        ],\n        Array [\n          \"Contentful: 0 deleted entries\",\n        ],\n        Array [\n          \"Contentful: 4 cached entries\",\n        ],\n        Array [\n          \"Contentful: 1 new assets\",\n        ],\n        Array [\n          \"Contentful: 0 updated assets\",\n        ],\n        Array [\n          \"Contentful: 4 cached assets\",\n        ],\n        Array [\n          \"Contentful: 0 deleted assets\",\n        ],\n        Array [\n          \"Creating 1 Contentful Blog Post nodes\",\n        ],\n        Array [\n          \"Creating 1 Contentful asset nodes\",\n        ],\n      ]\n    `);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"should update a blogpost","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":602,"column":30,"index":19573},"line":602,"code":"  it(`should update a blogpost`, async () => {\n    const locales = [`en-US`, `nl`];\n    fetchContent\n    // @ts-ignore\n    .mockImplementationOnce(startersBlogFixture.initialSync).mockImplementationOnce(startersBlogFixture.createBlogPost).mockImplementationOnce(startersBlogFixture.updateBlogPost);\n    const updatedBlogEntry = startersBlogFixture.updateBlogPost().currentSyncData.entries[0];\n    const updatedBlogEntryIds = locales.map(locale => makeId({\n      spaceId: updatedBlogEntry.sys.space.sys.id,\n      currentLocale: locale,\n      defaultLocale: locales[0],\n      id: updatedBlogEntry.sys.id,\n      type: updatedBlogEntry.sys.type\n    }));\n\n    // initial sync\n    await simulateGatsbyBuild();\n\n    // create blog post\n    await simulateGatsbyBuild();\n    updatedBlogEntryIds.forEach(blogEntryId => {\n      expect(getNode(blogEntryId).title).toBe(`Integration tests`);\n    });\n\n    // updated blog post\n    reporter.info.mockClear();\n    await simulateGatsbyBuild();\n    testIfContentTypesExists(startersBlogFixture.contentTypeItems());\n    testIfEntriesExists(startersBlogFixture.updateBlogPost().currentSyncData.entries, startersBlogFixture.contentTypeItems(), locales);\n    testIfAssetsExistsAndMatch(startersBlogFixture.updateBlogPost().currentSyncData.assets, locales);\n    updatedBlogEntryIds.forEach(blogEntryId => {\n      const blogEntry = getNode(blogEntryId);\n      expect(blogEntry.title).toBe(`Hello world 1234`);\n      expect(getNode(blogEntry[`author___NODE`])).toBeTruthy();\n    });\n    expect(actions.createNode).toHaveBeenCalledTimes(54);\n    expect(actions.deleteNode).toHaveBeenCalledTimes(0);\n    expect(actions.touchNode).toHaveBeenCalledTimes(0);\n    expect(reporter.info.mock.calls).toMatchInlineSnapshot(`\n      Array [\n        Array [\n          \"Contentful: 0 new entries\",\n        ],\n        Array [\n          \"Contentful: 1 updated entries\",\n        ],\n        Array [\n          \"Contentful: 0 deleted entries\",\n        ],\n        Array [\n          \"Contentful: 5 cached entries\",\n        ],\n        Array [\n          \"Contentful: 0 new assets\",\n        ],\n        Array [\n          \"Contentful: 0 updated assets\",\n        ],\n        Array [\n          \"Contentful: 5 cached assets\",\n        ],\n        Array [\n          \"Contentful: 0 deleted assets\",\n        ],\n        Array [\n          \"Creating 1 Contentful Blog Post nodes\",\n        ],\n      ]\n    `);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"should remove a blogpost and update linkedNodes","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":671,"column":53,"index":21996},"line":671,"code":"  it(`should remove a blogpost and update linkedNodes`, async () => {\n    const locales = [`en-US`, `nl`];\n    fetchContent\n    // @ts-ignore\n    .mockImplementationOnce(startersBlogFixture.initialSync).mockImplementationOnce(startersBlogFixture.createBlogPost).mockImplementationOnce(startersBlogFixture.removeBlogPost);\n    const removedBlogEntry = startersBlogFixture.removeBlogPost().currentSyncData.deletedEntries[0];\n    const normalizedType = removedBlogEntry.sys.type.startsWith(`Deleted`) ? removedBlogEntry.sys.type.substring(`Deleted`.length) : removedBlogEntry.sys.type;\n    const removedBlogEntryIds = locales.map(locale => makeId({\n      spaceId: removedBlogEntry.sys.space.sys.id,\n      currentLocale: locale,\n      defaultLocale: locales[0],\n      id: removedBlogEntry.sys.id,\n      type: normalizedType\n    }));\n\n    // initial sync\n    await simulateGatsbyBuild();\n    for (const author of getNodes().filter(n => n.internal.type === `ContentfulPerson`)) {\n      expect(author[`blog post___NODE`].length).toEqual(3);\n      expect(author[`blog post___NODE`]).toEqual(expect.not.arrayContaining([makeId({\n        spaceId: removedBlogEntry.sys.space.sys.id,\n        currentLocale: author.node_locale,\n        defaultLocale: locales[0],\n        id: removedBlogEntry.sys.id,\n        type: normalizedType\n      })]));\n    }\n\n    // create blog post\n    await simulateGatsbyBuild();\n    const authorIds = [];\n    // check if blog post exists\n    removedBlogEntryIds.forEach(entryId => {\n      const blogEntry = getNode(entryId);\n      authorIds.push(blogEntry[`author___NODE`]);\n      expect(blogEntry).not.toBeUndefined();\n    });\n    for (const author of getNodes().filter(n => n.internal.type === `ContentfulPerson`)) {\n      expect(author[`blog post___NODE`].length).toEqual(4);\n      expect(author[`blog post___NODE`]).toEqual(expect.arrayContaining([makeId({\n        spaceId: removedBlogEntry.sys.space.sys.id,\n        currentLocale: author.node_locale,\n        defaultLocale: locales[0],\n        id: removedBlogEntry.sys.id,\n        type: normalizedType\n      })]));\n    }\n\n    // remove blog post\n    reporter.info.mockClear();\n    await simulateGatsbyBuild();\n    const {\n      deletedEntries\n    } = startersBlogFixture.removeBlogPost().currentSyncData;\n    testIfContentTypesExists(startersBlogFixture.contentTypeItems());\n    testIfEntriesDeleted(deletedEntries, locales);\n    const deletedEntryIds = deletedEntries.map(entry => createNodeId(makeId({\n      spaceId: entry.sys.space.sys.id,\n      currentLocale: entry.sys.locale,\n      defaultLocale: locales[0],\n      id: entry.sys.id,\n      type: entry.sys.type\n    })));\n    for (const author of getNodes().filter(n => n.internal.type === `ContentfulPerson`)) {\n      expect(author[`blog post___NODE`].length).toEqual(3);\n      expect(author[`blog post___NODE`]).toEqual(expect.not.arrayContaining([makeId({\n        spaceId: removedBlogEntry.sys.space.sys.id,\n        currentLocale: author.node_locale,\n        defaultLocale: locales[0],\n        id: removedBlogEntry.sys.id,\n        type: normalizedType\n      })]));\n    }\n\n    // check if references are gone\n    authorIds.forEach(authorId => {\n      expect(getNode(authorId)[`blog post___NODE`]).toEqual(expect.not.arrayContaining(deletedEntryIds));\n    });\n    expect(actions.createNode).toHaveBeenCalledTimes(52);\n    expect(actions.deleteNode).toHaveBeenCalledTimes(2);\n    expect(actions.touchNode).toHaveBeenCalledTimes(2);\n    expect(reporter.info.mock.calls).toMatchInlineSnapshot(`\n      Array [\n        Array [\n          \"Contentful: 0 new entries\",\n        ],\n        Array [\n          \"Contentful: 0 updated entries\",\n        ],\n        Array [\n          \"Contentful: 1 deleted entries\",\n        ],\n        Array [\n          \"Contentful: 5 cached entries\",\n        ],\n        Array [\n          \"Contentful: 0 new assets\",\n        ],\n        Array [\n          \"Contentful: 0 updated assets\",\n        ],\n        Array [\n          \"Contentful: 5 cached assets\",\n        ],\n        Array [\n          \"Contentful: 0 deleted assets\",\n        ],\n      ]\n    `);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"should remove an asset","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":781,"column":28,"index":26069},"line":781,"code":"  it(`should remove an asset`, async () => {\n    const locales = [`en-US`, `nl`];\n    fetchContent\n    // @ts-ignore\n    .mockImplementationOnce(startersBlogFixture.initialSync).mockImplementationOnce(startersBlogFixture.createBlogPost).mockImplementationOnce(startersBlogFixture.removeAsset);\n    const removedAssetEntry = startersBlogFixture.createBlogPost().currentSyncData.entries[0];\n    const removedAssetEntryIds = locales.map(locale => makeId({\n      spaceId: removedAssetEntry.sys.space.sys.id,\n      currentLocale: locale,\n      defaultLocale: locales[0],\n      id: removedAssetEntry.sys.id,\n      type: removedAssetEntry.sys.type\n    }));\n\n    // initial sync\n    await simulateGatsbyBuild();\n\n    // create blog post\n    await simulateGatsbyBuild();\n\n    // check if blog post exists\n    removedAssetEntryIds.forEach(assetId => {\n      expect(getNode(assetId)).not.toBeUndefined();\n    });\n\n    // check if assets exists\n    testIfAssetsExists(startersBlogFixture.removeAsset().currentSyncData.deletedAssets, locales);\n\n    // remove asset\n    reporter.info.mockClear();\n    await simulateGatsbyBuild();\n    testIfContentTypesExists(startersBlogFixture.contentTypeItems());\n    testIfEntriesExists(startersBlogFixture.removeAsset().currentSyncData.entries, startersBlogFixture.removeAsset().contentTypeItems, locales);\n    testIfAssetsDeleted(startersBlogFixture.removeAsset().currentSyncData.deletedAssets, locales);\n    expect(actions.createNode).toHaveBeenCalledTimes(54);\n    expect(actions.deleteNode).toHaveBeenCalledTimes(2);\n    expect(actions.touchNode).toHaveBeenCalledTimes(2);\n    expect(reporter.info.mock.calls).toMatchInlineSnapshot(`\n      Array [\n        Array [\n          \"Contentful: 0 new entries\",\n        ],\n        Array [\n          \"Contentful: 0 updated entries\",\n        ],\n        Array [\n          \"Contentful: 0 deleted entries\",\n        ],\n        Array [\n          \"Contentful: 5 cached entries\",\n        ],\n        Array [\n          \"Contentful: 0 new assets\",\n        ],\n        Array [\n          \"Contentful: 0 updated assets\",\n        ],\n        Array [\n          \"Contentful: 5 cached assets\",\n        ],\n        Array [\n          \"Contentful: 1 deleted assets\",\n        ],\n      ]\n    `);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"stores rich text as raw with references attached","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":847,"column":54,"index":28339},"line":847,"code":"  it(`stores rich text as raw with references attached`, async () => {\n    // @ts-ignore\n    fetchContent.mockImplementationOnce(richTextFixture.initialSync);\n    // @ts-ignore\n    fetchContentTypes.mockImplementationOnce(richTextFixture.contentTypeItems);\n\n    // initial sync\n    await simulateGatsbyBuild();\n    const initNodes = getNodes();\n    const homeNodes = initNodes.filter(({\n      contentful_id: id\n    }) => id === `6KpLS2NZyB3KAvDzWf4Ukh`);\n    expect(homeNodes).toHaveLength(2);\n    homeNodes.forEach(homeNode => {\n      expect(homeNode.content.references___NODE).toStrictEqual([...new Set(homeNode.content.references___NODE)]);\n      expect(homeNode.content.references___NODE).toMatchSnapshot();\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"is able to render unpublished fields in Delivery API","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":865,"column":58,"index":29069},"line":865,"code":"  it(`is able to render unpublished fields in Delivery API`, async () => {\n    const locales = [`en-US`, `nl`];\n\n    // @ts-ignore\n    fetchContent.mockImplementationOnce(unpublishedFieldDelivery.initialSync);\n    // @ts-ignore\n    fetchContentTypes.mockImplementationOnce(unpublishedFieldDelivery.contentTypeItems);\n\n    // initial sync\n    await simulateGatsbyBuild();\n    testIfContentTypesExists(unpublishedFieldDelivery.contentTypeItems());\n    testIfEntriesExists(unpublishedFieldDelivery.initialSync().currentSyncData.entries, unpublishedFieldDelivery.contentTypeItems(), locales, true);\n    testIfAssetsExistsAndMatch(unpublishedFieldDelivery.initialSync().currentSyncData.assets, locales, true);\n    expect(actions.createNode).toHaveBeenCalledTimes(10);\n    expect(actions.deleteNode).toHaveBeenCalledTimes(0);\n    expect(actions.touchNode).toHaveBeenCalledTimes(0);\n    expect(reporter.info.mock.calls).toMatchInlineSnapshot(`\n      Array [\n        Array [\n          \"Contentful: 0 new entries\",\n        ],\n        Array [\n          \"Contentful: 3 updated entries\",\n        ],\n        Array [\n          \"Contentful: 0 deleted entries\",\n        ],\n        Array [\n          \"Contentful: 0 cached entries\",\n        ],\n        Array [\n          \"Contentful: 3 new assets\",\n        ],\n        Array [\n          \"Contentful: 0 updated assets\",\n        ],\n        Array [\n          \"Contentful: 0 cached assets\",\n        ],\n        Array [\n          \"Contentful: 0 deleted assets\",\n        ],\n        Array [\n          \"Creating 3 Contentful Type With Text Field nodes\",\n        ],\n        Array [\n          \"Creating 3 Contentful asset nodes\",\n        ],\n      ]\n    `);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"is able to render unpublished fields in Preview API","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":916,"column":57,"index":30750},"line":916,"code":"  it(`is able to render unpublished fields in Preview API`, async () => {\n    const locales = [`en-US`, `nl`];\n\n    // @ts-ignore\n    fetchContent.mockImplementationOnce(unpublishedFieldPreview.initialSync);\n    // @ts-ignore\n    fetchContentTypes.mockImplementationOnce(unpublishedFieldPreview.contentTypeItems);\n\n    // initial sync\n    await simulateGatsbyBuild();\n    testIfContentTypesExists(unpublishedFieldPreview.contentTypeItems());\n    testIfEntriesExists(unpublishedFieldPreview.initialSync().currentSyncData.entries, unpublishedFieldPreview.contentTypeItems(), locales, true);\n    testIfAssetsExistsAndMatch(unpublishedFieldPreview.initialSync().currentSyncData.assets, locales, true);\n    expect(actions.createNode).toHaveBeenCalledTimes(16);\n    expect(actions.deleteNode).toHaveBeenCalledTimes(0);\n    expect(actions.touchNode).toHaveBeenCalledTimes(0);\n    expect(reporter.info.mock.calls).toMatchInlineSnapshot(`\n      Array [\n        Array [\n          \"Contentful: 0 new entries\",\n        ],\n        Array [\n          \"Contentful: 5 updated entries\",\n        ],\n        Array [\n          \"Contentful: 0 deleted entries\",\n        ],\n        Array [\n          \"Contentful: 0 cached entries\",\n        ],\n        Array [\n          \"Contentful: 3 new assets\",\n        ],\n        Array [\n          \"Contentful: 2 updated assets\",\n        ],\n        Array [\n          \"Contentful: 0 cached assets\",\n        ],\n        Array [\n          \"Contentful: 0 deleted assets\",\n        ],\n        Array [\n          \"Creating 5 Contentful Type With Text Field nodes\",\n        ],\n        Array [\n          \"Creating 5 Contentful asset nodes\",\n        ],\n      ]\n    `);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"panics when localeFilter reduces locale list to 0","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":967,"column":55,"index":32423},"line":967,"code":"  it(`panics when localeFilter reduces locale list to 0`, async () => {\n    // @ts-ignore\n    fetchContent.mockImplementationOnce(startersBlogFixture.initialSync);\n    const locales = [`en-US`, `nl`];\n    await simulateGatsbyBuild({\n      ...defaultPluginOptions,\n      localeFilter: () => false\n    });\n    expect(reporter.panic).toBeCalledWith(expect.objectContaining({\n      context: {\n        sourceMessage: `Please check if your localeFilter is configured properly. Locales '${locales.join(`,`)}' were found but were filtered down to none.`\n      }\n    }));\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"filters content type with contentTypeFilter","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":981,"column":49,"index":32986},"line":981,"code":"  it(`filters content type with contentTypeFilter`, async () => {\n    // @ts-ignore\n    fetchContent.mockImplementationOnce(startersBlogFixture.initialSync);\n    await simulateGatsbyBuild({\n      ...defaultPluginOptions,\n      contentTypeFilter: contentTypeItem => contentTypeItem.sys.id !== `person`\n    });\n    expect(actions.createNode).toHaveBeenCalledTimes(27);\n    expect(actions.deleteNode).toHaveBeenCalledTimes(0);\n    expect(actions.touchNode).toHaveBeenCalledTimes(0);\n    expect(reporter.info.mock.calls).toMatchInlineSnapshot(`\n      Array [\n        Array [\n          \"Contentful: 4 new entries\",\n        ],\n        Array [\n          \"Contentful: 0 updated entries\",\n        ],\n        Array [\n          \"Contentful: 0 deleted entries\",\n        ],\n        Array [\n          \"Contentful: 0 cached entries\",\n        ],\n        Array [\n          \"Contentful: 4 new assets\",\n        ],\n        Array [\n          \"Contentful: 0 updated assets\",\n        ],\n        Array [\n          \"Contentful: 0 cached assets\",\n        ],\n        Array [\n          \"Contentful: 0 deleted assets\",\n        ],\n        Array [\n          \"Creating 3 Contentful Blog Post nodes\",\n        ],\n        Array [\n          \"Creating 4 Contentful asset nodes\",\n        ],\n      ]\n    `);\n    expect(getNode(createNodeId(`Person`))).toBeUndefined();\n    expect(getNode(createNodeId(`Blog Post`))).not.toBeUndefined();\n    const fixtureData = startersBlogFixture.initialSync();\n    const personEntry = fixtureData.currentSyncData.entries.find(entry => entry.sys.contentType.sys.id === `person`);\n    const personId = createNodeId(makeId({\n      spaceId: personEntry.sys.space.sys.id,\n      currentLocale: fixtureData.locales[0].code,\n      defaultLocale: fixtureData.locales[0].code,\n      id: personEntry.sys.id,\n      type: personEntry.sys.type\n    }));\n    expect(getNode(personId)).toBeUndefined();\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"panics when contentTypeFilter reduces content type list to none","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":1038,"column":69,"index":34894},"line":1038,"code":"  it(`panics when contentTypeFilter reduces content type list to none`, async () => {\n    // @ts-ignore\n    fetchContent.mockImplementationOnce(startersBlogFixture.initialSync);\n    await simulateGatsbyBuild({\n      ...defaultPluginOptions,\n      contentTypeFilter: () => false\n    });\n    expect(reporter.panic).toBeCalledWith(expect.objectContaining({\n      context: {\n        sourceMessage: `Please check if your contentTypeFilter is configured properly. Content types were filtered down to none.`\n      }\n    }));\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"panics when response contains restricted content types","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":1051,"column":60,"index":35409},"line":1051,"code":"  it(`panics when response contains restricted content types`, async () => {\n    // @ts-ignore\n    fetchContent.mockImplementationOnce(restrictedContentTypeFixture.initialSync);\n    // @ts-ignore\n    fetchContentTypes.mockImplementationOnce(restrictedContentTypeFixture.contentTypeItems);\n    await simulateGatsbyBuild();\n    expect(reporter.panic).toBeCalledWith(expect.objectContaining({\n      context: {\n        sourceMessage: `Restricted ContentType name found. The name \"reference\" is not allowed.`\n      }\n    }));\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"panics when response contains content type Tag while enableTags is true","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":1063,"column":77,"index":35953},"line":1063,"code":"  it(`panics when response contains content type Tag while enableTags is true`, async () => {\n    // @ts-ignore\n    fetchContent.mockImplementationOnce(restrictedContentTypeFixture.initialSync);\n    const contentTypesWithTag = () => {\n      const manipulatedContentTypeItems = restrictedContentTypeFixture.contentTypeItems();\n      manipulatedContentTypeItems[0].name = `Tag`;\n      return manipulatedContentTypeItems;\n    };\n    // @ts-ignore\n    fetchContentTypes.mockImplementationOnce(contentTypesWithTag);\n    await simulateGatsbyBuild({\n      spaceId: `mocked`,\n      enableTags: true,\n      useNameForId: true\n    });\n    expect(reporter.panic).toBeCalledWith(expect.objectContaining({\n      context: {\n        sourceMessage: `Restricted ContentType name found. The name \"tag\" is not allowed.`\n      }\n    }));\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"should preserve back reference when referencing entry wasn't touched","suites":["gatsby-node","onPreInit"],"updatePoint":{"line":1084,"column":74,"index":36774},"line":1084,"code":"  it(`should preserve back reference when referencing entry wasn't touched`, async () => {\n    // @ts-ignore\n    fetchContentTypes.mockImplementation(preserveBackLinks.contentTypeItems);\n    fetchContent\n    // @ts-ignore\n    .mockImplementationOnce(preserveBackLinks.initialSync).mockImplementationOnce(preserveBackLinks.editJustEntryWithBackLinks);\n    let blogPostNodes;\n    let blogCategoryNodes;\n    await simulateGatsbyBuild();\n    blogPostNodes = getNodes().filter(node => node.internal.type === `ContentfulBlogPost`);\n    blogCategoryNodes = getNodes().filter(node => node.internal.type === `ContentfulBlogCategory`);\n    expect(blogPostNodes.length).toEqual(1);\n    expect(blogCategoryNodes.length).toEqual(1);\n    expect(blogCategoryNodes[0][`blog post___NODE`]).toEqual([blogPostNodes[0].id]);\n    expect(blogCategoryNodes[0][`title`]).toEqual(`CMS`);\n    await simulateGatsbyBuild();\n    blogPostNodes = getNodes().filter(node => node.internal.type === `ContentfulBlogPost`);\n    blogCategoryNodes = getNodes().filter(node => node.internal.type === `ContentfulBlogCategory`);\n    expect(blogPostNodes.length).toEqual(1);\n    expect(blogCategoryNodes.length).toEqual(1);\n    expect(blogCategoryNodes[0][`blog post___NODE`]).toEqual([blogPostNodes[0].id]);\n    expect(blogCategoryNodes[0][`title`]).toEqual(`CMS edit #1`);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"default","suites":["gatsby-plugin-image","generateImageSource"],"updatePoint":{"line":56,"column":15,"index":1963},"line":56,"code":"    it(`default`, () => {\n      const resp = generateImageSource(`//test.png`, 420, 210, `webp`, null, {});\n      expect(resp.src).toContain(`w=420`);\n      expect(resp.src).toContain(`h=210`);\n      expect(resp.src).toContain(`fm=webp`);\n      expect(resp).toMatchInlineSnapshot(`\n        Object {\n          \"format\": \"webp\",\n          \"height\": 210,\n          \"src\": \"https://test.png?w=420&h=210&fm=webp\",\n          \"width\": 420,\n        }\n      `);\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"supports corner radius","suites":["gatsby-plugin-image","generateImageSource"],"updatePoint":{"line":70,"column":30,"index":2439},"line":70,"code":"    it(`supports corner radius`, async () => {\n      const resp = generateImageSource(`//test.png`, 420, 210, `webp`, null, {\n        cornerRadius: 10\n      });\n      expect(resp.src).toContain(`r=10`);\n      expect(resp).toMatchInlineSnapshot(`\n        Object {\n          \"format\": \"webp\",\n          \"height\": 210,\n          \"src\": \"https://test.png?w=420&h=210&fm=webp&r=10\",\n          \"width\": 420,\n        }\n      `);\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"transforms corner radius -1 to max","suites":["gatsby-plugin-image","generateImageSource"],"updatePoint":{"line":84,"column":42,"index":2881},"line":84,"code":"    it(`transforms corner radius -1 to max`, async () => {\n      const resp = generateImageSource(`//test.png`, 420, 210, `webp`, null, {\n        cornerRadius: -1\n      });\n      expect(resp.src).toContain(`r=max`);\n      expect(resp).toMatchInlineSnapshot(`\n        Object {\n          \"format\": \"webp\",\n          \"height\": 210,\n          \"src\": \"https://test.png?w=420&h=210&fm=webp&r=max\",\n          \"width\": 420,\n        }\n      `);\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"does not include corner by default","suites":["gatsby-plugin-image","generateImageSource"],"updatePoint":{"line":98,"column":42,"index":3325},"line":98,"code":"    it(`does not include corner by default`, async () => {\n      const resp = generateImageSource(`//test.png`, 420, 210, `webp`, null, {});\n      expect(resp.src).not.toContain(`r=`);\n      expect(resp).toMatchInlineSnapshot(`\n        Object {\n          \"format\": \"webp\",\n          \"height\": 210,\n          \"src\": \"https://test.png?w=420&h=210&fm=webp\",\n          \"width\": 420,\n        }\n      `);\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"default","suites":["gatsby-plugin-image","query arguments"],"updatePoint":{"line":115,"column":15,"index":3808},"line":115,"code":"    it(`default`, async () => {\n      const resp = await extendedNodeType.gatsbyImageData.resolve(exampleImage,\n      // @ts-ignore\n      {}, null, null);\n      expect(resp.images.sources[0].srcSet).toContain(`q=50`);\n      expect(resp.images.sources[0].srcSet).toContain(`fm=webp`);\n      expect(resp.images.fallback.srcSet).toContain(`q=50`);\n      expect(resp.images.fallback.srcSet).toContain(`fm=png`);\n      expect(resp.backgroundColor).toEqual(`#080808`);\n      expect(resp).toMatchSnapshot();\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"force format","suites":["gatsby-plugin-image","query arguments"],"updatePoint":{"line":126,"column":20,"index":4322},"line":126,"code":"    it(`force format`, async () => {\n      const resp = await extendedNodeType.gatsbyImageData.resolve(exampleImage,\n      // @ts-ignore\n      {\n        formats: [`jpg`, `webp`]\n      }, null, null);\n      expect(resp.images.sources[0].srcSet).toContain(`q=50`);\n      expect(resp.images.sources[0].srcSet).toContain(`fm=webp`);\n      expect(resp.images.fallback.srcSet).toContain(`q=50`);\n      expect(resp.images.fallback.srcSet).toContain(`fm=jpg`);\n      expect(resp).toMatchSnapshot();\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"custom width","suites":["gatsby-plugin-image","query arguments"],"updatePoint":{"line":138,"column":20,"index":4821},"line":138,"code":"    it(`custom width`, async () => {\n      const resp = await extendedNodeType.gatsbyImageData.resolve(exampleImage,\n      // @ts-ignore\n      {\n        width: 420\n      }, null, null);\n      expect(resp.images.sources[0].srcSet).toContain(`q=50`);\n      expect(resp.images.sources[0].srcSet).toContain(`fm=webp`);\n      expect(resp.images.sources[0].sizes).toContain(`(min-width: 420px) 420px`);\n      expect(resp.images.fallback.srcSet).toContain(`q=50`);\n      expect(resp.images.fallback.srcSet).toContain(`fm=png`);\n      expect(resp.images.fallback.sizes).toContain(`(min-width: 420px) 420px`);\n      expect(resp).toMatchSnapshot();\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"custom quality","suites":["gatsby-plugin-image","query arguments"],"updatePoint":{"line":152,"column":22,"index":5470},"line":152,"code":"    it(`custom quality`, async () => {\n      const resp = await extendedNodeType.gatsbyImageData.resolve(exampleImage,\n      // @ts-ignore\n      {\n        quality: 90\n      }, null, null);\n      expect(resp.images.sources[0].srcSet).toContain(`q=90`);\n      expect(resp.images.sources[0].srcSet).toContain(`fm=webp`);\n      expect(resp.images.fallback.srcSet).toContain(`q=90`);\n      expect(resp.images.fallback.srcSet).toContain(`fm=png`);\n      expect(resp).toMatchSnapshot();\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"layout fixed","suites":["gatsby-plugin-image","query arguments"],"updatePoint":{"line":164,"column":20,"index":5956},"line":164,"code":"    it(`layout fixed`, async () => {\n      const resp = await extendedNodeType.gatsbyImageData.resolve(exampleImage,\n      // @ts-ignore\n      {\n        layout: `fixed`\n      }, null, null);\n      expect(resp.images.sources[0].srcSet).not.toContain(`,`);\n      expect(resp.images.sources[0].sizes).not.toContain(`,`);\n      expect(resp.images.fallback.srcSet).not.toContain(`,`);\n      expect(resp.images.fallback.sizes).not.toContain(`,`);\n      expect(resp).toMatchSnapshot();\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"layout full width","suites":["gatsby-plugin-image","query arguments"],"updatePoint":{"line":176,"column":25,"index":6448},"line":176,"code":"    it(`layout full width`, async () => {\n      const resp = await extendedNodeType.gatsbyImageData.resolve(exampleImage,\n      // @ts-ignore\n      {\n        layout: `fullWidth`\n      }, null, null);\n      expect(resp.images.sources[0].srcSet).toContain(`,`);\n      expect(resp.images.sources[0].sizes).toEqual(`100vw`);\n      expect(resp.images.fallback.srcSet).toContain(`,`);\n      expect(resp.images.fallback.sizes).toEqual(`100vw`);\n      expect(resp).toMatchSnapshot();\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"placeholder blurred","suites":["gatsby-plugin-image","query arguments"],"updatePoint":{"line":188,"column":27,"index":6934},"line":188,"code":"    it(`placeholder blurred`, async () => {\n      const resp = await extendedNodeType.gatsbyImageData.resolve(exampleImage,\n      // @ts-ignore\n      {\n        placeholder: `blurred`\n      }, null, null);\n      expect(resp.backgroundColor).toEqual(undefined);\n      expect(resp.placeholder.fallback).toMatch(/^data:image\\/png;base64,.+/);\n      expect(resp).toMatchSnapshot();\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"placeholder traced svg (falls back to DOMINANT_COLOR)","suites":["gatsby-plugin-image","query arguments"],"updatePoint":{"line":198,"column":61,"index":7353},"line":198,"code":"    it(`placeholder traced svg (falls back to DOMINANT_COLOR)`, async () => {\n      const resp = await extendedNodeType.gatsbyImageData.resolve(exampleImage,\n      // @ts-ignore\n      {\n        placeholder: `tracedSVG`\n      }, null, null);\n      expect(resp.backgroundColor).toEqual(`#080808`);\n      expect(resp.placeholder).not.toBeDefined();\n      expect(resp).toMatchSnapshot();\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"custom quality","suites":["gatsby-plugin-image","defaults via gatsby-plugin-sharp"],"updatePoint":{"line":210,"column":22,"index":7767},"line":210,"code":"    it(`custom quality`, async () => {\n      setPluginOptions({\n        defaults: {\n          quality: 42\n        }\n      });\n      const resp = await extendedNodeType.gatsbyImageData.resolve(exampleImage,\n      // @ts-ignore\n      {}, null, null);\n      expect(resp.images.sources[0].srcSet).toContain(`q=42`);\n      expect(resp.images.fallback.srcSet).toContain(`q=42`);\n      expect(resp).toMatchSnapshot();\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"custom quality by format","suites":["gatsby-plugin-image","defaults via gatsby-plugin-sharp"],"updatePoint":{"line":223,"column":32,"index":8196},"line":223,"code":"    it(`custom quality by format`, async () => {\n      setPluginOptions({\n        defaults: {\n          pngOptions: {\n            quality: 60\n          },\n          webpOptions: {\n            quality: 42\n          }\n        }\n      });\n      const resp = await extendedNodeType.gatsbyImageData.resolve(exampleImage,\n      // @ts-ignore\n      {}, null, null);\n      expect(resp.images.sources[0].srcSet).toContain(`q=42`);\n      expect(resp.images.fallback.srcSet).toContain(`q=60`);\n      expect(resp).toMatchSnapshot();\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"custom placeholder tracedSVG (falls back to DOMINANT_COLOR)","suites":["gatsby-plugin-image","defaults via gatsby-plugin-sharp"],"updatePoint":{"line":241,"column":67,"index":8760},"line":241,"code":"    it(`custom placeholder tracedSVG (falls back to DOMINANT_COLOR)`, async () => {\n      setPluginOptions({\n        defaults: {\n          placeholder: `tracedSVG`,\n          tracedSVGOptions: {\n            color: `#663399`\n          }\n        }\n      });\n      const resp = await extendedNodeType.gatsbyImageData.resolve(exampleImage,\n      // @ts-ignore\n      {}, null, null);\n      expect(resp.backgroundColor).toEqual(`#080808`);\n      expect(resp.placeholder).not.toBeDefined();\n      expect(resp).toMatchSnapshot();\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"custom placeholder blurred","suites":["gatsby-plugin-image","defaults via gatsby-plugin-sharp"],"updatePoint":{"line":257,"column":34,"index":9257},"line":257,"code":"    it(`custom placeholder blurred`, async () => {\n      setPluginOptions({\n        defaults: {\n          placeholder: `blurred`,\n          blurredOptions: {\n            width: 16\n          }\n        }\n      });\n      const resp = await extendedNodeType.gatsbyImageData.resolve(exampleImage,\n      // @ts-ignore\n      {}, null, null);\n      expect(resp.placeholder.fallback).toMatch(/^data:image\\/png;base64,.+/);\n      expect(resp).toMatchSnapshot();\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"custom background color","suites":["gatsby-plugin-image","defaults via gatsby-plugin-sharp"],"updatePoint":{"line":272,"column":31,"index":9714},"line":272,"code":"    it(`custom background color`, async () => {\n      setPluginOptions({\n        defaults: {\n          placeholder: `none`,\n          backgroundColor: `#663399`\n        }\n      });\n      const resp = await extendedNodeType.gatsbyImageData.resolve(exampleImage,\n      // @ts-ignore\n      {}, null, null);\n      expect(resp.backgroundColor).toEqual(`#663399`);\n      expect(resp).toMatchSnapshot();\n    });","file":"gatsby-plugin-image.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"constrained: width and aspectRatio","suites":["useContentfulImage"],"updatePoint":{"line":16,"column":42,"index":435},"line":16,"code":"  test(`constrained: width and aspectRatio`, () => {\n    const result = useContentfulImage({\n      image,\n      width: 600,\n      aspectRatio: 1.778\n    });\n    const desiredHeight = Math.floor(600 / 1.778);\n    expect(result.layout).toBe(`constrained`);\n    expect(result.height).toBe(desiredHeight);\n    expect(result.width).toBe(600);\n    expect(result.images.fallback.src).toContain(`h=${desiredHeight}`);\n    expect(result).toMatchSnapshot();\n    expect(consoleWarnSpy).toHaveBeenCalledTimes(0);\n  });","file":"hooks.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"constrained: width and height","suites":["useContentfulImage"],"updatePoint":{"line":30,"column":37,"index":937},"line":30,"code":"  test(`constrained: width and height`, () => {\n    const result = useContentfulImage({\n      image,\n      width: 600,\n      height: 480\n    });\n    expect(result.layout).toBe(`constrained`);\n    expect(result.height).toBe(480);\n    expect(result.width).toBe(600);\n    expect(result.images.fallback.src).toContain(`h=480`);\n    expect(result.images.fallback.src).toContain(`w=600`);\n    expect(result.images.fallback.srcSet.split(`,`)).toHaveLength(3);\n    expect(result).toMatchSnapshot();\n    expect(consoleWarnSpy).toHaveBeenCalledTimes(0);\n  });","file":"hooks.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"fixed: width and height","suites":["useContentfulImage"],"updatePoint":{"line":45,"column":31,"index":1481},"line":45,"code":"  test(`fixed: width and height`, () => {\n    const result = useContentfulImage({\n      layout: `fixed`,\n      image,\n      width: 600,\n      height: 480\n    });\n    expect(result.layout).toBe(`fixed`);\n    expect(result.height).toBe(480);\n    expect(result.width).toBe(600);\n    expect(result.images.fallback.sizes).toContain(`600px`);\n    expect(result.images.fallback.src).toContain(`h=480`);\n    expect(result.images.fallback.src).toContain(`w=600`);\n    expect(result.images.fallback.srcSet.split(`,`)).toHaveLength(1);\n    expect(result).toMatchSnapshot();\n    expect(consoleWarnSpy).toHaveBeenCalledTimes(0);\n  });","file":"hooks.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"fullWidth: aspect ratio","suites":["useContentfulImage"],"updatePoint":{"line":62,"column":31,"index":2103},"line":62,"code":"  test(`fullWidth: aspect ratio`, () => {\n    const result = useContentfulImage({\n      image,\n      layout: `fullWidth`,\n      aspectRatio: 1.778\n    });\n    expect(result.layout).toBe(`fullWidth`);\n    expect(result.height).toBe(0.5625);\n    expect(result.width).toBe(1);\n    expect(result.images.fallback.sizes).toBe(`100vw`);\n    expect(result.images.fallback.src).toContain(`h=2304`);\n    expect(result.images.fallback.src).toContain(`w=4096`);\n    expect(result.images.fallback.srcSet.split(`,`)).toHaveLength(12);\n    expect(result).toMatchSnapshot();\n  });","file":"hooks.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"fullWidth: aspectRatio, maxWidth","suites":["useContentfulImage"],"updatePoint":{"line":77,"column":40,"index":2677},"line":77,"code":"  test(`fullWidth: aspectRatio, maxWidth`, () => {\n    const result = useContentfulImage({\n      image,\n      layout: `fullWidth`,\n      aspectRatio: 1.778,\n      maxWidth: 1280\n    });\n    expect(result.layout).toBe(`fullWidth`);\n    expect(result.height).toBe(0.5625);\n    expect(result.width).toBe(1);\n    expect(result.images.fallback.sizes).toBe(`100vw`);\n    expect(result.images.fallback.src).toContain(`h=2304`);\n    expect(result.images.fallback.src).toContain(`w=4096`);\n    expect(result.images.fallback.srcSet.split(`,`)).toHaveLength(12);\n    expect(result).toMatchSnapshot();\n  });","file":"hooks.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"fullWidth: width, height & maxWidth","suites":["useContentfulImage"],"updatePoint":{"line":93,"column":43,"index":3276},"line":93,"code":"  test(`fullWidth: width, height & maxWidth`, () => {\n    const result = useContentfulImage({\n      image,\n      layout: `fullWidth`,\n      width: 800,\n      height: 600,\n      maxWidth: 1280\n    });\n    expect(result.layout).toBe(`fullWidth`);\n    expect(result.height).toBe(0.75);\n    expect(result.width).toBe(1);\n    expect(result.images.fallback.sizes).toBe(`100vw`);\n    expect(result.images.fallback.src).toContain(`h=600`);\n    expect(result.images.fallback.src).toContain(`w=800`);\n    expect(result.images.fallback.srcSet.split(`,`)).toHaveLength(4);\n    expect(result).toMatchSnapshot();\n  });","file":"hooks.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"allows you to create URls","suites":["Contentful Image API helpers","createUrl"],"updatePoint":{"line":7,"column":33,"index":229},"line":7,"code":"    it(`allows you to create URls`, () => {\n      expect(createUrl(`//images.contentful.com/dsf/bl.jpg`, {\n        width: 100\n      })).toMatchInlineSnapshot(`\"https://images.contentful.com/dsf/bl.jpg?w=100\"`);\n    });","file":"image-helpers.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"ignores options it doesn't understand","suites":["Contentful Image API helpers","createUrl"],"updatePoint":{"line":12,"column":45,"index":460},"line":12,"code":"    it(`ignores options it doesn't understand`, () => {\n      expect(createUrl(`//images.contentful.com/dsf/bl.jpg`, {\n        happiness: 100\n      })).toMatchInlineSnapshot(`\"https://images.contentful.com/dsf/bl.jpg?\"`);\n    });","file":"image-helpers.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"builds entry list","suites":["generic"],"updatePoint":{"line":31,"column":23,"index":1103},"line":31,"code":"  it(`builds entry list`, () => {\n    const entryList = buildEntryList({\n      currentSyncData,\n      contentTypeItems\n    });\n    expect(entryList).toHaveLength(contentTypeItems.length);\n    expect(entryList[0][0].sys.contentType.sys.id).toBe(`6XwpTaSiiI2Ak2Ww0oi6qa`);\n    expect(entryList[0]).toHaveLength(2);\n    expect(entryList[1][0].sys.contentType.sys.id).toBe(`sFzTZbSuM8coEwygeUYes`);\n    expect(entryList[1]).toHaveLength(3);\n    expect(entryList[2][0].sys.contentType.sys.id).toBe(`2PqfXUJwE8qSYKuM0U6w8M`);\n    expect(entryList[2]).toHaveLength(4);\n    expect(entryList[3][0].sys.contentType.sys.id).toBe(`jsonTest`);\n    expect(entryList[3]).toHaveLength(1);\n    expect(entryList[4][0].sys.contentType.sys.id).toBe(`remarkTest`);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"builds list of resolvable data","suites":["generic"],"updatePoint":{"line":47,"column":36,"index":1866},"line":47,"code":"  it(`builds list of resolvable data`, () => {\n    const entryList = buildEntryList({\n      currentSyncData,\n      contentTypeItems\n    });\n    const resolvable = buildResolvableSet({\n      assets: currentSyncData.assets,\n      entryList\n    });\n    const allNodes = [...currentSyncData.entries, ...currentSyncData.assets];\n    allNodes.forEach(node => expect(resolvable).toContain(`${node.sys.id}___${node.sys.type}`));\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"builds foreignReferenceMap","suites":["generic"],"updatePoint":{"line":59,"column":32,"index":2289},"line":59,"code":"  it(`builds foreignReferenceMap`, () => {\n    const entryList = buildEntryList({\n      currentSyncData,\n      contentTypeItems\n    });\n    const resolvable = buildResolvableSet({\n      assets: currentSyncData.assets,\n      entryList\n    });\n    const foreignReferenceMapState = buildForeignReferenceMap({\n      contentTypeItems,\n      entryList,\n      resolvable,\n      defaultLocale,\n      space,\n      useNameForId: true,\n      previousForeignReferenceMapState: undefined,\n      deletedEntries: []\n    });\n    const referenceKeys = Object.keys(foreignReferenceMapState.backLinks);\n    const expectedReferenceKeys = [`2Y8LhXLnYAYqKCGEWG4EKI___Asset`, `3wtvPBbBjiMKqKKga8I2Cu___Asset`, `4LgMotpNF6W20YKmuemW0a___Entry`, `4zj1ZOfHgQ8oqgaSKm4Qo2___Asset`, `6m5AJ9vMPKc8OUoQeoCS4o___Asset`, `6t4HKjytPi0mYgs240wkG___Asset`, `7LAnCobuuWYSqks6wAwY2a___Entry`, `10TkaLheGeQG6qQGqWYqUI___Asset`, `24DPGBDeGEaYy8ms4Y8QMQ___Entry`, `651CQ8rLoIYCeY6G0QG22q___Entry`, `JrePkDVYomE8AwcuCUyMi___Entry`, `KTRF62Q4gg60q6WCsWKw8___Asset`, `wtrHxeu3zEoEce2MokCSi___Asset`, `Xc0ny7GWsMEMCeASWO2um___Asset`];\n    expect(referenceKeys).toHaveLength(expectedReferenceKeys.length);\n    expect(referenceKeys).toEqual(expect.arrayContaining(expectedReferenceKeys));\n    Object.keys(foreignReferenceMapState.backLinks).forEach(referenceId => {\n      expect(resolvable).toContain(referenceId);\n      let expectedLength = 1;\n      if (referenceId === `651CQ8rLoIYCeY6G0QG22q___Entry`) {\n        expectedLength = 2;\n      }\n      if (referenceId === `7LAnCobuuWYSqks6wAwY2a___Entry`) {\n        expectedLength = 3;\n      }\n      expect(foreignReferenceMapState.backLinks[referenceId]).toHaveLength(expectedLength);\n    });\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"builds foreignReferenceMap","suites":["Process contentful data (by name)"],"updatePoint":{"line":96,"column":32,"index":4048},"line":96,"code":"  it(`builds foreignReferenceMap`, () => {\n    const entryList = buildEntryList({\n      currentSyncData,\n      contentTypeItems\n    });\n    const resolvable = buildResolvableSet({\n      assets: currentSyncData.assets,\n      entryList\n    });\n    const foreignReferenceMapState = buildForeignReferenceMap({\n      contentTypeItems,\n      entryList,\n      resolvable,\n      defaultLocale,\n      space,\n      useNameForId: true,\n      previousForeignReferenceMapState: undefined,\n      deletedEntries: []\n    });\n    expect(foreignReferenceMapState.backLinks[`24DPGBDeGEaYy8ms4Y8QMQ___Entry`][0].name).toBe(`product___NODE`);\n    expect(foreignReferenceMapState.backLinks[`2Y8LhXLnYAYqKCGEWG4EKI___Asset`][0].name).toBe(`brand___NODE`);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"creates nodes for each entry","suites":["Process contentful data (by name)"],"updatePoint":{"line":118,"column":34,"index":4789},"line":118,"code":"  it(`creates nodes for each entry`, () => {\n    const entryList = buildEntryList({\n      currentSyncData,\n      contentTypeItems\n    });\n    const resolvable = buildResolvableSet({\n      assets: currentSyncData.assets,\n      entryList\n    });\n    const foreignReferenceMap = buildForeignReferenceMap({\n      contentTypeItems,\n      entryList,\n      resolvable,\n      defaultLocale,\n      space,\n      useNameForId: true,\n      previousForeignReferenceMapState: undefined,\n      deletedEntries: []\n    });\n    const createNode = jest.fn();\n    const createNodeId = jest.fn(id => id);\n    const getNode = jest.fn(() => undefined); // All nodes are new\n    contentTypeItems.forEach((contentTypeItem, i) => {\n      createNodesForContentType({\n        contentTypeItem,\n        restrictedNodeFields,\n        conflictFieldPrefix,\n        entries: entryList[i],\n        createNode,\n        createNodeId,\n        getNode,\n        resolvable,\n        foreignReferenceMap,\n        defaultLocale,\n        locales,\n        space,\n        useNameForId: true,\n        pluginConfig,\n        unstable_createNodeManifest\n      });\n    });\n    const nodeTypeCounts = countCreatedNodeTypesFromMock(createNode.mock);\n    expect(Object.keys(nodeTypeCounts)).toHaveLength(15);\n    expect(nodeTypeCounts).toEqual(expect.objectContaining({\n      // 3 Brand Contentful entries\n      ContentfulBrand: 6,\n      contentfulBrandCompanyDescriptionTextNode: 6,\n      contentfulBrandCompanyNameTextNode: 6,\n      // 2 Category Contentful entries\n      ContentfulCategory: 4,\n      contentfulCategoryCategoryDescriptionTextNode: 4,\n      contentfulCategoryTitleTextNode: 4,\n      ContentfulContentType: contentTypeItems.length,\n      // 1 JSON Test Contentful entry\n      ContentfulJsonTest: 2,\n      contentfulJsonTestJsonStringTestJsonNode: 2,\n      contentfulJsonTestJsonTestJsonNode: 2,\n      // 4 Product Contentful entries\n      ContentfulProduct: 8,\n      contentfulProductProductDescriptionTextNode: 8,\n      contentfulProductProductNameTextNode: 8,\n      // 1 Remark Test Contentful entry\n      ContentfulRemarkTest: 2,\n      contentfulRemarkTestContentTextNode: 2\n    }));\n\n    // Relevant to compare to compare warm and cold situation\n    expect(createNode.mock.calls.length).toBe(69); // \"cold build entries\" count\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"creates nodes for each asset","suites":["Process contentful data (by name)"],"updatePoint":{"line":188,"column":34,"index":7090},"line":188,"code":"  it(`creates nodes for each asset`, () => {\n    const createNode = jest.fn(() => Promise.resolve());\n    const createNodeId = jest.fn(id => id);\n    const assets = currentSyncData.assets;\n    assets.forEach(assetItem => {\n      createAssetNodes({\n        assetItem,\n        createNode,\n        createNodeId,\n        defaultLocale,\n        locales,\n        space,\n        pluginConfig\n      });\n    });\n    const nodeTypeCounts = countCreatedNodeTypesFromMock(createNode.mock);\n    expect(Object.keys(nodeTypeCounts)).toHaveLength(1);\n    expect(nodeTypeCounts).toHaveProperty(`ContentfulAsset`);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"creates nodes for each entry","suites":["Process existing mutated nodes in warm build"],"updatePoint":{"line":209,"column":34,"index":7762},"line":209,"code":"  it(`creates nodes for each entry`, () => {\n    const entryList = buildEntryList({\n      currentSyncData,\n      contentTypeItems\n    });\n    const resolvable = buildResolvableSet({\n      assets: currentSyncData.assets,\n      entryList\n    });\n    const foreignReferenceMap = buildForeignReferenceMap({\n      contentTypeItems,\n      entryList,\n      resolvable,\n      defaultLocale,\n      space,\n      useNameForId: true,\n      previousForeignReferenceMapState: undefined,\n      deletedEntries: []\n    });\n    const createNode = jest.fn();\n    const createNodeId = jest.fn(id => id);\n    let doReturn = true;\n    const getNode = jest.fn(id => {\n      if (doReturn) {\n        doReturn = false;\n        // Note: the relevant part for this test is that the same digest is returned\n        // so it skips generating the node and any of its children. Actual shape of\n        // returned is not relevant to test so update if anything breaks.\n        return {\n          id,\n          internal: {\n            contentDigest: entryList[0][0].sys.updatedAt + `changed`\n          }\n        };\n      }\n      // All other nodes are new (\"unknown\")\n      return undefined;\n    });\n    contentTypeItems.forEach((contentTypeItem, i) => {\n      createNodesForContentType({\n        contentTypeItem,\n        restrictedNodeFields,\n        conflictFieldPrefix,\n        entries: entryList[i],\n        createNode,\n        createNodeId,\n        getNode,\n        resolvable,\n        foreignReferenceMap,\n        defaultLocale,\n        locales,\n        space,\n        useNameForId: true,\n        pluginConfig,\n        unstable_createNodeManifest\n      });\n    });\n    const nodeTypeCounts = countCreatedNodeTypesFromMock(createNode.mock);\n    expect(Object.keys(nodeTypeCounts)).toHaveLength(15);\n    expect(nodeTypeCounts).toEqual(expect.objectContaining({\n      // 3 Brand Contentful entries\n      ContentfulBrand: 6,\n      contentfulBrandCompanyDescriptionTextNode: 6,\n      contentfulBrandCompanyNameTextNode: 6,\n      // 2 Category Contentful entries\n      ContentfulCategory: 4,\n      contentfulCategoryCategoryDescriptionTextNode: 4,\n      contentfulCategoryTitleTextNode: 4,\n      ContentfulContentType: contentTypeItems.length,\n      // 1 JSON Test Contentful entry\n      ContentfulJsonTest: 2,\n      contentfulJsonTestJsonStringTestJsonNode: 2,\n      contentfulJsonTestJsonTestJsonNode: 2,\n      // 4 Product Contentful entries\n      ContentfulProduct: 8,\n      contentfulProductProductDescriptionTextNode: 8,\n      contentfulProductProductNameTextNode: 8,\n      // 1 Remark Test Contentful entry\n      ContentfulRemarkTest: 2,\n      contentfulRemarkTestContentTextNode: 2\n    }));\n\n    // Relevant to compare to compare warm and cold situation\n    // This number ought to be the same as the cold build\n    expect(createNode.mock.calls.length).toBe(69); // \"warm build where entry was changed\" count\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"builds foreignReferenceMap","suites":["Process contentful data (by id)"],"updatePoint":{"line":298,"column":32,"index":10706},"line":298,"code":"  it(`builds foreignReferenceMap`, () => {\n    const entryList = buildEntryList({\n      currentSyncData,\n      contentTypeItems\n    });\n    const resolvable = buildResolvableSet({\n      assets: currentSyncData.assets,\n      entryList\n    });\n    const foreignReferenceMapState = buildForeignReferenceMap({\n      contentTypeItems,\n      entryList,\n      resolvable,\n      defaultLocale,\n      space,\n      useNameForId: false,\n      previousForeignReferenceMapState: undefined,\n      deletedEntries: []\n    });\n    expect(foreignReferenceMapState.backLinks[`24DPGBDeGEaYy8ms4Y8QMQ___Entry`][0].name).toBe(`2pqfxujwe8qsykum0u6w8m___NODE`);\n    expect(foreignReferenceMapState.backLinks[`2Y8LhXLnYAYqKCGEWG4EKI___Asset`][0].name).toBe(`sfztzbsum8coewygeuyes___NODE`);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"creates nodes for each entry","suites":["Process contentful data (by id)"],"updatePoint":{"line":320,"column":34,"index":11479},"line":320,"code":"  it(`creates nodes for each entry`, () => {\n    const entryList = buildEntryList({\n      currentSyncData,\n      contentTypeItems\n    });\n    const resolvable = buildResolvableSet({\n      assets: currentSyncData.assets,\n      entryList\n    });\n    const foreignReferenceMap = buildForeignReferenceMap({\n      contentTypeItems,\n      entryList,\n      resolvable,\n      defaultLocale,\n      space,\n      useNameForId: false,\n      previousForeignReferenceMapState: undefined,\n      deletedEntries: []\n    });\n    const createNode = jest.fn();\n    const createNodeId = jest.fn(id => id);\n    const getNode = jest.fn(() => undefined); // All nodes are new\n    contentTypeItems.forEach((contentTypeItem, i) => {\n      createNodesForContentType({\n        contentTypeItem,\n        restrictedNodeFields,\n        conflictFieldPrefix,\n        entries: entryList[i],\n        createNode,\n        createNodeId,\n        getNode,\n        resolvable,\n        foreignReferenceMap,\n        defaultLocale,\n        locales,\n        space,\n        useNameForId: false,\n        pluginConfig,\n        unstable_createNodeManifest\n      });\n    });\n    const nodeTypeCounts = countCreatedNodeTypesFromMock(createNode.mock);\n    expect(Object.keys(nodeTypeCounts)).toHaveLength(15);\n    expect(nodeTypeCounts).toEqual(expect.objectContaining({\n      // 3 Brand Contentful entries\n      ContentfulSFzTZbSuM8CoEwygeUYes: 6,\n      contentfulSFzTZbSuM8CoEwygeUYesCompanyDescriptionTextNode: 6,\n      contentfulSFzTZbSuM8CoEwygeUYesCompanyNameTextNode: 6,\n      // 2 Category Contentful entries\n      Contentful6XwpTaSiiI2Ak2Ww0Oi6Qa: 4,\n      contentful6XwpTaSiiI2Ak2Ww0Oi6QaCategoryDescriptionTextNode: 4,\n      contentful6XwpTaSiiI2Ak2Ww0Oi6QaTitleTextNode: 4,\n      ContentfulContentType: contentTypeItems.length,\n      // 1 JSON Test Contentful entry\n      ContentfulJsonTest: 2,\n      contentfulJsonTestJsonStringTestJsonNode: 2,\n      contentfulJsonTestJsonTestJsonNode: 2,\n      // 4 Product Contentful entries\n      Contentful2PqfXuJwE8QSyKuM0U6W8M: 8,\n      contentful2PqfXuJwE8QSyKuM0U6W8MProductDescriptionTextNode: 8,\n      contentful2PqfXuJwE8QSyKuM0U6W8MProductNameTextNode: 8,\n      // 1 Remark Test Contentful entry\n      ContentfulRemarkTest: 2,\n      contentfulRemarkTestContentTextNode: 2\n    }));\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"Gets the specified locale","suites":["Gets field value based on current locale"],"updatePoint":{"line":402,"column":31,"index":14171},"line":402,"code":"  it(`Gets the specified locale`, () => {\n    expect(getLocalizedField({\n      field,\n      localesFallback,\n      locale: {\n        code: `en-US`\n      }\n    })).toBe(field[`en-US`]);\n    expect(getLocalizedField({\n      field,\n      localesFallback,\n      locale: {\n        code: `de`\n      }\n    })).toBe(field[`de`]);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"Gets the specified locale if the field is falsey","suites":["Gets field value based on current locale"],"updatePoint":{"line":418,"column":54,"index":14522},"line":418,"code":"  it(`Gets the specified locale if the field is falsey`, () => {\n    const falseyField = {\n      de: 0,\n      \"en-US\": false\n    };\n    expect(getLocalizedField({\n      field: falseyField,\n      localesFallback,\n      locale: {\n        code: `en-US`\n      }\n    })).toBe(falseyField[`en-US`]);\n    expect(getLocalizedField({\n      field: falseyField,\n      localesFallback,\n      locale: {\n        code: `de`\n      }\n    })).toBe(falseyField[`de`]);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"falls back to the locale's fallback locale if passed a locale that doesn't have a localized field","suites":["Gets field value based on current locale"],"updatePoint":{"line":438,"column":103,"index":15027},"line":438,"code":"  it(`falls back to the locale's fallback locale if passed a locale that doesn't have a localized field`, () => {\n    expect(getLocalizedField({\n      field,\n      localesFallback,\n      locale: {\n        code: `gsw_CH`\n      }\n    })).toBe(field[`de`]);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"returns null if passed a locale that doesn't have a field on a localized field","suites":["Gets field value based on current locale"],"updatePoint":{"line":447,"column":84,"index":15269},"line":447,"code":"  it(`returns null if passed a locale that doesn't have a field on a localized field`, () => {\n    expect(getLocalizedField({\n      field,\n      localesFallback: {\n        \"es-ES\": null,\n        de: null\n      },\n      locale: {\n        code: `es-US`\n      }\n    })).toEqual(null);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"returns null if passed a locale that doesn't have a field nor a fallbackCode","suites":["Gets field value based on current locale"],"updatePoint":{"line":459,"column":82,"index":15555},"line":459,"code":"  it(`returns null if passed a locale that doesn't have a field nor a fallbackCode`, () => {\n    expect(getLocalizedField({\n      field,\n      localesFallback,\n      locale: {\n        code: `es-US`\n      }\n    })).toEqual(null);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"It doesn't postfix the spaceId and the id if its the default locale","suites":["Make IDs"],"updatePoint":{"line":470,"column":73,"index":15814},"line":470,"code":"  it(`It doesn't postfix the spaceId and the id if its the default locale`, () => {\n    expect(makeId({\n      spaceId: `spaceId`,\n      id: `id`,\n      type: `type`,\n      defaultLocale: `en-US`,\n      currentLocale: `en-US`\n    })).toBe(`spaceId___id___type`);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"It does postfix the spaceId and the id if its not the default locale","suites":["Make IDs"],"updatePoint":{"line":479,"column":74,"index":16083},"line":479,"code":"  it(`It does postfix the spaceId and the id if its not the default locale`, () => {\n    expect(makeId({\n      spaceId: `spaceId`,\n      id: `id`,\n      type: `type`,\n      defaultLocale: `en-US`,\n      currentLocale: `en-GB`\n    })).toBe(`spaceId___id___type___en-GB`);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"%s","suites":["Mask text"],"line":8,"code":"  it.each([[`handles very short inputs`, `a`, `*`], [`handles short inputs`, `abcd`, `***d`], [`handles long inputs`, `abcdefghijklmnopqrstuvwxyz`, `**********************wxyz`]])(`%s`, (_, input, expectedResult) => {\n    const result = maskText(input);\n\n    // explicit check for result\n    expect(result).toEqual(expectedResult);\n\n    // has same string length\n    expect(result.length).toEqual(input.length);\n    // hides 75% or more of input\n    expect(maskedCharacterCount(result)).toBeGreaterThanOrEqual(input.length * 0.75);\n    // show at max 4 characters\n    expect(result.length - maskedCharacterCount(result)).toBeLessThanOrEqual(4);\n  });","file":"plugin-options.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"kitchen sink","suites":["Formatting plugin options for CLI"],"updatePoint":{"line":23,"column":18,"index":1004},"line":23,"code":"  it(`kitchen sink`, () => {\n    const options = {\n      accessToken: `abcdefghijklmnopqrstuvwxyz`,\n      spaceId: `abcdefgh`,\n      host: `wat`,\n      localeFilter: locale => locale.code === `de`\n    };\n    const annotations = {\n      spaceId: `foo`,\n      environment: `bar`\n    };\n    const result = formatPluginOptionsForCLI(options, annotations);\n    const lines = result.split(`\\n`);\n\n    // doesn't leak secrets when listing plugin options\n    expect(result).toContain(`accessToken`);\n    expect(result).not.toContain(options.accessToken);\n    expect(result).toContain(`spaceId`);\n    expect(result).not.toContain(options.spaceId);\n\n    // mark if default value is used\n    expect(lines.find(line => line.includes(`downloadLocal`))).toContain(`default value`);\n    expect(lines.find(line => line.includes(`useNameForId`))).toContain(`default value`);\n    expect(lines.find(line => line.includes(`environment`))).toContain(`default value`);\n\n    // annotations are added\n    expect(lines.find(line => line.includes(`spaceId`))).toContain(annotations.spaceId);\n    expect(lines.find(line => line.includes(`environment`))).toContain(annotations.environment);\n  });","file":"plugin-options.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"renders with default options","suites":["rich text"],"updatePoint":{"line":333,"column":36,"index":6334},"line":333,"code":"  test(`renders with default options`, () => {\n    const {\n      container\n    } = render( /*#__PURE__*/React.createElement(React.Fragment, null, renderRichText({\n      raw: cloneDeep(raw),\n      references: cloneDeep(references)\n    })));\n    expect(container).toMatchSnapshot();\n  });","file":"rich-text.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"renders with custom options","suites":["rich text"],"updatePoint":{"line":342,"column":35,"index":6620},"line":342,"code":"  test(`renders with custom options`, () => {\n    const options = {\n      renderNode: {\n        [INLINES.EMBEDDED_ENTRY]: node => {\n          if (!node.data.target) {\n            return /*#__PURE__*/React.createElement(\"span\", null, \"Unresolved INLINE ENTRY: \", JSON.stringify(node, null, 2));\n          }\n          return /*#__PURE__*/React.createElement(\"span\", null, \"Resolved inline Entry (\", node.data.target.contentful_id, \")\");\n        },\n        [INLINES.ENTRY_HYPERLINK]: node => {\n          if (!node.data.target) {\n            return /*#__PURE__*/React.createElement(\"span\", null, \"Unresolved ENTRY HYPERLINK: \", JSON.stringify(node, null, 2));\n          }\n          return /*#__PURE__*/React.createElement(\"span\", null, \"Resolved entry Hyperlink (\", node.data.target.contentful_id, \")\");\n        },\n        [INLINES.ASSET_HYPERLINK]: node => {\n          if (!node.data.target) {\n            return /*#__PURE__*/React.createElement(\"span\", null, \"Unresolved ASSET HYPERLINK: \", JSON.stringify(node, null, 2));\n          }\n          return /*#__PURE__*/React.createElement(\"span\", null, \"Resolved asset Hyperlink (\", node.data.target.contentful_id, \")\");\n        },\n        [BLOCKS.EMBEDDED_ENTRY]: node => {\n          if (!node.data.target) {\n            return /*#__PURE__*/React.createElement(\"div\", null, \"Unresolved ENTRY !!!!\\\": \", JSON.stringify(node, null, 2));\n          }\n          return /*#__PURE__*/React.createElement(\"h2\", null, \"Resolved embedded Entry: \", node.data.target.title[`en-US`], \" (\", node.data.target.contentful_id, \")\");\n        },\n        [BLOCKS.EMBEDDED_ASSET]: node => {\n          if (!node.data.target) {\n            return /*#__PURE__*/React.createElement(\"div\", null, \"Unresolved ASSET !!!!\\\": \", JSON.stringify(node, null, 2));\n          }\n          return /*#__PURE__*/React.createElement(\"h2\", null, \"Resolved embedded Asset: \", node.data.target.title[`en-US`], \" (\", node.data.target.contentful_id, \")\");\n        }\n      }\n    };\n    const {\n      container\n    } = render( /*#__PURE__*/React.createElement(React.Fragment, null, renderRichText({\n      raw: cloneDeep(raw),\n      references: cloneDeep(references)\n    }, options)));\n    expect(container).toMatchSnapshot();\n  });","file":"rich-text.js","skipped":false,"dir":"packages/gatsby-source-contentful/src/__tests__"},{"name":"Generates nodes","suites":["gatsby-source-drupal"],"updatePoint":{"line":113,"column":21,"index":2659},"line":113,"code":"  it(`Generates nodes`, () => {\n    expect(Object.keys(nodes).length).not.toEqual(0);\n    expect(nodes[createNodeId(`und.file-1`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.file-2`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.tag-1`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.tag-2`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.article-1`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.article-2`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.article-3`)]).toBeDefined();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Nodes contain contentDigest","suites":["gatsby-source-drupal"],"updatePoint":{"line":123,"column":33,"index":3197},"line":123,"code":"  it(`Nodes contain contentDigest`, () => {\n    expect(nodes[createNodeId(`und.file-1`)]).toEqual(objectContaining({\n      internal: objectContaining({\n        contentDigest: `contentDigest`\n      })\n    }));\n    expect(nodes[createNodeId(`und.article-2`)]).toEqual(objectContaining({\n      internal: objectContaining({\n        contentDigest: `contentDigest`\n      })\n    }));\n    expect(nodes[createNodeId(`und.tag-1`)]).toEqual(objectContaining({\n      internal: objectContaining({\n        contentDigest: `contentDigest`\n      })\n    }));\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Nodes contain attributes data","suites":["gatsby-source-drupal"],"updatePoint":{"line":140,"column":35,"index":3746},"line":140,"code":"  it(`Nodes contain attributes data`, () => {\n    expect(nodes[createNodeId(`und.file-1`)].filename).toEqual(`main-image.png`);\n    expect(nodes[createNodeId(`und.article-2`)].title).toEqual(`Article #2`);\n    expect(nodes[createNodeId(`und.tag-1`)].langcode).toEqual(`en`);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Preserves attributes.id","suites":["gatsby-source-drupal"],"updatePoint":{"line":145,"column":29,"index":4021},"line":145,"code":"  it(`Preserves attributes.id`, () => {\n    expect(nodes[createNodeId(`und.article-2`)]._attributes_id).toEqual(22);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Handles 1:1 relationship","suites":["gatsby-source-drupal"],"updatePoint":{"line":148,"column":30,"index":4145},"line":148,"code":"  it(`Handles 1:1 relationship`, () => {\n    expect(nodes[createNodeId(`und.article-1`)].relationships.field_main_image___NODE).not.toBeDefined();\n    expect(nodes[createNodeId(`und.article-2`)].relationships.field_main_image___NODE).toEqual(createNodeId(`und.file-1`));\n    expect(nodes[createNodeId(`und.article-3`)].relationships.field_main_image___NODE).toEqual(createNodeId(`und.file-1`));\n    expect(nodes[createNodeId(`und.paragraph-image-1`)].relationships).toEqual({\n      field_gallery___NODE: createNodeId(`und.article-2`)\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Handles 1:N relationship","suites":["gatsby-source-drupal"],"updatePoint":{"line":156,"column":30,"index":4693},"line":156,"code":"  it(`Handles 1:N relationship`, () => {\n    expect(nodes[createNodeId(`und.article-1`)].relationships.field_tags___NODE).toEqual(expect.arrayContaining([createNodeId(`und.tag-1`), createNodeId(`und.tag-2`)]));\n    expect(nodes[createNodeId(`und.article-2`)].relationships.field_tags___NODE).not.toBeDefined();\n    expect(nodes[createNodeId(`und.article-3`)].relationships.field_tags___NODE).toEqual(expect.arrayContaining([createNodeId(`und.tag-1`)]));\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Creates back references","suites":["gatsby-source-drupal"],"updatePoint":{"line":161,"column":29,"index":5152},"line":161,"code":"  it(`Creates back references`, () => {\n    expect(nodes[createNodeId(`und.file-1`)].relationships[`node__article___NODE`]).toEqual(expect.arrayContaining([createNodeId(`und.article-2`), createNodeId(`und.article-3`)]));\n    expect(nodes[createNodeId(`und.tag-1`)].relationships[`node__article___NODE`]).toEqual(expect.arrayContaining([createNodeId(`und.article-1`), createNodeId(`und.article-3`)]));\n    expect(nodes[createNodeId(`und.tag-2`)].relationships[`node__article___NODE`]).toEqual(expect.arrayContaining([createNodeId(`und.article-1`)]));\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Download files without Basic Auth","suites":["gatsby-source-drupal"],"updatePoint":{"line":166,"column":39,"index":5718},"line":166,"code":"  it(`Download files without Basic Auth`, () => {\n    const urls = [`/sites/default/files/main-image.png`, `/sites/default/files/secondary-image.png`, `https://files.s3.eu-central-1.amazonaws.com/2020-05/third-image.png`, `/sites/default/files/forth-image.png`].map(fileUrl => new URL(fileUrl, baseUrl).href);\n    urls.forEach(url => {\n      expect(createRemoteFileNode).toBeCalledWith(expect.objectContaining({\n        url,\n        auth: {}\n      }));\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Download files with Basic Auth","suites":["gatsby-source-drupal"],"updatePoint":{"line":175,"column":36,"index":6182},"line":175,"code":"  it(`Download files with Basic Auth`, async () => {\n    const basicAuth = {\n      username: `user`,\n      password: `password`\n    };\n    await sourceNodes(args, {\n      baseUrl,\n      basicAuth\n    });\n    const urls = [`http://fixture/sites/default/files/main-image.png`, `http://fixture/sites/default/files/secondary-image.png`, `https://files.s3.eu-central-1.amazonaws.com/2020-05/third-image.png`, `/sites/default/files/forth-image.png`].map(fileUrl => new URL(fileUrl, baseUrl).href);\n    // first call without basicAuth (no fileSystem defined)\n    // (the first call is actually the 5th because sourceNodes was ran at first with no basicAuth)\n    expect(createRemoteFileNode).toHaveBeenNthCalledWith(6, expect.objectContaining({\n      url: urls[0],\n      auth: {}\n    }));\n    // 2nd call with basicAuth (public: fileSystem defined)\n    expect(createRemoteFileNode).toHaveBeenNthCalledWith(7, expect.objectContaining({\n      url: urls[1],\n      auth: {\n        htaccess_pass: `password`,\n        htaccess_user: `user`\n      }\n    }));\n    // 3rd call without basicAuth (s3: fileSystem defined)\n    expect(createRemoteFileNode).toHaveBeenNthCalledWith(8, expect.objectContaining({\n      url: urls[2],\n      auth: {}\n    }));\n    // 4th call with basicAuth (private: fileSystem defined)\n    expect(createRemoteFileNode).toHaveBeenNthCalledWith(9, expect.objectContaining({\n      url: urls[3],\n      auth: {\n        htaccess_pass: `password`,\n        htaccess_user: `user`\n      }\n    }));\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Skips File Downloads on initial build","suites":["gatsby-source-drupal"],"updatePoint":{"line":213,"column":43,"index":7690},"line":213,"code":"  it(`Skips File Downloads on initial build`, async () => {\n    const skipFileDownloads = true;\n    expect(createRemoteFileNode).toBeCalledTimes(10);\n    await sourceNodes(args, {\n      baseUrl,\n      skipFileDownloads\n    });\n    expect(createRemoteFileNode).toBeCalledTimes(10);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Skips File Downloads on webhook update","suites":["gatsby-source-drupal"],"updatePoint":{"line":222,"column":44,"index":7978},"line":222,"code":"  it(`Skips File Downloads on webhook update`, async () => {\n    const skipFileDownloads = true;\n    expect(createRemoteFileNode).toBeCalledTimes(10);\n    const nodeToUpdate = require(`./fixtures/webhook-file-update.json`).data;\n    await handleWebhookUpdate({\n      nodeToUpdate,\n      ...args\n    }, {\n      baseUrl,\n      skipFileDownloads\n    });\n    expect(createRemoteFileNode).toBeCalledTimes(10);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Attributes","suites":["gatsby-source-drupal","Update webhook","Update content","Before update"],"updatePoint":{"line":238,"column":22,"index":8483},"line":238,"code":"        it(`Attributes`, () => {\n          expect(nodes[createNodeId(`und.article-3`)].title).toBe(`Article #3`);\n        });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Relationships","suites":["gatsby-source-drupal","Update webhook","Update content","Before update"],"updatePoint":{"line":241,"column":25,"index":8612},"line":241,"code":"        it(`Relationships`, () => {\n          expect(nodes[createNodeId(`und.article-3`)].relationships).toEqual({\n            field_main_image___NODE: createNodeId(`und.file-1`),\n            field_tags___NODE: [createNodeId(`und.tag-1`)]\n          });\n        });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Back references","suites":["gatsby-source-drupal","Update webhook","Update content","Before update"],"updatePoint":{"line":247,"column":27,"index":8879},"line":247,"code":"        it(`Back references`, () => {\n          expect(nodes[createNodeId(`und.file-1`)].relationships[`node__article___NODE`]).toContain(createNodeId(`und.article-3`));\n          expect(nodes[createNodeId(`und.tag-1`)].relationships[`node__article___NODE`]).toContain(createNodeId(`und.article-3`));\n          expect(nodes[createNodeId(`und.tag-2`)].relationships[`node__article___NODE`]).not.toContain(createNodeId(`und.article-3`));\n        });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Attributes","suites":["gatsby-source-drupal","Update webhook","Update content","After update"],"updatePoint":{"line":261,"column":22,"index":9592},"line":261,"code":"        it(`Attributes`, () => {\n          expect(nodes[createNodeId(`und.article-3`)].title).toBe(`Article #3 - Updated`);\n        });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Relationships","suites":["gatsby-source-drupal","Update webhook","Update content","After update"],"updatePoint":{"line":264,"column":25,"index":9731},"line":264,"code":"        it(`Relationships`, () => {\n          // removed `field_main_image`, changed `field_tags`\n          expect(nodes[createNodeId(`und.article-3`)].relationships).toEqual({\n            field_tags___NODE: [createNodeId(`und.tag-2`)]\n          });\n        });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Back references","suites":["gatsby-source-drupal","Update webhook","Update content","After update"],"updatePoint":{"line":270,"column":27,"index":9995},"line":270,"code":"        it(`Back references`, () => {\n          // removed `field_main_image`, `file-1` no longer has back reference to `article-3`\n          expect(nodes[createNodeId(`und.file-1`)].relationships[`node__article___NODE`]).not.toContain(createNodeId(`und.article-3`));\n          // changed `field_tags`, `tag-1` no longer has back reference to `article-3`\n          expect(nodes[createNodeId(`und.tag-1`)].relationships[`node__article___NODE`]).not.toContain(createNodeId(`und.article-3`));\n          // changed `field_tags`, `tag-2` now has back reference to `article-3`\n          expect(nodes[createNodeId(`und.tag-2`)].relationships[`node__article___NODE`]).toContain(createNodeId(`und.article-3`));\n        });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Relationships","suites":["gatsby-source-drupal","Update webhook","multiple entities in webhook body"],"updatePoint":{"line":291,"column":23,"index":11033},"line":291,"code":"      it(`Relationships`, async () => {\n        expect(nodes[createNodeId(`und.article-10`)].relationships.field_tags___NODE.length).toBe(1);\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Node doesn't exist before webhook","suites":["gatsby-source-drupal","Update webhook","Insert content"],"updatePoint":{"line":296,"column":43,"index":11252},"line":296,"code":"      it(`Node doesn't exist before webhook`, () => {\n        expect(nodes[createNodeId(`und.article-4`)]).not.toBeDefined();\n        expect(nodes[createNodeId(`und.tag-1`)].relationships[`node__article___NODE`]).not.toContain(createNodeId(`und.article-4`));\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Creates node","suites":["gatsby-source-drupal","Update webhook","Insert content","After insert"],"updatePoint":{"line":308,"column":24,"index":11762},"line":308,"code":"        it(`Creates node`, () => {\n          expect(nodes[createNodeId(`und.article-4`)]).toBeDefined();\n          expect(nodes[createNodeId(`und.article-4`)].title).toBe(`Article #4`);\n        });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Adds back references to referenced nodes","suites":["gatsby-source-drupal","Update webhook","Insert content","After insert"],"updatePoint":{"line":312,"column":52,"index":11988},"line":312,"code":"        it(`Adds back references to referenced nodes`, () => {\n          expect(nodes[createNodeId(`und.tag-1`)].relationships[`node__article___NODE`]).toContain(createNodeId(`und.article-4`));\n        });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Control disallowed link types","suites":["gatsby-source-drupal","Update webhook","Insert content","After insert"],"updatePoint":{"line":318,"column":35,"index":12201},"line":318,"code":"  it(`Control disallowed link types`, async () => {\n    // Reset nodes and test new disallowed link type.\n    Object.keys(nodes).forEach(key => delete nodes[key]);\n    const disallowedLinkTypes = [`self`, `describedby`, `taxonomy_term--tags`];\n    await sourceNodes(args, {\n      baseUrl,\n      disallowedLinkTypes\n    });\n    expect(Object.keys(nodes).length).not.toEqual(0);\n    expect(nodes[createNodeId(`und.file-1`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.file-2`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.tag-1`)]).toBeUndefined();\n    expect(nodes[createNodeId(`und.tag-2`)]).toBeUndefined();\n    expect(nodes[createNodeId(`und.article-1`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.article-2`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.article-3`)]).toBeDefined();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Can use the proxyUrl plugin option to use a different API url for sourcing","suites":["gatsby-source-drupal","Update webhook","Insert content","After insert"],"updatePoint":{"line":335,"column":80,"index":13067},"line":335,"code":"  it(`Can use the proxyUrl plugin option to use a different API url for sourcing`, async () => {\n    got.mockClear();\n    nodes = {};\n    await sourceNodes(args, {\n      baseUrl,\n      proxyUrl\n    });\n    let callSkipCount = 0;\n    for (const [index, call] of got.mock.calls.entries()) {\n      if (call[0] === `http://fixture/jsonapi`) {\n        callSkipCount++;\n        continue;\n      }\n      expect(got).toHaveBeenNthCalledWith(index + 1, expect.stringContaining(proxyUrl), expect.anything());\n    }\n    expect(callSkipCount).toBe(1);\n    expect(got).toBeCalledTimes(8);\n    expect(Object.keys(nodes).length).not.toEqual(0);\n    expect(nodes[createNodeId(`und.file-1`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.file-2`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.tag-1`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.tag-2`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.article-1`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.article-2`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.article-3`)]).toBeDefined();\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Verify JSON:API includes relationships","suites":["gatsby-source-drupal","Update webhook","Insert content","After insert"],"updatePoint":{"line":361,"column":44,"index":14100},"line":361,"code":"  it(`Verify JSON:API includes relationships`, async () => {\n    // Reset nodes and test includes relationships.\n    Object.keys(nodes).forEach(key => delete nodes[key]);\n    const disallowedLinkTypes = [`self`, `describedby`, `taxonomy_term--tags`];\n    const entityReferenceRevisions = [`paragraph`];\n    const filters = {\n      \"node--article\": `include=field_tags`\n    };\n    const apiBase = `jsonapi-includes`;\n    await sourceNodes(args, {\n      baseUrl,\n      apiBase,\n      disallowedLinkTypes,\n      filters,\n      entityReferenceRevisions\n    });\n    expect(Object.keys(nodes).length).not.toEqual(0);\n    expect(nodes[createNodeId(`und.tag-1`)]).toBeUndefined();\n    expect(nodes[createNodeId(`und.tag-2`)]).toBeUndefined();\n    expect(nodes[createNodeId(`und.tag-3`)]).toBeDefined();\n    const paragraphForwardRevisionId = createNodeId(`und.08d07c95-26ab-46b8-a56d-0a55567b2e31.4`);\n    const paragraphDraft = nodes[paragraphForwardRevisionId];\n    expect(paragraphDraft).toBeDefined();\n    expect(nodes[createNodeId(`und.08d07c95-26ab-46b8-a56d-0a55567b2e31.3`)]).toBeDefined();\n    expect(nodes[createNodeId(`und.tag-3`)]).toBeDefined();\n    const article = nodes[createNodeId(`und.article-5`)];\n    expect(article).toBeDefined();\n    const paragraphRelationships = article.relationships[`content___NODE`];\n    expect(paragraphRelationships).toContain(paragraphForwardRevisionId);\n    expect(paragraphDraft.body.value).toEqual(`Aenean porta turpis quis vulputate blandit`);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"for non-translated content","suites":["gatsby-source-drupal","supports JSON:API extras meta.count to parallelize fetches"],"updatePoint":{"line":393,"column":34,"index":15664},"line":393,"code":"    it(`for non-translated content`, async () => {\n      // Reset nodes and test includes relationships.\n      Object.keys(nodes).forEach(key => delete nodes[key]);\n      const apiBase = `jsonapi-meta.count`;\n      await sourceNodes(args, {\n        baseUrl,\n        apiBase\n      });\n      expect(Object.keys(nodes).length).toEqual(3);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"for translated content","suites":["gatsby-source-drupal","supports JSON:API extras meta.count to parallelize fetches"],"updatePoint":{"line":403,"column":30,"index":16004},"line":403,"code":"    it(`for translated content`, async () => {\n      // Reset nodes and test includes relationships.\n      Object.keys(nodes).forEach(key => delete nodes[key]);\n      const apiBase = `jsonapi-meta.count-i18n`;\n      const options = {\n        baseUrl,\n        apiBase,\n        languageConfig: {\n          defaultLanguage: `en_US`,\n          enabledLanguages: [`en_US`, {\n            langCode: `en-gb`,\n            as: `i18n-test`\n          }],\n          translatableEntities: [`node--article`],\n          nonTranslatableEntities: []\n        }\n      };\n      // Call onPreBootstrap to set options\n      await onPreBootstrap(args, options);\n      await sourceNodes(args, options);\n      expect(Object.keys(nodes).length).toEqual(4);\n      expect(Object.values(nodes).filter(n => n.langcode === `i18n-test`).length).toEqual(2);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"creates the initial paragraph entity correctly","suites":["gatsby-source-drupal","Paragraph fields"],"updatePoint":{"line":428,"column":54,"index":16905},"line":428,"code":"    it(`creates the initial paragraph entity correctly`, async () => {\n      // Reset nodes.\n      Object.keys(nodes).forEach(key => delete nodes[key]);\n      const nodesToUpdate = require(`./fixtures/paragraph-v1.json`);\n      for (const nodeToUpdate of nodesToUpdate) {\n        await handleWebhookUpdate({\n          nodeToUpdate: nodeToUpdate.data,\n          ...args\n        }, {\n          baseUrl: `https://example.com`\n        });\n      }\n      expect(nodes[`generated-id-en_US.e7861064-0009-4458-bf6e-0284d34bb00d`].field_image.alt).toEqual(`alt text`);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"updates the referenced entities correctly","suites":["gatsby-source-drupal","Paragraph fields"],"updatePoint":{"line":442,"column":49,"index":17467},"line":442,"code":"    it(`updates the referenced entities correctly`, async () => {\n      // Reset nodes.\n      Object.keys(nodes).forEach(key => delete nodes[key]);\n      const nodesToUpdate = require(`./fixtures/paragraph-v2.json`);\n      for (const nodeToUpdate of nodesToUpdate) {\n        await handleWebhookUpdate({\n          nodeToUpdate: nodeToUpdate.data,\n          ...args\n        }, {\n          baseUrl: `https://example.com`\n        });\n      }\n      expect(nodes[`generated-id-en_US.e7861064-0009-4458-bf6e-0284d34bb00d`].field_image.alt).toEqual(`alt text v2`);\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"should generate required Image CDN node data","suites":["gatsby-source-drupal","Image CDN"],"updatePoint":{"line":461,"column":52,"index":18137},"line":461,"code":"    it(`should generate required Image CDN node data`, async () => {\n      // Reset nodes and test includes relationships.\n      Object.keys(nodes).forEach(key => delete nodes[key]);\n      const options = {\n        baseUrl,\n        skipFileDownloads: true\n      };\n\n      // Call onPreBootstrap to set options\n      await onPreBootstrap(args, options);\n      await sourceNodes(args, options);\n      const fileNode = nodes[createNodeId(`und.file-1`)];\n      expect(fileNode).toBeDefined();\n      expect(fileNode.url).toEqual(`http://fixture/sites/default/files/main-image.png`);\n      expect(fileNode.mimeType).toEqual(`image/png`);\n      expect(fileNode.width).toEqual(100);\n      expect(fileNode.height).toEqual(100);\n      expect(probeImageSize).toHaveBeenCalled();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"should generate Image CDN node data when mimetype is on \"mimetype\" field","suites":["gatsby-source-drupal","Image CDN"],"updatePoint":{"line":480,"column":80,"index":18941},"line":480,"code":"    it(`should generate Image CDN node data when mimetype is on \"mimetype\" field`, async () => {\n      // Reset nodes and test includes relationships.\n      Object.keys(nodes).forEach(key => delete nodes[key]);\n      const options = {\n        baseUrl,\n        skipFileDownloads: true\n      };\n\n      // Call onPreBootstrap to set options\n      await onPreBootstrap(args, options);\n      await sourceNodes(args, options);\n      const fileNode = nodes[createNodeId(`und.file-5`)];\n      expect(fileNode).toBeDefined();\n      expect(fileNode.url).toEqual(`http://fixture/sites/default/files/main-image5.png`);\n      expect(fileNode.mimeType).toEqual(`image/png`);\n      expect(fileNode.width).toEqual(100);\n      expect(fileNode.height).toEqual(100);\n      expect(probeImageSize).toHaveBeenCalled();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"should not generate required Image CDN node data when imageCDN option is set to false","suites":["gatsby-source-drupal","Image CDN"],"updatePoint":{"line":499,"column":93,"index":19759},"line":499,"code":"    it(`should not generate required Image CDN node data when imageCDN option is set to false`, async () => {\n      // Reset nodes and test includes relationships.\n      Object.keys(nodes).forEach(key => delete nodes[key]);\n      const options = {\n        baseUrl,\n        skipFileDownloads: true,\n        imageCDN: false\n      };\n\n      // Call onPreBootstrap to set options\n      await onPreBootstrap(args, options);\n      await sourceNodes(args, options);\n      const fileNode = nodes[createNodeId(`und.file-1`)];\n\n      // imageCDN: true fetches the width/height\n      expect(fileNode.width).not.toBeDefined();\n      expect(fileNode.height).not.toBeDefined();\n      expect(probeImageSize).not.toHaveBeenCalled();\n    });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Attributes","suites":["gatsby-source-drupal","Fastbuilds sync","Before sync with expired timestamp"],"updatePoint":{"line":532,"column":20,"index":20862},"line":532,"code":"      it(`Attributes`, () => {\n        expect(nodes[createNodeId(`und.article-3`)].title).toBe(`Article #3`);\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Relationships","suites":["gatsby-source-drupal","Fastbuilds sync","Before sync with expired timestamp"],"updatePoint":{"line":535,"column":23,"index":20985},"line":535,"code":"      it(`Relationships`, () => {\n        expect(nodes[createNodeId(`und.article-3`)].relationships).toEqual({\n          field_main_image___NODE: createNodeId(`und.file-1`),\n          field_tags___NODE: [createNodeId(`und.tag-1`)]\n        });\n        expect(nodes[createNodeId(`und.article-2`)].relationships.field_secondary_image___NODE).toEqual([createNodeId(`und.file-4`)]);\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Back references","suites":["gatsby-source-drupal","Fastbuilds sync","Before sync with expired timestamp"],"updatePoint":{"line":542,"column":25,"index":21375},"line":542,"code":"      it(`Back references`, () => {\n        expect(nodes[createNodeId(`und.file-1`)].relationships[`node__article___NODE`]).toContain(createNodeId(`und.article-3`));\n        expect(nodes[createNodeId(`und.tag-1`)].relationships[`node__article___NODE`]).toContain(createNodeId(`und.article-3`));\n        expect(nodes[createNodeId(`und.tag-2`)].relationships[`node__article___NODE`]).not.toContain(createNodeId(`und.article-3`));\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Attributes","suites":["gatsby-source-drupal","Fastbuilds sync","After sync with valid timestamp"],"updatePoint":{"line":567,"column":20,"index":22309},"line":567,"code":"      it(`Attributes`, () => {\n        expect(nodes[createNodeId(`und.article-3`)].title).toBe(`Article #3 - Synced`);\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Relationships","suites":["gatsby-source-drupal","Fastbuilds sync","After sync with valid timestamp"],"updatePoint":{"line":570,"column":23,"index":22441},"line":570,"code":"      it(`Relationships`, () => {\n        // removed `field_main_image`, changed `field_tags`\n        expect(nodes[createNodeId(`und.article-3`)].relationships).toEqual({\n          field_tags___NODE: [createNodeId(`und.tag-2`)]\n        });\n        expect(nodes[createNodeId(`und.paragraph-image-1`)].relationships).toEqual({\n          field_gallery___NODE: createNodeId(`und.article-1`)\n        });\n        expect(nodes[createNodeId(`und.article-2`)].relationships.field_secondary_image___NODE).toBe(undefined);\n        expect(nodes[createNodeId(`und.article-2`)].relationships.field_secondary_multiple_image___NODE.length).toBe(1);\n        expect(nodes[createNodeId(`und.article-2`)].relationships.field_tertiary_image___NODE_image___NODE).toBe(undefined);\n        expect(nodes[createNodeId(`und.article-10`)].relationships.field_tags___NODE.length).toBe(1);\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"Back references","suites":["gatsby-source-drupal","Fastbuilds sync","After sync with valid timestamp"],"updatePoint":{"line":583,"column":25,"index":23313},"line":583,"code":"      it(`Back references`, () => {\n        // removed `field_main_image`, `file-1` no longer has back reference to `article-3`\n        expect(nodes[createNodeId(`und.file-1`)].relationships[`node__article___NODE`]).not.toContain(createNodeId(`und.article-3`));\n        // changed `field_tags`, `tag-1` no longer has back reference to `article-3`\n        expect(nodes[createNodeId(`und.tag-1`)].relationships[`node__article___NODE`]).not.toContain(createNodeId(`und.article-3`));\n        // changed `field_tags`, `tag-2` now has back reference to `article-3`\n        expect(nodes[createNodeId(`und.tag-2`)].relationships[`node__article___NODE`]).toContain(createNodeId(`und.article-3`));\n        // Created a new node article-9 with reference to tag-2\n        expect(nodes[createNodeId(`und.tag-2`)].relationships[`node__article___NODE`]).toContain(createNodeId(`und.article-9`));\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"during data fetching","suites":["gatsby-source-drupal","Error handling","Does end activities if error is thrown"],"updatePoint":{"line":606,"column":30,"index":24588},"line":606,"code":"      it(`during data fetching`, async () => {\n        got.mockImplementationOnce(() => {\n          throw new Error(`data fetching failed`);\n        });\n        expect.assertions(5);\n        try {\n          await sourceNodes(args, {\n            baseUrl\n          });\n        } catch (e) {\n          expect(e).toMatchInlineSnapshot(`[Error: data fetching failed]`);\n        }\n        expect(reporter.activityTimer).toHaveBeenCalledTimes(1);\n        expect(reporter.activityTimer).toHaveBeenNthCalledWith(1, `Fetch all data from Drupal`, {\n          parentSpan: undefined\n        });\n        expect(activity.start).toHaveBeenCalledTimes(1);\n        expect(activity.end).toHaveBeenCalledTimes(1);\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"during file downloading","suites":["gatsby-source-drupal","Error handling","Does end activities if error is thrown"],"updatePoint":{"line":625,"column":33,"index":25295},"line":625,"code":"      it(`during file downloading`, async () => {\n        downloadFileSpy.mockImplementationOnce(() => {\n          throw new Error(`file downloading failed`);\n        });\n        expect.assertions(6);\n        try {\n          await sourceNodes(args, {\n            baseUrl\n          });\n        } catch (e) {\n          expect(e).toMatchInlineSnapshot(`[Error: file downloading failed]`);\n        }\n        expect(reporter.activityTimer).toHaveBeenCalledTimes(2);\n        expect(reporter.activityTimer).toHaveBeenNthCalledWith(1, `Fetch all data from Drupal`, {\n          parentSpan: undefined\n        });\n        expect(reporter.activityTimer).toHaveBeenNthCalledWith(2, `Remote file download`, {\n          parentSpan: undefined\n        });\n        expect(activity.start).toHaveBeenCalledTimes(2);\n        expect(activity.end).toHaveBeenCalledTimes(2);\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"during refresh webhook handling","suites":["gatsby-source-drupal","Error handling","Does end activities if error is thrown"],"updatePoint":{"line":647,"column":41,"index":26164},"line":647,"code":"      it(`during refresh webhook handling`, async () => {\n        expect.assertions(5);\n        await sourceNodes({\n          ...args,\n          webhookBody: {\n            malformattedPayload: true\n          }\n        }, {\n          baseUrl\n        });\n        expect(reporter.warn).toHaveBeenCalledTimes(2);\n        expect(reporter.activityTimer).toHaveBeenCalledTimes(1);\n        expect(reporter.activityTimer).toHaveBeenNthCalledWith(1, `loading Drupal content changes`, expect.anything());\n        expect(activity.start).toHaveBeenCalledTimes(1);\n        expect(activity.end).toHaveBeenCalledTimes(1);\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"during fastbuilds sync","suites":["gatsby-source-drupal","Error handling","Does end activities if error is thrown"],"updatePoint":{"line":663,"column":32,"index":26771},"line":663,"code":"      it(`during fastbuilds sync`, async () => {\n        expect.assertions(5);\n        try {\n          const fastBuilds = true;\n          // Mock the lastFetched timestamp to an invalid value.\n          args.store.getState.mockReturnValue({\n            status: {\n              plugins: {\n                \"gatsby-source-drupal\": {\n                  lastFetched: 1000000000\n                }\n              }\n            }\n          });\n          await sourceNodes(args, {\n            baseUrl,\n            fastBuilds\n          });\n        } catch (e) {\n          expect(e).toBeTruthy();\n        }\n        expect(reporter.activityTimer).toHaveBeenCalledTimes(1);\n        expect(reporter.activityTimer).toHaveBeenNthCalledWith(1, `Fetch incremental changes from Drupal`, {\n          parentSpan: {}\n        });\n        expect(activity.start).toHaveBeenCalledTimes(1);\n        expect(activity.end).toHaveBeenCalledTimes(1);\n      });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-drupal/src/__tests__"},{"name":"should create nodes based on faker generated values","suites":["gatsby-source-faker"],"updatePoint":{"line":27,"column":57,"index":674},"line":27,"code":"  it(`should create nodes based on faker generated values`, () => {\n    expect(actions.createNode).toHaveBeenNthCalledWith(pluginOptions.count, {\n      children: [],\n      id: `id`,\n      internal: {\n        type: pluginOptions.type,\n        contentDigest: `digest`\n      },\n      parent: null,\n      name: {\n        firstName: expect.any(String),\n        lastName: expect.any(String)\n      }\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-faker/src/__tests__"},{"name":"rejects when the buffer can't be read","suites":["create-file-node-from-buffer","functionality"],"updatePoint":{"line":62,"column":45,"index":1435},"line":62,"code":"    it(`rejects when the buffer can't be read`, () => {\n      expect(setup({\n        buffer: null\n      })).rejects.toEqual(expect.stringContaining(`bad buffer`));\n    });","file":"create-file-node-from-buffer.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"caches the buffer's content locally","suites":["create-file-node-from-buffer","functionality"],"updatePoint":{"line":67,"column":43,"index":1605},"line":67,"code":"    it(`caches the buffer's content locally`, async () => {\n      expect.assertions(2);\n      let output;\n      writeFile.mockImplementationOnce((_f, buf, cb) => {\n        output = buf;\n        cb();\n      });\n      const buffer = createMockBuffer(`buffer-content`);\n      await setup({\n        buffer,\n        hash: `some-hash`\n      });\n      expect(ensureDir).toBeCalledTimes(1);\n      expect(bufferEq(buffer, output)).toBe(true);\n    });","file":"create-file-node-from-buffer.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"uses cached file Promise for buffer with a matching hash","suites":["create-file-node-from-buffer","functionality"],"updatePoint":{"line":82,"column":64,"index":2068},"line":82,"code":"    it(`uses cached file Promise for buffer with a matching hash`, async () => {\n      expect.assertions(3);\n      const cache = createMockCache();\n      await setup({\n        getCache: () => cache,\n        hash: `same-hash`\n      });\n      await setup({\n        getCache: () => cache,\n        hash: `same-hash`\n      });\n      expect(cache.get).toBeCalledTimes(1);\n      expect(cache.set).toBeCalledTimes(1);\n      expect(writeFile).toBeCalledTimes(1);\n    });","file":"create-file-node-from-buffer.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"uses cached file from previous run with a matching hash","suites":["create-file-node-from-buffer","functionality"],"updatePoint":{"line":97,"column":63,"index":2529},"line":97,"code":"    it(`uses cached file from previous run with a matching hash`, async () => {\n      expect.assertions(3);\n      const cache = createMockCache();\n      cache.get.mockImplementationOnce(() => `cached-file-path`);\n      await setup({\n        getCache: () => cache,\n        hash: `cached-hash`\n      });\n      expect(cache.get).toBeCalledWith(expect.stringContaining(`cached-hash`));\n      expect(cache.set).not.toBeCalled();\n      expect(createFileNode).toBeCalledWith(expect.stringContaining(`cached-file-path`), expect.any(Function), expect.any(Object));\n    });","file":"create-file-node-from-buffer.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"uses hash as filename when no name is provided","suites":["create-file-node-from-buffer","functionality"],"updatePoint":{"line":109,"column":54,"index":3084},"line":109,"code":"    it(`uses hash as filename when no name is provided`, async () => {\n      expect.assertions(1);\n      let outputFilename;\n      writeFile.mockImplementationOnce((filename, buf, cb) => {\n        outputFilename = filename;\n        cb();\n      });\n      const buffer = createMockBuffer(`buffer-content`);\n      await setup({\n        hash: `a-given-hash`,\n        buffer: buffer,\n        getCache: () => createMockCache()\n      });\n      expect(outputFilename).toContain(`a-given-hash.bin`);\n    });","file":"create-file-node-from-buffer.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"uses generated hash as filename when no name or hash is provided","suites":["create-file-node-from-buffer","functionality"],"updatePoint":{"line":124,"column":72,"index":3601},"line":124,"code":"    it(`uses generated hash as filename when no name or hash is provided`, async () => {\n      expect.assertions(1);\n      let outputFilename;\n      writeFile.mockImplementationOnce((filename, buf, cb) => {\n        outputFilename = filename;\n        cb();\n      });\n      const buffer = createMockBuffer(`buffer-content`);\n      const expectedHash = createContentDigest(buffer);\n      await setup({\n        buffer: buffer,\n        getCache: () => createMockCache()\n      });\n      expect(outputFilename).toContain(`${expectedHash}.bin`);\n    });","file":"create-file-node-from-buffer.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"throws on invalid inputs: createNode","suites":["create-file-node-from-buffer","validation"],"updatePoint":{"line":141,"column":44,"index":4158},"line":141,"code":"    it(`throws on invalid inputs: createNode`, () => {\n      expect(() => {\n        createFileNodeFromBuffer({\n          ...defaultArgs,\n          buffer: createMockBuffer(`some binary content`),\n          hash: `some-hash`,\n          createNode: undefined\n        });\n      }).toThrowErrorMatchingInlineSnapshot(`\"createNode must be a function, was undefined\"`);\n    });","file":"create-file-node-from-buffer.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"throws on invalid inputs: createNodeId","suites":["create-file-node-from-buffer","validation"],"updatePoint":{"line":151,"column":46,"index":4532},"line":151,"code":"    it(`throws on invalid inputs: createNodeId`, () => {\n      expect(() => {\n        createFileNodeFromBuffer({\n          ...defaultArgs,\n          buffer: createMockBuffer(`some binary content`),\n          hash: `some-hash`,\n          createNodeId: undefined\n        });\n      }).toThrowErrorMatchingInlineSnapshot(`\"createNodeId must be a function, was undefined\"`);\n    });","file":"create-file-node-from-buffer.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"throws on invalid inputs: cache or getCache","suites":["create-file-node-from-buffer","validation"],"updatePoint":{"line":161,"column":51,"index":4915},"line":161,"code":"    it(`throws on invalid inputs: cache or getCache`, () => {\n      expect(() => {\n        createFileNodeFromBuffer({\n          ...defaultArgs,\n          buffer: createMockBuffer(`some binary content`),\n          hash: `some-hash`,\n          cache: undefined,\n          getCache: undefined\n        });\n      }).toThrowErrorMatchingInlineSnapshot(`\"Neither \\\\\"cache\\\\\" or \\\\\"getCache\\\\\" was passed. getCache must be function that return Gatsby cache, \\\\\"cache\\\\\" must be the Gatsby cache, was undefined\"`);\n    });","file":"create-file-node-from-buffer.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"doesn't throw when getCache is defined","suites":["create-file-node-from-buffer","validation"],"updatePoint":{"line":172,"column":46,"index":5424},"line":172,"code":"    it(`doesn't throw when getCache is defined`, () => {\n      expect(() => {\n        createFileNodeFromBuffer({\n          ...defaultArgs,\n          buffer: createMockBuffer(`some binary content`),\n          hash: `some-hash`,\n          getCache: () => createMockCache()\n        });\n      }).not.toThrow();\n    });","file":"create-file-node-from-buffer.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"doesn't throw when cache is defined","suites":["create-file-node-from-buffer","validation"],"updatePoint":{"line":182,"column":43,"index":5736},"line":182,"code":"    it(`doesn't throw when cache is defined`, () => {\n      expect(() => {\n        createFileNodeFromBuffer({\n          ...defaultArgs,\n          buffer: createMockBuffer(`some binary content`),\n          hash: `some-hash`,\n          cache: createMockCache()\n        });\n      }).not.toThrow();\n    });","file":"create-file-node-from-buffer.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"creates a file node","suites":["create-file-node"],"updatePoint":{"line":121,"column":25,"index":3760},"line":121,"code":"  it(`creates a file node`, async () => {\n    const createNodeId = createMockCreateNodeId();\n    const cache = createMockCache();\n    return createFileNode(path.resolve(`${__dirname}/fixtures/file.json`), createNodeId, {}, cache);\n  });","file":"create-file-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"records the shape of the node","suites":["create-file-node"],"updatePoint":{"line":126,"column":35,"index":4007},"line":126,"code":"  it(`records the shape of the node`, async () => {\n    const dname = fs.mkdtempSync(`gatsby-create-file-node-test`).trim();\n    try {\n      const fname = path.join(dname, `f`);\n      fs.writeFileSync(fname, `data`);\n      try {\n        const createNodeId = createMockCreateNodeId();\n        const emptyCache = {\n          get: jest.fn(),\n          set: jest.fn(),\n          directory: __dirname\n        };\n        const node = await createFileNode(fname, createNodeId, {}, emptyCache);\n        testNode(node, dname, fname, fileHash);\n      } finally {\n        fs.unlinkSync(fname);\n      }\n    } finally {\n      fs.rmdirSync(dname);\n    }\n  });","file":"create-file-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"records the shape of the node from cache","suites":["create-file-node"],"updatePoint":{"line":147,"column":46,"index":4664},"line":147,"code":"  it(`records the shape of the node from cache`, async () => {\n    const dname = fs.mkdtempSync(`gatsby-create-file-node-test`).trim();\n    try {\n      const fname = path.join(dname, `f`);\n      fs.writeFileSync(fname, `data`);\n      try {\n        const createNodeId = createMockCreateNodeId();\n        const getFromCache = jest.fn();\n        getFromCache.mockReturnValue(fileHash);\n        const cache = createMockCache(getFromCache);\n        const nodeFromCache = await createFileNode(fname, createNodeId, {}, cache);\n        testNode(nodeFromCache, dname, fname, fileHash);\n      } finally {\n        fs.unlinkSync(fname);\n      }\n    } finally {\n      fs.rmdirSync(dname);\n    }\n  });","file":"create-file-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"records the shape of the fast hashed node","suites":["create-file-node"],"updatePoint":{"line":166,"column":47,"index":5353},"line":166,"code":"  it(`records the shape of the fast hashed node`, async () => {\n    const dname = fs.mkdtempSync(`gatsby-create-file-node-test`).trim();\n    try {\n      const fname = path.join(dname, `f`);\n      fs.writeFileSync(fname, `data`);\n      try {\n        const createNodeId = createMockCreateNodeId();\n        const cache = createMockCache();\n        const nodeFastHash = await createFileNode(fname, createNodeId, {\n          fastHash: true\n        }, cache);\n        testNode(nodeFastHash, dname, fname, fileFastHash);\n      } finally {\n        fs.unlinkSync(fname);\n      }\n    } finally {\n      fs.rmdirSync(dname);\n    }\n  });","file":"create-file-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"should throw an error when an invalid url is given","suites":["create-remote-file-node"],"updatePoint":{"line":31,"column":56,"index":912},"line":31,"code":"  it(`should throw an error when an invalid url is given`, () => {\n    expect(() => createRemoteFileNode({\n      ...defaultArgs,\n      url: ``\n    })).toThrowError(`url passed to createRemoteFileNode is either missing or not a proper web uri: `);\n  });","file":"create-remote-file-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"should download and create file node","suites":["create-remote-file-node"],"updatePoint":{"line":37,"column":42,"index":1151},"line":37,"code":"  it(`should download and create file node`, async () => {\n    const node = await createRemoteFileNode(defaultArgs);\n    expect(node).toMatchObject(expect.objectContaining({\n      id: `1`,\n      extension: `jpg`,\n      name: `dog-thumbnail`,\n      base: `dog-thumbnail.jpg`,\n      url: defaultArgs.url,\n      internal: expect.objectContaining({\n        type: `File`\n      })\n    }));\n  });","file":"create-remote-file-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"passes headers","suites":["create-remote-file-node"],"updatePoint":{"line":50,"column":20,"index":1519},"line":50,"code":"  it(`passes headers`, async () => {\n    await createRemoteFileNode({\n      ...defaultArgs,\n      // bypass cache\n      url: `${defaultArgs.url}?header`,\n      httpHeaders: {\n        \"x-test\": `test`\n      }\n    });\n    expect(fetchRemoteFile).toHaveBeenCalledWith(expect.objectContaining({\n      httpHeaders: {\n        \"x-test\": `test`\n      }\n    }));\n  });","file":"create-remote-file-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"passes custom auth header, if defined","suites":["create-remote-file-node"],"updatePoint":{"line":65,"column":43,"index":1902},"line":65,"code":"  it(`passes custom auth header, if defined`, async () => {\n    const auth = {\n      htaccess_user: `hunter2`,\n      htaccess_pass: `*******`\n    };\n    await createRemoteFileNode({\n      ...defaultArgs,\n      // bypass cache\n      url: `${defaultArgs.url}?auth`,\n      auth\n    });\n    expect(fetchRemoteFile).toHaveBeenCalledWith(expect.objectContaining({\n      auth\n    }));\n  });","file":"create-remote-file-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"fails when fetchRemoteFile throws an error","suites":["create-remote-file-node"],"updatePoint":{"line":80,"column":48,"index":2291},"line":80,"code":"  it(`fails when fetchRemoteFile throws an error`, async () => {\n    expect.assertions(1);\n    try {\n      fetchRemoteFile.mockImplementationOnce(({\n        url\n      }) => Promise.reject(new Error(`failed to process ${url}`)));\n      await createRemoteFileNode({\n        ...defaultArgs,\n        // bypass cache\n        url: `${defaultArgs.url}?error`\n      });\n    } catch (err) {\n      expect(err.message).toEqual(`failed to process ${defaultArgs.url}?error`);\n    }\n  });","file":"create-remote-file-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"throws on invalid inputs: createNode","suites":["create-remote-file-node","validation"],"updatePoint":{"line":96,"column":44,"index":2795},"line":96,"code":"    it(`throws on invalid inputs: createNode`, () => {\n      expect(() => {\n        createRemoteFileNode({\n          ...defaultArgs,\n          createNode: undefined\n        });\n      }).toThrowErrorMatchingInlineSnapshot(`\"createNode must be a function, was undefined\"`);\n    });","file":"create-remote-file-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"throws on invalid inputs: createNodeId","suites":["create-remote-file-node","validation"],"updatePoint":{"line":104,"column":46,"index":3077},"line":104,"code":"    it(`throws on invalid inputs: createNodeId`, () => {\n      expect(() => {\n        createRemoteFileNode({\n          ...defaultArgs,\n          createNodeId: undefined\n        });\n      }).toThrowErrorMatchingInlineSnapshot(`\"createNodeId must be a function, was undefined\"`);\n    });","file":"create-remote-file-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"throws on invalid inputs: cache and getCache undefined","suites":["create-remote-file-node","validation"],"updatePoint":{"line":112,"column":62,"index":3379},"line":112,"code":"    it(`throws on invalid inputs: cache and getCache undefined`, () => {\n      expect(() => createRemoteFileNode({\n        ...defaultArgs,\n        cache: undefined,\n        getCache: undefined\n      })).toThrowErrorMatchingInlineSnapshot(`\"Neither \\\\\"cache\\\\\" or \\\\\"getCache\\\\\" was passed. getCache must be function that return Gatsby cache, \\\\\"cache\\\\\" must be the Gatsby cache, was undefined\"`);\n    });","file":"create-remote-file-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"doesn't throw when getCache is defined","suites":["create-remote-file-node","validation"],"updatePoint":{"line":119,"column":46,"index":3769},"line":119,"code":"    it(`doesn't throw when getCache is defined`, () => {\n      expect(() => createRemoteFileNode({\n        ...defaultArgs,\n        getCache: () => createMockCache()\n      })).not.toThrow();\n    });","file":"create-remote-file-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"doesn't throw when cache is defined","suites":["create-remote-file-node","validation"],"updatePoint":{"line":125,"column":43,"index":3964},"line":125,"code":"    it(`doesn't throw when cache is defined`, () => {\n      expect(() => createRemoteFileNode({\n        ...defaultArgs,\n        cache: createMockCache()\n      })).not.toThrow();\n    });","file":"create-remote-file-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"queues node creation from added files","suites":["tests","handles chokidar events emitted before \"ready\""],"updatePoint":{"line":72,"column":45,"index":1712},"line":72,"code":"    it(`queues node creation from added files`, async () => {\n      const api = createApi();\n      const sourceNodesPromise = gatsbyNode.sourceNodes(api, {\n        path: ``\n      });\n      // allow microtasks execution\n      await tick();\n      await emitChokidarEvent(`add`, `test.md`);\n\n      // ready was not emitted, so no nodes should be created\n      expect(createFileNode).not.toBeCalled();\n      expect(api.actions.createNode).not.toBeCalled();\n      await emitChokidarEvent(`ready`);\n      await expect(sourceNodesPromise).resolves.toBeDefined();\n      expect(api.actions.createNode).toBeCalled();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"queues node creation from changed files","suites":["tests","handles chokidar events emitted before \"ready\""],"updatePoint":{"line":88,"column":47,"index":2329},"line":88,"code":"    it(`queues node creation from changed files`, async () => {\n      const api = createApi();\n      const sourceNodesPromise = gatsbyNode.sourceNodes(api, {\n        path: ``\n      });\n      // allow microtasks execution\n      await tick();\n      await emitChokidarEvent(`change`, `test.md`);\n      // ready was not emitted, so no nodes should be created\n      expect(createFileNode).not.toBeCalled();\n      expect(api.actions.createNode).not.toBeCalled();\n      await emitChokidarEvent(`ready`);\n      await expect(sourceNodesPromise).resolves.toBeDefined();\n      expect(api.actions.createNode).toBeCalled();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"queues node creation from added directories","suites":["tests","handles chokidar events emitted before \"ready\""],"updatePoint":{"line":103,"column":51,"index":2952},"line":103,"code":"    it(`queues node creation from added directories`, async () => {\n      const api = createApi();\n      const sourceNodesPromise = gatsbyNode.sourceNodes(api, {\n        path: ``\n      });\n      // allow microtasks execution\n      await tick();\n      await emitChokidarEvent(`addDir`, `test`);\n\n      // ready was not emitted, so no nodes should be created\n      expect(createFileNode).not.toBeCalled();\n      expect(api.actions.createNode).not.toBeCalled();\n      await emitChokidarEvent(`ready`);\n      await expect(sourceNodesPromise).resolves.toBeDefined();\n      expect(api.actions.createNode).toBeCalled();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"queues node deletion from deleted files","suites":["tests","handles chokidar events emitted before \"ready\""],"updatePoint":{"line":119,"column":47,"index":3569},"line":119,"code":"    it(`queues node deletion from deleted files`, async () => {\n      const api = createApi();\n      const sourceNodesPromise = gatsbyNode.sourceNodes(api, {\n        path: ``\n      });\n      // allow microtasks execution\n      await tick();\n      await emitChokidarEvent(`unlink`, `test.md`);\n\n      // ready was not emitted, so no nodes should be deleted\n      expect(api.actions.deleteNode).not.toBeCalled();\n      await emitChokidarEvent(`ready`);\n      await expect(sourceNodesPromise).resolves.toBeDefined();\n      expect(api.actions.deleteNode).toBeCalled();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"queues node deletion from deleted directories","suites":["tests","handles chokidar events emitted before \"ready\""],"updatePoint":{"line":134,"column":53,"index":4148},"line":134,"code":"    it(`queues node deletion from deleted directories`, async () => {\n      const api = createApi();\n      const sourceNodesPromise = gatsbyNode.sourceNodes(api, {\n        path: ``\n      });\n      // allow microtasks execution\n      await tick();\n      await emitChokidarEvent(`unlinkDir`, `test`);\n\n      // ready was not emitted, so no nodes should be deleted\n      expect(api.actions.deleteNode).not.toBeCalled();\n      await emitChokidarEvent(`ready`);\n      await expect(sourceNodesPromise).resolves.toBeDefined();\n      expect(api.actions.deleteNode).toBeCalled();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"creates nodes from added files","suites":["tests","handles chokidar events emitted after \"ready\""],"updatePoint":{"line":151,"column":38,"index":4786},"line":151,"code":"    it(`creates nodes from added files`, async () => {\n      const api = createApi();\n      const sourceNodesPromise = gatsbyNode.sourceNodes(api, {\n        path: ``\n      });\n      // allow microtasks execution\n      await tick();\n\n      // ready was not emitted, so no nodes should be created\n      expect(createFileNode).not.toBeCalled();\n      expect(api.actions.createNode).not.toBeCalled();\n      await emitChokidarEvent(`ready`);\n      await expect(sourceNodesPromise).resolves.toBeDefined();\n      await emitChokidarEvent(`add`, `test.md`);\n      expect(api.actions.createNode).toBeCalled();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"creates nodes from changed files","suites":["tests","handles chokidar events emitted after \"ready\""],"updatePoint":{"line":167,"column":40,"index":5396},"line":167,"code":"    it(`creates nodes from changed files`, async () => {\n      const api = createApi();\n      const sourceNodesPromise = gatsbyNode.sourceNodes(api, {\n        path: ``\n      });\n      // allow microtasks execution\n      await tick();\n\n      // ready was not emitted, so no nodes should be created\n      expect(createFileNode).not.toBeCalled();\n      expect(api.actions.createNode).not.toBeCalled();\n      await emitChokidarEvent(`ready`);\n      await expect(sourceNodesPromise).resolves.toBeDefined();\n      await emitChokidarEvent(`change`, `test.md`);\n      expect(api.actions.createNode).toBeCalled();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"creates nodes from added directories","suites":["tests","handles chokidar events emitted after \"ready\""],"updatePoint":{"line":183,"column":44,"index":6013},"line":183,"code":"    it(`creates nodes from added directories`, async () => {\n      const api = createApi();\n      const sourceNodesPromise = gatsbyNode.sourceNodes(api, {\n        path: ``\n      });\n      // allow microtasks execution\n      await tick();\n\n      // ready was not emitted, so no nodes should be created\n      expect(createFileNode).not.toBeCalled();\n      expect(api.actions.createNode).not.toBeCalled();\n      await emitChokidarEvent(`ready`);\n      await expect(sourceNodesPromise).resolves.toBeDefined();\n      await emitChokidarEvent(`addDir`, `test`);\n      expect(api.actions.createNode).toBeCalled();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"delete nodes from deleted files","suites":["tests","handles chokidar events emitted after \"ready\""],"updatePoint":{"line":199,"column":39,"index":6622},"line":199,"code":"    it(`delete nodes from deleted files`, async () => {\n      const api = createApi();\n      const sourceNodesPromise = gatsbyNode.sourceNodes(api, {\n        path: ``\n      });\n      // allow microtasks execution\n      await tick();\n\n      // ready was not emitted, so no nodes should be deleted\n      expect(api.actions.deleteNode).not.toBeCalled();\n      await emitChokidarEvent(`ready`);\n      await expect(sourceNodesPromise).resolves.toBeDefined();\n      await emitChokidarEvent(`unlink`, `test.md`);\n      expect(api.actions.deleteNode).toBeCalled();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"delete nodes from deleted directories","suites":["tests","handles chokidar events emitted after \"ready\""],"updatePoint":{"line":214,"column":45,"index":7193},"line":214,"code":"    it(`delete nodes from deleted directories`, async () => {\n      const api = createApi();\n      const sourceNodesPromise = gatsbyNode.sourceNodes(api, {\n        path: ``\n      });\n      // allow microtasks execution\n      await tick();\n\n      // ready was not emitted, so no nodes should be deleted\n      expect(api.actions.deleteNode).not.toBeCalled();\n      await emitChokidarEvent(`ready`);\n      await expect(sourceNodesPromise).resolves.toBeDefined();\n      await emitChokidarEvent(`unlinkDir`, `test`);\n      expect(api.actions.deleteNode).toBeCalled();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"can load the content of a file","suites":["gatsby-source-filesystem"],"updatePoint":{"line":6,"column":36,"index":158},"line":6,"code":"  it(`can load the content of a file`, async () => {\n    const content = await loadNodeContent({\n      absolutePath: path.join(__dirname, `../index.js`)\n    });\n    expect(content.length).toBeGreaterThan(0);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"rejects if file not found","suites":["gatsby-source-filesystem"],"updatePoint":{"line":12,"column":31,"index":367},"line":12,"code":"  it(`rejects if file not found`, async () => {\n    await loadNodeContent({\n      absolutePath: path.join(__dirname, `haha-not-a-real-file.js`)\n    }).catch(err => {\n      expect(err).toBeDefined();\n    });\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"can correctly retrieve file name and extensions","suites":["create remote file node"],"updatePoint":{"line":6,"column":53,"index":177},"line":6,"code":"  it(`can correctly retrieve file name and extensions`, () => {\n    ;\n    [[`https://scontent.xx.fbcdn.net/v/t51.2885-15/42078503_294439751160571_1602896118583132160_n.jpg?_nc_cat=101&oh=e30490a47409051c45dc3daacf616bc0&oe=5C5EA8EB`, `42078503_294439751160571_1602896118583132160_n`, `.jpg`], [`https://facebook.com/hello,_world_asdf12341234.jpeg?test=true&other_thing=also-true`, `hello,_world_asdf12341234`, `.jpeg`], [`https://test.com/asdf.png`, `asdf`, `.png`], [`./path/to/relative/file.tiff`, `file`, `.tiff`], [`/absolutely/this/will/work.bmp`, `work`, `.bmp`]].forEach(([url, name, ext]) => {\n      expect(getRemoteFileName(url)).toBe(name);\n      expect(getRemoteFileExtension(url)).toBe(ext);\n    });\n  });","file":"utils.js","skipped":false,"dir":"packages/gatsby-source-filesystem/src/__tests__"},{"name":"should validate minimal, valid config","suites":["validation"],"updatePoint":{"line":57,"column":43,"index":1183},"line":57,"code":"  it(`should validate minimal, valid config`, async () => {\n    const {\n      isValid\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      url: `https://github.com`,\n      typeName: `GitHub`,\n      fieldName: `github`\n    });\n    expect(isValid).toEqual(true);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-graphql/src/__tests__"},{"name":"should invalidate a config missing required vars","suites":["validation"],"updatePoint":{"line":67,"column":54,"index":1475},"line":67,"code":"  it(`should invalidate a config missing required vars`, async () => {\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {});\n    expect(isValid).toEqual(false);\n    expect(errors).toMatchInlineSnapshot(`\n      Array [\n        \"\\\\\"typeName\\\\\" is required\",\n        \"\\\\\"fieldName\\\\\" is required\",\n        \"\\\\\"value\\\\\" must contain at least one of [url, createLink]\",\n      ]\n    `);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-graphql/src/__tests__"},{"name":"should validate a fully custom config","suites":["validation"],"updatePoint":{"line":81,"column":43,"index":1901},"line":81,"code":"  it(`should validate a fully custom config`, async () => {\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      url: `https://github.com`,\n      typeName: `GitHub`,\n      fieldName: `github`,\n      headers: () => {\n        return {\n          Authorization: `Bearer abc`\n        };\n      },\n      fetch: () => {},\n      fetchOptions: {},\n      createLink: () => {},\n      createSchema: () => {},\n      batch: true,\n      transformSchema: () => {}\n    });\n    expect(errors).toEqual([]);\n    expect(isValid).toEqual(true);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-graphql/src/__tests__"},{"name":"invokes createContentDigest","suites":["createSchemaNode"],"updatePoint":{"line":106,"column":33,"index":2514},"line":106,"code":"  it(`invokes createContentDigest`, async () => {\n    const api = getInternalGatsbyAPI();\n    await sourceNodes(api, {\n      typeName: `Github`,\n      fieldName: `github`,\n      url: `https://github.com`\n    });\n    expect(api.createContentDigest).toHaveBeenCalledWith(expect.any(String));\n    expect(api.createContentDigest).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-graphql/src/__tests__"},{"name":"use passed in fetch if provided","suites":["createHttpLink"],"updatePoint":{"line":118,"column":37,"index":2915},"line":118,"code":"  it(`use passed in fetch if provided`, async () => {\n    const api = getInternalGatsbyAPI();\n    const mockFetch = jest.fn();\n    await createSchemaCustomization(api, {\n      typeName: `Github foo`,\n      fieldName: `github`,\n      url: `https://github.com`,\n      fetch: mockFetch\n    });\n    expect(createHttpLink).toHaveBeenCalledWith(expect.objectContaining({\n      fetch: mockFetch\n    }));\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-graphql/src/__tests__"},{"name":"use default fetch if not provided","suites":["createHttpLink"],"updatePoint":{"line":131,"column":39,"index":3320},"line":131,"code":"  it(`use default fetch if not provided`, async () => {\n    const api = getInternalGatsbyAPI();\n    await createSchemaCustomization(api, {\n      typeName: `Github foo`,\n      fieldName: `github`,\n      url: `https://github.com`\n    });\n    expect(createHttpLink).toHaveBeenCalledWith(expect.objectContaining({\n      fetch: fetchWrapper\n    }));\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-graphql/src/__tests__"},{"name":"works","suites":["NamespaceUnderFieldTransform"],"updatePoint":{"line":19,"column":11,"index":322},"line":19,"code":"  it(`works`, () => {\n    const schema = buildSchema(sdl);\n    const transform = new NamespaceUnderFieldTransform({\n      typeName: `Wrapper`,\n      fieldName: `wrapper`,\n      resolver: () => {}\n    });\n    const transformedSchema = transform.transformSchema(schema);\n    const transformedSdl = printSchema(transformedSchema);\n    expect(transformedSdl).toMatchSnapshot();\n  });","file":"transforms.js","skipped":false,"dir":"packages/gatsby-source-graphql/src/__tests__"},{"name":"works","suites":["StripNonQueryTransform"],"updatePoint":{"line":32,"column":11,"index":749},"line":32,"code":"  it(`works`, () => {\n    const schema = buildSchema(sdl);\n    const transform = new StripNonQueryTransform();\n    const transformedSchema = transform.transformSchema(schema);\n    const transformedSdl = printSchema(transformedSchema);\n    expect(transformedSdl).toMatchSnapshot();\n  });","file":"transforms.js","skipped":false,"dir":"packages/gatsby-source-graphql/src/__tests__"},{"name":"Creates entities from object collections of entities","suites":["Process Lever data"],"updatePoint":{"line":4,"column":58,"index":180},"line":4,"code":"  it(`Creates entities from object collections of entities`, () => {\n    entities = normalize.normalizeEntities(entities);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-lever/src/__tests__"},{"name":"Standardizes ids & cleans keys","suites":["Process Lever data"],"updatePoint":{"line":7,"column":36,"index":287},"line":7,"code":"  it(`Standardizes ids & cleans keys`, () => {\n    entities = normalize.standardizeKeys(entities);\n    expect(entities).toMatchSnapshot();\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-lever/src/__tests__"},{"name":"Converts to use only GMT dates","suites":["Process Lever data"],"updatePoint":{"line":11,"column":36,"index":432},"line":11,"code":"  it(`Converts to use only GMT dates`, () => {\n    entities = normalize.standardizeDates(entities);\n    expect(entities).toMatchSnapshot();\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-lever/src/__tests__"},{"name":"creates Gatsby IDs for each entity","suites":["Process Lever data"],"updatePoint":{"line":15,"column":40,"index":582},"line":15,"code":"  it(`creates Gatsby IDs for each entity`, () => {\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    entities = normalize.createGatsbyIds(createNodeId, entities);\n    expect(entities).toMatchSnapshot();\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-lever/src/__tests__"},{"name":"creates nodes for each entry","suites":["Process Lever data"],"updatePoint":{"line":21,"column":34,"index":829},"line":21,"code":"  it(`creates nodes for each entry`, () => {\n    const createNode = jest.fn();\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    normalize.createNodesFromEntities({\n      entities,\n      createNode,\n      createContentDigest\n    });\n    expect(createNode.mock.calls).toMatchSnapshot();\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-lever/src/__tests__"},{"name":"It passes a key through untouched that passes","suites":["getValidKey"],"updatePoint":{"line":33,"column":51,"index":1204},"line":33,"code":"  it(`It passes a key through untouched that passes`, () => {\n    expect(normalize.getValidKey({\n      key: `hi`\n    })).toBe(`hi`);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-lever/src/__tests__"},{"name":"It prefixes keys that start with numbers","suites":["getValidKey"],"updatePoint":{"line":38,"column":46,"index":1338},"line":38,"code":"  it(`It prefixes keys that start with numbers`, () => {\n    expect(normalize.getValidKey({\n      key: `0hi`\n    })).toBe(`lever_0hi`);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-lever/src/__tests__"},{"name":"It prefixes keys that conflict with default Gatsby fields","suites":["getValidKey"],"updatePoint":{"line":43,"column":63,"index":1497},"line":43,"code":"  it(`It prefixes keys that conflict with default Gatsby fields`, () => {\n    expect(normalize.getValidKey({\n      key: `children`\n    })).toBe(`lever_children`);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-lever/src/__tests__"},{"name":"It replaces invalid characters","suites":["getValidKey"],"updatePoint":{"line":48,"column":36,"index":1639},"line":48,"code":"  it(`It replaces invalid characters`, () => {\n    expect(normalize.getValidKey({\n      key: `h:i`\n    })).toBe(`h_i`);\n  });","file":"normalize.js","skipped":false,"dir":"packages/gatsby-source-lever/src/__tests__"},{"name":"should create node based on medium data","suites":["gatsby-source-medium","sourceNodes"],"updatePoint":{"line":23,"column":47,"index":688},"line":23,"code":"    it(`should create node based on medium data`, async () => {\n      await sourceNodes({\n        actions,\n        createNodeId,\n        createContentDigest\n      }, {\n        username: `foo`,\n        limit: 5\n      });\n      expect(actions.createNode).toBeCalled();\n      expect(actions.createNode.mock.calls).toMatchSnapshot();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-medium/src/__tests__"},{"name":"should call medium api with username and limit","suites":["gatsby-source-medium","sourceNodes"],"updatePoint":{"line":35,"column":54,"index":1033},"line":35,"code":"    it(`should call medium api with username and limit`, async () => {\n      const username = `foo`;\n      const limit = 5;\n      await sourceNodes({\n        actions,\n        createNodeId,\n        createContentDigest\n      }, {\n        username,\n        limit\n      });\n      expect(axios.get).toBeCalledWith(`https://medium.com/${username}/?format=json&limit=${limit}`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-medium/src/__tests__"},{"name":"it is a function","suites":[],"updatePoint":{"line":2,"column":22,"index":62},"line":2,"code":"test(`it is a function`, () => {\n  expect(mapping).toEqual(expect.any(Function));\n});","file":"mapping.js","skipped":false,"dir":"packages/gatsby-source-mongodb/src/__tests__"},{"name":"it returns an object","suites":[],"updatePoint":{"line":22,"column":26,"index":565},"line":22,"code":"test(`it returns an object`, () => {\n  expect(mapping(params.node, params.key, params.text, params.mediaType, params.createContentDigest)).toHaveProperty(`id`);\n  expect(mapping(params.node, params.key, params.text, params.mediaType, params.createContentDigest)).toHaveProperty(`parent`);\n  expect(mapping(params.node, params.key, params.text, params.mediaType, params.createContentDigest)).toHaveProperty(`children`);\n  expect(mapping(params.node, params.key, params.text, params.mediaType, params.createContentDigest)).toHaveProperty(`internal`);\n  expect(mapping(params.node, params.key, params.text, params.mediaType, params.createContentDigest)).toHaveProperty(`someKey`);\n});","file":"mapping.js","skipped":false,"dir":"packages/gatsby-source-mongodb/src/__tests__"},{"name":"it returns a transformed object","suites":[],"updatePoint":{"line":29,"column":37,"index":1258},"line":29,"code":"test(`it returns a transformed object`, () => {\n  const desiredResult = {\n    id: `someStringifiedObjectIdsomeKeyMappingNode`,\n    parent: `someStringifiedObjectId`,\n    someKey: `someText`,\n    children: [],\n    internal: {\n      type: `mongodbCloudsomeCollectionSomeKeyMappingNode`,\n      mediaType: `someMediaType`,\n      content: `someText`,\n      contentDigest: expect.any(String)\n    }\n  };\n  expect(mapping(params.node, params.key, params.text, params.mediaType, params.createContentDigest)).toMatchObject(desiredResult);\n});","file":"mapping.js","skipped":false,"dir":"packages/gatsby-source-mongodb/src/__tests__"},{"name":"removes unsupported characters from name","suites":[],"updatePoint":{"line":2,"column":44,"index":95},"line":2,"code":"it(`removes unsupported characters from name`, () => {\n  const name = `one-two-three`;\n  const output = sanitizeName(name);\n  expect(output).not.toContain(`-`);\n});","file":"sanitize-name.js","skipped":false,"dir":"packages/gatsby-source-mongodb/src/__tests__"},{"name":"ObjectIDs are not Equal to hexStrings with the same value","suites":[],"updatePoint":{"line":3,"column":63,"index":173},"line":3,"code":"test(`ObjectIDs are not Equal to hexStrings with the same value`, () => {\n  const objectId = new ObjectID();\n  expect(objectId).not.toEqual(objectId.toHexString());\n});","file":"stringify-object-ids.js","skipped":false,"dir":"packages/gatsby-source-mongodb/src/__tests__"},{"name":"it returns stringified object id when passed one","suites":[],"updatePoint":{"line":7,"column":54,"index":333},"line":7,"code":"test(`it returns stringified object id when passed one`, () => {\n  const objectId = new ObjectID();\n  expect(stringifyObjectIds(objectId)).toEqual(objectId.toHexString());\n  expect(stringifyObjectIds(objectId)).not.toEqual(objectId);\n});","file":"stringify-object-ids.js","skipped":false,"dir":"packages/gatsby-source-mongodb/src/__tests__"},{"name":"when passed an array of ObjectIDs it returns an array of strings","suites":[],"updatePoint":{"line":12,"column":70,"index":587},"line":12,"code":"test(`when passed an array of ObjectIDs it returns an array of strings`, () => {\n  const ids = [new ObjectID().toHexString(), new ObjectID().toHexString(), new ObjectID().toHexString()];\n  const arrOfObjectIds = ids.map(id => new ObjectID(id));\n  expect(stringifyObjectIds(arrOfObjectIds)).toEqual(ids);\n  expect(stringifyObjectIds(arrOfObjectIds)).not.toEqual(arrOfObjectIds);\n});","file":"stringify-object-ids.js","skipped":false,"dir":"packages/gatsby-source-mongodb/src/__tests__"},{"name":"when passed an array of object literals with ObjectIDs it returns an array of object literals with strings","suites":[],"updatePoint":{"line":18,"column":112,"index":1011},"line":18,"code":"test(`when passed an array of object literals with ObjectIDs it returns an array of object literals with strings`, () => {\n  const ids = [new ObjectID().toHexString(), new ObjectID().toHexString(), new ObjectID().toHexString()];\n  const arrayOfObjects = ids.map((id, ind) => {\n    return {\n      key: ind,\n      value: new ObjectID(id)\n    };\n  }, []);\n  const expectedResult = ids.map((id, ind) => {\n    return {\n      key: ind,\n      value: id\n    };\n  }, []);\n  expect(stringifyObjectIds(arrayOfObjects)).toEqual(expectedResult);\n  expect(stringifyObjectIds(arrayOfObjects)).not.toEqual(arrayOfObjects);\n});","file":"stringify-object-ids.js","skipped":false,"dir":"packages/gatsby-source-mongodb/src/__tests__"},{"name":"when passed a deeply nested, complex object literal, it returns all stringified ObjectIds within a nested, complex object literal","suites":[],"updatePoint":{"line":35,"column":135,"index":1645},"line":35,"code":"test(`when passed a deeply nested, complex object literal, it returns all stringified ObjectIds within a nested, complex object literal`, () => {\n  const ids = [new ObjectID().toHexString(), new ObjectID().toHexString(), new ObjectID().toHexString(), new ObjectID().toHexString(), new ObjectID().toHexString(), new ObjectID().toHexString()];\n  const complexNested = {\n    id: new ObjectID(ids[0]),\n    connections: [{\n      id: new ObjectID(ids[1])\n    }, {\n      ids: [new ObjectID(ids[2]), new ObjectID(ids[3])]\n    }],\n    name: {\n      first: `sally`,\n      last: {\n        maiden: {\n          val: `smith`,\n          id: new ObjectID(ids[4])\n        },\n        current: {\n          val: `wilson`,\n          id: new ObjectID(ids[5])\n        },\n        former: {\n          val: `smith`,\n          id: new ObjectID(ids[4])\n        }\n      }\n    }\n  };\n  const expectedResult = {\n    id: ids[0],\n    connections: [{\n      id: ids[1]\n    }, {\n      ids: [ids[2], ids[3]]\n    }],\n    name: {\n      first: `sally`,\n      last: {\n        maiden: {\n          val: `smith`,\n          id: ids[4]\n        },\n        current: {\n          val: `wilson`,\n          id: ids[5]\n        },\n        former: {\n          val: `smith`,\n          id: ids[4]\n        }\n      }\n    }\n  };\n  expect(stringifyObjectIds(complexNested)).toEqual(expectedResult);\n  expect(stringifyObjectIds(complexNested)).not.toEqual(complexNested);\n});","file":"stringify-object-ids.js","skipped":false,"dir":"packages/gatsby-source-mongodb/src/__tests__"},{"name":"should search with config keywords","suites":["gatsby-source-npm-package-search","sourceNodes","with readme"],"updatePoint":{"line":36,"column":44,"index":892},"line":36,"code":"      it(`should search with config keywords`, () => {\n        expect(browse.mock.calls[0]).toMatchSnapshot();\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-npm-package-search/src/__tests__"},{"name":"should create a package node for each search hit","suites":["gatsby-source-npm-package-search","sourceNodes","with readme"],"updatePoint":{"line":39,"column":58,"index":1027},"line":39,"code":"      it(`should create a package node for each search hit`, () => {\n        expect(actions.createNode.mock.calls[0]).toMatchSnapshot();\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-npm-package-search/src/__tests__"},{"name":"should create readme node for each search hit","suites":["gatsby-source-npm-package-search","sourceNodes","with readme"],"updatePoint":{"line":42,"column":55,"index":1171},"line":42,"code":"      it(`should create readme node for each search hit`, () => {\n        expect(actions.createNode.mock.calls[1]).toMatchSnapshot();\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-npm-package-search/src/__tests__"},{"name":"should fetch readme","suites":["gatsby-source-npm-package-search","sourceNodes","without readme"],"updatePoint":{"line":60,"column":29,"index":1650},"line":60,"code":"      it(`should fetch readme`, () => {\n        expect(got.get).toBeCalledWith(`https://unpkg.com/${packageName}/README.md`);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-source-npm-package-search/src/__tests__"},{"name":"generates an imagedata object","suites":["getShopifyImage"],"updatePoint":{"line":10,"column":35},"line":10,"code":"  it(`generates an imagedata object`, () => {\n    const data = getShopifyImage({ image, layout: `fullWidth` })\n    expect(data).toMatchSnapshot()\n  })","file":"get-shopify-image.ts","skipped":false,"dir":"packages/gatsby-source-shopify/__tests__"},{"name":"testing prioritize: , type: ","suites":["makeSourceFromOperation"],"updatePoint":{"line":162,"column":56},"line":162,"code":"    it(`testing prioritize: ${prioritize}, type: ${type}`, async () => {\n      const jsonLData = bulkResults.map(d => JSON.stringify(d)).join(os.EOL)\n      server.use(\n        rest.get(BULK_DATA_URL, (req, res, ctx) => res(ctx.text(jsonLData)))\n      )\n      const options = {\n        password: ``,\n        storeUrl: `my-shop.shopify.com`,\n        downloadImages: true,\n      }\n      const operations = createOperations(mockGatsbyApi(), options)\n\n      const finishLastOperation = jest.spyOn(operations, `finishLastOperation`)\n      const completedOperation = jest.spyOn(operations, `completedOperation`)\n      const cancelOperationInProgress = jest.spyOn(\n        operations,\n        `cancelOperationInProgress`\n      )\n      const gatsbyApi = mockGatsbyApi()\n      const pluginOptions = mockPluginOptions()\n\n      const sourceFromOperation = makeSourceFromOperation(\n        finishLastOperation,\n        completedOperation,\n        cancelOperationInProgress,\n        gatsbyApi,\n        { ...pluginOptions, prioritize }\n      )\n\n      await sourceFromOperation(operations.productsOperation)\n\n      const { createNode } = gatsbyApi.actions\n\n      expect(createNode).toHaveBeenCalledTimes(bulkResults.length)\n      expect(cancelOperationInProgress.mock.calls.length).toEqual(\n        prioritize ? 1 : 0\n      )\n      expect(finishLastOperation.mock.calls.length).toEqual(prioritize ? 0 : 1)\n\n      bulkResults.forEach(({ id }) => {\n        expect(createNode).toHaveBeenCalledWith(\n          expect.objectContaining({\n            shopifyId: id,\n          })\n        )\n      })\n    })","file":"source-from-operation.ts","skipped":false,"dir":"packages/gatsby-source-shopify/__tests__"},{"name":"successfully runs without delete events","suites":["updateCache"],"updatePoint":{"line":17,"column":45},"line":17,"code":"  it(`successfully runs without delete events`, async () => {\n    eventsApi.mockReturnValue({ fetchDestroyEventsSince: async () => [] })\n\n    await updateCache(gatsbyApi, pluginOptions, new Date(0))\n\n    expect(gatsbyApi.actions.touchNode.mock.calls.length).toEqual(21)\n    expect(gatsbyApi.actions.deleteNode.mock.calls.length).toEqual(0)\n  })","file":"update-cache.ts","skipped":false,"dir":"packages/gatsby-source-shopify/__tests__"},{"name":"successfully runs with delete events","suites":["updateCache"],"updatePoint":{"line":26,"column":42},"line":26,"code":"  it(`successfully runs with delete events`, async () => {\n    eventsApi.mockReturnValue({\n      fetchDestroyEventsSince: async () => mockShopifyEvents(`destroy`),\n    })\n\n    await updateCache(gatsbyApi, pluginOptions, new Date(0))\n\n    expect(gatsbyApi.actions.touchNode.mock.calls.length).toEqual(11)\n    expect(gatsbyApi.actions.deleteNode.mock.calls.length).toEqual(10)\n  })","file":"update-cache.ts","skipped":false,"dir":"packages/gatsby-source-shopify/__tests__"},{"name":"Docs have been generated by running \"yarn build\" or \"yarn generate-plugin-options-docs\"","suites":["Plugin options docs"],"updatePoint":{"line":5,"column":95,"index":264},"line":5,"code":"  test(`Docs have been generated by running \"yarn build\" or \"yarn generate-plugin-options-docs\"`, async () => {\n    const generatedDocsFileContents = await fs.readFile(path.join(__dirname, `../docs/plugin-options.md`), `utf-8`);\n    const mdString = await getPluginOptionsMdString();\n    expect(generatedDocsFileContents).toBeTruthy();\n    expect(mdString).toBeTruthy();\n    expect(generatedDocsFileContents).toEqual(mdString);\n  });","file":"docs-generation.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"handles 500 errors","suites":["fetchGraphQL helper"],"updatePoint":{"line":66,"column":26,"index":1674},"line":66,"code":"  test(`handles 500 errors`, withGlobalStore(async () => {\n    await fetchGraphQL({\n      query: 500,\n      url: `fake url`\n    });\n    expect(panicMessages[0]).toInclude(`Your WordPress server is either overloaded or encountered a PHP error.`);\n  }));","file":"fetch-graphql.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"handles 502, 503, and 504 errors","suites":["fetchGraphQL helper"],"updatePoint":{"line":73,"column":40,"index":1941},"line":73,"code":"  test(`handles 502, 503, and 504 errors`, withGlobalStore(async () => {\n    const errorMessage = `Your WordPress server at ${chalk.bold(`fake url`)} appears to be overloaded.`;\n    await fetchGraphQL({\n      query: 502,\n      url: `fake url`\n    });\n    expect(panicMessages[1]).toInclude(errorMessage);\n    await fetchGraphQL({\n      query: 503,\n      url: `fake url`\n    });\n    expect(panicMessages[2]).toInclude(errorMessage);\n    await fetchGraphQL({\n      query: 504,\n      url: `fake url`\n    });\n    expect(panicMessages[3]).toInclude(errorMessage);\n  }));","file":"fetch-graphql.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"errors when WPGraphQL is not active","suites":["fetchGraphQL helper"],"updatePoint":{"line":91,"column":43,"index":2510},"line":91,"code":"  test(`errors when WPGraphQL is not active`, withGlobalStore(async () => {\n    await fetchGraphQL({\n      query: `wpgraphql-deactivated`,\n      url: `fake url`\n    });\n    expect(panicMessages[4]).toInclude(`Unable to connect to WPGraphQL.`);\n  }));","file":"fetch-graphql.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"should properly download multiple pages","suites":["fetch-referenced-media-items","fetchMediaItemsBySourceUrl"],"updatePoint":{"line":58,"column":47,"index":1552},"line":58,"code":"    it(`should properly download multiple pages`, withGlobalStore(async () => {\n      fetchGraphql.mockResolvedValueOnce({\n        data: {\n          mediaItem__index_0: null,\n          mediaItem__index_1: null\n        }\n      }).mockResolvedValueOnce({\n        data: {\n          mediaItem__index_2: {\n            id: 2,\n            mediaItemUrl: `https://wordpress.host/wp-content/uploads/2018/05/file1.mp3`\n          },\n          mediaItem__index_3: {\n            id: 3,\n            mediaItemUrl: `https://wordpress.host/wp-content/uploads/2018/05/file1.mp3`\n          }\n        }\n      }).mockResolvedValueOnce({\n        data: {\n          mediaItem__index_4: null,\n          mediaItem__index_5: null\n        }\n      }).mockResolvedValueOnce({\n        data: {\n          mediaItem__index_6: null,\n          mediaItem__index_7: null\n        }\n      });\n      const result = await fetchMediaItemsBySourceUrl({\n        mediaItemUrls: [`https://wordpress.host/wp-content/uploads/2018/05/file1.mp3?_=7`, `https://wordpress.host/wp-content/uploads/2018/05/file2.mp3?_=7`, `https://wordpress.host/wp-content/uploads/2018/05/file1.mp3`, `https://wordpress.host/wp-content/uploads/2018/05/file2.mp3`],\n        createContentDigest,\n        helpers: createApi()\n      });\n      expect(result).toHaveLength(2);\n    }));","file":"fetch-referenced-media-items.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"should properly download a single page if there is only 1","suites":["fetch-referenced-media-items","fetchMediaItemsBySourceUrl"],"updatePoint":{"line":93,"column":65,"index":2878},"line":93,"code":"    it(`should properly download a single page if there is only 1`, withGlobalStore(async () => {\n      getStore().dispatch.gatsbyApi.setState({\n        pluginOptions: {\n          schema: {\n            perPage: 5\n          }\n        }\n      });\n      fetchGraphql.mockResolvedValueOnce({\n        data: {\n          mediaItem__index_0: {\n            id: 0,\n            mediaItemUrl: `https://wordpress.host/wp-content/uploads/2018/05/single-page-file1.mp3`\n          },\n          mediaItem__index_1: {\n            id: 1,\n            mediaItemUrl: `https://wordpress.host/wp-content/uploads/2018/05/single-page-file1.mp3`\n          }\n        }\n      });\n      const result = await fetchMediaItemsBySourceUrl({\n        mediaItemUrls: [`https://wordpress.host/wp-content/uploads/2018/05/single-page-file1.mp3`, `https://wordpress.host/wp-content/uploads/2018/05/single-page-file2.mp3`],\n        selectionSet: `id\\nmediaItemUrl`,\n        createContentDigest,\n        helpers: createApi()\n      });\n      expect(result).toHaveLength(2);\n    }));","file":"fetch-referenced-media-items.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"should properly download multiple pages of ids","suites":["fetch-referenced-media-items","fetchMediaItemsById"],"updatePoint":{"line":135,"column":54,"index":4238},"line":135,"code":"    it(`should properly download multiple pages of ids`, withGlobalStore(async () => {\n      getNodeMock.mockReturnValueOnce(undefined).mockReturnValueOnce(undefined).mockReturnValueOnce(undefined).mockReturnValueOnce(undefined).mockReturnValueOnce({\n        localFile: {\n          id: 0\n        }\n      }).mockReturnValueOnce({\n        localFile: {\n          id: 1\n        }\n      }).mockReturnValueOnce({\n        localFile: {\n          id: 2\n        }\n      }).mockReturnValueOnce({\n        localFile: {\n          id: 3\n        }\n      });\n      getStore().dispatch.gatsbyApi.setState({\n        pluginOptions: {\n          schema: {\n            perPage: 2\n          }\n        }\n      });\n      fetchGraphql.mockResolvedValueOnce({\n        data: {\n          mediaItems: {\n            nodes: [{\n              id: 0,\n              mediaItemUrl: `https://wordpress.host/wp-content/uploads/2018/05/file1.mp3`\n            }, {\n              id: 1,\n              mediaItemUrl: `https://wordpress.host/wp-content/uploads/2018/05/file1.mp3`\n            }]\n          }\n        }\n      }).mockResolvedValueOnce({\n        data: {\n          mediaItems: {\n            nodes: [{\n              id: 2,\n              mediaItemUrl: `https://wordpress.host/wp-content/uploads/2018/05/file2.mp3`\n            }, {\n              id: 3,\n              mediaItemUrl: `https://wordpress.host/wp-content/uploads/2018/05/file3.mp3`\n            }]\n          }\n        }\n      });\n      const result = await fetchMediaItemsById({\n        mediaItemIds: [btoa(`attachment:1`), btoa(`attachment:2`), btoa(`attachment:3`), btoa(`attachment:4`)],\n        settings: {\n          limit: 5\n        },\n        typeInfo: {\n          pluralName: `mediaItems`,\n          nodesTypeName: `MediaItem`\n        },\n        createContentDigest,\n        helpers: createApi()\n      });\n      expect(result).toHaveLength(4);\n    }));","file":"fetch-referenced-media-items.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"should properly download a single page of ids if there is only 1","suites":["fetch-referenced-media-items","fetchMediaItemsById"],"updatePoint":{"line":199,"column":72,"index":6137},"line":199,"code":"    it(`should properly download a single page of ids if there is only 1`, withGlobalStore(async () => {\n      getNodeMock.mockReturnValueOnce(undefined).mockReturnValueOnce(undefined).mockReturnValueOnce({\n        localFile: {\n          id: 0\n        }\n      }).mockReturnValueOnce({\n        localFile: {\n          id: 1\n        }\n      });\n      getStore().dispatch.gatsbyApi.setState({\n        pluginOptions: {\n          schema: {\n            perPage: 5\n          }\n        }\n      });\n      fetchGraphql.mockResolvedValueOnce({\n        data: {\n          mediaItems: {\n            nodes: [{\n              id: 0,\n              mediaItemUrl: `https://wordpress.host/wp-content/uploads/2018/05/file1.mp3`\n            }, {\n              id: 1,\n              mediaItemUrl: `https://wordpress.host/wp-content/uploads/2018/05/file1.mp3`\n            }]\n          }\n        }\n      });\n      const result = await fetchMediaItemsById({\n        mediaItemIds: [btoa(`attachment:1`), btoa(`attachment:2`)],\n        settings: {\n          limit: 5\n        },\n        typeInfo: {\n          pluralName: `mediaItems`,\n          nodesTypeName: `MediaItem`\n        },\n        selectionSet: `id\\nmediaItemUrl`,\n        createContentDigest,\n        helpers: createApi()\n      });\n      expect(result).toHaveLength(2);\n    }));","file":"fetch-referenced-media-items.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"should validate a minimal, valid config","suites":["pluginOptionsSchema"],"updatePoint":{"line":4,"column":45,"index":253},"line":4,"code":"  it(`should validate a minimal, valid config`, async () => {\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      url: `http://localhost:8000/graphql`\n    });\n    expect(isValid).toEqual(true);\n    expect(errors).toEqual([]);\n  });","file":"plugin-options-schema.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"should invalidate a config missing required vars","suites":["pluginOptionsSchema"],"updatePoint":{"line":14,"column":54,"index":549},"line":14,"code":"  it(`should invalidate a config missing required vars`, async () => {\n    const expectedErrors = [`\"url\" is required`];\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {});\n    expect(isValid).toEqual(false);\n    expect(errors).toEqual(expectedErrors);\n  });","file":"plugin-options-schema.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"should validate a fully custom config","suites":["pluginOptionsSchema"],"updatePoint":{"line":23,"column":43,"index":849},"line":23,"code":"  it(`should validate a fully custom config`, async () => {\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      url: `https://fakeurl.com/graphql`,\n      verbose: false,\n      debug: {\n        throwRefetchErrors: true,\n        graphql: {\n          showQueryOnError: false,\n          showQueryVarsOnError: false,\n          copyQueryOnError: false,\n          panicOnError: false,\n          onlyReportCriticalErrors: true,\n          copyNodeSourcingQueryAndExit: false,\n          writeQueriesToDisk: false\n        },\n        timeBuildSteps: false,\n        disableCompatibilityCheck: false\n      },\n      develop: {\n        nodeUpdateInterval: 300,\n        hardCacheMediaFiles: false,\n        hardCacheData: false\n      },\n      production: {\n        hardCacheMediaFiles: false\n      },\n      auth: {\n        htaccess: {\n          username: `test`,\n          password: `test`\n        }\n      },\n      schema: {\n        queryDepth: 15,\n        circularQueryLimit: 5,\n        typePrefix: `Wp`,\n        timeout: 30 * 1000,\n        // 30 seconds\n        perPage: 100\n      },\n      excludeFieldNames: [],\n      html: {\n        useGatsbyImage: true,\n        imageMaxWidth: null,\n        fallbackImageMaxWidth: 100,\n        imageQuality: 90,\n        createStaticFiles: true\n      },\n      type: {\n        __all: {\n          excludeFieldNames: [`viewer`]\n        },\n        RootQuery: {\n          excludeFieldNames: [`schemaMd5`]\n        },\n        MediaItem: {\n          lazyNodes: true,\n          localFile: {\n            excludeByMimeTypes: [`video/mp4`],\n            maxFileSizeBytes: 1400000\n          }\n        },\n        ContentNode: {\n          nodeInterface: true\n        },\n        Menu: {\n          beforeChangeNode: () => {}\n        },\n        MenuItem: {\n          beforeChangeNode: null\n        },\n        Page: {\n          beforeChangeNode: `./docs-generation.test.js`\n        },\n        Post: {\n          beforeChangeNode: () => {\n            console.log(`Hi from an inline fn!`);\n          }\n        },\n        EnqueuedScript: {\n          exclude: true\n        },\n        EnqueuedThing: {\n          exclude: null\n        }\n      }\n    });\n    expect(isValid).toEqual(true);\n    expect(errors).toEqual([]);\n  });","file":"plugin-options-schema.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"HTML image transformation regex matches images","suites":[],"updatePoint":{"line":11,"column":52,"index":578},"line":11,"code":"test(`HTML image transformation regex matches images`, async () => {\n  const nodeString = `<img src=\\\\\"https://${wpUrl}/wp-content/uploads/2020/01/SDM-Yep-Hi-000-Header.jpg\\\\\" />\n\n  <img src=\\\\\"http://${wpUrl}/wp-content/uploads/2020/01/SDM-Yep-Hi-000-Header.jpg\\\\\" />\n\n  <img src=\\\\\"/wp-content/uploads/2020/01/SDM-Yep-Hi-000-Header.jpg\\\\\" />`;\n  const matches = getImgSrcRemoteFileMatchesFromNodeString(nodeString);\n  expect(matches.length).toBe(3);\n  const imgTagMatches = getImgTagMatches({\n    nodeString,\n    wpUrl: `https://${wpUrl}`\n  });\n  expect(imgTagMatches.length).toBe(3);\n});","file":"process-node.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"HTML link transformation regex matches links","suites":[],"updatePoint":{"line":25,"column":50,"index":1173},"line":25,"code":"test(`HTML link transformation regex matches links`, withGlobalStore(async () => {\n  const nodeString = `<a href=\\\\\"https://${wpUrl}/wp-content/uploads/2020/01/SDM-Yep-Hi-000-Header.jpg\\\\\" />Not a transformable link</a>\n\n  <a href=\\\\\"https://other-site.com/hi\\\\\" />Not a transformable link</a>\n\n  <a href=\\\\\"https://${wpUrl}/page-1\\\\\">\n    page 1\n  </a>\n\n  <a href=\\\\\"https://${wpUrl}/\\\\\">Home</a>`;\n  const wpLinkRegex = getWpLinkRegex(`https://${wpUrl}`);\n  const matches = execall(wpLinkRegex, nodeString);\n  expect(matches.length).toBe(2);\n}));","file":"process-node.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"Search and replace node strings using regex matches","suites":[],"updatePoint":{"line":39,"column":57,"index":1731},"line":39,"code":"test(`Search and replace node strings using regex matches`, withGlobalStore(async () => {\n  const nodeString = `Some stuff in a random string\n\n  A new line with some stuff!\n\n  We need to test some <a href=\\\\\"https://old-site.com/hi\\\\\" />link</a> as well!`;\n  const result = searchAndReplaceNodeStrings({\n    nodeString,\n    node: {\n      __typename: `FakeTypeName`,\n      id: `cG9zdDo0OQ==`\n    },\n    pluginOptions: {\n      searchAndReplace: [{\n        search: /(S|s)ome stuff/gm,\n        replace: `some other thing`\n      }, {\n        search: `https://old-site.com`,\n        replace: `https://new-site.com`\n      }]\n    }\n  });\n  expect(result).toBe(`some other thing in a random string\n\n  A new line with some other thing!\n\n  We need to test some <a href=\\\\\"https://new-site.com/hi\\\\\" />link</a> as well!`);\n}));","file":"process-node.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"Gatsby Image service works in html fields via replaceNodeHtmlImages","suites":[],"updatePoint":{"line":74,"column":73,"index":2875},"line":74,"code":"test(`Gatsby Image service works in html fields via replaceNodeHtmlImages`, withGlobalStore(async () => {\n  const node = {\n    content: `\\n<p>Welcome to WordPress. This is your first post. Edit or deleteit, then start writing!</p>\\n\\n\\n\\n<p></p>\\n\\n\\n\\n<figureclass=\"wp-block-image size-large\"><img loading=\"lazy\" width=\"1024\" height=\"768\" src=\"http://wpgatsby.local/wp-content/uploads/2022/02/sasha-set-GURzQwO8Li0-unsplash-1024x768.jpg\" alt=\"\"class=\"wp-image-115\" srcset=\"http://wpgatsby.local/wp-content/uploads/2022/02/sasha-set-GURzQwO8Li0-unsplash-1024x768.jpg 1024w,http://wpgatsby.local/wp-content/uploads/2022/02/sasha-set-GURzQwO8Li0-unsplash-300x225.jpg 300w, http://wpgatsby.local/wp-content/uploads/2022/02/sasha-set-GURzQwO8Li0-unsplash-768x576.jpg 768w,http://wpgatsby.local/wp-content/uploads/2022/02/sasha-set-GURzQwO8Li0-unsplash-1536x1152.jpg 1536w, http://wpgatsby.local/wp-content/uploads/2022/02/sasha-set-GURzQwO8Li0-unsplash-2048x1536.jpg 2048w\"sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure>\\n<figure class=\"wp-block-image size-large\"><img src=\"http://wpgatsby.local/wp-content/uploads/2022/04/gaussian2.svg\" alt=\"\" class=\"wp-image-11836\"/></figure>`,\n    id: `cG9zdDox`,\n    modifiedGmt: `2022-02-18T23:18:00`,\n    __typename: `Post`\n  };\n  const gatsbyImageUrlPart = `/_gatsby/image`;\n  const gatsbyFileUrlPart = `/_gatsby/file`;\n  const nodeString = JSON.stringify(node);\n  const updatedNodeString = await replaceNodeHtmlImages({\n    nodeString,\n    node,\n    helpers: {\n      reporter: console,\n      actions: {\n        addGatsbyImageSourceUrl: jest.fn(),\n        createJobV2: jest.fn()\n      }\n    },\n    wpUrl: `http://wpgatsby.local/`,\n    pluginOptions: {\n      html: {\n        useGatsbyImage: true\n      }\n    }\n  });\n  expect(updatedNodeString).not.toEqual(nodeString);\n  expect(updatedNodeString).toInclude(gatsbyImageUrlPart);\n  expect(updatedNodeString).toInclude(gatsbyFileUrlPart);\n  const imageMatches = execall(/\\/_gatsby\\/image/gm, updatedNodeString);\n  expect(imageMatches.length).toBe(15);\n  const fileMatches = execall(/\\/_gatsby\\/file/gm, updatedNodeString);\n  expect(fileMatches.length).toBe(1);\n  const transformedNodeStringNoHtmlImages = await replaceNodeHtmlImages({\n    nodeString,\n    node,\n    helpers: {\n      reporter: console,\n      actions: {\n        addGatsbyImageSourceUrl: jest.fn(),\n        createJobV2: jest.fn()\n      }\n    },\n    wpUrl: `http://wpgatsby.local/`,\n    pluginOptions: {\n      html: {\n        useGatsbyImage: false\n      }\n    }\n  });\n  expect(transformedNodeStringNoHtmlImages).toEqual(nodeString);\n  const noImageMatches = execall(/\\/_gatsby\\/image/gm, transformedNodeStringNoHtmlImages);\n  expect(noImageMatches.length).toBe(0);\n  expect(transformedNodeStringNoHtmlImages).not.toInclude(gatsbyImageUrlPart);\n  expect(transformedNodeStringNoHtmlImages).not.toInclude(gatsbyFileUrlPart);\n}));","file":"process-node.test.js","skipped":false,"dir":"packages/gatsby-source-wordpress/__tests__"},{"name":"Removes env, output and converts buffers to strings from execa output","suites":["Errors Helpers","sanitizeError"],"updatePoint":{"line":5,"column":77},"line":5,"code":"    it(`Removes env, output and converts buffers to strings from execa output`, () => {\n      const error = {\n        error: null,\n        cmd: `git commit -m\"test\"`,\n        file: `/bin/sh`,\n        args: [`/bin/sh`, `-c`, `git commit -m\"test`],\n        options: {\n          cwd: `here`,\n          shell: true,\n          envPairs: [`VERSION=1.2.3`],\n          stdio: [{}, {}, {}], // pipes\n        },\n        envPairs: [`VERSION=1.2.3`],\n\n        stderr: Buffer.from(`this is a an error`),\n        stdout: Buffer.from(`this is a test`),\n      }\n\n      const errorString = sanitizeError(error)\n\n      const sanitizedError = JSON.parse(errorString)\n\n      expect(sanitizedError.stderr).toStrictEqual(`this is a an error`)\n      expect(sanitizedError.stdout).toStrictEqual(`this is a test`)\n      expect(sanitizedError.envPairs).toBeUndefined()\n      expect(sanitizedError.options).toBeUndefined()\n    })","file":"error-helpers.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"Sanitizes current path from error stacktraces","suites":["Errors Helpers","sanitizeError"],"updatePoint":{"line":33,"column":53},"line":33,"code":"    it(`Sanitizes current path from error stacktraces`, () => {\n      const errorMessage = `this is a test`\n      let e\n      try {\n        throw new Error(errorMessage)\n      } catch (error) {\n        e = error\n      }\n      expect(e).toBeDefined()\n      expect(e.message).toEqual(errorMessage)\n      expect(e.stack).toEqual(expect.stringContaining(process.cwd()))\n\n      const sanitizedErrorString = sanitizeError(e)\n\n      expect(sanitizedErrorString).toEqual(\n        expect.stringContaining(errorMessage)\n      )\n      expect(sanitizedErrorString).toEqual(\n        expect.not.stringContaining(process.cwd().replace(`\\\\`, `\\\\\\\\`))\n      )\n    })","file":"error-helpers.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"Sanitizes a section of the current path from error stacktrace","suites":["Errors Helpers","sanitizeError"],"updatePoint":{"line":55,"column":69},"line":55,"code":"    it(`Sanitizes a section of the current path from error stacktrace`, () => {\n      const errorMessage = `this is a test`\n\n      const e = {\n        message: errorMessage,\n        stack: `\n        Error: this is an error\n          at Object.<anonymous> (/Users/sidharthachatterjee/Code/gatsby-site/gatsby-config.js:1:32)\n          at Object.<anonymous> (/Users/sidharthachatterjee/Code/gatsby-site/node_module/gatsby-telemetry/blah.js:1:69)\n          at Object.<anonymous> (/Users/sidharthachatterjee/Code/gatsby-site/node_module/fake-path/index.js:1:41)\n          at Object.<anonymous> (/Users/sidharthachatterjee/.fake-path/index.js:1:69)\n          at Module._compile (internal/modules/cjs/loader.js:736:30)\n          at Object.Module._extensions..js (internal/modules/cjs/loader.js:747:10)\n          at Module.load (internal/modules/cjs/loader.js:628:32)\n          at tryModuleLoad (internal/modules/cjs/loader.js:568:12)\n          at Function.Module._load (internal/modules/cjs/loader.js:560:3)\n          at Function.Module.runMain (internal/modules/cjs/loader.js:801:12)\n          at executeUserCode (internal/bootstrap/node.js:526:15)\n          at startMainThreadExecution (internal/bootstrap/node.js:439:3)\n        `,\n      }\n\n      expect(e).toBeDefined()\n      expect(e.message).toEqual(errorMessage)\n      expect(e.stack).toBeDefined()\n\n      const mockCwd = jest\n        .spyOn(process, `cwd`)\n        .mockImplementation(() => `/Users/sidharthachatterjee/Code/gatsby-site`)\n\n      expect(e.stack).toEqual(expect.stringContaining(`sidharthachatterjee`))\n\n      const sanitizedErrorString = sanitizeError(e, `/`)\n\n      expect(sanitizedErrorString.includes(errorMessage)).toBe(true)\n      expect(sanitizedErrorString).toEqual(\n        expect.not.stringContaining(`sidharthachatterjee`)\n      )\n      const result = sanitizedErrorString.match(/\\$SNIP/g) as Array<string>\n      expect(result.length).toBe(4)\n\n      mockCwd.mockRestore()\n    })","file":"error-helpers.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"should clean path on unix: %s","suites":["Errors Helpers","cleanPaths"],"line":100,"code":"    it.each([`gatsby-config.js`, `src/pages/index.js`])(\n      `should clean path on unix: %s`,\n      filePath => {\n        const cwdMockPath = `/Users/username/gatsby-site`\n        const fullPath = `${cwdMockPath}/${filePath}`\n\n        const mockCwd = jest\n          .spyOn(process, `cwd`)\n          .mockImplementation(() => cwdMockPath)\n\n        const errorMessage = `This path ${fullPath} is a test ${fullPath}`\n\n        expect(cleanPaths(errorMessage, `/`)).toBe(\n          `This path $SNIP/${filePath} is a test $SNIP/${filePath}`\n        )\n        mockCwd.mockRestore()\n      }\n    )","file":"error-helpers.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"should clean path on windows: %s","suites":["Errors Helpers","cleanPaths"],"line":119,"code":"    it.each([`gatsby-config.js`, `src\\\\pages\\\\index.js`])(\n      `should clean path on windows: %s`,\n      filePath => {\n        const cwdMockPath = `C:\\\\Users\\\\username\\\\gatsby-site`\n        const fullPath = `${cwdMockPath}\\\\${filePath}`\n\n        const mockCwd = jest\n          .spyOn(process, `cwd`)\n          .mockImplementation(() => cwdMockPath)\n\n        const errorMessage = `This path ${fullPath} is a test ${fullPath}`\n\n        expect(cleanPaths(errorMessage, `\\\\`)).toBe(\n          `This path $SNIP\\\\${filePath} is a test $SNIP\\\\${filePath}`\n        )\n        mockCwd.mockRestore()\n      }\n    )","file":"error-helpers.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"getRepositoryId from git","suites":["Repository ID Helpers"],"updatePoint":{"line":10,"column":30},"line":10,"code":"  it(`getRepositoryId from git`, () => {\n    const cwdMockPath = `/Users/username/gatsby-site`\n    const mockCwd = jest\n      .spyOn(process, `cwd`)\n      .mockImplementation(() => cwdMockPath)\n\n    const { execSync } = require(`child_process`)\n    const mockGitRemote = `git@github.com:user/repo.git`\n    execSync.mockImplementation(() => mockGitRemote)\n\n    const id = getRepositoryId()\n\n    expect(id).toEqual({\n      repositoryId: `git:${hash(mockGitRemote)}`,\n      repositoryData: {\n        provider: hash(`github.com`),\n        owner: hash(`user`),\n        name: hash(`repo`),\n      },\n    })\n\n    mockCwd.mockRestore()\n    execSync.mockRestore()\n  })","file":"repository-id.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"getRepositoryId when git is broken","suites":["Repository ID Helpers"],"updatePoint":{"line":35,"column":40},"line":35,"code":"  it(`getRepositoryId when git is broken`, () => {\n    const cwdMockPath = `/Users/username/gatsby-site`\n    const mockCwd = jest\n      .spyOn(process, `cwd`)\n      .mockImplementation(() => cwdMockPath)\n\n    const { execSync } = require(`child_process`)\n    execSync.mockImplementation(() => {\n      throw new Error(`broken`)\n    })\n\n    const id = getRepositoryId()\n    expect(id).toEqual({ repositoryId: `pwd:${hash(`gatsby-site`)}` })\n\n    execSync.mockRestore()\n    mockCwd.mockRestore()\n  })","file":"repository-id.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"getRepositoryId when in netlify","suites":["Repository ID Helpers"],"updatePoint":{"line":53,"column":37},"line":53,"code":"  it(`getRepositoryId when in netlify`, () => {\n    const cwdMockPath = `/Users/username/gatsby-site`\n    const mockGitRemote = `github.com/user/repo`\n    const mockCwd = jest\n      .spyOn(process, `cwd`)\n      .mockImplementation(() => cwdMockPath)\n\n    const { execSync } = require(`child_process`)\n    execSync.mockImplementation(() => {\n      throw new Error(`broken`)\n    })\n\n    process.env.NETLIFY = `1`\n    process.env.REPOSITORY_URL = `https://x-access-token:v1.6a60ab57393b6e8a11baf6435ae6f8097157033d@github.com/user/repo`\n\n    // `https://x-access-token:v1.6xxxxxxxxxxxxxxxxx@github.com/user/repo`\n    const id = getRepositoryId()\n    expect(id).toEqual({\n      repositoryId: `git:${hash(mockGitRemote)}`,\n      repositoryData: {\n        provider: hash(`github.com`),\n        owner: hash(`user`),\n        name: hash(`repo`),\n      },\n    })\n\n    execSync.mockRestore()\n    mockCwd.mockRestore()\n  })","file":"repository-id.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"works with github urls ","suites":["Repository ID Helpers","Git repo metadata"],"updatePoint":{"line":88,"column":39},"line":88,"code":"      it(`works with github urls ${url}`, () => {\n        const metadata = getRepoMetadata(url)\n        expect(metadata).toEqual({\n          provider: hash(`github.com`),\n          owner: hash(`user`),\n          name: hash(`repo`),\n        })\n      })","file":"repository-id.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"Adds event to store","suites":["Telemetry"],"updatePoint":{"line":19,"column":25},"line":19,"code":"  it(`Adds event to store`, () => {\n    telemetry.buildAndStoreEvent(`demo`, {})\n    expect(EventStorage).toHaveBeenCalledTimes(1)\n    expect(\n      (EventStorage as jest.Mock).mock.instances[0].addEvent\n    ).toHaveBeenCalledTimes(2)\n  })","file":"telemetry.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"Doesn't add event to store if telemetry tracking is turned off","suites":["Telemetry"],"updatePoint":{"line":27,"column":68},"line":27,"code":"  it(`Doesn't add event to store if telemetry tracking is turned off`, () => {\n    ;(EventStorage as jest.Mock).mockReset()\n    telemetry = new AnalyticsTracker({ trackingEnabled: false })\n    telemetry.trackActivity(`demo`)\n    expect(\n      (EventStorage as jest.Mock).mock.instances[0].addEvent\n    ).not.toHaveBeenCalled()\n  })","file":"telemetry.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"Attaches feature list to the events","suites":["Telemetry","trackFeatureIsUsed"],"updatePoint":{"line":37,"column":43},"line":37,"code":"    it(`Attaches feature list to the events`, () => {\n      telemetry.trackFeatureIsUsed(`Foo:bar`)\n      telemetry.buildAndStoreEvent(`demo`, {})\n      expect(\n        (EventStorage as jest.Mock).mock.instances[0].addEvent\n      ).toHaveBeenCalledWith(\n        expect.objectContaining({\n          features: [`Foo:bar`],\n        })\n      )\n    })","file":"telemetry.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"allows overriding componentId","suites":["Telemetry","allows overriding defaults"],"updatePoint":{"line":51,"column":37},"line":51,"code":"    it(`allows overriding componentId`, () => {\n      const t = new AnalyticsTracker({\n        componentId: `desktop`,\n        gatsbyCliVersion: `1.2.3-beta1`,\n      })\n      t.buildAndStoreEvent(`demo`, {})\n      expect(\n        (EventStorage as jest.Mock).mock.instances[1].addEvent\n      ).toHaveBeenCalledWith(\n        expect.objectContaining({\n          componentId: `desktop`,\n          gatsbyCliVersion: `1.2.3-beta1`,\n        })\n      )\n    })","file":"telemetry.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"getTagsFromPath should read the file and detect updates","suites":["Telemetry","allows reading tags from path"],"updatePoint":{"line":69,"column":63},"line":69,"code":"    it(`getTagsFromPath should read the file and detect updates`, async () => {\n      const t = new AnalyticsTracker({\n        componentId: `component`,\n      })\n\n      // Test it when env not set\n      let res = t.getTagsFromPath()\n      expect(res).toMatchObject({})\n      expect(t.lastEnvTagsFromFileTime).toBe(0)\n\n      // create file and write initial data\n      const filePath = path.join(fs.realpathSync(os.tmpdir()), uuidv4())\n      console.log(filePath)\n      process.env.GATSBY_TELEMETRY_METADATA_PATH = filePath\n\n      fs.writeFileSync(filePath, JSON.stringify({ componentId: `test` }))\n      await new Promise(resolve => {\n        setTimeout(resolve, 2000)\n      })\n      // get it and make sure we see it and the ts matches\n      res = t.getTagsFromPath()\n      expect(res).toMatchObject({ componentId: `test` })\n      let stat = fs.statSync(filePath)\n      expect(t.lastEnvTagsFromFileTime).toBe(stat.mtimeMs)\n\n      // Update the file\n      fs.writeFileSync(filePath, JSON.stringify({ componentId: `test2` }))\n\n      await new Promise(resolve => {\n        setTimeout(resolve, 2000)\n      })\n      stat = fs.statSync(filePath)\n      // make sure we see the change\n      res = t.getTagsFromPath()\n      expect(t.lastEnvTagsFromFileTime).toBe(stat.mtimeMs)\n      expect(res).toMatchObject({ componentId: `test2` })\n\n      // read it with out updating\n      res = t.getTagsFromPath()\n      expect(t.lastEnvTagsFromFileTime).toBe(stat.mtimeMs)\n      expect(res).toMatchObject({ componentId: `test2` })\n      fs.unlinkSync(filePath)\n\n      const filePath2 = path.join(fs.realpathSync(os.tmpdir()), uuidv4())\n      process.env.GATSBY_TELEMETRY_METADATA_PATH = filePath2\n      res = t.getTagsFromPath()\n      expect(t.lastEnvTagsFromFileTime).toBe(stat.mtimeMs)\n      expect(res).toMatchObject({})\n    }, 10000)","file":"telemetry.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"getTagsFromPath is used for buildEvent","suites":["Telemetry","allows reading tags from path"],"updatePoint":{"line":120,"column":44},"line":120,"code":"  it(`getTagsFromPath is used for buildEvent`, async () => {\n    const t = new AnalyticsTracker({\n      componentId: `component`,\n    })\n    t.buildAndStoreEvent(`demo`, {})\n    expect(\n      (EventStorage as jest.Mock).mock.instances[1].addEvent\n    ).toHaveBeenCalledWith(\n      expect.objectContaining({\n        eventType: `demo`,\n        componentId: `component`,\n      })\n    )\n    const filePath = path.join(fs.realpathSync(os.tmpdir()), uuidv4())\n    process.env.GATSBY_TELEMETRY_METADATA_PATH = filePath\n    fs.writeFileSync(filePath, JSON.stringify({ componentId: `test` }))\n    await new Promise(resolve => {\n      setTimeout(resolve, 2000)\n    })\n    const stat = fs.statSync(filePath)\n    t.buildAndStoreEvent(`demo2`, {})\n\n    expect(t.lastEnvTagsFromFileTime).toBe(stat.mtimeMs)\n    expect(\n      (EventStorage as jest.Mock).mock.instances[1].addEvent\n    ).toHaveBeenCalledWith(\n      expect.objectContaining({\n        eventType: `demo2`,\n        componentId: `test`,\n      })\n    )\n\n    t.buildAndStoreEvent(`demo3`, {})\n    expect(\n      (EventStorage as jest.Mock).mock.instances[1].addEvent\n    ).toHaveBeenCalledWith(\n      expect.objectContaining({\n        eventType: `demo3`,\n        componentId: `test`,\n      })\n    )\n\n    expect(t.lastEnvTagsFromFileTime).toBe(stat.mtimeMs)\n\n    fs.writeFileSync(filePath, JSON.stringify({ componentId: `4` }))\n    await new Promise(resolve => {\n      setTimeout(resolve, 2000)\n    })\n    const stat2 = fs.statSync(filePath)\n\n    t.buildAndStoreEvent(`demo4`, {})\n    expect(t.lastEnvTagsFromFileTime).toBe(stat2.mtimeMs)\n    expect(\n      (EventStorage as jest.Mock).mock.instances[1].addEvent\n    ).toHaveBeenCalledWith(\n      expect.objectContaining({\n        eventType: `demo4`,\n        componentId: `4`,\n      })\n    )\n    fs.unlinkSync(filePath)\n  }, 10000)","file":"telemetry.ts","skipped":false,"dir":"packages/gatsby-telemetry/src/__tests__"},{"name":"should do nothing when extension is not allowed","suites":["gatsby-transformer-asciidoc"],"updatePoint":{"line":49,"column":53,"index":1276},"line":49,"code":"  it(`should do nothing when extension is not allowed`, async () => {\n    node.extension = `foo`;\n    const shouldCreateNode = shouldOnCreateNode({\n      node\n    }, {});\n    if (shouldCreateNode) {\n      await onCreateNode({\n        node,\n        actions,\n        loadNodeContent,\n        createNodeId,\n        createContentDigest\n      }, {});\n    }\n    expect(actions.createNode).not.toHaveBeenCalled();\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-asciidoc/src/__tests__"},{"name":"should enhance available extension","suites":["gatsby-transformer-asciidoc"],"updatePoint":{"line":65,"column":40,"index":1676},"line":65,"code":"  it(`should enhance available extension`, async () => {\n    node.extension = `ad`;\n    const shouldCreateNode = shouldOnCreateNode({\n      node\n    }, {\n      fileExtensions: [`ad`]\n    });\n    if (shouldCreateNode) {\n      await onCreateNode({\n        node,\n        actions,\n        loadNodeContent,\n        createNodeId,\n        createContentDigest\n      }, {\n        fileExtensions: [`ad`]\n      });\n    }\n    expect(actions.createNode).toHaveBeenCalled();\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-asciidoc/src/__tests__"},{"name":"should create node based on loaded asciidoc file","suites":["gatsby-transformer-asciidoc"],"updatePoint":{"line":85,"column":54,"index":2157},"line":85,"code":"  it(`should create node based on loaded asciidoc file`, async () => {\n    const shouldCreateNode = shouldOnCreateNode({\n      node\n    }, {});\n    if (shouldCreateNode) {\n      await onCreateNode({\n        node,\n        actions,\n        loadNodeContent,\n        createNodeId,\n        createContentDigest\n      }, {});\n    }\n    expect(actions.createNode).toHaveBeenCalledWith({\n      author: null,\n      children: [],\n      document: {\n        main: `main`,\n        subtitle: `subtitle`,\n        title: `title`\n      },\n      html: `html generated`,\n      id: `dummy >>> ASCIIDOC`,\n      internal: {\n        contentDigest: `digest`,\n        mediaType: `text/html`,\n        type: `Asciidoc`\n      },\n      pageAttributes: {},\n      parent: `dummy`,\n      revision: null\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-asciidoc/src/__tests__"},{"name":"correctly creates nodes from JSON which is an array of objects","suites":["Process nodes correctly"],"updatePoint":{"line":30,"column":68,"index":670},"line":30,"code":"  it(`correctly creates nodes from JSON which is an array of objects`, async () => {\n    const fields = [`blue`, `funny`];\n    const data = [{\n      blue: true,\n      funny: `yup`\n    }, {\n      blue: false,\n      funny: `nope`\n    }];\n    const csv = json2csv(data, {\n      fields\n    });\n    node.content = csv;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(2);\n      expect(createParentChildLink).toHaveBeenCalledTimes(2);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-csv/src/__tests__"},{"name":"correctly handles the noheader option","suites":["Process nodes correctly"],"updatePoint":{"line":65,"column":43,"index":1668},"line":65,"code":"  it(`correctly handles the noheader option`, async () => {\n    node.content = `blue,funny\\ntrue,yup\\nfalse,nope`;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }, {\n      noheader: true\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(3);\n      expect(createParentChildLink).toHaveBeenCalledTimes(3);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-csv/src/__tests__"},{"name":"allows other extensions to be used for input files","suites":["Process nodes correctly"],"updatePoint":{"line":91,"column":56,"index":2535},"line":91,"code":"  it(`allows other extensions to be used for input files`, async () => {\n    const tsvNode = cloneDeep(node);\n    tsvNode.extension = `ksv`;\n    tsvNode.internal.mediaType = `text/ksv`;\n    tsvNode.content = `blue\\tfunny\\ntrue\\tyup\\nfalse\\tnope`;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node: tsvNode,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }, {\n      noheader: true,\n      extensions: [`ksv`],\n      delimiter: `\\t`\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(3);\n      expect(createParentChildLink).toHaveBeenCalledTimes(3);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-csv/src/__tests__"},{"name":"passes through the delimiter option","suites":["Process nodes correctly"],"updatePoint":{"line":122,"column":41,"index":3565},"line":122,"code":"  it(`passes through the delimiter option`, async () => {\n    const tsvNode = cloneDeep(node);\n    tsvNode.extension = `tsv`;\n    tsvNode.internal.mediaType = `text/tsv`;\n    tsvNode.content = `blue\\tfunny\\ntrue\\tyup\\nfalse\\tnope`;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node: tsvNode,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }, {\n      noheader: true,\n      extensions: [`tsv`],\n      delimiter: `\\t`\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(3);\n      expect(createParentChildLink).toHaveBeenCalledTimes(3);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-csv/src/__tests__"},{"name":"correctly handles the typeName option with the provided typeNameFromFile function","suites":["Process nodes correctly"],"updatePoint":{"line":153,"column":87,"index":4641},"line":153,"code":"  it(`correctly handles the typeName option with the provided typeNameFromFile function`, async () => {\n    node.name = `theQueryShouldMatch`;\n    node.content = `letter,number\\na,65\\nb,42\\nc,23`;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }, {\n      typeName: typeNameFromFile\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(3);\n      expect(createParentChildLink).toHaveBeenCalledTimes(3);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-csv/src/__tests__"},{"name":"correctly handles the typeName option with the provided typeNameFromDir function","suites":["Process nodes correctly"],"updatePoint":{"line":180,"column":86,"index":5588},"line":180,"code":"  it(`correctly handles the typeName option with the provided typeNameFromDir function`, async () => {\n    node.name = `theTypeWontBeThis`;\n    node.content = `letter,number\\na,65\\nb,42\\nc,23`;\n    node.dir = `${os.tmpdir()}/foo/`; // The type will be FooCsv\n    node.internal.type = `File`;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }, {\n      typeName: typeNameFromDir\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(3);\n      expect(createParentChildLink).toHaveBeenCalledTimes(3);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-csv/src/__tests__"},{"name":"correctly handles the typeName option with a custom function","suites":["Process nodes correctly"],"updatePoint":{"line":209,"column":66,"index":6610},"line":209,"code":"  it(`correctly handles the typeName option with a custom function`, async () => {\n    node.name = `theTypeWontBeThis`;\n    node.content = `letter,number\\na,65\\nb,42\\nc,23`;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }, {\n      typeName: ({\n        node,\n        object\n      }) => `CsvTypeSetByFunction`\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(3);\n      expect(createParentChildLink).toHaveBeenCalledTimes(3);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-csv/src/__tests__"},{"name":"correctly handles the typeName option with a string","suites":["Process nodes correctly"],"updatePoint":{"line":239,"column":57,"index":7576},"line":239,"code":"  it(`correctly handles the typeName option with a string`, async () => {\n    node.name = `theTypeWontBeThis`;\n    node.content = `letter,number\\na,65\\nb,42\\nc,23`;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }, {\n      typeName: `CsvTypeSetByFunction`\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(3);\n      expect(createParentChildLink).toHaveBeenCalledTimes(3);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-csv/src/__tests__"},{"name":"correctly handles the nodePerFile option in the false case","suites":["Process nodes correctly"],"updatePoint":{"line":266,"column":64,"index":8505},"line":266,"code":"  it(`correctly handles the nodePerFile option in the false case`, async () => {\n    node.name = `theTypeWillBeThis`;\n    node.content = `letter,number\\na,65\\nb,42\\nc,23`;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }, {\n      nodePerFile: false\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(3);\n      expect(createParentChildLink).toHaveBeenCalledTimes(3);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-csv/src/__tests__"},{"name":"correctly handles the nodePerFile option in the true case","suites":["Process nodes correctly"],"updatePoint":{"line":293,"column":63,"index":9419},"line":293,"code":"  it(`correctly handles the nodePerFile option in the true case`, async () => {\n    node.name = `theTypeWillBeThis`;\n    node.content = `letter,number\\na,65\\nb,42\\nc,23`;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }, {\n      nodePerFile: true\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(1);\n      expect(createParentChildLink).toHaveBeenCalledTimes(1);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-csv/src/__tests__"},{"name":"correctly handles the nodePerFile option in the string case","suites":["Process nodes correctly"],"updatePoint":{"line":320,"column":65,"index":10334},"line":320,"code":"  it(`correctly handles the nodePerFile option in the string case`, async () => {\n    node.name = `theTypeWillBeThis`;\n    node.content = `letter,number\\na,65\\nb,42\\nc,23`;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }, {\n      nodePerFile: `theItems`\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(1);\n      expect(createParentChildLink).toHaveBeenCalledTimes(1);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-csv/src/__tests__"},{"name":"creates doc json apple node","suites":["gatsby-transformer-documentationjs: onCreateNode","Simple example ()"],"updatePoint":{"line":48,"column":37,"index":1516},"line":48,"code":"      it(`creates doc json apple node`, () => {\n        const appleNode = createdNodes.find(node => node.name === `apple`);\n        expect(appleNode).toBeDefined();\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should extract out a description, params, and examples","suites":["gatsby-transformer-documentationjs: onCreateNode","Simple example ()"],"updatePoint":{"line":52,"column":64,"index":1718},"line":52,"code":"      it(`should extract out a description, params, and examples`, () => {\n        const appleNode = createdNodes.find(node => node.name === `apple`);\n        expect(appleNode.examples.length).toBe(1);\n        expect(appleNode.examples[0]).toMatchSnapshot(`example`);\n        const appleDescriptionNode = createdNodes.find(node => node.id === appleNode.description___NODE);\n        expect(appleDescriptionNode).toBeDefined();\n        expect(appleDescriptionNode.internal.content).toMatchSnapshot(`description content`);\n        const paramNode = createdNodes.find(node => node.id === appleNode.params___NODE[0]);\n        expect(paramNode).toBeDefined();\n        expect(paramNode.name).toMatchSnapshot(`param name`);\n        const paramDescriptionNode = createdNodes.find(node => node.id === paramNode.description___NODE);\n        expect(paramDescriptionNode).toBeDefined();\n        expect(paramDescriptionNode.internal.content).toMatchSnapshot(`param description`);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should extract out a captions from examples","suites":["gatsby-transformer-documentationjs: onCreateNode","Simple example ()"],"updatePoint":{"line":66,"column":53,"index":2683},"line":66,"code":"      it(`should extract out a captions from examples`, () => {\n        const pearNode = createdNodes.find(node => node.name === `pear`);\n        expect(pearNode.examples.length).toBe(2);\n        expect(pearNode.examples).toMatchSnapshot(`examplesWithCaptions`);\n        expect(pearNode.examples[1].caption).toBeDefined();\n        const pearDescriptionNode = createdNodes.find(node => node.id === pearNode.description___NODE);\n        expect(pearDescriptionNode).toBeDefined();\n        expect(pearDescriptionNode.internal.content).toMatchSnapshot(`description content`);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should extract code and docs location","suites":["gatsby-transformer-documentationjs: onCreateNode","Simple example ()"],"updatePoint":{"line":75,"column":47,"index":3258},"line":75,"code":"      it(`should extract code and docs location`, () => {\n        const appleNode = createdNodes.find(node => node.name === `apple`);\n        expect(appleNode.docsLocation).toBeDefined();\n        expect(appleNode.docsLocation).toEqual(expect.objectContaining({\n          start: expect.objectContaining({\n            line: 1\n          }),\n          end: expect.objectContaining({\n            line: 7\n          })\n        }));\n        expect(appleNode.codeLocation).toBeDefined();\n        expect(appleNode.codeLocation).toEqual(expect.objectContaining({\n          start: expect.objectContaining({\n            line: 8\n          }),\n          end: expect.objectContaining({\n            line: 10\n          })\n        }));\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"doesn't create multiple nodes with same id","suites":["gatsby-transformer-documentationjs: onCreateNode","Simple example ()"],"updatePoint":{"line":96,"column":52,"index":3990},"line":96,"code":"      it(`doesn't create multiple nodes with same id`, () => {\n        const groupedById = groupBy(createdNodes, `id`);\n        Object.keys(groupedById).forEach(id => expect(groupedById[id].length).toBe(1));\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should create top-level node for callback","suites":["gatsby-transformer-documentationjs: onCreateNode","Complex example"],"updatePoint":{"line":108,"column":49,"index":4386},"line":108,"code":"    it(`should create top-level node for callback`, () => {\n      callbackNode = createdNodes.find(node => node.name === `CallbackType` && node.kind === `typedef` && node.parent === `node_1`);\n      expect(callbackNode).toBeDefined();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should create top-level node for typedef","suites":["gatsby-transformer-documentationjs: onCreateNode","Complex example","should handle typedefs"],"updatePoint":{"line":113,"column":50,"index":4677},"line":113,"code":"      it(`should create top-level node for typedef`, () => {\n        typedefNode = createdNodes.find(node => node.name === `ObjectType` && node.kind === `typedef` && node.parent === `node_1`);\n        expect(typedefNode).toBeDefined();\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should have property nodes for typedef","suites":["gatsby-transformer-documentationjs: onCreateNode","Complex example","should handle typedefs"],"updatePoint":{"line":119,"column":48,"index":4964},"line":119,"code":"      it(`should have property nodes for typedef`, () => {\n        expect(typedefNode.properties___NODE).toBeDefined();\n        expect(typedefNode.properties___NODE.length).toBe(2);\n        [readyNode, nestedNode] = typedefNode.properties___NODE.map(paramID => createdNodes.find(node => node.id === paramID));\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should handle type applications","suites":["gatsby-transformer-documentationjs: onCreateNode","Complex example","should handle typedefs"],"updatePoint":{"line":124,"column":41,"index":5277},"line":124,"code":"      it(`should handle type applications`, () => {\n        expect(readyNode).toMatchSnapshot();\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should have second param as nested object","suites":["gatsby-transformer-documentationjs: onCreateNode","Complex example","should handle typedefs"],"updatePoint":{"line":130,"column":51,"index":5479},"line":130,"code":"      it(`should have second param as nested object`, () => {\n        expect(nestedNode.name).toBe(`nested`);\n        expect(nestedNode.properties___NODE).toBeDefined();\n        expect(nestedNode.properties___NODE.length).toBe(3);\n        [nestedFooNode, nestedOptionalNode, nestedCallbackNode] = nestedNode.properties___NODE.map(paramID => createdNodes.find(node => node.id === paramID));\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should strip prefixes from nested nodes","suites":["gatsby-transformer-documentationjs: onCreateNode","Complex example","should handle typedefs"],"updatePoint":{"line":136,"column":49,"index":5877},"line":136,"code":"      it(`should strip prefixes from nested nodes`, () => {\n        expect(nestedFooNode.name).not.toContain(`nested`);\n        expect(nestedFooNode.name).toEqual(`foo`);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should handle optional types","suites":["gatsby-transformer-documentationjs: onCreateNode","Complex example","should handle typedefs"],"updatePoint":{"line":140,"column":38,"index":6047},"line":140,"code":"      it(`should handle optional types`, () => {\n        expect(nestedOptionalNode.name).toEqual(`optional`);\n        expect(nestedOptionalNode.optional).toEqual(true);\n        expect(nestedOptionalNode.type).toEqual(expect.objectContaining({\n          name: `number`,\n          type: `NameExpression`\n        }));\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should handle typedefs in nested properties","suites":["gatsby-transformer-documentationjs: onCreateNode","Complex example","should handle typedefs"],"updatePoint":{"line":148,"column":53,"index":6387},"line":148,"code":"      it(`should handle typedefs in nested properties`, () => {\n        expect(nestedCallbackNode.name).toEqual(`callback`);\n        expect(nestedCallbackNode.optional).toEqual(false);\n        expect(nestedCallbackNode.type).toEqual(expect.objectContaining({\n          name: `CallbackType`,\n          type: `NameExpression`,\n          typeDef___NODE: callbackNode.id\n        }));\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should create top-level node for complex type","suites":["gatsby-transformer-documentationjs: onCreateNode","Complex example","should handle members"],"updatePoint":{"line":164,"column":55,"index":7014},"line":164,"code":"      it(`should create top-level node for complex type`, () => {\n        expect(complexNode).toBeDefined();\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should have link from complex node to its members","suites":["gatsby-transformer-documentationjs: onCreateNode","Complex example","should handle members"],"updatePoint":{"line":167,"column":59,"index":7137},"line":167,"code":"      it(`should have link from complex node to its members`, () => {\n        expect(complexNode.members).toBeDefined();\n        expect(complexNode.members.static___NODE).toBeDefined();\n        expect(complexNode.members.static___NODE.length).toBe(1);\n        memberNode = createdNodes.find(node => node.id === complexNode.members.static___NODE[0]);\n        expect(memberNode).toBeDefined();\n        expect(memberNode.parent).toEqual(complexNode.id);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should handle type unions","suites":["gatsby-transformer-documentationjs: onCreateNode","Complex example","should handle members"],"updatePoint":{"line":175,"column":35,"index":7574},"line":175,"code":"      it(`should handle type unions`, () => {\n        expect(memberNode.type).toMatchSnapshot();\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should link to type to type definition","suites":["gatsby-transformer-documentationjs: onCreateNode","Complex example","should handle members"],"updatePoint":{"line":178,"column":48,"index":7694},"line":178,"code":"      it(`should link to type to type definition`, () => {\n        const typeElement = memberNode.type.elements.find(type => type.name === `ObjectType`);\n        expect(typeElement.typeDef___NODE).toBe(typedefNode.id);\n      });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"doesn't create multiple nodes with same id","suites":["gatsby-transformer-documentationjs: onCreateNode","Complex example","should handle members"],"updatePoint":{"line":183,"column":50,"index":7933},"line":183,"code":"    it(`doesn't create multiple nodes with same id`, () => {\n      const groupedById = groupBy(createdNodes, `id`);\n      Object.keys(groupedById).forEach(id => expect(groupedById[id].length).toBe(1));\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"doesn't create multiple nodes with same id","suites":["gatsby-transformer-documentationjs: onCreateNode","Free floating comments"],"updatePoint":{"line":192,"column":50,"index":8280},"line":192,"code":"    it(`doesn't create multiple nodes with same id`, () => {\n      const groupedById = groupBy(createdNodes, `id`);\n      Object.keys(groupedById).forEach(id => expect(groupedById[id].length).toBe(1));\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"merges JsDoc and flow types","suites":["gatsby-transformer-documentationjs: onCreateNode","JSDoc + Flow"],"updatePoint":{"line":201,"column":35,"index":8603},"line":201,"code":"    it(`merges JsDoc and flow types`, () => {\n      const firstParamNodes = createdNodes.filter(node => node.name === `$0`);\n      expect(firstParamNodes.length).toBe(1);\n      expect(firstParamNodes[0].properties___NODE.length).toBe(1);\n      const subField = createdNodes.find(node => node.id === firstParamNodes[0].properties___NODE[0]);\n      expect(subField).toBeDefined();\n      expect(subField.name).toBe(`nodeId`);\n      expect(subField.type).toEqual(expect.objectContaining({\n        name: `string`,\n        type: `NameExpression`\n      }));\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"flow: required param result in same data shape as JsDoc","suites":["gatsby-transformer-documentationjs: onCreateNode","JSDoc + Flow"],"updatePoint":{"line":213,"column":63,"index":9190},"line":213,"code":"    it(`flow: required param result in same data shape as JsDoc`, () => {\n      const requiredFlowParam = createdNodes.find(node => node.name === `requiredParam`);\n      expect(requiredFlowParam).toBeDefined();\n      expect(requiredFlowParam).toEqual(expect.objectContaining({\n        name: `requiredParam`,\n        optional: false,\n        type: expect.objectContaining({\n          name: `string`,\n          type: `NameExpression`\n        })\n      }));\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"flow: optional param result in same data shape as JsDoc","suites":["gatsby-transformer-documentationjs: onCreateNode","JSDoc + Flow"],"updatePoint":{"line":225,"column":63,"index":9652},"line":225,"code":"    it(`flow: optional param result in same data shape as JsDoc`, () => {\n      const optionalFlowParam = createdNodes.find(node => node.name === `optionalParam`);\n      expect(optionalFlowParam).toBeDefined();\n      expect(optionalFlowParam).toEqual(expect.objectContaining({\n        name: `optionalParam`,\n        optional: true,\n        type: expect.objectContaining({\n          name: `number`,\n          type: `NameExpression`\n        })\n      }));\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should extract create description nodes with markdown types","suites":["gatsby-transformer-documentationjs: onCreateNode","Sanity checks"],"updatePoint":{"line":239,"column":67,"index":10159},"line":239,"code":"    it(`should extract create description nodes with markdown types`, () => {\n      const types = groupBy(createdNodes, `internal.type`);\n      expect(types.DocumentationJSComponentDescription.every(d => d.internal.mediaType === `text/markdown`)).toBe(true);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"creates parent nodes before children","suites":["gatsby-transformer-documentationjs: onCreateNode","Sanity checks"],"updatePoint":{"line":243,"column":44,"index":10403},"line":243,"code":"    it(`creates parent nodes before children`, () => {\n      const seenNodes = [];\n      createdNodes.forEach(node => {\n        seenNodes.push(node.id);\n        node.children.forEach(childID => {\n          expect(seenNodes.includes(childID)).not.toBe(true);\n        });\n      });\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"should only process javascript File nodes","suites":["gatsby-transformer-documentationjs: onCreateNode","Sanity checks"],"updatePoint":{"line":252,"column":49,"index":10696},"line":252,"code":"    it(`should only process javascript File nodes`, async () => {\n      await run({\n        internal: {\n          mediaType: `text/x-foo`\n        }\n      });\n      expect(createdNodes.length).toBe(0);\n      await run({\n        internal: {\n          mediaType: `application/javascript`\n        }\n      });\n      expect(createdNodes.length).toBe(0);\n      await run(getFileNode(`code.js`));\n      expect(createdNodes.length).toBeGreaterThan(0);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"doesn't cause a stack overflow for nodes of the same name","suites":["gatsby-transformer-documentationjs: onCreateNode","Sanity checks"],"updatePoint":{"line":269,"column":63,"index":11167},"line":269,"code":"  it(`doesn't cause a stack overflow for nodes of the same name`, () => expect(run(getFileNode(`same-name.ts`))).resolves.toBeUndefined());","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-documentationjs/src/__tests__"},{"name":"correctly creates nodes from JSON which is an array of objects","suites":["Process nodes correctly"],"updatePoint":{"line":21,"column":68,"index":546},"line":21,"code":"  it(`correctly creates nodes from JSON which is an array of objects`, async () => {\n    const data = [[`blue`, `funny`], [true, `yup`], [false, `nope`]];\n    const csv = XLSX.utils.sheet_to_csv(XLSX.utils.aoa_to_sheet(data));\n    node.content = csv;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(2 + 1);\n      expect(createParentChildLink).toHaveBeenCalledTimes(2 + 1);\n      expect(createContentDigest).toHaveBeenCalledTimes(2 + 1);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-excel/src/__tests__"},{"name":"should correctly create nodes from JSON with raw option false","suites":["Process nodes correctly"],"updatePoint":{"line":48,"column":67,"index":1577},"line":48,"code":"  it(`should correctly create nodes from JSON with raw option false`, async () => {\n    const data = [[`red`, `veryfunny`], [true, `certainly`], [false, `nada`]];\n    const csv = XLSX.utils.sheet_to_csv(XLSX.utils.aoa_to_sheet(data));\n    node.content = csv;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }, {\n      raw: false\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(2 + 1);\n      expect(createParentChildLink).toHaveBeenCalledTimes(2 + 1);\n      expect(createContentDigest).toHaveBeenCalledTimes(2 + 1);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-excel/src/__tests__"},{"name":"should correctly create nodes from JSON with legacy rawOutput option false","suites":["Process nodes correctly"],"updatePoint":{"line":77,"column":80,"index":2656},"line":77,"code":"  it(`should correctly create nodes from JSON with legacy rawOutput option false`, async () => {\n    const data = [[`red`, `veryfunny`], [true, `certainly`], [false, `nada`]];\n    const csv = XLSX.utils.sheet_to_csv(XLSX.utils.aoa_to_sheet(data));\n    node.content = csv;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }, {\n      rawOutput: false\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(2 + 1);\n      expect(createParentChildLink).toHaveBeenCalledTimes(2 + 1);\n      expect(createContentDigest).toHaveBeenCalledTimes(2 + 1);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-excel/src/__tests__"},{"name":"correctly creates nodes from HJSON which is an array of objects","suites":["Process HJSON nodes correctly"],"updatePoint":{"line":22,"column":69,"index":592},"line":22,"code":"  it(`correctly creates nodes from HJSON which is an array of objects`, async () => {\n    const data = [{\n      id: `foo`,\n      blue: true,\n      funny: `yup`\n    }, {\n      blue: false,\n      funny: `nope`\n    }];\n    node.content = HJSON.stringify(data);\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(2);\n      expect(createParentChildLink).toHaveBeenCalledTimes(2);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-hjson/src/__tests__"},{"name":"correctly creates a node from HJSON which is a single object","suites":["Process HJSON nodes correctly"],"updatePoint":{"line":54,"column":66,"index":1556},"line":54,"code":"  it(`correctly creates a node from HJSON which is a single object`, async () => {\n    const data = {\n      id: `foo`,\n      blue: true,\n      funny: `yup`\n    };\n    node.content = HJSON.stringify(data);\n    node.dir = `${os.tmpdir()}/foo/`;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(1);\n      expect(createParentChildLink).toHaveBeenCalledTimes(1);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-hjson/src/__tests__"},{"name":"should loadNodeContent if file has extension $extension","suites":["gatsby-transformer-javascript-frontmatter","onCreateNode"],"line":37,"code":"    it.each`\n      extension\n      ${`js`}\n      ${`jsx`}\n      ${`ts`}\n      ${`tsx`}\n    `(`should loadNodeContent if file has extension $extension`, async ({\n      extension\n    }) => {\n      const shouldCreateNode = shouldOnCreateNode({\n        node: {\n          ...node,\n          extension\n        }\n      });\n      if (shouldCreateNode) {\n        await onCreateNode({\n          node: {\n            ...node,\n            extension\n          },\n          actions,\n          loadNodeContent,\n          createContentDigest\n        });\n      }\n      expect(loadNodeContent).toBeCalled();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-javascript-frontmatter/src/__tests__"},{"name":"should not loadNodeContent for not javascript file","suites":["gatsby-transformer-javascript-frontmatter","onCreateNode"],"updatePoint":{"line":65,"column":58,"index":1616},"line":65,"code":"    it(`should not loadNodeContent for not javascript file`, async () => {\n      const shouldCreateNode = shouldOnCreateNode({\n        node: {\n          ...node,\n          extension: `csv`\n        }\n      });\n      if (shouldCreateNode) {\n        await onCreateNode({\n          node: {\n            ...node,\n            extension: `csv`\n          },\n          actions,\n          loadNodeContent,\n          createContentDigest\n        });\n      }\n      expect(loadNodeContent).not.toBeCalled();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-javascript-frontmatter/src/__tests__"},{"name":"should load frontmatter data with exported object","suites":["gatsby-transformer-javascript-frontmatter","onCreateNode"],"updatePoint":{"line":85,"column":57,"index":2116},"line":85,"code":"    it(`should load frontmatter data with exported object`, async () => {\n      const shouldCreateNode = shouldOnCreateNode({\n        node\n      });\n      if (shouldCreateNode) {\n        await onCreateNode({\n          node,\n          actions,\n          loadNodeContent,\n          createContentDigest\n        });\n      }\n      expect(actions.createNode).toBeCalled();\n      expect(actions.createNode.mock.calls[0]).toMatchSnapshot();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-javascript-frontmatter/src/__tests__"},{"name":"should load frontmatter data from named export","suites":["gatsby-transformer-javascript-frontmatter","onCreateNode"],"updatePoint":{"line":100,"column":54,"index":2554},"line":100,"code":"    it(`should load frontmatter data from named export`, async () => {\n      loadNodeContent = jest.fn().mockReturnValue(`\n          export const frontmatter = {\n            title: \"Choropleth on d3v4\",\n            written: \"2017-05-04\",\n            layoutType: \"post\",\n            path: \"choropleth-on-d3v4\",\n            category: \"data science\",\n            description: \"Things about the choropleth.\",\n          }\n        `);\n      const shouldCreateNode = shouldOnCreateNode({\n        node\n      });\n      if (shouldCreateNode) {\n        await onCreateNode({\n          node,\n          actions,\n          loadNodeContent,\n          createContentDigest\n        });\n      }\n      expect(actions.createNode).toBeCalled();\n      expect(actions.createNode.mock.calls[0]).toMatchSnapshot();\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-javascript-frontmatter/src/__tests__"},{"name":"should pass fileAbsolutePath to node if file type is \"File\"","suites":["gatsby-transformer-javascript-frontmatter","onCreateNode"],"updatePoint":{"line":125,"column":67,"index":3363},"line":125,"code":"    it(`should pass fileAbsolutePath to node if file type is \"File\"`, async () => {\n      node.internal.type = `File`;\n      node.absolutePath = `bar`;\n      const shouldCreateNode = shouldOnCreateNode({\n        node\n      });\n      if (shouldCreateNode) {\n        await onCreateNode({\n          node,\n          actions,\n          loadNodeContent,\n          createContentDigest\n        });\n      }\n      expect(actions.createNode.mock.calls[0][0].fileAbsolutePath).toEqual(node.absolutePath);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-javascript-frontmatter/src/__tests__"},{"name":"correctly creates nodes from JSON which is an array of objects","suites":["Process JSON nodes correctly"],"updatePoint":{"line":58,"column":68,"index":1393},"line":58,"code":"  it(`correctly creates nodes from JSON which is an array of objects`, async () => {\n    const data = [{\n      id: `foo`,\n      blue: true,\n      funny: `yup`\n    }, {\n      blue: false,\n      funny: `nope`\n    }];\n    const node = {\n      ...baseFileNode,\n      content: JSON.stringify(data)\n    };\n    return bootstrapTest(node).then(({\n      createNode,\n      createParentChildLink\n    }) => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(2);\n      expect(createParentChildLink).toHaveBeenCalledTimes(2);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-json/src/__tests__"},{"name":"correctly creates a node from JSON which is a single object","suites":["Process JSON nodes correctly"],"updatePoint":{"line":81,"column":65,"index":2035},"line":81,"code":"  it(`correctly creates a node from JSON which is a single object`, async () => {\n    const data = {\n      id: `foo`,\n      blue: true,\n      funny: `yup`\n    };\n    const node = {\n      ...baseFileNode,\n      content: JSON.stringify(data)\n    };\n    return bootstrapTest(node).then(({\n      createNode,\n      createParentChildLink\n    }) => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(1);\n      expect(createParentChildLink).toHaveBeenCalledTimes(1);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-json/src/__tests__"},{"name":"creates a jsonId key if id was given","suites":["Process JSON nodes correctly"],"updatePoint":{"line":101,"column":42,"index":2604},"line":101,"code":"  it(`creates a jsonId key if id was given`, async () => {\n    const data = {\n      id: `123`,\n      blue: true,\n      funny: `yup`\n    };\n    const node = {\n      ...baseFileNode,\n      content: JSON.stringify(data)\n    };\n    return bootstrapTest(node).then(({\n      createNode,\n      createParentChildLink\n    }) => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(1);\n      expect(createParentChildLink).toHaveBeenCalledTimes(1);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-json/src/__tests__"},{"name":"correctly sets node type for array of objects","suites":["Process JSON nodes correctly"],"updatePoint":{"line":121,"column":51,"index":3182},"line":121,"code":"  it(`correctly sets node type for array of objects`, async () => {\n    ;\n    [{\n      typeName: null,\n      expectedNodeTypes: [`NodeNameJson`, `NodeNameJson`]\n    }, {\n      typeName: `fixed`,\n      expectedNodeTypes: [`fixed`, `fixed`]\n    }, {\n      typeName: ({\n        node,\n        object\n      }) => object.funny,\n      expectedNodeTypes: [`yup`, `nope`]\n    }].forEach(async ({\n      typeName,\n      expectedNodeTypes: [expectedOne, expectedTwo]\n    }) => {\n      const data = [{\n        id: `foo`,\n        blue: true,\n        funny: `yup`\n      }, {\n        blue: false,\n        funny: `nope`\n      }];\n      const node = {\n        ...baseFileNode,\n        content: JSON.stringify(data)\n      };\n      return bootstrapTest(node, {\n        typeName\n      }).then(({\n        createNode,\n        createParentChildLink\n      }) => {\n        expect(createNode).toBeCalledWith(expect.objectContaining({\n          internal: expect.objectContaining({\n            type: expectedOne\n          })\n        }));\n        expect(createNode).toBeCalledWith(expect.objectContaining({\n          internal: expect.objectContaining({\n            type: expectedTwo\n          })\n        }));\n      });\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-json/src/__tests__"},{"name":"correctly sets node type for single object","suites":["Process JSON nodes correctly"],"updatePoint":{"line":170,"column":48,"index":4382},"line":170,"code":"  it(`correctly sets node type for single object`, async () => {\n    ;\n    [{\n      typeName: null,\n      expectedNodeType: `FooJson`\n    }, {\n      typeName: `fixed`,\n      expectedNodeType: `fixed`\n    }, {\n      typeName: ({\n        node,\n        object\n      }) => object.funny,\n      expectedNodeType: `yup`\n    }].forEach(async ({\n      typeName,\n      expectedNodeType\n    }) => {\n      const data = {\n        id: `foo`,\n        blue: true,\n        funny: `yup`\n      };\n      const node = {\n        ...baseFileNode,\n        content: JSON.stringify(data)\n      };\n      return bootstrapTest(node, {\n        typeName\n      }).then(({\n        createNode,\n        createParentChildLink\n      }) => {\n        expect(createNode).toBeCalledWith(expect.objectContaining({\n          internal: expect.objectContaining({\n            type: expectedNodeType\n          })\n        }));\n      });\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-json/src/__tests__"},{"name":"correctly creates nodes from JSON which is an array of objects and doesn't come from fs","suites":["Process JSON nodes correctly"],"updatePoint":{"line":211,"column":93,"index":5330},"line":211,"code":"  it(`correctly creates nodes from JSON which is an array of objects and doesn't come from fs`, async () => {\n    const data = [{\n      id: `foo`,\n      blue: true,\n      funny: `yup`\n    }, {\n      blue: false,\n      funny: `nope`\n    }];\n    const node = {\n      ...baseNonFileNode,\n      content: JSON.stringify(data)\n    };\n    return bootstrapTest(node).then(({\n      createNode,\n      createParentChildLink\n    }) => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(2);\n      expect(createParentChildLink).toHaveBeenCalledTimes(2);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-json/src/__tests__"},{"name":"correctly creates a node from JSON which is a single object and doesn't come from fs","suites":["Process JSON nodes correctly"],"updatePoint":{"line":234,"column":90,"index":6000},"line":234,"code":"  it(`correctly creates a node from JSON which is a single object and doesn't come from fs`, async () => {\n    const data = {\n      id: `foo`,\n      blue: true,\n      funny: `yup`\n    };\n    const node = {\n      ...baseNonFileNode,\n      content: JSON.stringify(data)\n    };\n    return bootstrapTest(node).then(({\n      createNode,\n      createParentChildLink\n    }) => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(1);\n      expect(createParentChildLink).toHaveBeenCalledTimes(1);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-json/src/__tests__"},{"name":"should do nothing if file extension is not pdf","suites":["gatsby-transformer-pdf"],"updatePoint":{"line":26,"column":52,"index":679},"line":26,"code":"  it(`should do nothing if file extension is not pdf`, async () => {\n    node.extension = `js`;\n    const shouldCreateNode = shouldOnCreateNode({\n      node\n    });\n    if (shouldCreateNode) {\n      await onCreateNode({\n        node,\n        actions,\n        loadNodeContent,\n        createNodeId,\n        createContentDigest\n      });\n    }\n    expect(createNodeId).not.toHaveBeenCalled();\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-pdf/src/__tests__"},{"name":"should create node base on pdf data","suites":["gatsby-transformer-pdf"],"updatePoint":{"line":42,"column":41,"index":1065},"line":42,"code":"  it(`should create node base on pdf data`, async () => {\n    const shouldCreateNode = shouldOnCreateNode({\n      node\n    });\n    if (shouldCreateNode) {\n      await onCreateNode({\n        node,\n        actions,\n        loadNodeContent,\n        createNodeId,\n        createContentDigest\n      });\n    }\n    expect(actions.createNode).toHaveBeenCalledWith({\n      children: [],\n      content: expect.any(String),\n      id: `dummy >>> pdf`,\n      internal: {\n        contentDigest: `digest`,\n        type: `pdf`\n      },\n      parent: `dummy`\n    });\n    expect(actions.createParentChildLink).toHaveBeenCalledWith({\n      child: {\n        children: [],\n        content: expect.any(String),\n        id: `dummy >>> pdf`,\n        internal: {\n          contentDigest: `digest`,\n          type: `pdf`\n        },\n        parent: `dummy`\n      },\n      parent: node\n    });\n    expect(actions.createNode.mock.calls[0][0].content).toMatchSnapshot();\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-pdf/src/__tests__"},{"name":"Explicitly set displayName as member of React.createClass","suites":["DisplayNameHandler"],"updatePoint":{"line":17,"column":63,"index":503},"line":17,"code":"  it(`Explicitly set displayName as member of React.createClass`, () => {\n    const doc = parse(`\n    var MyComponent = React.createClass({ displayName: 'foo' });\n  `, displayNameHandler);\n    expect(doc).toEqual({\n      displayName: `foo`\n    });\n  });","file":"displayname-handler.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"Explicitly set displayName as static class member","suites":["DisplayNameHandler"],"updatePoint":{"line":25,"column":55,"index":749},"line":25,"code":"  it(`Explicitly set displayName as static class member`, () => {\n    const doc = parse(`\n    class MyComponent extends React.Component { static displayName = 'foo'; render() {} }\n  `, displayNameHandler);\n    expect(doc).toEqual({\n      displayName: `foo`\n    });\n  });","file":"displayname-handler.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"Infer displayName from function declaration/expression name","suites":["DisplayNameHandler"],"updatePoint":{"line":33,"column":65,"index":1030},"line":33,"code":"  it(`Infer displayName from function declaration/expression name`, () => {\n    {\n      const doc = parse(`\n      function MyComponent() { return <div />; }\n    `, displayNameHandler);\n      expect(doc).toEqual({\n        displayName: `MyComponent`\n      });\n    }\n    {\n      const doc = parse(`\n      var x = function MyComponent() { return <div />; }\n    `, displayNameHandler);\n      expect(doc).toEqual({\n        displayName: `MyComponent`\n      });\n    }\n  });","file":"displayname-handler.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"Infer displayName from class declaration/expression name","suites":["DisplayNameHandler"],"updatePoint":{"line":51,"column":62,"index":1493},"line":51,"code":"  it(`Infer displayName from class declaration/expression name`, () => {\n    {\n      const doc = parse(`\n      class MyComponent extends React.Component { render() {} }\n    `, displayNameHandler);\n      expect(doc).toEqual({\n        displayName: `MyComponent`\n      });\n    }\n    {\n      const doc = parse(`\n      var x = class MyComponent extends React.Component { render() {} }\n    `, displayNameHandler);\n      expect(doc).toEqual({\n        displayName: `MyComponent`\n      });\n    }\n  });","file":"displayname-handler.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"Infer displayName from variable declaration name","suites":["DisplayNameHandler"],"updatePoint":{"line":69,"column":54,"index":1978},"line":69,"code":"  it(`Infer displayName from variable declaration name`, () => {\n    const doc = parse(`\n    var Foo = React.createClass({});\n  `, displayNameHandler);\n    expect(doc).toEqual({\n      displayName: `Foo`\n    });\n  });","file":"displayname-handler.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"Infer displayName from assignment","suites":["DisplayNameHandler"],"updatePoint":{"line":77,"column":39,"index":2180},"line":77,"code":"  it(`Infer displayName from assignment`, () => {\n    const doc = parse(`\n    var Foo = {};\n    Foo.Bar = () => <div />\n  `, displayNameHandler);\n    expect(doc).toEqual({\n      displayName: `Foo.Bar`\n    });\n  });","file":"displayname-handler.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"Infer displayName from file name","suites":["DisplayNameHandler"],"updatePoint":{"line":86,"column":38,"index":2394},"line":86,"code":"  it(`Infer displayName from file name`, () => {\n    const doc = parse(`\n    module.exports = () => <div />;\n  `, createDisplayNameHandler(path.join(`foo`, `bar`, `MyComponent.js`)));\n    expect(doc).toEqual({\n      displayName: `MyComponent`\n    });\n  });","file":"displayname-handler.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"Infer displayName from file path","suites":["DisplayNameHandler"],"updatePoint":{"line":94,"column":38,"index":2651},"line":94,"code":"  it(`Infer displayName from file path`, () => {\n    {\n      const doc = parse(`\n      module.exports = () => <div />;\n    `, createDisplayNameHandler(path.join(`foo`, `MyComponent`, `index.js`)));\n      expect(doc).toEqual({\n        displayName: `MyComponent`\n      });\n    }\n    {\n      const doc = parse(`\n      module.exports = () => <div />;\n    `, createDisplayNameHandler(path.join(`foo`, `my-component`, `index.js`)));\n      expect(doc).toEqual({\n        displayName: `MyComponent`\n      });\n    }\n  });","file":"displayname-handler.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"Use default if displayName cannot be inferred","suites":["DisplayNameHandler"],"updatePoint":{"line":112,"column":51,"index":3176},"line":112,"code":"  it(`Use default if displayName cannot be inferred`, () => {\n    const doc = parse(`\n    module.exports = () => <div />;\n  `, displayNameHandler);\n    expect(doc).toEqual({\n      displayName: `UnknownComponent`\n    });\n  });","file":"displayname-handler.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should replace the undefined type with the tsType (string) definition","suites":["transformer-react-doc-gen: Doclets","tsType","doclets: []","tsType: { name: string }"],"updatePoint":{"line":10,"column":81,"index":387},"line":10,"code":"        it(`should replace the undefined type with the tsType (string) definition`, () => {\n          expect(applyPropDoclets({\n            doclets,\n            tsType\n          })).toHaveProperty(`type`, expect.objectContaining({\n            ...tsType\n          }));\n        });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should replace the undefined type with the ts Union Type","suites":["transformer-react-doc-gen: Doclets","tsType","doclets: []","tsType: { name: union, raw: \"number | any\", elements: [[Object], [Object]] }"],"updatePoint":{"line":25,"column":68,"index":900},"line":25,"code":"        it(`should replace the undefined type with the ts Union Type`, () => {\n          expect(applyPropDoclets({\n            doclets,\n            tsType\n          })).toHaveProperty(`type`, expect.objectContaining({\n            name: `union`,\n            value: [{\n              name: `number`\n            }, {\n              name: `any`\n            }]\n          }));\n        });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should replace the undefined type with the ts Raw Type React.Component<Props>","suites":["transformer-react-doc-gen: Doclets","tsType","doclets: []","tsType: { name: ReactComponent, raw: \"React.Component<Props>\", elements: [ [Object] ] }"],"updatePoint":{"line":45,"column":89,"index":1568},"line":45,"code":"        it(`should replace the undefined type with the ts Raw Type React.Component<Props>`, () => {\n          expect(applyPropDoclets({\n            doclets,\n            tsType\n          })).toHaveProperty(`type`, expect.objectContaining({\n            name: `React.Component<Props>`\n          }));\n        });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"doclet says number, typescript says string, doclet should win as default behavior","suites":["transformer-react-doc-gen: Doclets","tsType","doclets: [{ tag: \"type\", value: \"{number}\" }]","tsType: { name: string }"],"updatePoint":{"line":66,"column":93,"index":2202},"line":66,"code":"        it(`doclet says number, typescript says string, doclet should win as default behavior`, () => {\n          expect(applyPropDoclets({\n            doclets,\n            tsType\n          })).toHaveProperty(`type`, {\n            name: `number`\n          });\n        });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should set { name: \"string\" } as type","suites":["transformer-react-doc-gen: Doclets","doclets","type","[ { tag: \"type\", value: \"{string}\" } ]"],"updatePoint":{"line":84,"column":49,"index":2668},"line":84,"code":"        it(`should set { name: \"string\" } as type`, () => {\n          expect(applyPropDoclets({\n            doclets\n          })).toHaveProperty(`type`, expect.objectContaining({\n            name: `string`\n          }));\n        });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should set { name: \"React.Component<Props>\" } as type","suites":["transformer-react-doc-gen: Doclets","doclets","type","[ { tag: \"type\", value: \"{React.Component<Props>}\" } ]"],"updatePoint":{"line":97,"column":65,"index":3114},"line":97,"code":"        it(`should set { name: \"React.Component<Props>\" } as type`, () => {\n          expect(applyPropDoclets({\n            doclets\n          })).toHaveProperty(`type`, {\n            name: `React.Component<Props>`\n          });\n        });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should set { name: \"number | any\" } as type","suites":["transformer-react-doc-gen: Doclets","doclets","type","[ { tag: \"type\", value: \"{(number | any)}\" } ]"],"updatePoint":{"line":110,"column":55,"index":3525},"line":110,"code":"        it(`should set { name: \"number | any\" } as type`, () => {\n          expect(applyPropDoclets({\n            doclets\n          })).toHaveProperty(`type`, expect.objectContaining({\n            name: `union`,\n            value: [{\n              name: `number`\n            }, {\n              name: `any`\n            }]\n          }));\n        });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should replace the undefined type with the flowType (string) definition","suites":["transformer-react-doc-gen: Doclets","flowType","doclets: []","flowType: { name: string }"],"updatePoint":{"line":132,"column":83,"index":4134},"line":132,"code":"        it(`should replace the undefined type with the flowType (string) definition`, () => {\n          expect(applyPropDoclets({\n            doclets,\n            flowType\n          })).toHaveProperty(`type`, expect.objectContaining({\n            ...flowType\n          }));\n        });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should replace the undefined type with the ts Union Type","suites":["transformer-react-doc-gen: Doclets","flowType","doclets: []","flowType: { name: union, raw: \"number | any\", elements: [[Object], [Object]] }"],"updatePoint":{"line":147,"column":68,"index":4655},"line":147,"code":"        it(`should replace the undefined type with the ts Union Type`, () => {\n          expect(applyPropDoclets({\n            doclets,\n            flowType\n          })).toHaveProperty(`type`, expect.objectContaining({\n            name: `union`,\n            value: [{\n              name: `number`\n            }, {\n              name: `any`\n            }]\n          }));\n        });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should replace the undefined type with the ts Raw Type React.Component<Props>","suites":["transformer-react-doc-gen: Doclets","flowType","doclets: []","flowType: { name: ReactComponent, raw: \"React.Component<Props>\", elements: [ [Object] ] }"],"updatePoint":{"line":167,"column":89,"index":5329},"line":167,"code":"        it(`should replace the undefined type with the ts Raw Type React.Component<Props>`, () => {\n          expect(applyPropDoclets({\n            doclets,\n            flowType\n          })).toHaveProperty(`type`, expect.objectContaining({\n            name: `React.Component<Props>`\n          }));\n        });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"doclet says number, typescript says string, doclet should win as default behauvior","suites":["transformer-react-doc-gen: Doclets","flowType","doclets: [{ tag: \"type\", value: \"{number}\" }]","flowType: { name: string }"],"updatePoint":{"line":186,"column":94,"index":5931},"line":186,"code":"        it(`doclet says number, typescript says string, doclet should win as default behauvior`, () => {\n          expect(applyPropDoclets({\n            doclets,\n            flowType\n          })).toHaveProperty(`type`, {\n            name: `number`\n          });\n        });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should return an object with the propety \"name\" equal to \"propertyName\"","suites":["transformer-react-doc-gen: Doclets","no types set "],"updatePoint":{"line":198,"column":79,"index":6251},"line":198,"code":"    it(`should return an object with the propety \"name\" equal to \"propertyName\"`, () => {\n      const doclets = [{\n        tag: `type`,\n        value: `propertyName`\n      }];\n      const type = undefined;\n      expect(applyPropDoclets({\n        doclets,\n        type\n      })).toHaveProperty(`type`, expect.objectContaining({\n        name: `propertyName`\n      }));\n    });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should apply @required","suites":["transformer-react-doc-gen: Doclets","no types set "],"updatePoint":{"line":212,"column":28,"index":6581},"line":212,"code":"  it(`should apply @required`, () => {\n    const doclets = [{\n      tag: `required`,\n      value: true\n    }];\n    expect(applyPropDoclets({\n      doclets\n    })).toEqual({\n      doclets,\n      required: true\n    });\n  });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should apply @required","suites":["transformer-react-doc-gen: Doclets","no types set "],"updatePoint":{"line":224,"column":28,"index":6804},"line":224,"code":"  it(`should apply @required`, () => {\n    const doclets = [{\n      tag: `defaultValue`,\n      value: `() => {}`\n    }];\n    expect(applyPropDoclets({\n      doclets\n    })).toEqual({\n      doclets,\n      defaultValue: {\n        value: `() => {}`,\n        computed: false\n      }\n    });\n  });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should handle inline enum types","suites":["transformer-react-doc-gen: Doclets","no types set "],"updatePoint":{"line":239,"column":37,"index":7106},"line":239,"code":"  it(`should handle inline enum types`, () => {\n    const doclets = [{\n      tag: `type`,\n      value: `{(true|'foo'|40|\"bar\")}`\n    }];\n    expect(applyPropDoclets({\n      doclets,\n      type: {}\n    })).toEqual({\n      doclets,\n      type: {\n        name: `enum`,\n        value: [{\n          value: `true`,\n          computed: false\n        }, {\n          value: `'foo'`,\n          computed: false\n        }, {\n          value: `40`,\n          computed: false\n        }, {\n          value: `\"bar\"`,\n          computed: false\n        }]\n      }\n    });\n  });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should create a union type for none-literals","suites":["transformer-react-doc-gen: Doclets","no types set "],"updatePoint":{"line":267,"column":50,"index":7679},"line":267,"code":"  it(`should create a union type for none-literals`, () => {\n    const doclets = [{\n      tag: `type`,\n      value: `{(string|func|bool)}`\n    }];\n    expect(applyPropDoclets({\n      doclets,\n      type: {}\n    })).toEqual({\n      doclets,\n      type: {\n        name: `union`,\n        value: [{\n          name: `string`\n        }, {\n          name: `func`\n        }, {\n          name: `bool`\n        }]\n      }\n    });\n  });","file":"doclets.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should only process javascript, jsx, and typescript nodes","suites":["transformer-react-doc-gen: onCreateNode"],"updatePoint":{"line":62,"column":63,"index":1711},"line":62,"code":"  it(`should only process javascript, jsx, and typescript nodes`, async () => {\n    loadNodeContent = jest.fn().mockResolvedValue(``);\n    const unknown = [null, {\n      internal: {\n        mediaType: `text/x-foo`\n      }\n    }, {\n      internal: {\n        mediaType: `text/markdown`\n      }\n    }];\n    const expected = [{\n      internal: {\n        mediaType: `application/javascript`\n      }\n    }, {\n      internal: {\n        mediaType: `text/jsx`\n      }\n    }, {\n      internal: {\n        mediaType: `text/tsx`\n      }\n    }, {\n      internal: {},\n      extension: `tsx`\n    }, {\n      internal: {},\n      extension: `ts`\n    }];\n    await Promise.all([].concat(unknown).concat(expected).map(node => run(node)));\n    expect(loadNodeContent).toHaveBeenCalledTimes(expected.length);\n  });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should extract all components in a file","suites":["transformer-react-doc-gen: onCreateNode"],"updatePoint":{"line":95,"column":45,"index":2485},"line":95,"code":"  it(`should extract all components in a file`, async () => {\n    await run(node);\n    const types = groupBy(createdNodes, n => n.internal.type);\n    expect(types.ComponentMetadata).toHaveLength(6);\n  });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should give all components a name","suites":["transformer-react-doc-gen: onCreateNode"],"updatePoint":{"line":100,"column":39,"index":2684},"line":100,"code":"  it(`should give all components a name`, async () => {\n    await run(node);\n    const types = groupBy(createdNodes, `internal.type`);\n    expect(types.ComponentMetadata.map(c => c.displayName)).toEqual([`Baz`, `Buz`, `Foo`, `Baz.Foo`, `Bar`, `Qux`]);\n  });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should handle duplicate doclet values","suites":["transformer-react-doc-gen: onCreateNode"],"updatePoint":{"line":105,"column":43,"index":2946},"line":105,"code":"  it(`should handle duplicate doclet values`, async () => {\n    await run(node);\n    const Bar = groupBy(createdNodes, `internal.type`).ComponentMetadata.find(d => d.displayName === `Bar`);\n    expect(Bar.doclets.filter(d => d.tag === `property`)).toHaveLength(2);\n  });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should infer a name","suites":["transformer-react-doc-gen: onCreateNode"],"updatePoint":{"line":110,"column":25,"index":3199},"line":110,"code":"  it(`should infer a name`, async () => {\n    node.__fixture = `unnamed.js`;\n    await run(node);\n    expect(groupBy(createdNodes, `internal.type`).ComponentMetadata[0].displayName).toEqual(`Unnamed`);\n  });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should create a description node when there is no description","suites":["transformer-react-doc-gen: onCreateNode"],"updatePoint":{"line":115,"column":67,"index":3449},"line":115,"code":"  it(`should create a description node when there is no description`, async () => {\n    node.__fixture = `unnamed.js`;\n    await run(node);\n    expect(groupBy(createdNodes, `internal.type`).ComponentDescription).toHaveLength(1);\n  });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should extract all propTypes","suites":["transformer-react-doc-gen: onCreateNode"],"updatePoint":{"line":120,"column":34,"index":3651},"line":120,"code":"  it(`should extract all propTypes`, async () => {\n    await run(node);\n    const types = groupBy(createdNodes, `internal.type`);\n    expect(types.ComponentProp).toHaveLength(14);\n  });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should delicately remove doclets","suites":["transformer-react-doc-gen: onCreateNode"],"updatePoint":{"line":125,"column":38,"index":3841},"line":125,"code":"  it(`should delicately remove doclets`, async () => {\n    await run(node);\n    const types = groupBy(createdNodes, `internal.type`);\n    const id = types.ComponentProp[0].id;\n    expect(types.ComponentProp[0].doclets).toEqual([{\n      tag: `type`,\n      value: `{Foo}`\n    }, {\n      tag: `default`,\n      value: `blue`\n    }]);\n    expect(types.ComponentDescription.find(d => d.parent === id).text).toEqual(`An object hash of field (fix this @mention?) errors for the form.`);\n  });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should extract create description nodes with markdown types","suites":["transformer-react-doc-gen: onCreateNode"],"updatePoint":{"line":138,"column":65,"index":4353},"line":138,"code":"  it(`should extract create description nodes with markdown types`, async () => {\n    await run(node);\n    const types = groupBy(createdNodes, `internal.type`);\n    expect(types.ComponentDescription.every(d => d.internal.mediaType === `text/markdown`)).toBe(true);\n  });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should allow specifying handlers","suites":["transformer-react-doc-gen: onCreateNode"],"updatePoint":{"line":143,"column":38,"index":4597},"line":143,"code":"  it(`should allow specifying handlers`, async () => {\n    const handler = jest.fn();\n    await run(node, {\n      handlers: [handler]\n    });\n    expect(!!handler.mock.calls.length).toBe(true);\n  });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should add flow type info","suites":["transformer-react-doc-gen: onCreateNode","flowTypes"],"updatePoint":{"line":154,"column":33,"index":4889},"line":154,"code":"    it(`should add flow type info`, async () => {\n      await run(node);\n      const created = createdNodes.map(f => f.flowType).filter(Boolean);\n      expect(created).toMatchSnapshot(`flow types`);\n    });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"literalsAndUnion property should be union type","suites":["transformer-react-doc-gen: onCreateNode","flowTypes"],"updatePoint":{"line":159,"column":54,"index":5117},"line":159,"code":"    it(`literalsAndUnion property should be union type`, async () => {\n      await run(node);\n      const created = createdNodes.find(f => f.name === `literalsAndUnion`);\n      expect(created.flowType).toEqual(expect.objectContaining({\n        name: `union`,\n        raw: `\"string\" | \"otherstring\" | number`\n      }));\n    });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"badDocumented property should flowType ReactNode","suites":["transformer-react-doc-gen: onCreateNode","flowTypes"],"updatePoint":{"line":167,"column":56,"index":5446},"line":167,"code":"    it(`badDocumented property should flowType ReactNode`, async () => {\n      await run(node);\n      const created = createdNodes.find(f => f.name === `badDocumented`);\n      expect(created.flowType).toEqual(expect.objectContaining({\n        name: `ReactNode`\n      }));\n    });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should add TS type info","suites":["transformer-react-doc-gen: onCreateNode","tsTypes"],"updatePoint":{"line":179,"column":31,"index":5809},"line":179,"code":"    it(`should add TS type info`, async () => {\n      await run(node, {\n        parserOpts: {\n          plugins: [`jsx`, `typescript`, `classProperties`]\n        }\n      });\n      const created = createdNodes.map(f => f.tsType).filter(Boolean);\n      expect(created).toMatchSnapshot(`typescript types`);\n    });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-react-docgen/src/__tests__"},{"name":"should provide meaningful errors when fields are invalid","suites":["gatsby-node.js"],"updatePoint":{"line":4,"column":62,"index":215},"line":4,"code":"  it(`should provide meaningful errors when fields are invalid`, async () => {\n    const expectedErrors = [`\"footnotes\" must be a boolean`, `\"gfm\" must be a boolean`, `\"plugins\" must be an array`, `\"jsFrontmatterEngine\" must be a boolean`];\n    const {\n      errors,\n      isValid\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      footnotes: `this should be a boolean`,\n      gfm: `this should be a boolean`,\n      plugins: `this should be an array`,\n      jsFrontmatterEngine: `this should be a boolean`\n    });\n    expect(isValid).toBe(false);\n    expect(errors).toEqual(expectedErrors);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-remark/src/__tests__"},{"name":"should validate the schema","suites":["gatsby-node.js"],"updatePoint":{"line":18,"column":32,"index":798},"line":18,"code":"  it(`should validate the schema`, async () => {\n    const {\n      isValid,\n      errors\n    } = await testPluginOptionsSchema(pluginOptionsSchema, {\n      footnotes: false,\n      gfm: false,\n      plugins: [`gatsby-remark-copy-linked-files`, {\n        resolve: `gatsby-remark-images`,\n        options: {\n          maxWidth: 756\n        }\n      }],\n      jsFrontmatterEngine: true\n    });\n    expect(isValid).toBe(true);\n    expect(errors).toEqual([]);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-remark/src/__tests__"},{"name":"Correctly creates a new MarkdownRemark node","suites":["Process markdown content correctly","Process generated markdown node correctly"],"updatePoint":{"line":32,"column":51,"index":790},"line":32,"code":"    it(`Correctly creates a new MarkdownRemark node`, async () => {\n      const content = `---\ntitle: \"my little pony\"\ndate: \"2017-09-18T23:19:51.246Z\"\n---\nWhere oh where is my little pony?\n            `;\n      node.content = content;\n      await onCreateNode({\n        node,\n        loadNodeContent,\n        actions,\n        createNodeId,\n        createContentDigest\n      }).then(() => {\n        expect(actions.createNode.mock.calls).toMatchSnapshot();\n        expect(_.isString(actions.createNode.mock.calls[0][0].frontmatter.date)).toBeTruthy();\n        expect(actions.createParentChildLink.mock.calls).toMatchSnapshot();\n        expect(actions.createNode).toHaveBeenCalledTimes(1);\n        expect(actions.createParentChildLink).toHaveBeenCalledTimes(1);\n      });\n    });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-remark/src/__tests__"},{"name":"Correctly parses a graymatter excerpt","suites":["Process markdown content correctly","Process generated markdown node correctly"],"updatePoint":{"line":54,"column":45,"index":1561},"line":54,"code":"    it(`Correctly parses a graymatter excerpt`, async () => {\n      const content = `---\ntitle: \"my little pony\"\ndate: \"2017-09-18T23:19:51.246Z\"\n---\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi auctor sit amet velit id facilisis. Nulla viverra, eros at efficitur pulvinar, lectus orci accumsan nisi, eu blandit elit nulla nec lectus. Integer porttitor imperdiet sapien. Quisque in orci sed nisi consequat aliquam. Aenean id mollis nisi. Sed auctor odio id erat facilisis venenatis. Quisque posuere faucibus libero vel fringilla.\n\nIn quis lectus sed eros efficitur luctus. Morbi tempor, nisl eget feugiat tincidunt, sem velit vulputate enim, nec interdum augue enim nec mauris. Nulla iaculis ante sed enim placerat pretium. Nulla metus odio, facilisis vestibulum lobortis vitae, bibendum at nunc. Donec sit amet efficitur metus, in bibendum nisi. Vivamus tempus vel turpis sit amet auctor. Maecenas luctus vestibulum velit, at sagittis leo volutpat quis. Praesent posuere nec augue eget sodales. Pellentesque vitae arcu ut est varius venenatis id maximus sem. Curabitur non consectetur turpis.\n\n<!-- end -->\n\nMaecenas sodales, arcu at dictum porta, sapien leo consectetur metus, nec rhoncus quam mauris vel odio. Vivamus sed sapien in massa pulvinar feugiat vel eu tellus. Nam rutrum sem nisi, vitae viverra erat varius ut. Praesent fringilla, metus in condimentum varius, ligula augue efficitur dolor, at tempus velit velit id arcu. Suspendisse urna est, blandit ac lacus id, efficitur semper purus. Etiam dignissim suscipit lorem accumsan ultricies. Duis lacinia tortor sapien, sed malesuada leo molestie nec. Sed lobortis varius ipsum, eu lobortis metus malesuada consequat. Sed purus nulla, tempor ac tincidunt et, blandit vel ex. Vestibulum id dolor non nulla posuere consectetur quis et turpis. Cras dolor metus, elementum a enim at, semper bibendum sapien. Sed lacus augue, laoreet in metus id, volutpat malesuada mauris.\n\nSed eu gravida mauris. Suspendisse potenti. Praesent sit amet egestas mi, sed hendrerit eros. Vestibulum congue scelerisque magna, id viverra justo congue nec. Duis id dapibus metus, et dictum erat. Nulla rhoncus a mauris nec tincidunt. Interdum et malesuada fames ac ante ipsum primis in faucibus. Donec elementum molestie ullamcorper. Nulla pulvinar feugiat mauris, placerat malesuada ligula rutrum non. Integer venenatis ex at dignissim fermentum. Nunc bibendum nulla in purus pharetra, non sodales justo fringilla.\n\nSed bibendum sem iaculis, pellentesque leo sed, imperdiet ante. Sed consequat mattis dui nec pretium. Donec vel consectetur est. Nam sagittis, libero vitae pretium pharetra, velit est dignissim erat, at cursus quam massa vitae ligula. Suspendisse potenti. In hac habitasse platea dictumst. Donec sit amet finibus justo. Mauris ante dolor, pulvinar vitae feugiat eu, rhoncus nec diam. In ut accumsan diam, faucibus fringilla odio. Nunc id ultricies turpis. Quisque justo quam, tristique sit amet interdum quis, facilisis at mi. Fusce porttitor vel sem ut condimentum. Praesent at libero congue, vulputate elit ut, rhoncus erat.\n            `;\n      node.content = content;\n      await onCreateNode({\n        node,\n        loadNodeContent,\n        actions,\n        createNodeId,\n        createContentDigest\n      }, {\n        excerpt_separator: `<!-- end -->`\n      }).then(() => {\n        expect(actions.createNode.mock.calls).toMatchSnapshot();\n        expect(_.isString(actions.createNode.mock.calls[0][0].excerpt)).toBeTruthy();\n        expect(actions.createNode.mock.calls[0][0].excerpt).not.toEqual(0);\n        expect(actions.createParentChildLink.mock.calls).toMatchSnapshot();\n        expect(actions.createNode).toHaveBeenCalledTimes(1);\n        expect(actions.createParentChildLink).toHaveBeenCalledTimes(1);\n      });\n    });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-remark/src/__tests__"},{"name":"coerces a date object into a date string","suites":["Process markdown content correctly","date formatting"],"updatePoint":{"line":97,"column":48,"index":5486},"line":97,"code":"    it(`coerces a date object into a date string`, async () => {\n      const date = `2019-01-01`;\n      node.content = getContent(date);\n      const parsed = await onCreateNode({\n        node,\n        actions,\n        createNodeId,\n        loadNodeContent,\n        createContentDigest\n      });\n      expect(parsed.frontmatter.date).toEqual(new Date(date).toJSON());\n    });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-remark/src/__tests__"},{"name":"Correctly queries an excerpt for a node with an excerpt separator","suites":["Process markdown content correctly","process graphql correctly"],"updatePoint":{"line":154,"column":73,"index":7225},"line":154,"code":"    it(`Correctly queries an excerpt for a node with an excerpt separator`, done => {\n      const content = `---\ntitle: \"my little pony\"\ndate: \"2017-09-18T23:19:51.246Z\"\n---\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi auctor sit amet velit id facilisis. Nulla viverra, eros at efficitur pulvinar, lectus orci accumsan nisi, eu blandit elit nulla nec lectus. Integer porttitor imperdiet sapien. Quisque in orci sed nisi consequat aliquam. Aenean id mollis nisi. Sed auctor odio id erat facilisis venenatis. Quisque posuere faucibus libero vel fringilla.\n\nIn quis lectus sed eros efficitur luctus. Morbi tempor, nisl eget feugiat tincidunt, sem velit vulputate enim, nec interdum augue enim nec mauris. Nulla iaculis ante sed enim placerat pretium. Nulla metus odio, facilisis vestibulum lobortis vitae, bibendum at nunc. Donec sit amet efficitur metus, in bibendum nisi. Vivamus tempus vel turpis sit amet auctor. Maecenas luctus vestibulum velit, at sagittis leo volutpat quis. Praesent posuere nec augue eget sodales. Pellentesque vitae arcu ut est varius venenatis id maximus sem. Curabitur non consectetur turpis.\n\n<!-- end -->\n\nMaecenas sodales, arcu at dictum porta, sapien leo consectetur metus, nec rhoncus quam mauris vel odio. Vivamus sed sapien in massa pulvinar feugiat vel eu tellus. Nam rutrum sem nisi, vitae viverra erat varius ut. Praesent fringilla, metus in condimentum varius, ligula augue efficitur dolor, at tempus velit velit id arcu. Suspendisse urna est, blandit ac lacus id, efficitur semper purus. Etiam dignissim suscipit lorem accumsan ultricies. Duis lacinia tortor sapien, sed malesuada leo molestie nec. Sed lobortis varius ipsum, eu lobortis metus malesuada consequat. Sed purus nulla, tempor ac tincidunt et, blandit vel ex. Vestibulum id dolor non nulla posuere consectetur quis et turpis. Cras dolor metus, elementum a enim at, semper bibendum sapien. Sed lacus augue, laoreet in metus id, volutpat malesuada mauris.\n\nSed eu gravida mauris. Suspendisse potenti. Praesent sit amet egestas mi, sed hendrerit eros. Vestibulum congue scelerisque magna, id viverra justo congue nec. Duis id dapibus metus, et dictum erat. Nulla rhoncus a mauris nec tincidunt. Interdum et malesuada fames ac ante ipsum primis in faucibus. Donec elementum molestie ullamcorper. Nulla pulvinar feugiat mauris, placerat malesuada ligula rutrum non. Integer venenatis ex at dignissim fermentum. Nunc bibendum nulla in purus pharetra, non sodales justo fringilla.\n\nSed bibendum sem iaculis, pellentesque leo sed, imperdiet ante. Sed consequat mattis dui nec pretium. Donec vel consectetur est. Nam sagittis, libero vitae pretium pharetra, velit est dignissim erat, at cursus quam massa vitae ligula. Suspendisse potenti. In hac habitasse platea dictumst. Donec sit amet finibus justo. Mauris ante dolor, pulvinar vitae feugiat eu, rhoncus nec diam. In ut accumsan diam, faucibus fringilla odio. Nunc id ultricies turpis. Quisque justo quam, tristique sit amet interdum quis, facilisis at mi. Fusce porttitor vel sem ut condimentum. Praesent at libero congue, vulputate elit ut, rhoncus erat.\n            `;\n      node.content = content;\n      let createdNode;\n      const createNode = markdownNode => queryResult([markdownNode], `\n                    excerpt\n                    frontmatter {\n                        title\n                    }\n                `).then(result => {\n        try {\n          createdNode = result.data.listNode[0];\n          expect(createdNode).toMatchSnapshot();\n          expect(createdNode.excerpt).toMatch(`Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi auctor sit amet velit id facilisis. Nulla viverra, eros at efficitur pulvinar, lectus orci accumsan nisi, eu blandit elit nulla nec lectus. Integer porttitor imperdiet sapien. Quisque in orci sed nisi consequat aliquam. Aenean id mollis nisi. Sed auctor odio id erat facilisis venenatis. Quisque posuere faucibus libero vel fringilla.\n\nIn quis lectus sed eros efficitur luctus. Morbi tempor, nisl eget feugiat tincidunt, sem velit vulputate enim, nec interdum augue enim nec mauris. Nulla iaculis ante sed enim placerat pretium. Nulla metus odio, facilisis vestibulum lobortis vitae, bibendum at nunc. Donec sit amet efficitur metus, in bibendum nisi. Vivamus tempus vel turpis sit amet auctor. Maecenas luctus vestibulum velit, at sagittis leo volutpat quis. Praesent posuere nec augue eget sodales. Pellentesque vitae arcu ut est varius venenatis id maximus sem. Curabitur non consectetur turpis.\n\n`);\n          done();\n        } catch (err) {\n          done.fail(err);\n        }\n      });\n      const createParentChildLink = jest.fn();\n      const actions = {\n        createNode,\n        createParentChildLink\n      };\n      const createNodeId = jest.fn();\n      createNodeId.mockReturnValue(`uuid-from-gatsby`);\n      onCreateNode({\n        node,\n        loadNodeContent,\n        actions,\n        createNodeId,\n        createContentDigest\n      }, {\n        excerpt_separator: `<!-- end -->`\n      });\n    });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-remark/src/__tests__"},{"name":"Correctly queries an excerpt for a node without an excerpt separator","suites":["Process markdown content correctly","process graphql correctly"],"updatePoint":{"line":209,"column":76,"index":12272},"line":209,"code":"    it(`Correctly queries an excerpt for a node without an excerpt separator`, done => {\n      const content = `---\ntitle: \"my little pony\"\ndate: \"2017-09-18T23:19:51.246Z\"\n---\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi auctor sit amet velit id facilisis. Nulla viverra, eros at efficitur pulvinar, lectus orci accumsan nisi, eu blandit elit nulla nec lectus. Integer porttitor imperdiet sapien. Quisque in orci sed nisi consequat aliquam. Aenean id mollis nisi. Sed auctor odio id erat facilisis venenatis. Quisque posuere faucibus libero vel fringilla.\n\nIn quis lectus sed eros efficitur luctus. Morbi tempor, nisl eget feugiat tincidunt, sem velit vulputate enim, nec interdum augue enim nec mauris. Nulla iaculis ante sed enim placerat pretium. Nulla metus odio, facilisis vestibulum lobortis vitae, bibendum at nunc. Donec sit amet efficitur metus, in bibendum nisi. Vivamus tempus vel turpis sit amet auctor. Maecenas luctus vestibulum velit, at sagittis leo volutpat quis. Praesent posuere nec augue eget sodales. Pellentesque vitae arcu ut est varius venenatis id maximus sem. Curabitur non consectetur turpis.\n\nMaecenas sodales, arcu at dictum porta, sapien leo consectetur metus, nec rhoncus quam mauris vel odio. Vivamus sed sapien in massa pulvinar feugiat vel eu tellus. Nam rutrum sem nisi, vitae viverra erat varius ut. Praesent fringilla, metus in condimentum varius, ligula augue efficitur dolor, at tempus velit velit id arcu. Suspendisse urna est, blandit ac lacus id, efficitur semper purus. Etiam dignissim suscipit lorem accumsan ultricies. Duis lacinia tortor sapien, sed malesuada leo molestie nec. Sed lobortis varius ipsum, eu lobortis metus malesuada consequat. Sed purus nulla, tempor ac tincidunt et, blandit vel ex. Vestibulum id dolor non nulla posuere consectetur quis et turpis. Cras dolor metus, elementum a enim at, semper bibendum sapien. Sed lacus augue, laoreet in metus id, volutpat malesuada mauris.\n\nSed eu gravida mauris. Suspendisse potenti. Praesent sit amet egestas mi, sed hendrerit eros. Vestibulum congue scelerisque magna, id viverra justo congue nec. Duis id dapibus metus, et dictum erat. Nulla rhoncus a mauris nec tincidunt. Interdum et malesuada fames ac ante ipsum primis in faucibus. Donec elementum molestie ullamcorper. Nulla pulvinar feugiat mauris, placerat malesuada ligula rutrum non. Integer venenatis ex at dignissim fermentum. Nunc bibendum nulla in purus pharetra, non sodales justo fringilla.\n\nSed bibendum sem iaculis, pellentesque leo sed, imperdiet ante. Sed consequat mattis dui nec pretium. Donec vel consectetur est. Nam sagittis, libero vitae pretium pharetra, velit est dignissim erat, at cursus quam massa vitae ligula. Suspendisse potenti. In hac habitasse platea dictumst. Donec sit amet finibus justo. Mauris ante dolor, pulvinar vitae feugiat eu, rhoncus nec diam. In ut accumsan diam, faucibus fringilla odio. Nunc id ultricies turpis. Quisque justo quam, tristique sit amet interdum quis, facilisis at mi. Fusce porttitor vel sem ut condimentum. Praesent at libero congue, vulputate elit ut, rhoncus erat.\n            `;\n      node.content = content;\n      let createdNode;\n      const createNode = markdownNode => queryResult([markdownNode], `\n                    excerpt\n                    frontmatter {\n                        title\n                    }\n                `).then(result => {\n        try {\n          createdNode = result.data.listNode[0];\n          expect(createdNode).toMatchSnapshot();\n          expect(createdNode.excerpt).toMatch(``);\n          done();\n        } catch (err) {\n          done.fail(err);\n        }\n      });\n      const createParentChildLink = jest.fn();\n      const actions = {\n        createNode,\n        createParentChildLink\n      };\n      const createNodeId = jest.fn();\n      createNodeId.mockReturnValue(`uuid-from-gatsby`);\n      onCreateNode({\n        node,\n        loadNodeContent,\n        actions,\n        createNodeId,\n        createContentDigest\n      });\n    });","file":"on-node-create.js","skipped":false,"dir":"packages/gatsby-transformer-remark/src/__tests__"},{"name":"correctly creates an ImageSharp node from a file image node","suites":["Process image nodes correctly"],"updatePoint":{"line":6,"column":65,"index":192},"line":6,"code":"  it(`correctly creates an ImageSharp node from a file image node`, async () => {\n    const node = {\n      extension: `png`,\n      id: `whatever`,\n      children: [],\n      internal: {\n        contentDigest: `whatever`,\n        type: `File`\n      }\n    };\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const shouldCreateNode = shouldOnCreateNode({\n      node\n    });\n    if (shouldCreateNode) {\n      await onCreateNode({\n        node,\n        actions,\n        createNodeId\n      });\n    }\n    expect(createNode.mock.calls).toMatchSnapshot();\n    expect(createParentChildLink.mock.calls).toMatchSnapshot();\n    expect(createNode).toHaveBeenCalledTimes(1);\n    expect(createParentChildLink).toHaveBeenCalledTimes(1);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-sharp/src/__tests__"},{"name":"doesn't create an ImageSharp node for a .gif file","suites":["Process image nodes correctly"],"updatePoint":{"line":39,"column":55,"index":1106},"line":39,"code":"  it(`doesn't create an ImageSharp node for a .gif file`, async () => {\n    const node = {\n      extension: `gif`,\n      id: `whatever`,\n      children: [],\n      internal: {\n        contentDigest: `whatever`,\n        type: `File`\n      }\n    };\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const shouldCreateNode = shouldOnCreateNode({\n      node\n    });\n    if (shouldCreateNode) {\n      await onCreateNode({\n        node,\n        actions,\n        createNodeId\n      });\n    }\n    expect(createNode).toHaveBeenCalledTimes(0);\n    expect(createParentChildLink).toHaveBeenCalledTimes(0);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-sharp/src/__tests__"},{"name":"doesn't create an ImageSharp node if parent is not a File","suites":["Process image nodes correctly"],"updatePoint":{"line":70,"column":63,"index":1911},"line":70,"code":"  it(`doesn't create an ImageSharp node if parent is not a File`, async () => {\n    const node = {\n      extension: `png`,\n      id: `whatever`,\n      children: [],\n      internal: {\n        contentDigest: `whatever`,\n        type: `NotAFile`\n      }\n    };\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const shouldCreateNode = shouldOnCreateNode({\n      node\n    });\n    if (shouldCreateNode) {\n      await onCreateNode({\n        node,\n        actions,\n        createNodeId\n      });\n    }\n    expect(createNode).toHaveBeenCalledTimes(0);\n    expect(createParentChildLink).toHaveBeenCalledTimes(0);\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-sharp/src/__tests__"},{"name":"not cached","suites":["gatsby-transformer-sqip","generateSqip"],"updatePoint":{"line":33,"column":18,"index":827},"line":33,"code":"    it(`not cached`, async () => {\n      const cache = {\n        get: jest.fn(),\n        set: jest.fn()\n      };\n      const numberOfPrimitives = 5;\n      const blur = 0;\n      const mode = 3;\n      const result = await generateSqip({\n        cache,\n        cacheDir,\n        absolutePath,\n        numberOfPrimitives,\n        blur,\n        mode\n      });\n      expect(result).toMatchSnapshot();\n      expect(sqip).toHaveBeenCalledTimes(1);\n      const sqipArgs = sqip.mock.calls[0][0];\n      expect(sqipArgs.filename).toMatch(absolutePath);\n      delete sqipArgs.filename;\n      expect(sqipArgs).toMatchSnapshot();\n      expect(exists).toHaveBeenCalledTimes(1);\n      expect(writeFile).toHaveBeenCalledTimes(1);\n      expect(readFile).toHaveBeenCalledTimes(0);\n    });","file":"generate-sqip.js","skipped":false,"dir":"packages/gatsby-transformer-sqip/src/__tests__"},{"name":"cached","suites":["gatsby-transformer-sqip","generateSqip"],"updatePoint":{"line":59,"column":14,"index":1592},"line":59,"code":"    it(`cached`, async () => {\n      exists.mockImplementationOnce(() => true);\n      const cache = {\n        get: jest.fn(),\n        set: jest.fn()\n      };\n      const numberOfPrimitives = 5;\n      const blur = 0;\n      const mode = 3;\n      const result = await generateSqip({\n        cache,\n        cacheDir,\n        absolutePath,\n        numberOfPrimitives,\n        blur,\n        mode\n      });\n      expect(result).toMatchSnapshot();\n      expect(sqip).toHaveBeenCalledTimes(0);\n      expect(exists).toHaveBeenCalledTimes(1);\n      expect(writeFile).toHaveBeenCalledTimes(0);\n      expect(readFile).toHaveBeenCalledTimes(1);\n    });","file":"generate-sqip.js","skipped":false,"dir":"packages/gatsby-transformer-sqip/src/__tests__"},{"name":"returns null for unsupported files","suites":["gatsby-transformer-sqip","generateSqip"],"updatePoint":{"line":82,"column":42,"index":2259},"line":82,"code":"    it(`returns null for unsupported files`, async () => {\n      exists.mockImplementationOnce(() => true);\n      const cache = {\n        get: jest.fn(),\n        set: jest.fn()\n      };\n      const numberOfPrimitives = 5;\n      const blur = 0;\n      const mode = 3;\n      const result = await generateSqip({\n        cache,\n        cacheDir,\n        absolutePath: absolutePath.replace(`.jpg`, `.svg`),\n        numberOfPrimitives,\n        blur,\n        mode\n      });\n      expect(result).toBe(null);\n      expect(sqip).toHaveBeenCalledTimes(0);\n      expect(exists).toHaveBeenCalledTimes(0);\n      expect(writeFile).toHaveBeenCalledTimes(0);\n      expect(readFile).toHaveBeenCalledTimes(0);\n    });","file":"generate-sqip.js","skipped":false,"dir":"packages/gatsby-transformer-sqip/src/__tests__"},{"name":"Correctly creates nodes from TOML test file","suites":["Process TOML nodes correctly"],"updatePoint":{"line":18,"column":49,"index":420},"line":18,"code":"  it(`Correctly creates nodes from TOML test file`, async () => {\n    // Unfortunately due to TOML limitations no JSON -> TOML converters exist,\n    // which means that we are stuck with JS template literals.\n    node.content = `\n    [the]\n    test_string = \"You'll hate me after this - #\"\n\n    [the.hard]\n    test_array = [ \"] \", \" # \"]      # ]\n    test_array2 = [ \"Test #11 ]proved that\", \"Experiment #9 was a success\" ]\n    another_test_string = \" Same thing, but with a string #\"\n    harder_test_string = \" And when \\\\\"'s are in the string, along with # \\\\\"\"\n    # Things will get harder\n\n        [the.hard.\"bit#\"]\n        \"what?\" = \"You don't think some user won't do that?\"\n        multi_line_array = [\n            \"]\",\n            # ] Oh yes I did\n            ]\n    `;\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(1);\n      expect(createParentChildLink).toHaveBeenCalledTimes(1);\n      expect(createContentDigest).toHaveBeenCalledTimes(1);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-toml/src/__tests__"},{"name":"correctly creates nodes from XML","suites":["Process XML nodes correctly"],"updatePoint":{"line":44,"column":38,"index":1376},"line":44,"code":"  it(`correctly creates nodes from XML`, async () => {\n    const createNode = jest.fn();\n    const createParentChildLink = jest.fn();\n    const actions = {\n      createNode,\n      createParentChildLink\n    };\n    const createNodeId = jest.fn();\n    createNodeId.mockReturnValue(`uuid-from-gatsby`);\n    const createContentDigest = jest.fn().mockReturnValue(`contentDigest`);\n    await onCreateNode({\n      node,\n      loadNodeContent,\n      actions,\n      createNodeId,\n      createContentDigest\n    }).then(() => {\n      expect(createNode.mock.calls).toMatchSnapshot();\n      expect(createParentChildLink.mock.calls).toMatchSnapshot();\n      expect(createNode).toHaveBeenCalledTimes(2);\n      expect(createParentChildLink).toHaveBeenCalledTimes(2);\n    });\n  });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-xml/src/__tests__"},{"name":"when no target type name is specified, the type name is based on the directory name","suites":["Processing YAML nodes with internal type 'File'","from a single YAML dictionary,"],"updatePoint":{"line":65,"column":91,"index":1776},"line":65,"code":"    it(`when no target type name is specified, the type name is based on the directory name`, async () => {\n      await onCreateNode(createNodeSpec);\n      expectCreatedNodesMatchingSnapshot(1);\n      expectCreatedNodeTypeName(`FooBarYaml`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-yaml/src/__tests__"},{"name":"with the specified target type name","suites":["Processing YAML nodes with internal type 'File'","from a single YAML dictionary,"],"updatePoint":{"line":70,"column":43,"index":1978},"line":70,"code":"    it(`with the specified target type name`, async () => {\n      await onCreateNode(createNodeSpec, {\n        typeName: `fixed`\n      });\n      expectCreatedNodesMatchingSnapshot(1);\n      expectCreatedNodeTypeName(`fixed`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-yaml/src/__tests__"},{"name":"with the target type name explicitly retrieved from the YAML content","suites":["Processing YAML nodes with internal type 'File'","from a single YAML dictionary,"],"updatePoint":{"line":77,"column":76,"index":2245},"line":77,"code":"    it(`with the target type name explicitly retrieved from the YAML content`, async () => {\n      // noinspection JSUnusedLocalSymbols (unused fields left as documentation)\n      await onCreateNode(createNodeSpec, {\n        typeName: ({\n          node,\n          object,\n          isArray\n        }) => object.funny\n      });\n      expectCreatedNodesMatchingSnapshot(1);\n      expectCreatedNodeTypeName(`yup`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-yaml/src/__tests__"},{"name":"when no target type name is specified, all nodes have a type name based on the file name","suites":["Processing YAML nodes with internal type 'File'","from a YAML array of dictionaries,"],"updatePoint":{"line":99,"column":96,"index":2913},"line":99,"code":"    it(`when no target type name is specified, all nodes have a type name based on the file name`, async () => {\n      await onCreateNode(createNodeSpec);\n      expectCreatedNodesMatchingSnapshot(2);\n      expectCreatedNodeTypeName(`MyFileYaml`);\n      expectCreatedNodeTypeName(`MyFileYaml`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-yaml/src/__tests__"},{"name":"with the specified target type name","suites":["Processing YAML nodes with internal type 'File'","from a YAML array of dictionaries,"],"updatePoint":{"line":105,"column":43,"index":3162},"line":105,"code":"    it(`with the specified target type name`, async () => {\n      await onCreateNode(createNodeSpec, {\n        typeName: `fixed`\n      });\n      expectCreatedNodesMatchingSnapshot(2);\n      expectCreatedNodeTypeName(`fixed`);\n      expectCreatedNodeTypeName(`fixed`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-yaml/src/__tests__"},{"name":"with the target type name explicitly retrieved from the YAML content","suites":["Processing YAML nodes with internal type 'File'","from a YAML array of dictionaries,"],"updatePoint":{"line":113,"column":76,"index":3471},"line":113,"code":"    it(`with the target type name explicitly retrieved from the YAML content`, async () => {\n      // noinspection JSUnusedLocalSymbols (unused fields left as documentation)\n      await onCreateNode(createNodeSpec, {\n        typeName: ({\n          node,\n          object,\n          isArray\n        }) => object.funny\n      });\n      expectCreatedNodesMatchingSnapshot(2);\n      expectCreatedNodeTypeName(`yup`);\n      expectCreatedNodeTypeName(`nope`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-yaml/src/__tests__"},{"name":"when no target type name is specified, the type name is based on the original node's internal type","suites":["Processing YAML nodes with internal type other than 'File'","from a single YAML dictionary,"],"updatePoint":{"line":140,"column":106,"index":4295},"line":140,"code":"    it(`when no target type name is specified, the type name is based on the original node's internal type`, async () => {\n      await onCreateNode(createNodeSpec);\n      expectCreatedNodesMatchingSnapshot(1);\n      expectCreatedNodeTypeName(`OtherYaml`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-yaml/src/__tests__"},{"name":"with the specified target type name","suites":["Processing YAML nodes with internal type other than 'File'","from a single YAML dictionary,"],"updatePoint":{"line":145,"column":43,"index":4496},"line":145,"code":"    it(`with the specified target type name`, async () => {\n      await onCreateNode(createNodeSpec, {\n        typeName: `fixed`\n      });\n      expectCreatedNodesMatchingSnapshot(1);\n      expectCreatedNodeTypeName(`fixed`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-yaml/src/__tests__"},{"name":"with the target type name explicitly retrieved from the YAML content","suites":["Processing YAML nodes with internal type other than 'File'","from a single YAML dictionary,"],"updatePoint":{"line":152,"column":76,"index":4763},"line":152,"code":"    it(`with the target type name explicitly retrieved from the YAML content`, async () => {\n      // noinspection JSUnusedLocalSymbols (unused fields left as documentation)\n      await onCreateNode(createNodeSpec, {\n        typeName: ({\n          node,\n          object,\n          isArray\n        }) => object.funny\n      });\n      expectCreatedNodesMatchingSnapshot(1);\n      expectCreatedNodeTypeName(`yup`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-yaml/src/__tests__"},{"name":"when no target type name is specified, all nodes have a type name based on the original node's internal type","suites":["Processing YAML nodes with internal type other than 'File'","from a YAML array of dictionaries,"],"updatePoint":{"line":174,"column":116,"index":5451},"line":174,"code":"    it(`when no target type name is specified, all nodes have a type name based on the original node's internal type`, async () => {\n      await onCreateNode(createNodeSpec);\n      expectCreatedNodesMatchingSnapshot(2);\n      expectCreatedNodeTypeName(`OtherYaml`);\n      expectCreatedNodeTypeName(`OtherYaml`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-yaml/src/__tests__"},{"name":"with the specified target type name","suites":["Processing YAML nodes with internal type other than 'File'","from a YAML array of dictionaries,"],"updatePoint":{"line":180,"column":43,"index":5698},"line":180,"code":"    it(`with the specified target type name`, async () => {\n      await onCreateNode(createNodeSpec, {\n        typeName: `fixed`\n      });\n      expectCreatedNodesMatchingSnapshot(2);\n      expectCreatedNodeTypeName(`fixed`);\n      expectCreatedNodeTypeName(`fixed`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-yaml/src/__tests__"},{"name":"with the target type name explicitly retrieved from the YAML content","suites":["Processing YAML nodes with internal type other than 'File'","from a YAML array of dictionaries,"],"updatePoint":{"line":188,"column":76,"index":6007},"line":188,"code":"    it(`with the target type name explicitly retrieved from the YAML content`, async () => {\n      // noinspection JSUnusedLocalSymbols (unused fields left as documentation)\n      await onCreateNode(createNodeSpec, {\n        typeName: ({\n          node,\n          object,\n          isArray\n        }) => object.funny\n      });\n      expectCreatedNodesMatchingSnapshot(2);\n      expectCreatedNodeTypeName(`yup`);\n      expectCreatedNodeTypeName(`nope`);\n    });","file":"gatsby-node.js","skipped":false,"dir":"packages/gatsby-transformer-yaml/src/__tests__"},{"name":"discovers exported functions","suites":["gatsby-worker"],"updatePoint":{"line":36,"column":34},"line":36,"code":"  it(`discovers exported functions`, () => {\n    if (!workerPool) {\n      fail(`worker pool not created`)\n    }\n\n    const exposedMethodsSingle = Object.keys(workerPool.single).sort()\n    const exposedMethodsAll = Object.keys(workerPool.all).sort()\n    // we expect that `notAFunction` even tho is exported in child module is not exposed\n    // as it's not a function\n    expect(exposedMethodsSingle).toMatchInlineSnapshot(`\n      Array [\n        \"async\",\n        \"async100ms\",\n        \"asyncThrow\",\n        \"getWasPonged\",\n        \"lotOfMessagesAndExit\",\n        \"neverEnding\",\n        \"pid\",\n        \"setupPingPongMessages\",\n        \"sync\",\n        \"syncThrow\",\n      ]\n    `)\n    // .all and .single should have same methods\n    expect(exposedMethodsSingle).toEqual(exposedMethodsAll)\n  })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"exported sync function","suites":["gatsby-worker",".single"],"updatePoint":{"line":64,"column":30},"line":64,"code":"    it(`exported sync function`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      const returnValue = workerPool.single.sync(`.single sync`)\n      // turns sync function into async\n      expect(isPromise(returnValue)).toEqual(true)\n\n      const resolvedValue = await returnValue\n      expect(resolvedValue).toMatchInlineSnapshot(`\"foo .single sync\"`)\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"exported async function","suites":["gatsby-worker",".single"],"updatePoint":{"line":77,"column":31},"line":77,"code":"    it(`exported async function`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      const returnValue = workerPool.single.async(`.single async`)\n      // promise is preserved\n      expect(isPromise(returnValue)).toEqual(true)\n\n      const resolvedValue = await returnValue\n      expect(resolvedValue).toMatchInlineSnapshot(`\"foo .single async\"`)\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"exported sync function that throws","suites":["gatsby-worker",".single"],"updatePoint":{"line":90,"column":42},"line":90,"code":"    it(`exported sync function that throws`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      expect.assertions(2)\n\n      const returnValue = workerPool.single.syncThrow(`.single syncThrow`)\n      // turns sync function into async\n      expect(isPromise(returnValue)).toEqual(true)\n\n      try {\n        await returnValue\n        fail(`promise should reject`)\n      } catch (e) {\n        expect(e).toMatchInlineSnapshot(`[Error: sync throw]`)\n      }\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"exported async function that throws","suites":["gatsby-worker",".single"],"updatePoint":{"line":109,"column":43},"line":109,"code":"    it(`exported async function that throws`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      expect.assertions(2)\n\n      const returnValue = workerPool.single.asyncThrow(`.single asyncThrow`)\n      // promise is preserved\n      expect(isPromise(returnValue)).toEqual(true)\n\n      try {\n        await returnValue\n        fail(`promise should reject`)\n      } catch (e) {\n        expect(e).toMatchInlineSnapshot(`[Error: async throw]`)\n      }\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"exported sync function","suites":["gatsby-worker",".all"],"updatePoint":{"line":130,"column":30},"line":130,"code":"    it(`exported sync function`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      const returnValue = workerPool.all.sync(`.single sync`, {\n        addWorkerId: true,\n      })\n\n      expect(returnValue).toBeArrayOfSize(numWorkers)\n      // turns sync function into async\n      expect(returnValue).toSatisfyAll(isPromise)\n\n      const resolvedValue = await Promise.all(returnValue)\n      expect(resolvedValue).toMatchInlineSnapshot(`\n        Array [\n          \"foo .single sync (worker #1)\",\n          \"foo .single sync (worker #2)\",\n        ]\n      `)\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"exported async function","suites":["gatsby-worker",".all"],"updatePoint":{"line":152,"column":31},"line":152,"code":"    it(`exported async function`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      const returnValue = workerPool.all.async(`.single async`, {\n        addWorkerId: true,\n      })\n\n      expect(returnValue).toBeArrayOfSize(numWorkers)\n      // promise is preserved\n      expect(returnValue).toSatisfyAll(isPromise)\n\n      const resolvedValue = await Promise.all(returnValue)\n      expect(resolvedValue).toMatchInlineSnapshot(`\n        Array [\n          \"foo .single async (worker #1)\",\n          \"foo .single async (worker #2)\",\n        ]\n      `)\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"exported sync function that throws","suites":["gatsby-worker",".all"],"updatePoint":{"line":174,"column":42},"line":174,"code":"    it(`exported sync function that throws`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      expect.assertions(3)\n\n      const returnValue = workerPool.all.syncThrow(`.single syncThrow`, {\n        addWorkerId: true,\n        throwOnWorker: 2,\n      })\n      expect(returnValue).toBeArrayOfSize(numWorkers)\n      // turns sync function into async\n      expect(returnValue).toSatisfyAll(isPromise)\n\n      try {\n        await Promise.all(returnValue)\n        fail(`promise should reject`)\n      } catch (e) {\n        expect(e).toMatchInlineSnapshot(`[Error: sync throw (worker #2)]`)\n      }\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"exported async function that throws","suites":["gatsby-worker",".all"],"updatePoint":{"line":197,"column":43},"line":197,"code":"    it(`exported async function that throws`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      expect.assertions(3)\n\n      const returnValue = workerPool.all.asyncThrow(`.single asyncThrow`, {\n        addWorkerId: true,\n        throwOnWorker: 2,\n      })\n      expect(returnValue).toBeArrayOfSize(numWorkers)\n      // promise is preserved\n      expect(returnValue).toSatisfyAll(isPromise)\n\n      try {\n        await Promise.all(returnValue)\n        fail(`promise should reject`)\n      } catch (e) {\n        expect(e).toMatchInlineSnapshot(`[Error: async throw (worker #2)]`)\n      }\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"fails currently executed and pending tasks when worker is closed","suites":["gatsby-worker",".end"],"updatePoint":{"line":222,"column":72},"line":222,"code":"    it(`fails currently executed and pending tasks when worker is closed`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      expect.assertions(numWorkers * 2)\n\n      // queueing 2 * numWorkers task, so that currently executed tasks reject\n      // as well as pending tasks\n      for (let i = 0; i < numWorkers * 2; i++) {\n        workerPool.single\n          .neverEnding()\n          .then(() => {\n            fail(`promise should reject`)\n          })\n          .catch(e => {\n            expect(e).toMatchInlineSnapshot(\n              `[Error: Worker exited before finishing task]`\n            )\n          })\n      }\n\n      await endWorkerPool()\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"spawns new processes on restart","suites":["gatsby-worker",".restart"],"updatePoint":{"line":249,"column":39},"line":249,"code":"    it(`spawns new processes on restart`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      const initialPids = await Promise.all(workerPool.all.pid())\n\n      // sanity checks:\n      expect(initialPids).toBeArrayOfSize(numWorkers)\n      expect(initialPids).toSatisfyAll(value => typeof value === `number`)\n\n      await workerPool.restart()\n      const newPids = await Promise.all(workerPool.all.pid())\n      expect(newPids).toBeArrayOfSize(numWorkers)\n      expect(newPids).toSatisfyAll(value => !initialPids.includes(value))\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"kills old processes on restart","suites":["gatsby-worker",".restart"],"updatePoint":{"line":266,"column":38},"line":266,"code":"    it(`kills old processes on restart`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      const initialPids = await Promise.all(workerPool.all.pid())\n\n      // sanity checks:\n      expect(initialPids).toBeArrayOfSize(numWorkers)\n      expect(initialPids).toSatisfyAll(pid => isRunning(pid))\n\n      await workerPool.restart()\n      expect(initialPids).toSatisfyAll(pid => !isRunning(pid))\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":".single works after restart","suites":["gatsby-worker",".restart"],"updatePoint":{"line":281,"column":35},"line":281,"code":"    it(`.single works after restart`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      const returnValue = workerPool.single.async(`.single async`)\n      // promise is preserved\n      expect(isPromise(returnValue)).toEqual(true)\n\n      const resolvedValue = await returnValue\n      expect(resolvedValue).toMatchInlineSnapshot(`\"foo .single async\"`)\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":".all works after restart","suites":["gatsby-worker",".restart"],"updatePoint":{"line":294,"column":32},"line":294,"code":"    it(`.all works after restart`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      const returnValue = workerPool.all.async(`.single async`, {\n        addWorkerId: true,\n      })\n\n      expect(returnValue).toBeArrayOfSize(numWorkers)\n      // promise is preserved\n      expect(returnValue).toSatisfyAll(isPromise)\n\n      const resolvedValue = await Promise.all(returnValue)\n      expect(resolvedValue).toMatchInlineSnapshot(`\n        Array [\n          \"foo .single async (worker #1)\",\n          \"foo .single async (worker #2)\",\n        ]\n      `)\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"fails currently executed and pending tasks when worker is restarted","suites":["gatsby-worker",".restart"],"updatePoint":{"line":316,"column":75},"line":316,"code":"    it(`fails currently executed and pending tasks when worker is restarted`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      expect.assertions(numWorkers * 2)\n\n      // queueing 2 * numWorkers task, so that currently executed tasks reject\n      // as well as pending tasks\n      for (let i = 0; i < numWorkers * 2; i++) {\n        workerPool.single\n          .neverEnding()\n          .then(() => {\n            fail(`promise should reject`)\n          })\n          .catch(e => {\n            expect(e).toMatchInlineSnapshot(\n              `[Error: Worker exited before finishing task]`\n            )\n          })\n      }\n\n      await workerPool.restart()\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"distributes task between workers when using .single","suites":["gatsby-worker","task queue"],"updatePoint":{"line":343,"column":59},"line":343,"code":"    it(`distributes task between workers when using .single`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      interface IReturnOfasync100ms {\n        taskId: number\n        workerId: string\n      }\n\n      const promises: Array<Promise<IReturnOfasync100ms>> = []\n      const resultsOrder: Array<IReturnOfasync100ms> = []\n      const numTask = numWorkers * 10\n      for (let taskId = 1; taskId <= numTask; taskId++) {\n        const promise = workerPool.single.async100ms(taskId, {\n          addWorkerId: true,\n        })\n        promise.then(res => {\n          resultsOrder.push(res)\n        })\n        promises.push(promise)\n      }\n\n      await Promise.all(promises)\n\n      expect(resultsOrder).toBeArrayOfSize(numTask)\n\n      const executedOnWorker1 = resultsOrder.filter(res => res.workerId === `1`)\n      const executedOnWorker2 = resultsOrder.filter(res => res.workerId === `2`)\n\n      // each worker executed some tasks - we can't ensure that task are evenly split\n      // so just making sure there are some tasks executed in each worker\n      expect(executedOnWorker1.length).toBeGreaterThan(0)\n      expect(executedOnWorker2.length).toBeGreaterThan(0)\n\n      // results from each worker came in order of being called\n      expect(executedOnWorker1).toEqual(\n        executedOnWorker1.sort((a, b) => a.taskId - b.taskId)\n      )\n      expect(executedOnWorker2).toEqual(\n        executedOnWorker2.sort((a, b) => a.taskId - b.taskId)\n      )\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"worker can receive and send messages","suites":["gatsby-worker","messaging"],"updatePoint":{"line":389,"column":44},"line":389,"code":"    it(`worker can receive and send messages`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n\n      workerPool.onMessage((msg, workerId) => {\n        if (msg.type === `PING`) {\n          if (!workerPool) {\n            fail(`worker pool not created`)\n          }\n          workerPool.sendMessage({ type: `PONG` }, workerId)\n        }\n      })\n\n      // baseline - workers shouldn't be PONGed yet\n      expect(await Promise.all(workerPool.all.getWasPonged()))\n        .toMatchInlineSnapshot(`\n        Array [\n          false,\n          false,\n        ]\n      `)\n\n      await Promise.all(workerPool.all.setupPingPongMessages())\n\n      expect(await Promise.all(workerPool.all.getWasPonged()))\n        .toMatchInlineSnapshot(`\n        Array [\n          true,\n          true,\n        ]\n      `)\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"sending message to worker that doesn't exist throws error","suites":["gatsby-worker","messaging"],"updatePoint":{"line":423,"column":65},"line":423,"code":"    it(`sending message to worker that doesn't exist throws error`, async () => {\n      expect(() => {\n        if (!workerPool) {\n          fail(`worker pool not created`)\n        }\n\n        workerPool.sendMessage({ type: `PONG` }, 9001)\n      }).toThrowError(`There is no worker with \"9001\" id.`)\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"messages are not lost if worker exits soon after sending a message","suites":["gatsby-worker","messaging"],"updatePoint":{"line":433,"column":74},"line":433,"code":"    it(`messages are not lost if worker exits soon after sending a message`, async () => {\n      if (!workerPool) {\n        fail(`worker pool not created`)\n      }\n      const COUNT = 10000\n\n      let counter = 0\n      workerPool.onMessage(msg => {\n        if (msg.type === `LOT_OF_MESSAGES_TEST`) {\n          counter++\n        }\n      })\n\n      try {\n        await workerPool.single.lotOfMessagesAndExit(COUNT)\n      } catch (e) {\n        console.log(e)\n      }\n\n      expect(counter).toEqual(COUNT)\n    })","file":"integration.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"correctly holds all queued items in order","suites":["Task Queue"],"updatePoint":{"line":13,"column":47},"line":13,"code":"  it(`correctly holds all queued items in order`, () => {\n    const taskQueue = new TaskQueue<number | string>()\n\n    for (let i = 1; i <= 20; i++) {\n      taskQueue.enqueue(i)\n    }\n\n    expect(getValuesInQueue(taskQueue)).toMatchInlineSnapshot(`\n      Array [\n        1,\n        2,\n        3,\n        4,\n        5,\n        6,\n        7,\n        8,\n        9,\n        10,\n        11,\n        12,\n        13,\n        14,\n        15,\n        16,\n        17,\n        18,\n        19,\n        20,\n      ]\n    `)\n  })","file":"task-queue.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"handles removing first item","suites":["Task Queue"],"updatePoint":{"line":46,"column":33},"line":46,"code":"  it(`handles removing first item`, () => {\n    const taskQueue = new TaskQueue<number | string>()\n\n    for (let i = 1; i <= 20; i++) {\n      taskQueue.enqueue(i)\n    }\n\n    for (const item of taskQueue) {\n      if (item.value === 1) {\n        taskQueue.remove(item)\n        break\n      }\n    }\n\n    taskQueue.enqueue(`added after removal`)\n\n    expect(getValuesInQueue(taskQueue)).toMatchInlineSnapshot(`\n      Array [\n        2,\n        3,\n        4,\n        5,\n        6,\n        7,\n        8,\n        9,\n        10,\n        11,\n        12,\n        13,\n        14,\n        15,\n        16,\n        17,\n        18,\n        19,\n        20,\n        \"added after removal\",\n      ]\n    `)\n  })","file":"task-queue.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"handles removing last item","suites":["Task Queue"],"updatePoint":{"line":88,"column":32},"line":88,"code":"  it(`handles removing last item`, () => {\n    const taskQueue = new TaskQueue<number | string>()\n\n    for (let i = 1; i <= 20; i++) {\n      taskQueue.enqueue(i)\n    }\n\n    for (const item of taskQueue) {\n      if (item.value === 20) {\n        taskQueue.remove(item)\n        break\n      }\n    }\n\n    taskQueue.enqueue(`added after removal`)\n\n    expect(getValuesInQueue(taskQueue)).toMatchInlineSnapshot(`\n      Array [\n        1,\n        2,\n        3,\n        4,\n        5,\n        6,\n        7,\n        8,\n        9,\n        10,\n        11,\n        12,\n        13,\n        14,\n        15,\n        16,\n        17,\n        18,\n        19,\n        \"added after removal\",\n      ]\n    `)\n  })","file":"task-queue.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"handles removing item in the middle","suites":["Task Queue"],"updatePoint":{"line":130,"column":41},"line":130,"code":"  it(`handles removing item in the middle`, () => {\n    const taskQueue = new TaskQueue<number | string>()\n\n    for (let i = 1; i <= 20; i++) {\n      taskQueue.enqueue(i)\n    }\n\n    for (const item of taskQueue) {\n      if (item.value === 11) {\n        taskQueue.remove(item)\n        break\n      }\n    }\n\n    taskQueue.enqueue(`added after removal`)\n\n    expect(getValuesInQueue(taskQueue)).toMatchInlineSnapshot(`\n      Array [\n        1,\n        2,\n        3,\n        4,\n        5,\n        6,\n        7,\n        8,\n        9,\n        10,\n        12,\n        13,\n        14,\n        15,\n        16,\n        17,\n        18,\n        19,\n        20,\n        \"added after removal\",\n      ]\n    `)\n  })","file":"task-queue.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"queue can fill up after being drained","suites":["Task Queue"],"updatePoint":{"line":172,"column":43},"line":172,"code":"  it(`queue can fill up after being drained`, () => {\n    const taskQueue = new TaskQueue<number | string>()\n\n    taskQueue.enqueue(1)\n    taskQueue.enqueue(2)\n\n    expect(getValuesInQueue(taskQueue)).toMatchInlineSnapshot(`\n      Array [\n        1,\n        2,\n      ]\n    `)\n\n    for (const item of taskQueue) {\n      taskQueue.remove(item)\n    }\n\n    expect(getValuesInQueue(taskQueue)).toMatchInlineSnapshot(`Array []`)\n\n    taskQueue.enqueue(3)\n    taskQueue.enqueue(4)\n\n    expect(getValuesInQueue(taskQueue)).toMatchInlineSnapshot(`\n      Array [\n        3,\n        4,\n      ]\n    `)\n  })","file":"task-queue.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"%s","suites":["Task Queue","Removed node is not referenced in .next or .prev"],"line":212,"code":"    it.each([\n      [`removed from head`, 1],\n      [`removed from middle`, 2],\n      [`removed from tail`, 3],\n    ])(`%s`, (_label, itemToRemove) => {\n      for (const item of taskQueue) {\n        if (item.value === itemToRemove) {\n          taskQueue.remove(item)\n        }\n      }\n\n      for (const item of taskQueue) {\n        if (item.value === itemToRemove) {\n          fail(`\"${itemToRemove}\" found as value`)\n        }\n\n        if (item?.prev?.value === itemToRemove) {\n          fail(`\"${itemToRemove}\" found as value of previous node`)\n        }\n\n        if (item?.next?.value === itemToRemove) {\n          fail(`\"${itemToRemove}\" found as value of next node`)\n        }\n      }\n    })","file":"task-queue.ts","skipped":false,"dir":"packages/gatsby-worker/src/__tests__"},{"name":"Shadowing e2e: %s","suites":[],"line":5,"code":"test.each([[`inits but does not use shadowing`, {\n  mode: `development`,\n  entry: `./index.js`,\n  resolve: {\n    plugins: [new ShadowRealm({\n      extensions: [`.wasm`, `.mjs`, `.js`, `.json`],\n      themes: [],\n      projectRoot: path.resolve(__dirname, `fixtures/test-sites/non-usage`)\n    })]\n  }\n}, {\n  context: path.resolve(__dirname, `fixtures/test-sites/non-usage`)\n}, `./index.js`], [`shadows a single .js file`, {\n  mode: `development`,\n  entry: `./index.js`,\n  resolve: {\n    plugins: [new ShadowRealm({\n      extensions: [`.wasm`, `.mjs`, `.js`, `.json`],\n      themes: [{\n        themeName: `theme-a`,\n        themeDir: path.join(__dirname, `./fixtures/test-sites/basic-shadowing/node_modules/theme-a`)\n      }],\n      projectRoot: path.resolve(__dirname, `fixtures/test-sites/basic-shadowing`)\n    })]\n  }\n}, {\n  context: path.resolve(__dirname, `fixtures/test-sites/basic-shadowing`)\n}, `./src/theme-a/components.js`], [`shadows a single .css file`, {\n  mode: `development`,\n  entry: `./index.js`,\n  resolve: {\n    plugins: [new ShadowRealm({\n      extensions: [`.wasm`, `.mjs`, `.js`, `.json`],\n      themes: [{\n        themeName: `theme-a`,\n        themeDir: path.join(__dirname, `./fixtures/test-sites/css-shadowing/node_modules/theme-a`)\n      }],\n      projectRoot: path.resolve(__dirname, `fixtures/test-sites/css-shadowing`)\n    })]\n  },\n  module: {\n    rules: [{\n      test: /\\.css$/,\n      use: `gatsby-raw-loader`\n    }]\n  },\n  resolveLoader: {\n    modules: [`../../fake-loaders`]\n  }\n}, {\n  context: path.resolve(__dirname, `fixtures/test-sites/css-shadowing`)\n}, `./src/theme-a/styles.css`], [`shadows .tsx with .js and .tsx`, {\n  mode: `development`,\n  entry: `./index.js`,\n  resolve: {\n    extensions: [`.ts`, `.tsx`, `.js`],\n    plugins: [new ShadowRealm({\n      extensions: [`.ts`, `.tsx`, `.js`],\n      themes: [{\n        themeName: `theme-a`,\n        themeDir: path.join(__dirname, `./fixtures/test-sites/ts-shadowing/node_modules/theme-a`)\n      }],\n      projectRoot: path.resolve(__dirname, `fixtures/test-sites/ts-shadowing`)\n    })]\n  },\n  module: {\n    rules: [{\n      test: /\\.tsx?$/,\n      use: `gatsby-raw-loader`\n    }]\n  },\n  resolveLoader: {\n    modules: [`../../fake-loaders`]\n  }\n}, {\n  context: path.resolve(__dirname, `fixtures/test-sites/ts-shadowing`)\n}, [`./src/theme-a/file-a.tsx`, `./src/theme-a/file-b.js`, `./src/theme-a/file-c.ts`]], [`shadows in a yarn-style workspace`, {\n  mode: `development`,\n  entry: `./index.js`,\n  resolve: {\n    extensions: [`.ts`, `.tsx`, `.js`],\n    plugins: [new ShadowRealm({\n      extensions: [`.ts`, `.tsx`, `.js`],\n      themes: [{\n        themeName: `theme-a`,\n        themeDir: path.join(__dirname, `./fixtures/test-sites/workspace-shadowing/packages/theme-a`)\n      }],\n      projectRoot: path.resolve(__dirname, `fixtures/test-sites/workspace-shadowing/packages/site`)\n    })]\n  },\n  module: {\n    rules: [{\n      test: /\\.tsx?$/,\n      use: `gatsby-raw-loader`\n    }]\n  },\n  resolveLoader: {\n    modules: [`../../fake-loaders`]\n  }\n}, {\n  context: path.resolve(__dirname, `fixtures/test-sites/workspace-shadowing`),\n  setup: () => {\n    // Yarn/Lerna workspaces are implemented by creating symlinks from node_modules/<modulename>\n    // to the actual location of the package (for example packages/<modulename>). In this test,\n    // we need a fixture that complies with such structure. However, restoration of symlinks in\n    // git repositories is unreliable on Windows. We therefore programmatically create the\n    // expeced structure here.\n\n    if (fs.existsSync(`node_modules`)) {\n      fs.rmdirSync(`node_modules`, {\n        recursive: true\n      });\n    }\n    fs.mkdirSync(`node_modules`);\n    process.chdir(`node_modules`);\n    fs.symlinkSync(`../packages/site`, `site`, `junction`);\n    fs.symlinkSync(`../packages/theme-a`, `theme-a`, `junction`);\n    process.chdir(`../`);\n\n    //\n    process.chdir(`packages/site`);\n  },\n  cleanup: () => {\n    process.chdir(`../..`);\n    fs.rmdirSync(`node_modules`, {\n      recursive: true\n    });\n  }\n}, [`./src/theme-a/file-a.tsx`,\n// index.js => theme-a/file-a ==shadow=> src/theme-a/file-a.tsx\n`./src/theme-a/file-b.js`,\n// index.js => theme-a/file-b ==shadow=> src/theme-a/file-b.js\n`./src/theme-a/file-c.js`,\n// index.js => theme-a/file-c ==shadow=> src/theme-a/file-c.js\n`../theme-a/src/file-c.ts`,\n// src/theme-a/file-c.js => theme-a/src/file-c.js (no shadow)\n`../theme-a/src/file-d.ts` // src/theme-a/file-c.js => theme-a/src/file-d.js\n]], [`support for legacy extension handling`, {\n  mode: `development`,\n  entry: `./index.js`,\n  resolve: {\n    extensions: [`.js`, `.customscript`],\n    plugins: [new ShadowRealm({\n      extensions: [`.js`, `.customscript`],\n      themes: [{\n        themeName: `theme-a`,\n        themeDir: path.join(__dirname, `./fixtures/test-sites/legacy-extensions-shadowing/node_modules/theme-a`)\n      }],\n      projectRoot: path.resolve(__dirname, `fixtures/test-sites/legacy-extensions-shadowing`)\n    })]\n  },\n  module: {\n    rules: [{\n      test: /\\.customscript?$/,\n      use: `gatsby-raw-loader`\n    }]\n  },\n  resolveLoader: {\n    modules: [`../../fake-loaders`]\n  }\n}, {\n  context: path.resolve(__dirname, `fixtures/test-sites/legacy-extensions-shadowing`)\n}, [`./node_modules/theme-a/src/file-a.js`, `./src/theme-a/file-b.js`, `./src/theme-a/file-c.customscript`]], [`edge case; extra extensions in filename`, {\n  mode: `development`,\n  entry: `./index.js`,\n  resolve: {\n    extensions: [`.js`, `.tsx`],\n    alias: {\n      \"@components\": path.join(__dirname, `./fixtures/test-sites/dot-shadowing/node_modules/theme-a/src`)\n    },\n    plugins: [new ShadowRealm({\n      extensions: [`.js`, `.tsx`],\n      themes: [{\n        themeName: `theme-a`,\n        themeDir: path.join(__dirname, `./fixtures/test-sites/dot-shadowing/node_modules/theme-a`)\n      }],\n      projectRoot: path.resolve(__dirname, `fixtures/test-sites/dot-shadowing`)\n    })]\n  }\n}, {\n  context: path.resolve(__dirname, `fixtures/test-sites/dot-shadowing`)\n}, `./src/theme-a/Some.Component.js`]])(`Shadowing e2e: %s`, (testName, config, {\n  context,\n  setup,\n  cleanup\n}, shadowPath, done) => {\n  // shadowing wants process.cwd() to be the root of the site.\n  // so change it from this dir to each of the example projects\n  // when running them\n  const oldCwd = process.cwd();\n  const newCwd = context;\n  process.chdir(newCwd);\n  if (typeof setup === `function`) setup();\n  webpack(config, (err, stats) => {\n    try {\n      // start error handling\n      if (err) {\n        done(err.stack || err);\n        return;\n      }\n      const info = stats.toJson();\n      if (stats.hasErrors()) {\n        done(info.errors);\n      }\n      if (stats.hasWarnings()) {\n        done(info.warnings);\n      }\n      // end error handling\n\n      const statsJSON = stats.toJson({\n        assets: false,\n        hash: true\n      });\n      const moduleNames = statsJSON.modules.map(({\n        name\n      }) => name);\n      if (Array.isArray(shadowPath)) {\n        shadowPath.forEach(aShadowPath => {\n          expect(moduleNames.includes(aShadowPath)).toBe(true);\n        });\n      } else {\n        expect(moduleNames.includes(shadowPath)).toBe(true);\n      }\n      done();\n    } finally {\n      if (typeof cleanup === `function`) cleanup();\n      process.chdir(oldCwd);\n    }\n  });\n});","file":"e2e.js","skipped":false,"dir":"packages/gatsby/src/internal-plugins/webpack-theme-component-shadowing/__tests__"},{"name":"gets matching themes","suites":["Component Shadowing"],"line":7,"code":"  it.each([[\n  // simple request path to a theme's component\n  `/some/place/a-theme/src/components/a-component`, {\n    themeDir: `/some/place/a-theme`,\n    themeName: `a-theme`\n  }, `/components/a-component`], [\n  // request to a shadowed component in theme b\n  // component-path is expected to be `a-theme/components/a-component`\n  `/some/place/theme-b/src/a-theme/components/a-component`, {\n    themeDir: `/some/place/theme-b`,\n    themeName: `theme-b`\n  }, `/a-theme/components/a-component`]])(`gets matching themes`, (componentFullPath, {\n    themeDir,\n    themeName\n  }, component) => {\n    const plugin = new ShadowingPlugin({\n      themes: [`a-theme`, `theme-b`, `gatsby-theme-c`, `@orgname/theme-d`].map(name => {\n        return {\n          themeName: name,\n          themeDir: xplatPath(`/some/place/${name}`)\n        };\n      }),\n      extensions: []\n    });\n    expect(plugin.getThemeAndComponent(xplatPath(componentFullPath))).toEqual([{\n      themeDir: xplatPath(themeDir),\n      themeName\n    }, xplatPath(component)]);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby/src/internal-plugins/webpack-theme-component-shadowing/__tests__"},{"name":"can determine if the request path is in the shadow chain for the issuer","suites":["Component Shadowing"],"line":36,"code":"  it.each([[{\n    // issuer is in `theme-b`\n    issuerPath: `/some/node_modules/theme-b/src/a-theme/components/a-component`,\n    // require'ing a file it is a \"shadow child\" of in a-theme\n    requestPath: `/some/node_modules/a-theme/src/components/a-component`,\n    userSiteDir: `/some`\n  }, true], [{\n    // issuer is in `theme-b`\n    issuerPath: `/some/node_modules/theme-b/src/a-theme/components/a-component`,\n    // require'ing a file it is NOT a \"shadow child\" of, also in theme-b\n    // the `component-path` here would be \"components/a-component\"\n    requestPath: `/some/node_modules/theme-b/src/components/a-component`,\n    userSiteDir: `/some`\n  }, false], [{\n    // issuer is in the user's site\n    issuerPath: `/some/src/theme-b/components/a-component`,\n    // require'ing a file it is a \"shadow child\" of\n    requestPath: `/some/node_modules/theme-b/src/components/a-component`,\n    userSiteDir: `/some`\n  }, true], [{\n    // issuer is in the user's site\n    issuerPath: `/some/src/@orgname/theme-d/components/a-component`,\n    // require'ing a file it is a \"shadow child\" of\n    requestPath: `/some/node_modules/@orgname/theme-d/src/components/a-component`,\n    userSiteDir: `/some`\n  }, true]])(`can determine if the request path is in the shadow chain for the issuer`, ({\n    issuerPath,\n    requestPath,\n    userSiteDir\n  }, result) => {\n    const plugin = new ShadowingPlugin({\n      themes: [`a-theme`, `theme-b`, `gatsby-theme-c`, `@orgname/theme-d`].map(name => {\n        return {\n          themeName: name,\n          themeDir: xplatPath(`/some/node_modules/${name}`)\n        };\n      })\n    });\n    const [theme, component] = plugin.getThemeAndComponent(xplatPath(requestPath));\n    expect(plugin.requestPathIsIssuerShadowPath({\n      // issuer is in `theme-b`\n      issuerPath: xplatPath(issuerPath),\n      // require'ing a file it is a \"shadow child\" of in a-theme\n      theme,\n      component,\n      userSiteDir: xplatPath(userSiteDir)\n    })).toEqual(result);\n  });","file":"index.js","skipped":false,"dir":"packages/gatsby/src/internal-plugins/webpack-theme-component-shadowing/__tests__"}]}